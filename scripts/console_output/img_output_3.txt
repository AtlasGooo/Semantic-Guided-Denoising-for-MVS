DIR_NAME: g:\Workspaces\Anaconda_ws\Semantic_Denoising_MVS\scripts 

DEVICE: cuda? True

Graph params:
(pLambda,pAlpha,pCigma_int,pCigma_spa,pB,pK,pQ): 
(20,10,0.07,3,9,20,3)

cv_MatI numpy: 
[[66 67 68 ... 85 91 95]
 [68 65 68 ... 89 91 94]
 [68 67 68 ... 90 90 95]
 ...
 [50 48 50 ... 82 81 78]
 [51 46 50 ... 82 78 79]
 [48 47 47 ... 82 74 80]]
MatI: 
tensor([[66., 67., 68.,  ..., 85., 91., 95.],
        [68., 65., 68.,  ..., 89., 91., 94.],
        [68., 67., 68.,  ..., 90., 90., 95.],
        ...,
        [50., 48., 50.,  ..., 82., 81., 78.],
        [51., 46., 50.,  ..., 82., 78., 79.],
        [48., 47., 47.,  ..., 82., 74., 80.]])
MatI[0:10,35:45]: 
tensor([[ 69.,  73.,  74.,  69.,  72.,  74.,  77.,  84.,  93.,  94.],
        [ 75.,  78.,  77.,  74.,  87.,  94.,  94.,  92.,  93.,  89.],
        [ 84.,  83.,  87.,  83.,  84.,  94.,  92.,  97.,  94.,  91.],
        [ 82.,  79.,  81.,  81.,  86.,  94., 102.,  95.,  94.,  89.],
        [ 88.,  84.,  77.,  87.,  93.,  94.,  93.,  92.,  94.,  86.],
        [ 81.,  83.,  95.,  82.,  98.,  95.,  96.,  98.,  93.,  88.],
        [ 81.,  83.,  94.,  99.,  94.,  94.,  97.,  91.,  84.,  88.],
        [ 88.,  93.,  95.,  94.,  94.,  93.,  92.,  94.,  93.,  99.],
        [ 87.,  97.,  94., 103.,  96.,  94., 103.,  97.,  95., 102.],
        [ 91.,  93.,  94.,  96.,  93.,  93.,  95.,  93.,  94.,  94.]]) 

debug:
MatD.shape: torch.Size([44, 73]) 
has nan? False 
MatD: 
tensor([[0.0152, 0.0149, 0.0147,  ..., 0.0118, 0.0110, 0.0105],
        [0.0147, 0.0154, 0.0147,  ..., 0.0112, 0.0110, 0.0106],
        [0.0147, 0.0149, 0.0147,  ..., 0.0111, 0.0111, 0.0105],
        ...,
        [0.0200, 0.0208, 0.0200,  ..., 0.0122, 0.0123, 0.0128],
        [0.0196, 0.0217, 0.0200,  ..., 0.0122, 0.0128, 0.0127],
        [0.0208, 0.0213, 0.0213,  ..., 0.0122, 0.0135, 0.0125]]) 

MatU.shape: torch.Size([44, 73, 2]) 
has nan? False 
MatUx: 
tensor([[-2.2614e-04, -2.1949e-04,  4.4563e-04,  ..., -7.7569e-04,
         -4.6269e-04, -4.6269e-04],
        [ 6.7873e-04, -6.7873e-04, -2.1313e-04,  ..., -2.4694e-04,
         -3.5071e-04, -3.5071e-04],
        [ 2.1949e-04, -2.1949e-04, -2.1313e-04,  ...,  1.0000e-10,
         -5.8480e-04, -5.8480e-04],
        ...,
        [ 8.3333e-04, -8.3333e-04, -1.1321e-03,  ...,  1.5056e-04,
          4.7483e-04,  4.7483e-04],
        [ 2.1313e-03, -1.7391e-03,  1.2766e-03,  ...,  6.2539e-04,
         -1.6228e-04, -1.6228e-04],
        [ 4.4326e-04,  1.0000e-10,  1.0000e-10,  ...,  1.3184e-03,
         -1.0135e-03, -1.0135e-03]]) 

MatD[0:10,35:45]: 
tensor([[0.0145, 0.0137, 0.0135, 0.0145, 0.0139, 0.0135, 0.0130, 0.0119, 0.0108,
         0.0106],
        [0.0133, 0.0128, 0.0130, 0.0135, 0.0115, 0.0106, 0.0106, 0.0109, 0.0108,
         0.0112],
        [0.0119, 0.0120, 0.0115, 0.0120, 0.0119, 0.0106, 0.0109, 0.0103, 0.0106,
         0.0110],
        [0.0122, 0.0127, 0.0123, 0.0123, 0.0116, 0.0106, 0.0098, 0.0105, 0.0106,
         0.0112],
        [0.0114, 0.0119, 0.0130, 0.0115, 0.0108, 0.0106, 0.0108, 0.0109, 0.0106,
         0.0116],
        [0.0123, 0.0120, 0.0105, 0.0122, 0.0102, 0.0105, 0.0104, 0.0102, 0.0108,
         0.0114],
        [0.0123, 0.0120, 0.0106, 0.0101, 0.0106, 0.0106, 0.0103, 0.0110, 0.0119,
         0.0114],
        [0.0114, 0.0108, 0.0105, 0.0106, 0.0106, 0.0108, 0.0109, 0.0106, 0.0108,
         0.0101],
        [0.0115, 0.0103, 0.0106, 0.0097, 0.0104, 0.0106, 0.0097, 0.0103, 0.0105,
         0.0098],
        [0.0110, 0.0108, 0.0106, 0.0104, 0.0108, 0.0108, 0.0105, 0.0108, 0.0106,
         0.0106]]) 

MatU[0:10,35:45]: 
tensor([[[-7.9412e-04, -1.1594e-03],
         [-1.8512e-04, -8.7812e-04],
         [ 9.7924e-04, -5.2650e-04],
         [-6.0386e-04, -9.7924e-04],
         [-3.7538e-04, -2.3946e-03],
         [-5.2650e-04, -2.8752e-03],
         [-1.0823e-03, -2.3487e-03],
         [-1.1521e-03, -1.0352e-03],
         [-1.1439e-04,  1.0000e-10],
         [-1.1198e-04,  5.9766e-04]],

        [[-5.1282e-04, -1.4286e-03],
         [ 1.6650e-04, -7.7232e-04],
         [ 5.2650e-04, -1.4928e-03],
         [-2.0193e-03, -1.4653e-03],
         [-8.5596e-04,  4.1051e-04],
         [ 1.0000e-10,  1.0000e-10],
         [ 2.3127e-04,  2.3127e-04],
         [-1.1688e-04, -5.6029e-04],
         [ 4.8327e-04, -1.1439e-04],
         [-5.9766e-04, -2.4694e-04]],

        [[ 1.4343e-04,  2.9036e-04],
         [-5.5394e-04,  6.1004e-04],
         [ 5.5394e-04,  8.5143e-04],
         [-1.4343e-04,  2.9749e-04],
         [-1.2665e-03, -2.7686e-04],
         [ 2.3127e-04,  1.0000e-10],
         [-5.6029e-04, -1.0656e-03],
         [ 3.2902e-04,  2.1704e-04],
         [ 3.5071e-04,  1.0000e-10],
         [ 1.2210e-04,  2.4694e-04]],

        [[ 4.6311e-04, -8.3148e-04],
         [-3.1255e-04, -7.5347e-04],
         [ 1.0000e-10,  6.4133e-04],
         [-7.1777e-04, -8.5143e-04],
         [-9.8961e-04, -8.7522e-04],
         [-8.3438e-04,  1.0000e-10],
         [ 7.2239e-04,  9.4877e-04],
         [ 1.1198e-04,  3.4325e-04],
         [ 5.9766e-04,  1.0000e-10],
         [-1.2484e-04,  3.9195e-04]],

        [[ 5.4113e-04,  9.8204e-04],
         [ 1.0823e-03,  1.4343e-04],
         [-1.4928e-03, -2.4607e-03],
         [-7.4156e-04,  7.0087e-04],
         [-1.1439e-04, -5.4861e-04],
         [ 1.1439e-04, -1.1198e-04],
         [ 1.1688e-04, -3.3602e-04],
         [-2.3127e-04, -6.6548e-04],
         [ 9.8961e-04,  1.1439e-04],
         [-6.3890e-04, -2.6427e-04]],

        [[-2.9749e-04,  1.0000e-10],
         [-1.5219e-03,  1.0000e-10],
         [ 1.6688e-03,  1.1198e-04],
         [-1.9910e-03, -2.0941e-03],
         [ 3.2223e-04,  4.3422e-04],
         [-1.0965e-04,  1.1198e-04],
         [-2.1259e-04, -1.0739e-04],
         [ 5.4861e-04,  7.8493e-04],
         [ 6.1095e-04,  1.1521e-03],
         [ 1.3062e-04,  1.0000e-10]],

        [[-2.9749e-04, -9.8204e-04],
         [-1.4099e-03, -1.2955e-03],
         [-5.3729e-04, -1.1198e-04],
         [ 5.3729e-04,  5.3729e-04],
         [ 1.0000e-10,  1.0000e-10],
         [-3.2902e-04,  1.1439e-04],
         [ 6.7973e-04,  5.6029e-04],
         [ 9.1575e-04, -3.5071e-04],
         [-5.4113e-04, -1.1521e-03],
         [-2.5253e-04, -1.2626e-03]],

        [[-6.1095e-04,  1.3062e-04],
         [-2.2637e-04, -4.4341e-04],
         [ 1.1198e-04,  1.1198e-04],
         [ 1.0000e-10, -9.2956e-04],
         [ 1.1439e-04, -2.2163e-04],
         [ 1.1688e-04, -1.1439e-04],
         [-2.3127e-04, -1.1608e-03],
         [ 1.1439e-04, -3.2902e-04],
         [-6.5168e-04, -2.2637e-04],
         [-2.9709e-04, -2.9709e-04]],

        [[-1.1850e-03, -5.0524e-04],
         [ 3.2902e-04,  4.4341e-04],
         [-9.2956e-04,  1.0000e-10],
         [ 7.0793e-04,  7.0793e-04],
         [ 2.2163e-04,  3.3602e-04],
         [-9.2956e-04,  1.1439e-04],
         [ 6.0054e-04,  8.1758e-04],
         [ 2.1704e-04,  4.4341e-04],
         [-7.2239e-04,  1.1198e-04],
         [ 5.0536e-04,  8.3438e-04]],

        [[-2.3632e-04, -2.3632e-04],
         [-1.1439e-04,  1.0000e-10],
         [-2.2163e-04,  1.1439e-04],
         [ 3.3602e-04,  6.9444e-04],
         [ 1.0000e-10,  1.1688e-04],
         [-2.2637e-04,  1.0000e-10],
         [ 2.2637e-04,  3.4325e-04],
         [-1.1439e-04,  1.0000e-10],
         [ 1.0000e-10, -3.2902e-04],
         [-9.2956e-04, -5.3729e-04]]]) 

Optimize & Adam params:
(n_iter,lr,betas,eps):
(20,0.0005,(0.9, 0.999),1e-08)










test_counter in loss_omega_mat(): 321
test_counter in loss_omega_mat(): 642
test_counter in loss_omega_mat(): 963
test_counter in loss_omega_mat(): 1284
test_counter in loss_omega_mat(): 1605
test_counter in loss_omega_mat(): 1926
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7572, 0.7571],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7571],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7573],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7573],
         [0.9460, 0.9460, 0.9459,  ..., 0.7574, 0.7574, 0.7573]],

        [[0.9459, 0.9458, 0.9458,  ..., 0.7570, 0.7544, 0.7543],
         [0.9459, 0.9458, 0.9458,  ..., 0.7573, 0.7572, 0.7547],
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7547],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7574],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7574],
         [0.9460, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7573]],

        [[0.9458, 0.9458, 0.9456,  ..., 0.7564, 0.7465, 0.7459],
         [0.9458, 0.9458, 0.9458,  ..., 0.7542, 0.7519, 0.7437],
         [0.9459, 0.9458, 0.9458,  ..., 0.7572, 0.7546, 0.7463],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7574],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7574],
         [0.9460, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7573]],

        ...,

        [[0.9412, 0.9395, 0.9380,  ..., 0.7394, 0.7305, 0.7245],
         [0.9452, 0.9448, 0.9419,  ..., 0.7447, 0.7413, 0.7296],
         [0.9455, 0.9453, 0.9452,  ..., 0.7534, 0.7528, 0.7433],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7571, 0.7571, 0.7571],
         [0.9459, 0.9457, 0.9457,  ..., 0.7571, 0.7570, 0.7568],
         [0.9459, 0.9457, 0.9457,  ..., 0.7572, 0.7569, 0.7567]],

        [[0.9380, 0.9376, 0.9361,  ..., 0.7430, 0.7389, 0.7384],
         [0.9419, 0.9412, 0.9375,  ..., 0.7474, 0.7443, 0.7339],
         [0.9453, 0.9453, 0.9448,  ..., 0.7529, 0.7525, 0.7439],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.7569, 0.7569, 0.7567],
         [0.9457, 0.9457, 0.9457,  ..., 0.7567, 0.7567, 0.7564],
         [0.9457, 0.9455, 0.9454,  ..., 0.7567, 0.7566, 0.7564]],

        [[0.9376, 0.9375, 0.9366,  ..., 0.7439, 0.7414, 0.7232],
         [0.9414, 0.9376, 0.9375,  ..., 0.7509, 0.7368, 0.7353],
         [0.9453, 0.9452, 0.9449,  ..., 0.7532, 0.7448, 0.7447],
         ...,
         [0.9456, 0.9456, 0.9456,  ..., 0.7568, 0.7566, 0.7565],
         [0.9457, 0.9456, 0.9456,  ..., 0.7566, 0.7565, 0.7560],
         [0.9457, 0.9454, 0.9452,  ..., 0.7563, 0.7563, 0.7563]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[5.1141e-08, 4.8176e-08, 4.8176e-08,  ..., 4.6068e-07,
          1.9270e-07, 4.1250e-06],
         [5.1141e-08, 2.1090e-07, 2.1090e-07,  ..., 3.2550e-08,
          5.4335e-08, 8.4362e-07],
         [1.0000e-20, 1.0000e-20, 1.0000e-20,  ..., 5.1141e-08,
          2.1090e-07, 4.8948e-07],
         ...,
         [1.4908e-08, 6.5982e-12, 1.4908e-08,  ..., 3.6626e-07,
          5.9634e-08, 5.4720e-08],
         [6.3769e-08, 6.3769e-08, 1.4241e-07,  ..., 5.7392e-07,
          5.9186e-07, 2.4411e-07],
         [1.0376e-20, 1.6303e-08, 1.0376e-20,  ..., 2.5231e-07,
          2.6084e-07, 1.4672e-07]],

        [[8.0681e-07, 1.2076e-06, 1.2076e-06,  ..., 3.0005e-06,
          1.3235e-06, 2.4278e-06],
         [8.4361e-07, 7.6233e-21, 1.2950e-06,  ..., 8.4361e-07,
          1.2950e-06, 7.6233e-21],
         [2.1090e-07, 2.1090e-07, 2.1090e-07,  ..., 1.3430e-06,
          1.2076e-06, 1.8255e-06],
         ...,
         [1.0376e-20, 1.0376e-20, 7.0457e-12,  ..., 1.6894e-08,
          1.0104e-06, 4.3934e-07],
         [1.0376e-20, 1.5586e-08, 7.5283e-12,  ..., 2.4938e-07,
          2.5948e-10, 7.5283e-12],
         [6.5210e-08, 1.6303e-08, 1.6303e-08,  ..., 5.6981e-08,
          1.4898e-07, 9.3385e-20]],

        [[1.1232e-06, 1.3553e-20, 1.1232e-06,  ..., 1.1232e-06,
          6.7252e-07, 4.8176e-08],
         [2.1090e-07, 1.1498e-06, 1.8716e-07,  ..., 7.4864e-07,
          1.8716e-07, 2.9979e-05],
         [2.1090e-07, 2.1090e-07, 2.1090e-07,  ..., 8.4361e-07,
          2.1090e-07, 2.1090e-07],
         ...,
         [1.3424e-07, 7.5283e-12, 1.3424e-07,  ..., 1.2270e-07,
          6.9066e-07, 1.1680e-06],
         [1.3823e-07, 6.0981e-08, 1.5586e-08,  ..., 3.7618e-07,
          7.4008e-07, 7.4008e-07],
         [6.3769e-08, 1.5586e-08, 6.3769e-08,  ..., 1.3612e-07,
          6.2344e-08, 2.5508e-07]],

        ...,

        [[2.3100e-07, 1.3863e-06, 1.3863e-06,  ..., 5.3288e-05,
          1.2351e-04, 6.0167e-06],
         [3.2908e-06, 1.9290e-06, 1.9290e-06,  ..., 1.0196e-04,
          9.5455e-06, 3.5847e-05],
         [7.7160e-06, 8.2047e-07, 8.2047e-07,  ..., 9.3351e-07,
          1.0220e-07, 6.5985e-06],
         ...,
         [1.1508e-06, 2.6750e-07, 3.0864e-07,  ..., 3.0864e-07,
          1.4292e-08, 3.1012e-06],
         [3.2377e-06, 4.8025e-07, 1.6314e-06,  ..., 7.6130e-08,
          7.3319e-06, 3.1024e-06],
         [2.3309e-07, 1.0273e-07, 1.1414e-06,  ..., 2.8457e-10,
          6.9444e-07, 2.3078e-06]],

        [[1.0273e-05, 5.3580e-05, 5.3580e-05,  ..., 1.0201e-04,
          4.4761e-04, 8.2731e-07],
         [2.3100e-07, 4.5424e-06, 4.5424e-06,  ..., 1.1987e-05,
          6.5493e-05, 9.8097e-05],
         [1.7868e-07, 1.8077e-07, 1.8077e-07,  ..., 1.5838e-06,
          2.0012e-05, 9.9635e-05],
         ...,
         [4.3779e-08, 2.7603e-08, 1.4091e-07,  ..., 2.0844e-06,
          2.0851e-07, 3.1942e-06],
         [1.0089e-07, 2.4365e-11, 7.7109e-07,  ..., 2.4846e-06,
          4.3129e-06, 3.0844e-06],
         [3.8298e-06, 3.0235e-06, 2.2547e-07,  ..., 6.3907e-06,
          1.1045e-05, 1.6802e-05]],

        [[1.3951e-04, 6.4051e-07, 6.4051e-07,  ..., 2.8159e-07,
          3.5608e-04, 7.5242e-05],
         [1.6660e-07, 1.6660e-07, 4.1039e-06,  ..., 1.5413e-06,
          6.9622e-06, 2.8496e-05],
         [7.0859e-06, 1.3553e-20, 1.3553e-20,  ..., 8.2047e-07,
          7.9271e-06, 1.7715e-06],
         ...,
         [5.5624e-07, 3.6198e-08, 1.0376e-20,  ..., 3.6198e-08,
          3.3614e-06, 2.1109e-06],
         [3.8611e-07, 4.0305e-08, 1.4340e-06,  ..., 8.8898e-06,
          1.4207e-06, 3.6921e-06],
         [3.3814e-07, 1.5977e-06, 3.8266e-08,  ..., 2.2445e-06,
          1.9290e-06, 7.5932e-07]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[6.6524e-06, 7.0778e-04, 6.7873e-04,  ..., 2.3350e-04,
          6.0766e-04, 2.1062e-03],
         [7.2173e-04, 1.0269e-03, 6.7873e-04,  ..., 6.6461e-04,
          8.3303e-04, 7.1334e-04],
         [4.5924e-04, 4.5924e-04, 8.3689e-04,  ..., 6.5021e-04,
          7.1764e-04, 7.3977e-04],
         ...,
         [1.1995e-04, 1.2470e-04, 1.1948e-04,  ..., 1.1683e-04,
          2.6709e-04, 5.5376e-04],
         [4.0107e-04, 1.7857e-04, 1.7656e-04,  ..., 5.2094e-04,
          1.0869e-03, 1.7882e-04],
         [2.8550e-04, 1.8057e-04, 4.6281e-04,  ..., 3.5324e-04,
          2.7071e-04, 6.8089e-04]],

        [[7.0778e-04, 1.1386e-03, 1.0605e-03,  ..., 7.8604e-04,
          1.3349e-03, 7.0778e-04],
         [1.0269e-03, 4.6001e-04, 1.1386e-03,  ..., 1.0269e-03,
          6.7986e-04, 6.3673e-03],
         [4.5924e-04, 0.0000e+00, 4.5924e-04,  ..., 1.1835e-03,
          6.6461e-04, 8.9226e-04],
         ...,
         [3.6366e-04, 3.8801e-06, 3.7537e-06,  ..., 2.6615e-04,
          1.1220e-03, 7.3264e-04],
         [3.9219e-04, 1.7857e-04, 3.8801e-06,  ..., 5.0685e-04,
          1.1266e-05, 2.4431e-04],
         [2.8550e-04, 1.2484e-04, 1.2768e-04,  ..., 1.6502e-04,
          2.8944e-04, 1.1669e-03]],

        [[1.0605e-03, 1.2486e-03, 1.1401e-03,  ..., 2.8764e-03,
          7.3146e-03, 7.7609e-03],
         [4.6001e-04, 1.2486e-03, 6.3092e-04,  ..., 2.1313e-04,
          6.3092e-04, 5.4659e-03],
         [0.0000e+00, 6.9234e-04, 0.0000e+00,  ..., 1.1616e-03,
          5.9749e-03, 7.9246e-03],
         ...,
         [1.2496e-04, 3.6366e-04, 6.0796e-04,  ..., 3.5851e-04,
          2.2011e-04, 4.8464e-04],
         [1.2496e-04, 1.7667e-04, 3.9219e-04,  ..., 4.3885e-04,
          3.8537e-04, 6.1333e-04],
         [1.2771e-04, 1.7667e-04, 2.4970e-04,  ..., 2.4701e-04,
          1.2771e-04, 4.3188e-04]],

        ...,

        [[1.1428e-03, 3.0209e-03, 4.5872e-03,  ..., 1.6397e-03,
          3.3167e-03, 1.8227e-03],
         [1.4525e-03, 3.3292e-03, 1.8840e-03,  ..., 7.7572e-03,
          7.0317e-03, 2.5401e-03],
         [2.6194e-03, 9.7584e-04, 1.4705e-03,  ..., 2.3213e-03,
          2.3577e-03, 6.0287e-03],
         ...,
         [1.0397e-03, 1.1909e-03, 7.5141e-04,  ..., 1.1357e-03,
          1.0760e-03, 1.6545e-03],
         [1.2440e-03, 6.7458e-04, 2.0983e-03,  ..., 2.3048e-03,
          1.0834e-03, 8.9742e-04],
         [2.2951e-04, 3.5573e-04, 8.3678e-04,  ..., 3.6322e-04,
          7.4789e-04, 1.2303e-03]],

        [[4.5872e-03, 1.3388e-02, 4.5455e-03,  ..., 5.8372e-03,
          9.2337e-03, 1.0840e-03],
         [1.8840e-03, 1.8147e-03, 1.6211e-03,  ..., 1.3148e-03,
          6.1019e-03, 2.0779e-03],
         [9.7584e-04, 3.4769e-03, 2.4132e-03,  ..., 3.4176e-03,
          5.5206e-04, 1.0801e-02],
         ...,
         [3.8411e-04, 7.5141e-04, 9.4851e-04,  ..., 7.4789e-04,
          1.0032e-03, 1.4450e-03],
         [6.7458e-04, 9.4851e-04, 1.1007e-03,  ..., 7.2462e-04,
          7.7167e-04, 2.2679e-03],
         [1.1007e-03, 5.7500e-04, 1.2734e-03,  ..., 1.4512e-03,
          1.5781e-03, 8.8701e-04]],

        [[1.3388e-02, 1.0365e-02, 8.3850e-03,  ..., 1.0801e-02,
          8.8837e-03, 1.0895e-02],
         [1.0784e-03, 1.0373e-03, 1.6211e-03,  ..., 9.5097e-04,
          3.3912e-03, 5.4547e-03],
         [3.4769e-03, 2.6028e-03, 3.7985e-03,  ..., 2.2057e-03,
          7.0535e-03, 3.0523e-03],
         ...,
         [8.3274e-04, 1.2414e-03, 1.3289e-03,  ..., 8.9742e-04,
          9.4705e-04, 7.8727e-04],
         [1.2632e-03, 1.3564e-03, 1.3289e-03,  ..., 9.0717e-04,
          9.5780e-04, 1.1822e-03],
         [1.2632e-03, 1.5349e-03, 1.7388e-03,  ..., 3.7750e-04,
          4.1297e-05, 1.0942e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:672.247314453125
Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([44, 73]) torch.Size([44, 73, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 4.1333e-02,  1.1312e-01,  3.2573e-01, -1.9696e-01, -3.8953e-01,
          2.2421e-02, -3.2409e-02,  1.1321e-01,  9.5512e-02,  1.6573e-02],
        [-1.1788e+01, -1.8042e+00, -5.8097e+00,  5.9337e+00,  7.0244e+00,
         -7.7034e-01, -6.3619e+00,  7.9460e+00,  2.8910e+00, -4.0773e+00],
        [-3.5570e+01, -1.6713e+01,  6.8361e+00,  1.5615e+01,  6.5354e+00,
          1.0840e+01,  1.7926e+01,  1.3955e+01, -9.0151e+00, -6.3598e+00],
        [-3.1026e+01,  1.1467e+01, -3.3173e+01,  8.7234e+01, -4.4145e+01,
         -1.3608e+01, -3.1957e+01, -6.8336e+01, -3.1162e+01,  2.9587e+01],
        [ 3.3471e+00,  3.9234e+01, -4.5122e+01, -4.7014e+01,  1.3122e+01,
          2.0653e+01, -4.2813e+01,  2.1092e+01,  8.2164e+01,  2.9828e+01],
        [-2.7240e+01, -5.3965e+01, -1.6460e+01,  1.6609e+01,  2.4410e+01,
          5.7868e+01,  2.8278e+01, -9.9595e+00, -9.8484e+00, -7.3583e+01],
        [ 1.1407e+01, -3.7184e+01,  1.4424e+01, -1.2226e+02, -3.9336e+01,
          3.0788e+00, -1.6311e+02, -7.1948e+01, -3.9269e+00, -5.5769e+01],
        [-1.7452e+01, -1.1608e+01, -6.3077e+00, -3.5373e+01,  3.9069e+01,
          1.0900e+01, -4.7034e+01,  4.3290e+01,  6.2410e+01,  6.2489e+01]]) 

MatU.grad[0:10,35:45]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 3.9586e+02, -2.0657e+02],
         [-5.8794e+00, -2.9639e+02],
         [ 7.6017e+01,  2.2935e+02],
         [-1.2107e+02, -6.2564e+01],
         [-1.1787e+02, -1.0906e+02],
         [-4.4924e+02, -5.1907e+01],
         [ 3.2316e+02,  3.3121e+02],
         [-1.0354e+02, -1.1984e+02],
         [ 1.5904e+02, -3.1127e+02],
         [-9.8480e+01,  1.4381e+02]],

        [[ 6.5747e+02,  8.9535e+02],
         [ 8.6372e+02,  3.5447e+02],
         [-3.0258e+02, -1.0923e+03],
         [-5.7342e+02,  7.3360e+02],
         [-1.1301e+02, -8.6870e+02],
         [ 4.4662e+02, -6.3065e+02],
         [-4.4894e+01, -9.6491e+02],
         [-4.2988e+02, -8.2652e+02],
         [ 8.8344e+02,  1.2980e+02],
         [-4.7008e+02,  1.5904e+02]],

        [[ 1.5317e+03,  6.2571e+02],
         [-3.4630e+03,  1.4106e+03],
         [ 5.0755e+03,  7.4007e+02],
         [-3.5965e+03, -3.7054e+03],
         [ 1.7688e+03,  2.9691e+03],
         [-1.1774e+03,  1.5422e+03],
         [-2.6334e+03, -8.4300e+02],
         [ 1.5209e+03,  3.5851e+03],
         [ 1.9117e+03,  4.7868e+03],
         [ 1.9728e+03,  1.0496e+03]],

        [[ 1.7504e+03, -3.7643e+03],
         [-2.7516e+03, -3.8130e+03],
         [-2.1111e+03,  6.3001e+01],
         [ 3.5058e+03,  3.3585e+03],
         [-2.1248e+02, -3.7079e+01],
         [-3.7212e+03,  1.4777e+03],
         [ 3.8593e+03,  2.4554e+03],
         [ 4.6298e+03, -1.8281e+03],
         [-2.4029e+03, -4.1191e+03],
         [ 8.0057e+02, -4.3722e+03]],

        [[ 4.7782e+02,  2.4805e+03],
         [ 1.4200e+03, -2.5647e+03],
         [ 2.0287e+03,  1.1072e+03],
         [ 5.7284e+02, -5.3442e+03],
         [ 1.4386e+03, -3.4629e+03],
         [ 8.0213e+02, -2.0043e+03],
         [-7.7718e+02, -5.9849e+03],
         [ 1.6327e+03, -2.6441e+03],
         [-3.1560e+03, -1.2214e+02],
         [-2.1375e+02, -3.6758e+02]],

        [[-2.0892e+03, -1.8790e+03],
         [ 3.8406e+03,  2.2447e+03],
         [-5.3186e+03,  2.9108e+02],
         [ 4.9204e+03,  4.2257e+03],
         [ 1.9689e+03,  2.3159e+03],
         [-6.2688e+03,  3.3291e+02],
         [ 3.6670e+03,  5.1607e+03],
         [ 1.9137e+03,  3.7242e+03],
         [-3.7402e+03,  2.3279e+03],
         [ 3.4592e+03,  4.2746e+03]],

        [[ 6.9496e+02, -2.0031e+03],
         [ 1.0950e+03, -3.3843e+02],
         [-2.1158e+03,  1.1217e+03],
         [ 2.1375e+03,  4.9045e+03],
         [ 2.0987e+01,  8.5601e+02],
         [-3.2955e+03, -9.0330e+02],
         [ 3.5351e+03,  3.4000e+03],
         [ 1.4671e+03, -1.8259e+01],
         [ 1.5296e+03, -3.2227e+03],
         [-3.8845e+03, -3.0399e+03]]]) 

MatD.grad: 
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.3667e+02,  6.5322e+01],
         [ 0.0000e+00, -3.1162e+02],
         [-3.0942e+02, -2.6769e+02],
         [ 1.8312e+02, -3.3747e+02],
         [-4.2988e+01, -3.7469e+02],
         [-1.1291e+02, -9.2260e+01]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.5142e+02,  4.3578e+00],
         [ 8.4317e+01,  9.1796e+01],
         [-1.8888e+01, -4.0704e+02],
         [-6.6516e+02, -3.0406e+02],
         [-5.9374e+01,  3.0656e+01],
         [ 4.3858e+02, -3.3385e+01],
         [-6.3507e+02,  8.6293e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 9.4179e+01, -2.7167e+02],
         [-1.5210e+02,  1.2321e+02],
         [-5.0657e+02, -8.4492e+02],
         [-1.1734e+03,  4.0116e+03],
         [-5.2911e+01,  1.1079e+03],
         [ 4.1407e+03,  2.9758e+03],
         [-4.7200e+03, -1.7771e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 3.2755e+02,  3.1029e+02],
         [-5.2676e+02, -1.6139e+02],
         [ 3.1279e+03, -2.6831e+03],
         [-4.0827e+03, -3.4889e+03],
         [ 3.5710e+03, -3.2827e+02],
         [-7.4084e+02, -3.4131e+02],
         [-4.7663e+03, -2.1742e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.8586e+02, -1.4108e+02],
         [-4.8268e+02,  1.5025e+02],
         [ 2.2583e+03,  1.8453e+03],
         [-7.9441e+02, -4.5204e+03],
         [ 2.5867e+03, -1.2745e+03],
         [-3.1291e+03, -4.3965e+02],
         [-4.3135e+03,  3.9247e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.2898e+02, -3.6186e+02],
         [-2.5035e+02, -4.7744e+02],
         [-5.2228e+02,  4.0477e+03],
         [ 5.6029e+02,  3.5741e+03],
         [ 2.5019e+03, -3.1201e+02],
         [ 8.5700e+02, -5.2648e+02],
         [-3.2030e+03,  2.6472e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 2.1403e+02,  3.6399e+02],
         [ 1.0247e+03,  5.6832e+02],
         [-3.6117e+03, -6.3688e+02],
         [-4.3218e+02,  4.6941e+03],
         [ 1.2541e+03, -7.3222e+02],
         [ 4.1263e+03, -3.1746e+02],
         [-5.0823e+03, -5.6925e+02]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[   49.3212,   159.8844],
         [ 3356.5959,   440.0557],
         [-3846.3535,  1316.7123],
         [ 4085.4163,   909.9816],
         [-1312.4684, -2704.5762],
         [ -811.9325,  5627.2080],
         [ 4811.2573,  2093.8948],
         [-1541.6807, -3492.9246],
         [ 1630.5698, -1670.7520],
         [-1107.2264,   -98.0552]],

        [[  705.0345,   343.6002],
         [ 4020.8481,   293.5883],
         [-2739.4106, -1545.6660],
         [  306.0800,  1712.6592],
         [ 4737.1133,  -215.4503],
         [-2920.6680, -3479.9866],
         [-1161.4065,    92.5321],
         [  748.9036,  2498.2629],
         [  357.4306,  -197.7229],
         [  827.0245,    88.5369]],

        [[  791.9843,  3452.3999],
         [ 1510.3345, -4474.2959],
         [  260.8254, -4662.0190],
         [-1326.7701,  3183.2312],
         [  622.1651, -5833.3394],
         [  516.9741, -4422.8779],
         [  191.6392, -1747.3721],
         [ -243.0749,  1120.0460],
         [  251.6653,  -889.8989],
         [  642.0635,  -195.9145]],

        [[-4198.0127, -1299.3070],
         [ -566.3091,  2851.8823],
         [ 4301.8350,  4328.0483],
         [-6282.7729,  -300.8241],
         [ 1605.4540,  5190.9141],
         [ -814.3138,   342.7087],
         [  569.0784,   597.4139],
         [ -613.1737,  -455.0210],
         [ -382.2713,  -173.1572],
         [  683.5863,  1004.1384]],

        [[-1146.3813,   433.7226],
         [ 5426.4932,  -145.0700],
         [-3983.8921,  -731.2390],
         [ 2920.0168,  1299.7383],
         [-3878.9839,   427.2866],
         [ 1309.4910,   -58.5237],
         [ -479.5793,  -578.8514],
         [ -701.2842,   130.8964],
         [ 1476.9166,   830.6826],
         [-4461.4106, -1386.6621]],

        [[ -232.7428, -2741.1353],
         [ 3631.7090, -2913.5173],
         [-1375.8431, -4187.5879],
         [ 1253.9513,   427.8672],
         [  648.2513, -5368.5703],
         [  -13.7381,  -816.4804],
         [  362.2232,  -692.3427],
         [  -43.4097,  -137.2490],
         [  -96.4692, -3451.5806],
         [  541.6625, -4592.3687]],

        [[-1198.2828,  -205.1629],
         [  -74.2184,   -52.1096],
         [ 2962.3586,  3587.3386],
         [-6020.5913,  -224.0952],
         [ 1254.9343,  5036.2822],
         [ -579.9662,  -660.5149],
         [ 3969.8362,  2592.7087],
         [-3789.7207,  -183.7860],
         [-2320.6150,  3541.3105],
         [ 3981.4114,  4011.6917]],

        [[ -902.3270,  1148.0994],
         [ 2734.9688,   794.8720],
         [ -955.9476,  1205.1083],
         [ 2794.1716,  1609.0751],
         [-4681.9883,  1954.1694],
         [ 2835.4531,  5176.2998],
         [  214.1213,  3857.7288],
         [ -333.7838,   798.6034],
         [ -342.3642,  3580.1394],
         [ 1501.5490,  5055.2114]],

        [[  366.2928,  5218.6177],
         [ 1323.0630, -4368.6528],
         [  808.5822, -4306.9717],
         [ 2445.1387, -4988.6885],
         [ 1759.8323, -5924.9785],
         [  100.6411, -4060.1689],
         [-1643.0920, -6148.3984],
         [ 1566.8792, -5691.1494],
         [  533.0593, -3991.7961],
         [-1718.8929, -6251.2690]],

        [[-5643.6299, -1950.3859],
         [  551.6416,  5676.7988],
         [-3717.3684,    30.9200],
         [ -134.7051,  4588.9380],
         [ 4195.1626,  3763.8071],
         [-4774.6494,   150.2981],
         [-1464.5957,  4556.7485],
         [ 4684.9263,  3865.6150],
         [-4879.5459,  -167.5089],
         [-1564.0303,  4716.7393]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[  342.2366,  -702.3975],
         [ -466.1603,  3319.0315],
         [ 3195.5811,   741.8515],
         [ -112.4542, -4453.3872],
         [   74.3350, -2531.7083],
         [ 1972.3579, -1180.4606],
         [-1238.8374, -1149.0992],
         [ 2383.6636, -4269.8643],
         [  299.2705,  2706.4509],
         [ 2540.1338, -1323.9971]],

        [[ 4377.4868,  1517.2600],
         [-1598.0930, -4808.7515],
         [-5640.4092,   358.6863],
         [ 3321.6238,  5375.9307],
         [  701.7271,  4102.4800],
         [ 2380.0764,  -103.4490],
         [-5736.1694,   821.5546],
         [ 5623.8794,  3384.9158],
         [-2987.4741, -4430.4219],
         [-4402.9131,  -920.6491]],

        [[-3378.0430,  2808.9585],
         [ 2998.3220,  4258.9697],
         [  513.6339,  3678.3550],
         [ 1482.4189,  1182.7816],
         [-3855.1414,   205.0193],
         [ 2480.0127,  2240.8032],
         [  332.4371,  1400.0382],
         [-2194.8711,  1863.3887],
         [  809.4799,  3600.2539],
         [-3957.4004,  2947.6201]],

        [[ -512.0919, -5026.3462],
         [ 3870.8257,    16.0269],
         [-1862.5029, -3091.6665],
         [ -524.8601,  3617.0251],
         [-2526.6934,  -941.9504],
         [ 1325.7120, -3092.3066],
         [ 1027.9222, -5814.5308],
         [  970.6343, -1922.4958],
         [  733.2261, -1641.3253],
         [-1000.7974, -5074.4839]],

        [[ 3588.3777,  4196.8652],
         [  192.6648, -3197.5032],
         [ 4790.6660, -1746.4103],
         [-3010.1055, -5792.6313],
         [-4125.8442, -3281.7334],
         [-2045.9714,  3365.9026],
         [ 4740.1812,   511.7676],
         [  763.5450, -4715.8413],
         [-4713.8633, -2217.9548],
         [ 4474.7378, -1854.8634]],

        [[-3846.8750,  -190.8140],
         [ 2107.9377,  2264.2048],
         [-3452.6194,   119.7866],
         [ 1094.2031,  2329.3037],
         [ 1942.7394,  3083.6060],
         [-4374.4277,  3210.5132],
         [ -523.7291,  3431.0610],
         [ 2188.6829,  5747.2847],
         [-4397.0239,  2805.8376],
         [ 2133.4207,  3232.9375]],

        [[ -410.6332, -5587.0215],
         [ -938.8597,  3554.3088],
         [   92.3841,  -139.7616],
         [ 1101.6000,  4627.1792],
         [ 2217.7114,  -358.3321],
         [-4637.5845,  -191.5629],
         [ 4033.0901, -2927.7021],
         [-1526.1992,  -894.1049],
         [-2333.8164, -1091.1643],
         [ 5167.2676, -2709.0093]],

        [[ 4780.7544,  3378.5598],
         [-3065.6541, -3018.1140],
         [ 4077.7949,  3865.5369],
         [-1239.8171, -5447.3281],
         [ 1673.2372, -3786.1819],
         [-5138.0630, -3523.9031],
         [ 5261.1802,   103.5641],
         [-1636.6891, -5624.9585],
         [-5656.5620, -1189.9259],
         [ 4939.5698,  4266.9390]],

        [[  265.6405,  -304.7256],
         [ 4778.2261,    46.2058],
         [-4768.1733, -4451.4468],
         [ 1852.8943,  1339.0985],
         [-2936.2554,   951.7778],
         [-2271.9631,  1344.9446],
         [-1990.6022,  3459.6096],
         [ 2203.7488,  5120.0474],
         [ 2832.4136,  3387.6458],
         [ -815.8209,  3237.8533]],

        [[ 2110.2327, -3468.2073],
         [-2339.5801, -2977.5771],
         [ 1774.0403,   517.6024],
         [ 1870.7874, -3635.0527],
         [-1822.3279, -2863.3147],
         [  124.3270,   416.3134],
         [ 2247.8816, -4428.7241],
         [ 1873.4963, -2646.1567],
         [ 1478.3787,  2295.5115],
         [-4484.2163,  -166.0621]]]) 

t:0, loss.item(): 13444.9462890625
Optimized result :
MatD: 
has nan? False 
tensor([[0.0152, 0.0149, 0.0147,  ..., 0.0118, 0.0110, 0.0105],
        [0.0147, 0.0154, 0.0147,  ..., 0.0112, 0.0110, 0.0106],
        [0.0147, 0.0149, 0.0147,  ..., 0.0111, 0.0111, 0.0105],
        ...,
        [0.0200, 0.0208, 0.0200,  ..., 0.0122, 0.0123, 0.0128],
        [0.0196, 0.0217, 0.0200,  ..., 0.0122, 0.0128, 0.0127],
        [0.0208, 0.0213, 0.0213,  ..., 0.0122, 0.0135, 0.0125]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[-2.2614e-04, -2.1949e-04,  4.4563e-04,  ..., -7.7569e-04,
         -4.6269e-04, -4.6269e-04],
        [ 6.7873e-04, -6.7873e-04, -2.1313e-04,  ..., -2.4694e-04,
         -3.5071e-04, -3.5071e-04],
        [ 2.1949e-04, -2.1949e-04, -2.1313e-04,  ...,  1.0000e-10,
         -5.8480e-04, -5.8480e-04],
        ...,
        [ 8.3333e-04, -8.3333e-04, -1.1321e-03,  ...,  1.5056e-04,
          4.7483e-04,  4.7483e-04],
        [ 2.1313e-03, -1.7391e-03,  1.2766e-03,  ...,  6.2539e-04,
         -1.6228e-04, -1.6228e-04],
        [ 4.4326e-04,  1.0000e-10,  1.0000e-10,  ...,  1.3184e-03,
         -1.0135e-03, -1.0135e-03]], grad_fn=<SelectBackward>)

Epoch 0 finished. Total time: 131.37951231002808;  Epoch time: 131.37951231002808 












test_counter in loss_omega_mat(): 321
test_counter in loss_omega_mat(): 642
test_counter in loss_omega_mat(): 963
test_counter in loss_omega_mat(): 1284
test_counter in loss_omega_mat(): 1605
test_counter in loss_omega_mat(): 1926
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9458, 0.9457, 0.9457,  ..., 0.7571, 0.7571, 0.7569],
         [0.9458, 0.9457, 0.9457,  ..., 0.7571, 0.7571, 0.7570],
         [0.9458, 0.9458, 0.9458,  ..., 0.7572, 0.7571, 0.7571],
         ...,
         [0.9457, 0.9457, 0.9457,  ..., 0.7572, 0.7571, 0.7571],
         [0.9458, 0.9458, 0.9457,  ..., 0.7572, 0.7572, 0.7571],
         [0.9458, 0.9458, 0.9458,  ..., 0.7571, 0.7570, 0.7567]],

        [[0.9458, 0.9457, 0.9457,  ..., 0.7569, 0.7543, 0.7533],
         [0.9458, 0.9457, 0.9457,  ..., 0.7571, 0.7570, 0.7545],
         [0.9458, 0.9458, 0.9457,  ..., 0.7571, 0.7571, 0.7545],
         ...,
         [0.9458, 0.9457, 0.9456,  ..., 0.7571, 0.7571, 0.7570],
         [0.9458, 0.9457, 0.9457,  ..., 0.7571, 0.7571, 0.7571],
         [0.9458, 0.9458, 0.9458,  ..., 0.7571, 0.7569, 0.7567]],

        [[0.9458, 0.9458, 0.9456,  ..., 0.7562, 0.7430, 0.7429],
         [0.9458, 0.9458, 0.9455,  ..., 0.7530, 0.7503, 0.7401],
         [0.9458, 0.9458, 0.9456,  ..., 0.7571, 0.7535, 0.7438],
         ...,
         [0.9458, 0.9458, 0.9455,  ..., 0.7572, 0.7571, 0.7571],
         [0.9458, 0.9458, 0.9456,  ..., 0.7572, 0.7572, 0.7571],
         [0.9458, 0.9458, 0.9458,  ..., 0.7571, 0.7567, 0.7566]],

        ...,

        [[0.9398, 0.9376, 0.9354,  ..., 0.7340, 0.7228, 0.7224],
         [0.9454, 0.9453, 0.9411,  ..., 0.7411, 0.7381, 0.7234],
         [0.9458, 0.9458, 0.9456,  ..., 0.7525, 0.7522, 0.7409],
         ...,
         [0.9458, 0.9458, 0.9456,  ..., 0.7572, 0.7571, 0.7571],
         [0.9458, 0.9458, 0.9457,  ..., 0.7572, 0.7571, 0.7570],
         [0.9459, 0.9458, 0.9458,  ..., 0.7571, 0.7571, 0.7570]],

        [[0.9354, 0.9350, 0.9330,  ..., 0.7399, 0.7361, 0.7335],
         [0.9411, 0.9405, 0.9350,  ..., 0.7449, 0.7403, 0.7289],
         [0.9456, 0.9454, 0.9454,  ..., 0.7523, 0.7507, 0.7415],
         ...,
         [0.9458, 0.9457, 0.9456,  ..., 0.7572, 0.7571, 0.7570],
         [0.9458, 0.9458, 0.9457,  ..., 0.7571, 0.7570, 0.7570],
         [0.9458, 0.9458, 0.9457,  ..., 0.7569, 0.7568, 0.7568]],

        [[0.9350, 0.9349, 0.9333,  ..., 0.7407, 0.7364, 0.7158],
         [0.9402, 0.9351, 0.9350,  ..., 0.7504, 0.7306, 0.7301],
         [0.9454, 0.9453, 0.9451,  ..., 0.7522, 0.7420, 0.7408],
         ...,
         [0.9457, 0.9457, 0.9456,  ..., 0.7570, 0.7565, 0.7564],
         [0.9457, 0.9457, 0.9456,  ..., 0.7570, 0.7562, 0.7559],
         [0.9457, 0.9456, 0.9454,  ..., 0.7561, 0.7561, 0.7558]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[7.8686e-08, 7.8686e-08, 5.1767e-07,  ..., 3.7234e-09,
          5.2007e-06, 1.3894e-06],
         [1.0832e-06, 7.4998e-08, 1.6611e-09,  ..., 2.5012e-06,
          3.3816e-07, 7.1236e-08],
         [2.5000e-07, 2.5000e-07, 2.5000e-07,  ..., 1.6611e-09,
          1.4391e-06, 1.6227e-06],
         ...,
         [2.4744e-07, 7.9578e-07, 3.8701e-07,  ..., 6.9618e-08,
          5.3864e-07, 1.0724e-11],
         [1.2603e-06, 1.5562e-06, 6.1244e-08,  ..., 2.5513e-11,
          3.4973e-06, 3.5145e-11],
         [2.5000e-07, 1.2539e-06, 2.5000e-07,  ..., 9.9539e-07,
          1.3862e-07, 1.2476e-06]],

        [[3.6214e-07, 1.6088e-07, 4.9095e-07,  ..., 1.5183e-06,
          1.1197e-06, 2.7239e-06],
         [3.3816e-07, 2.5000e-07, 1.3106e-07,  ..., 1.1355e-07,
          4.0701e-07, 2.5000e-07],
         [1.6612e-09, 1.0832e-06, 1.6612e-09,  ..., 1.6612e-09,
          1.6088e-07, 7.2438e-07],
         ...,
         [2.2420e-06, 2.5000e-07, 2.4735e-07,  ..., 1.2791e-06,
          6.1244e-08, 1.3522e-06],
         [2.5000e-07, 2.4726e-07, 1.4074e-07,  ..., 4.0025e-06,
          1.2603e-06, 2.2418e-06],
         [1.3862e-07, 1.8911e-06, 5.9847e-08,  ..., 1.5562e-06,
          1.2410e-06, 2.5000e-07]],

        [[1.9375e-07, 2.5000e-07, 3.1341e-07,  ..., 1.9375e-07,
          1.0245e-07, 5.1767e-07],
         [4.5402e-09, 3.2750e-07, 1.6612e-09,  ..., 1.8639e-06,
          4.2741e-06, 2.4754e-05],
         [1.0832e-06, 2.5000e-07, 1.6612e-09,  ..., 9.2015e-07,
          1.6612e-09, 1.6611e-09],
         ...,
         [1.8592e-08, 1.7852e-08, 2.5275e-07,  ..., 7.3659e-07,
          4.4748e-07, 5.8863e-07],
         [6.4037e-08, 1.6438e-08, 1.8911e-06,  ..., 3.5595e-06,
          4.0925e-07, 4.0925e-07],
         [6.1244e-08, 1.4074e-07, 1.3862e-07,  ..., 3.0844e-06,
          6.2657e-08, 9.8992e-07]],

        ...,

        [[9.6163e-07, 4.5886e-07, 2.8136e-06,  ..., 7.7437e-05,
          1.3487e-04, 9.0803e-07],
         [7.9013e-07, 1.7268e-06, 7.9012e-07,  ..., 1.1231e-04,
          2.5267e-06, 5.6059e-05],
         [1.6327e-06, 3.5308e-07, 1.6467e-07,  ..., 6.0821e-06,
          6.7190e-07, 9.4172e-06],
         ...,
         [3.0864e-09, 2.9593e-10, 3.0864e-09,  ..., 3.7877e-09,
          5.3964e-07, 1.1142e-06],
         [4.9617e-08, 3.7249e-08, 1.6884e-06,  ..., 8.3540e-07,
          1.1028e-06, 1.5911e-06],
         [6.7324e-07, 3.2305e-07, 2.9592e-10,  ..., 1.6779e-06,
          1.0387e-06, 3.2576e-06]],

        [[7.3177e-06, 6.1150e-05, 4.6510e-05,  ..., 2.2073e-04,
          1.9869e-06, 4.2670e-04],
         [3.7535e-10, 3.9853e-07, 2.6611e-06,  ..., 3.8504e-06,
          7.3836e-05, 8.8443e-05],
         [5.9745e-09, 5.5991e-09, 8.5594e-07,  ..., 5.7533e-07,
          3.8948e-06, 8.9904e-05],
         ...,
         [7.6628e-07, 8.4544e-08, 1.5531e-08,  ..., 1.9159e-06,
          1.6570e-06, 9.1515e-07],
         [2.2648e-06, 1.4297e-07, 1.8992e-06,  ..., 3.3183e-06,
          5.8157e-09, 5.0906e-06],
         [1.5347e-06, 2.0884e-07, 6.3334e-10,  ..., 6.4541e-08,
          4.1127e-06, 3.3245e-06]],

        [[1.5158e-04, 5.2915e-06, 4.8955e-07,  ..., 8.3869e-05,
          3.0172e-04, 6.6818e-05],
         [8.2476e-07, 8.4340e-09, 2.3281e-06,  ..., 1.3016e-06,
          2.6405e-05, 4.6760e-05],
         [1.3501e-06, 2.5000e-07, 2.5000e-07,  ..., 1.6467e-07,
          6.9051e-07, 1.7306e-06],
         ...,
         [9.5940e-08, 2.5000e-07, 5.6880e-07,  ..., 1.4358e-06,
          9.0799e-07, 1.1116e-07],
         [1.6880e-06, 9.1499e-08, 1.2575e-06,  ..., 5.0427e-07,
          9.4912e-08, 2.0206e-06],
         [5.8369e-07, 8.4365e-07, 9.2648e-08,  ..., 9.9630e-07,
          5.6235e-06, 5.0002e-06]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[3.7879e-04, 7.8051e-04, 3.2127e-04,  ..., 5.8360e-04,
          9.4953e-04, 2.3350e-04],
         [4.6642e-04, 3.8746e-04, 4.5924e-04,  ..., 3.8909e-04,
          8.9987e-04, 6.1335e-04],
         [5.4875e-04, 1.1368e-03, 5.8208e-11,  ..., 8.0154e-04,
          3.8472e-04, 7.7386e-04],
         ...,
         [8.7534e-04, 9.1631e-04, 8.8062e-04,  ..., 9.8829e-04,
          4.4646e-04, 1.1622e-03],
         [8.8402e-04, 6.3281e-04, 8.8442e-04,  ..., 2.7322e-04,
          8.8121e-04, 1.2357e-03],
         [9.6515e-04, 6.3281e-04, 7.5550e-04,  ..., 1.0610e-03,
          8.1229e-04, 9.3307e-04]],

        [[3.7879e-04, 1.4340e-04, 2.2501e-04,  ..., 8.2864e-04,
          3.7879e-04, 3.9741e-04],
         [4.6642e-04, 4.6642e-04, 1.4340e-04,  ..., 7.0945e-04,
          3.2363e-04, 5.3673e-03],
         [1.1368e-03, 5.4076e-04, 4.6642e-04,  ..., 5.8360e-04,
          4.0298e-04, 1.1137e-04],
         ...,
         [9.9735e-04, 3.8801e-06, 1.1948e-04,  ..., 1.2563e-03,
          1.0610e-03, 7.3264e-04],
         [8.7516e-04, 3.8801e-06, 8.8442e-04,  ..., 1.0123e-03,
          1.2377e-03, 7.5572e-04],
         [1.3270e-03, 8.7516e-04, 7.5550e-04,  ..., 2.4156e-04,
          7.5312e-04, 1.5368e-03]],

        [[4.2441e-04, 3.6752e-04, 7.1457e-05,  ..., 1.8928e-03,
          7.2322e-03, 7.7609e-03],
         [6.9252e-04, 3.6752e-04, 4.6001e-04,  ..., 2.1313e-04,
          6.9252e-04, 5.4659e-03],
         [3.0766e-04, 6.9252e-04, 8.2318e-11,  ..., 2.9159e-05,
          4.9092e-03, 6.8717e-03],
         ...,
         [1.2213e-04, 8.7517e-04, 6.3636e-04,  ..., 6.3361e-04,
          2.2011e-04, 2.4156e-04],
         [8.8082e-04, 8.7517e-04, 1.0773e-03,  ..., 9.8829e-04,
          6.4477e-04, 3.8667e-04],
         [8.7232e-04, 8.8082e-04, 1.2484e-04,  ..., 5.0883e-04,
          8.7232e-04, 9.6790e-04]],

        ...,

        [[1.1428e-03, 1.6099e-03, 4.2411e-03,  ..., 6.9535e-04,
          2.4400e-03, 6.1676e-04],
         [2.3828e-03, 1.4525e-03, 1.1173e-03,  ..., 7.7572e-03,
          6.0415e-03, 2.0986e-03],
         [2.0486e-03, 1.4705e-03, 5.0648e-04,  ..., 1.4486e-03,
          1.4766e-03, 4.6791e-03],
         ...,
         [1.0094e-03, 4.8825e-04, 7.5141e-04,  ..., 8.3850e-04,
          1.1139e-03, 6.9710e-04],
         [1.0094e-03, 8.3678e-04, 5.7857e-04,  ..., 4.5887e-04,
          3.8155e-04, 8.9742e-04],
         [6.9679e-04, 8.3678e-04, 1.1847e-03,  ..., 1.0848e-03,
          2.9370e-04, 1.0007e-03]],

        [[4.2411e-03, 1.2450e-02, 4.5455e-03,  ..., 4.0523e-03,
          1.0840e-03, 8.4975e-03],
         [1.1173e-03, 8.1842e-04, 6.2659e-04,  ..., 3.1762e-04,
          5.7952e-03, 7.1451e-04],
         [5.0648e-04, 2.0716e-03, 1.5330e-03,  ..., 2.0153e-03,
          5.5206e-04, 9.3921e-03],
         ...,
         [6.4221e-04, 3.8411e-04, 6.7894e-04,  ..., 4.7958e-04,
          7.8439e-04, 1.0996e-04],
         [6.4221e-04, 2.3199e-04, 1.9457e-04,  ..., 6.3194e-04,
          8.4596e-04, 8.6094e-04],
         [8.2588e-04, 2.3199e-04, 3.0579e-04,  ..., 1.3072e-03,
          5.2632e-04, 5.9372e-04]],

        [[1.2450e-02, 8.9605e-03, 8.3850e-03,  ..., 9.1399e-03,
          8.8837e-03, 9.5035e-03],
         [1.0784e-03, 1.0373e-03, 6.2659e-04,  ..., 6.3980e-04,
          3.0852e-03, 5.7571e-03],
         [2.0716e-03, 1.8169e-03, 2.4114e-03,  ..., 1.2395e-03,
          1.6797e-03, 6.0543e-03],
         ...,
         [2.9599e-04, 4.6762e-04, 6.7894e-04,  ..., 4.5454e-04,
          8.7924e-04, 7.5460e-04],
         [1.9457e-04, 4.6762e-04, 4.3596e-04,  ..., 1.3026e-03,
          9.5780e-04, 3.8109e-04],
         [6.9788e-04, 4.3596e-04, 4.0756e-04,  ..., 9.4712e-04,
          3.5708e-04, 2.4816e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:1.3724994659423828 loss2:635.1685791015625
Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([44, 73]) torch.Size([44, 73, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-6.7493e-01, -7.3123e-01, -6.0840e-01,  5.4422e-01,  4.6420e-01,
         -9.8283e-01,  8.0319e-01, -8.7636e-01, -7.8146e-01, -7.7015e-01],
        [-1.5119e+01,  1.1025e+00,  4.5586e-01,  3.2620e+00, -1.7596e+00,
          1.0332e+01,  2.3727e+00, -9.7355e+00, -1.6712e+01,  3.0143e+00],
        [-3.9928e+01, -1.2886e+01,  1.9470e+01,  6.4983e+00, -3.5404e+00,
         -6.1253e+00, -6.6417e-02, -1.5278e+01, -2.9119e+00,  2.4584e+01],
        [ 1.4672e+01, -6.8786e+01, -2.9634e+01,  6.8338e+01,  2.8305e+00,
          7.4978e+01,  5.8408e+01, -2.3020e+01,  3.1163e+01, -3.7271e+01],
        [-6.7282e+01, -2.3006e+01,  1.7967e+01, -1.9711e+01, -6.3150e+01,
         -7.3307e+01,  3.7084e+01, -8.1273e+01,  5.9594e+01, -1.2381e+01],
        [-7.6806e+00, -6.7035e+00,  4.4326e+01, -7.9045e+01, -6.1010e+01,
         -6.6516e+01, -6.9709e+01,  7.5321e+01,  7.9678e+01, -7.0477e+00],
        [-5.2253e+01, -4.5558e+01, -9.5365e+01, -4.6201e+01,  1.1149e+02,
         -5.0602e+01, -7.4988e+01,  4.8505e+01,  9.5586e+01, -1.8373e+01],
        [ 5.2714e+00,  1.7143e+01,  6.7528e+01,  7.9684e+01, -7.2816e+00,
         -1.6403e+01,  1.2872e+02, -3.8671e+01, -6.4876e+01, -3.5558e+01]]) 

MatU.grad[0:10,35:45]: 
tensor([[[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[  447.2933,     7.5129],
         [  153.6438,    89.2398],
         [   18.1056,   297.0844],
         [  -57.8607,   -34.0818],
         [ -168.7328,     6.4981],
         [ -290.7606,   295.6847],
         [  -40.8071,   356.9816],
         [  343.5867,   289.4998],
         [   83.7664,   125.3282],
         [  333.4547,  -120.3502]],

        [[  698.1451,   844.6796],
         [  908.0591,   201.0300],
         [ -257.6379, -1100.9358],
         [ -411.9111,   773.4540],
         [  414.2342,   145.4511],
         [ -835.4877,   649.2756],
         [ 1054.9120,   122.9969],
         [  241.5025,  -479.4095],
         [  811.8219,  -570.0406],
         [  -76.7357,  -851.8053]],

        [[ -539.6242, -2299.3472],
         [-2889.5417, -1063.9851],
         [ 5109.2109,  -347.0450],
         [-3716.9304, -3590.7939],
         [-1338.6605,   -54.6062],
         [ 2631.7764, -3067.1055],
         [ 1306.1119,  2463.6438],
         [ -693.0021,  1891.5267],
         [  220.5532,  4714.6938],
         [-2011.3260, -1312.4105]],

        [[ -318.2661, -1678.5413],
         [-1985.4232, -3869.0425],
         [ 2821.4998, -2601.4434],
         [ 1961.7394,  1981.6791],
         [ 3710.7822,  4217.1226],
         [ 1376.0200, -3347.4292],
         [ 1543.8958,  -460.9105],
         [ 4030.9365,  1221.3683],
         [  387.2409, -3969.1272],
         [-3942.8184, -3344.2432]],

        [[-2962.2969, -1334.4359],
         [-1213.8812,  2468.6860],
         [  199.5752, -1501.8217],
         [-3306.5928, -2570.5437],
         [-2931.3518,  3488.7383],
         [-3348.6494,  4305.0195],
         [ 2608.9153, -5398.2583],
         [-3202.3000,  1125.0415],
         [ -226.2013,  2819.6489],
         [ 3132.7117,  1245.4259]],

        [[  453.6064,  -208.9984],
         [ 3259.9490,   -79.4573],
         [ -627.5284, -4574.6265],
         [ 3477.5374,  2311.8848],
         [-1637.5129,  -363.3490],
         [-2763.3474, -3735.5044],
         [ 2518.6384,  3018.9902],
         [-1855.1639, -1363.9495],
         [ -442.4456, -4179.6558],
         [ 1078.6532,  2825.4617]],

        [[-1016.4178,  1482.8813],
         [ -865.8464,  3852.6904],
         [ 4152.0981, -2258.1833],
         [  -76.2378,  2857.0198],
         [-4117.3364, -2213.1484],
         [ 2981.0259,  4677.7700],
         [ -433.9094,  -473.2867],
         [-4285.7759,  4311.1001],
         [-4561.7402,  1093.0437],
         [-3284.9180, -1100.7458]]]) 

MatD.grad: 
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-8.6231e+01, -1.2446e+02],
         [-2.8899e+02,  7.5002e+01],
         [-2.9184e+02,  2.6365e+02],
         [-3.0842e+02,  3.3300e+02],
         [ 6.9034e+01, -1.3865e+02],
         [ 3.4384e+02,  1.4666e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-7.5441e+01, -1.3131e+02],
         [-3.4933e+02, -3.2367e+02],
         [ 2.7209e+02,  2.9250e+02],
         [-1.8237e+00,  6.2827e+02],
         [ 3.7475e+02, -1.1885e+03],
         [-7.7988e+02,  8.3325e+02],
         [ 1.1656e+02, -6.2957e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-8.1722e+01, -2.9469e+02],
         [ 2.5905e+02, -7.5306e+02],
         [ 2.2789e+03,  2.4909e+03],
         [ 2.6310e+03, -1.8685e+03],
         [ 1.9474e+03, -4.4336e+03],
         [ 1.4138e+03, -2.2414e+03],
         [-2.5402e+03,  4.0016e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 3.9562e+02,  2.3994e+02],
         [-4.1506e+01,  4.8836e+02],
         [-6.5506e+02, -1.2212e+03],
         [-2.8104e+03, -2.1485e+03],
         [-1.1145e+03,  3.0971e+03],
         [ 4.3178e+03,  2.9383e+03],
         [-1.6995e+03, -3.5238e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 2.3130e+02,  7.9615e+01],
         [-9.1104e+01, -1.0813e+03],
         [-6.0057e+02, -1.1624e+03],
         [ 3.5380e+03, -2.3765e+03],
         [-2.3131e+03,  2.8478e+03],
         [ 3.1282e+03,  2.6353e+03],
         [ 1.7360e+01, -4.3445e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 9.2118e+01, -3.6888e+02],
         [ 5.1943e+02, -1.3625e+02],
         [-5.3458e+01,  4.0241e+03],
         [-1.4520e+03, -1.0279e+03],
         [-1.7395e+03,  2.2253e+03],
         [-5.1390e+03,  1.9397e+03],
         [ 2.2497e+03, -5.4438e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.8572e+02,  3.8557e+02],
         [ 1.0308e+03,  5.4690e+02],
         [-3.6183e+03, -3.4877e+02],
         [ 7.5748e+01,  4.6588e+03],
         [-4.1069e+02,  1.1090e+03],
         [ 2.4233e+02,  2.4533e+03],
         [ 4.8577e+02,  3.3872e+03]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[-4046.3638, -3777.5706],
         [-1175.9886, -3683.9434],
         [ 3159.1433, -3282.7268],
         [ 2014.3448, -2836.3928],
         [  128.4426,   303.9019],
         [ 2441.0171,  4457.4209],
         [ 4200.6650,  -861.4595],
         [ -366.5759, -3126.1863],
         [  -22.7147,   675.7881],
         [-1199.3335,    34.3805]],

        [[-3990.7144, -3646.3345],
         [ -486.8751, -3425.0896],
         [ 2056.9116,  3507.7749],
         [-3538.6990, -1508.1887],
         [ 4288.5801,  2926.6572],
         [-2358.8499, -3222.1897],
         [ 1712.8572, -3131.2493],
         [-1776.0359,   102.2998],
         [-1140.3932,  1925.7344],
         [  805.0396,    79.1952]],

        [[-4056.0891, -1304.5500],
         [-3342.5063,  2267.8376],
         [-2907.4414,   446.9340],
         [ 2683.1096,   189.6054],
         [    8.5577, -5860.5444],
         [  -50.5299, -4452.1577],
         [   66.2551, -1745.6650],
         [ -213.7869,  1076.4819],
         [   33.5115,  -905.3290],
         [  649.2888,  -164.3965]],

        [[ -754.4417,  2446.5903],
         [ 4470.3164, -2395.9929],
         [ 4309.1104,  3440.6763],
         [-6295.4395,   218.3710],
         [ 1416.4673,  5241.9058],
         [ -646.1816,    58.2835],
         [  554.9080,   542.3169],
         [ -592.7628,  -441.6940],
         [ -340.8124,    59.2683],
         [  672.6066,   986.4199]],

        [[ 2053.0239, -5569.9658],
         [  513.6035,  4828.9194],
         [-2576.9272,  2098.3191],
         [ 1043.0045, -1687.8334],
         [-3816.2520,  -255.5740],
         [ 1283.4131,   -49.9219],
         [ -465.2758,  -561.1283],
         [ -659.4672,    46.2561],
         [ 1461.1788,   815.0038],
         [-4480.5142, -1292.3713]],

        [[ 3683.8826,  1302.6768],
         [-3352.7646,  2318.5300],
         [ 1150.3013, -1728.0963],
         [ -799.2350, -2347.3264],
         [  591.4461, -5408.3750],
         [  214.9346,  -771.1006],
         [  250.7225,  -700.7123],
         [   56.1618,  -101.9860],
         [  636.5648, -3394.5310],
         [ -176.7840, -4781.5547]],

        [[ 2327.3452,  3102.1880],
         [ 3505.6257,  4181.7007],
         [  -54.6397,   643.9426],
         [-6001.4658,   368.6787],
         [ 1115.5487,  5073.2227],
         [ -373.2203,   101.3844],
         [ 4005.4507,  2714.0393],
         [-3795.4070,    55.7794],
         [-1975.0331,  3292.5254],
         [ 3878.6819,  4109.2075]],

        [[ 2463.5063, -3018.6091],
         [-1242.2101, -2051.2290],
         [ 2880.9436, -1779.4037],
         [ 2024.7219,  1168.6388],
         [-4559.8965,  1805.5397],
         [ 2752.8074,  5205.9062],
         [ -787.2134,  4067.6309],
         [  214.0304,   559.4176],
         [  640.5885,  3314.7043],
         [  236.5568,  5483.5405]],

        [[ -455.3313,  5134.5747],
         [  265.6620, -4275.1479],
         [   45.3804, -4199.9692],
         [ 2348.1299, -5001.7959],
         [ 1579.9200, -5903.4912],
         [ -192.0950, -4027.3682],
         [-1382.7970, -6242.6372],
         [ 1300.0956, -5614.3135],
         [  -11.6766, -3853.2676],
         [-1410.7488, -6368.2266]],

        [[-5790.0586, -1491.0740],
         [  -72.7844,  5585.0464],
         [-3635.1865,  -489.7003],
         [  590.3878,  4626.3931],
         [ 4207.4517,  3741.0530],
         [-4708.6245,  -357.6134],
         [ -642.6305,  4426.3413],
         [ 4659.8599,  3858.8130],
         [-4893.4551,   232.7426],
         [ -931.4958,  4579.6636]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[-3.5709e+03,  3.0222e+03],
         [ 4.3008e+03,  1.5456e+03],
         [ 1.5965e+03, -1.3003e+03],
         [ 3.7052e+03, -2.7787e+03],
         [-4.1027e+03,  2.6253e+03],
         [-1.6160e+03,  3.9413e+03],
         [ 4.2449e+03,  3.7898e+03],
         [-2.4529e+03,  1.8545e+02],
         [-4.6570e+03, -1.8462e+03],
         [-1.0861e+03,  3.9043e+03]],

        [[ 2.0351e+03, -1.3786e+02],
         [ 3.0375e+03, -1.0110e+03],
         [-2.8597e+03, -3.6685e+03],
         [ 1.1207e+03,  5.3133e+03],
         [-2.2838e+03,  8.2528e+02],
         [-1.4277e+03,  5.2794e+03],
         [ 1.4846e+03, -4.5982e+03],
         [ 5.6787e+03,  6.1009e+02],
         [ 1.3836e+03, -3.3629e+02],
         [ 1.4635e+02,  4.5471e+03]],

        [[ 1.7438e+03, -3.1275e+03],
         [-1.0186e+02,  2.2623e+03],
         [-4.2876e+03,  1.1252e+03],
         [-3.1972e+03, -3.2660e+03],
         [ 2.0099e+03, -4.5020e+03],
         [-2.1103e+03, -2.7671e+03],
         [-3.3470e+03, -4.4324e+03],
         [ 4.2156e+03, -4.0073e+03],
         [-3.9204e+03, -2.9775e+03],
         [ 7.3502e+02, -2.6732e+03]],

        [[ 5.3932e+03, -1.9424e+02],
         [-7.4097e+02, -4.0144e+03],
         [ 3.0678e+03,  2.9848e+03],
         [ 5.2775e+03, -7.8704e+02],
         [ 3.6991e+03,  4.3015e+03],
         [-3.6932e+03,  4.0005e+03],
         [-3.4418e+03,  7.0170e+02],
         [-2.9428e+03,  4.1037e+03],
         [-3.8391e+03,  3.8971e+03],
         [ 3.6476e+03,  9.9708e+01]],

        [[-3.2814e+02, -3.7390e+02],
         [-5.0115e+03,  2.0086e+03],
         [-9.7507e+02,  4.7042e+03],
         [ 1.9251e+03, -3.8552e+02],
         [ 1.3379e+03,  3.0239e+03],
         [ 4.1008e+03, -2.2067e+03],
         [-1.4724e+03, -4.8064e+03],
         [-3.7977e+03,  9.8101e+02],
         [ 2.1701e+03,  2.7404e+03],
         [-6.9429e+02,  3.2247e+03]],

        [[ 2.2044e+03,  4.6043e+03],
         [-3.2744e+03, -3.2733e+03],
         [ 2.6982e+03, -4.7489e+03],
         [-3.9896e+03, -3.5699e+03],
         [-3.6948e+03, -2.8794e+03],
         [ 2.5144e+03, -3.1525e+03],
         [ 4.3641e+03, -3.5654e+03],
         [-2.4038e+03, -7.5805e+02],
         [ 1.4428e+03, -4.8193e+03],
         [-3.2981e+03, -4.0690e+03]],

        [[ 4.6940e+03,  5.7604e+01],
         [ 4.7019e+03, -2.7597e+03],
         [-3.1030e+03,  4.8355e+03],
         [-3.8814e+03, -1.4795e+03],
         [-3.1764e+03,  4.4767e+03],
         [ 1.3419e+03,  5.1043e+03],
         [-2.5899e+03,  3.0755e+03],
         [ 3.0902e+03,  4.4078e+03],
         [ 3.7907e+03,  3.9687e+03],
         [-6.4756e+02,  1.1072e+03]],

        [[ 5.8647e+02, -1.6411e+03],
         [ 2.7642e+03,  2.8629e+03],
         [-8.2127e+02, -1.5756e+03],
         [ 3.9780e+03,  1.1438e+03],
         [-3.2430e+03,  2.4214e+03],
         [ 2.6588e+00,  1.7604e+03],
         [-1.4044e+03, -4.9314e+03],
         [ 3.1863e+03, -7.8590e+02],
         [ 1.0415e+03,  3.9959e+03],
         [ 1.2178e+03,  1.2581e+02]],

        [[-3.5780e+03,  4.2732e+03],
         [-8.7158e+02, -4.4090e+03],
         [ 1.7326e+03,  1.3999e+03],
         [-2.5913e+03, -3.5459e+03],
         [ 3.5609e+03, -3.7006e+03],
         [ 3.9239e+03, -4.2915e+03],
         [ 3.9538e+03, -2.4111e+03],
         [-2.0963e+03,  5.1752e+02],
         [-2.3433e+03, -2.6487e+03],
         [ 2.7846e+03, -4.6307e+03]],

        [[-3.4758e+03,  2.4711e+03],
         [ 4.8039e+03,  3.2821e+03],
         [-3.2818e+03, -4.6406e+03],
         [-3.0400e+03,  2.8672e+03],
         [ 3.8194e+03,  3.2164e+03],
         [-3.9304e+03, -4.1523e+03],
         [-3.8583e+03,  2.3252e+03],
         [-3.5750e+03,  3.5902e+03],
         [-4.2790e+03, -3.7295e+03],
         [ 2.1155e+03,  4.5211e+03]]]) 

t:1, loss.item(): 12704.7431640625
Optimized result :
MatD: 
has nan? False 
tensor([[0.0152, 0.0149, 0.0147,  ..., 0.0118, 0.0110, 0.0105],
        [0.0147, 0.0154, 0.0147,  ..., 0.0112, 0.0110, 0.0106],
        [0.0147, 0.0149, 0.0147,  ..., 0.0111, 0.0111, 0.0105],
        ...,
        [0.0200, 0.0208, 0.0200,  ..., 0.0122, 0.0123, 0.0128],
        [0.0196, 0.0217, 0.0200,  ..., 0.0122, 0.0128, 0.0127],
        [0.0208, 0.0213, 0.0213,  ..., 0.0122, 0.0135, 0.0125]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[-2.2614e-04, -2.1949e-04,  4.4563e-04,  ..., -7.7569e-04,
         -4.6269e-04, -4.6269e-04],
        [ 6.7873e-04, -6.7873e-04, -2.1313e-04,  ..., -2.4694e-04,
         -3.5071e-04, -3.5071e-04],
        [ 2.1949e-04, -2.1949e-04, -2.1313e-04,  ...,  1.0000e-10,
         -5.8480e-04, -5.8480e-04],
        ...,
        [ 8.3333e-04, -8.3333e-04, -1.1321e-03,  ...,  1.5056e-04,
          4.7483e-04,  4.7483e-04],
        [ 2.1313e-03, -1.7391e-03,  1.2766e-03,  ...,  6.2539e-04,
         -1.6228e-04, -1.6228e-04],
        [ 4.4326e-04,  1.0000e-10,  1.0000e-10,  ...,  1.3184e-03,
         -1.0135e-03, -1.0135e-03]], grad_fn=<SelectBackward>)

Epoch 1 finished. Total time: 417.98581433296204;  Epoch time: 286.6042935848236 












test_counter in loss_omega_mat(): 321
test_counter in loss_omega_mat(): 642
test_counter in loss_omega_mat(): 963
test_counter in loss_omega_mat(): 1284
test_counter in loss_omega_mat(): 1605
test_counter in loss_omega_mat(): 1926
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7571, 0.7571],
         [0.9459, 0.9459, 0.9459,  ..., 0.7572, 0.7571, 0.7571],
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7572, 0.7571],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7569]],

        [[0.9458, 0.9458, 0.9458,  ..., 0.7567, 0.7531, 0.7525],
         [0.9459, 0.9459, 0.9458,  ..., 0.7571, 0.7569, 0.7534],
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7570, 0.7536],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7569]],

        [[0.9458, 0.9457, 0.9455,  ..., 0.7559, 0.7397, 0.7383],
         [0.9457, 0.9457, 0.9455,  ..., 0.7525, 0.7488, 0.7364],
         [0.9457, 0.9457, 0.9456,  ..., 0.7571, 0.7530, 0.7412],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7569, 0.7568]],

        ...,

        [[0.9384, 0.9353, 0.9327,  ..., 0.7291, 0.7199, 0.7154],
         [0.9455, 0.9455, 0.9398,  ..., 0.7379, 0.7332, 0.7174],
         [0.9459, 0.9458, 0.9457,  ..., 0.7513, 0.7513, 0.7378],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7570, 0.7570]],

        [[0.9327, 0.9322, 0.9291,  ..., 0.7353, 0.7336, 0.7274],
         [0.9398, 0.9392, 0.9322,  ..., 0.7417, 0.7356, 0.7231],
         [0.9457, 0.9456, 0.9456,  ..., 0.7513, 0.7487, 0.7386],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9458, 0.9458,  ..., 0.7569, 0.7569, 0.7568]],

        [[0.9322, 0.9320, 0.9294,  ..., 0.7362, 0.7308, 0.7079],
         [0.9389, 0.9322, 0.9322,  ..., 0.7490, 0.7245, 0.7236],
         [0.9456, 0.9453, 0.9451,  ..., 0.7510, 0.7393, 0.7363],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7565, 0.7565],
         [0.9459, 0.9459, 0.9458,  ..., 0.7570, 0.7564, 0.7563],
         [0.9458, 0.9457, 0.9457,  ..., 0.7565, 0.7562, 0.7559]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[9.7454e-08, 2.6724e-09, 6.8383e-10,  ..., 8.5832e-07,
          3.5469e-11, 8.9944e-09],
         [4.3255e-07, 2.8640e-07, 2.8645e-07,  ..., 6.8298e-08,
          2.0849e-08, 4.6203e-07],
         [1.3248e-07, 3.2279e-07, 6.9801e-09,  ..., 8.6499e-07,
          5.5012e-07, 1.4887e-06],
         ...,
         [1.2550e-07, 9.0397e-08, 1.3299e-06,  ..., 3.9087e-06,
          9.0316e-08, 4.2800e-06],
         [5.6077e-07, 3.4525e-08, 1.1341e-06,  ..., 4.2426e-08,
          1.2436e-06, 1.8497e-06],
         [6.9455e-07, 9.2748e-11, 9.7568e-08,  ..., 1.6726e-07,
          1.5995e-07, 6.9366e-07]],

        [[6.5625e-08, 1.5349e-07, 5.4091e-07,  ..., 1.0885e-08,
          7.8347e-08, 3.2052e-06],
         [1.5139e-09, 7.9004e-07, 5.1508e-07,  ..., 2.6109e-06,
          2.3819e-10, 1.6948e-06],
         [1.0046e-07, 5.2215e-10, 3.0568e-07,  ..., 9.4411e-07,
          3.1337e-07, 1.0368e-06],
         ...,
         [5.0555e-07, 1.3368e-07, 9.1971e-08,  ..., 1.2705e-07,
          5.2118e-07, 4.2246e-07],
         [2.6649e-08, 3.0359e-07, 2.8372e-08,  ..., 1.6531e-06,
          1.8914e-07, 2.4999e-06],
         [1.9225e-07, 6.0110e-08, 8.4076e-08,  ..., 5.1333e-08,
          8.8327e-08, 7.0484e-08]],

        [[8.7841e-07, 2.9710e-09, 1.2510e-07,  ..., 1.5586e-06,
          4.1321e-07, 1.4833e-06],
         [1.3098e-07, 2.8838e-07, 6.3284e-08,  ..., 1.3401e-07,
          4.6634e-06, 4.6170e-05],
         [1.4879e-08, 5.5984e-07, 3.8881e-08,  ..., 7.6141e-07,
          5.8973e-07, 3.1190e-07],
         ...,
         [2.5257e-07, 9.4935e-08, 7.5174e-08,  ..., 6.6381e-07,
          7.8629e-07, 5.0232e-08],
         [3.2659e-07, 1.6895e-07, 5.2605e-07,  ..., 5.8968e-07,
          2.6242e-06, 1.2233e-06],
         [1.3738e-07, 6.0099e-07, 2.8229e-08,  ..., 2.8607e-06,
          1.1162e-06, 1.4046e-06]],

        ...,

        [[2.6170e-07, 1.1883e-08, 4.2386e-06,  ..., 1.0122e-04,
          9.7146e-08, 1.4376e-04],
         [2.0367e-07, 6.9398e-07, 1.0360e-07,  ..., 1.2012e-04,
          4.3604e-08, 7.8623e-05],
         [6.8343e-08, 8.6071e-07, 1.0196e-09,  ..., 2.3921e-07,
          5.0114e-06, 3.5701e-06],
         ...,
         [2.1301e-08, 3.0410e-07, 2.9295e-07,  ..., 4.4328e-08,
          2.4855e-07, 1.6711e-07],
         [2.1760e-08, 9.2742e-07, 1.1957e-07,  ..., 2.0956e-06,
          2.1687e-08, 4.1899e-07],
         [1.0604e-08, 2.1520e-07, 6.1746e-08,  ..., 2.4108e-09,
          1.2195e-06, 1.4669e-06]],

        [[4.9698e-06, 6.8892e-05, 3.9917e-05,  ..., 2.3506e-04,
          3.4562e-06, 4.0710e-04],
         [3.2988e-07, 5.1022e-07, 1.3069e-06,  ..., 2.4257e-07,
          8.2493e-05, 7.9766e-05],
         [2.0425e-07, 1.4907e-06, 1.8227e-07,  ..., 4.8974e-07,
          1.3635e-07, 8.2693e-05],
         ...,
         [1.2665e-07, 1.5002e-07, 1.4735e-07,  ..., 1.2797e-06,
          7.9886e-07, 1.3997e-07],
         [1.4435e-07, 1.4256e-09, 3.9557e-07,  ..., 2.0794e-07,
          3.4412e-07, 2.8080e-07],
         [1.2454e-07, 4.2620e-08, 4.3195e-07,  ..., 7.9929e-07,
          6.5460e-07, 6.5159e-07]],

        [[1.6302e-04, 1.4115e-05, 4.6389e-06,  ..., 4.5098e-05,
          2.5061e-04, 5.8507e-05],
         [1.8987e-06, 4.4138e-08, 1.9904e-06,  ..., 4.8582e-06,
          7.5104e-05, 5.1781e-05],
         [3.4375e-08, 2.8536e-08, 9.7579e-07,  ..., 8.2532e-09,
          1.1004e-07, 3.1115e-08],
         ...,
         [2.6040e-07, 1.9042e-07, 7.1681e-09,  ..., 2.4829e-07,
          1.0384e-06, 1.4832e-07],
         [1.5781e-08, 1.0952e-06, 7.8268e-08,  ..., 1.0299e-06,
          2.1370e-06, 2.1717e-06],
         [3.1379e-10, 1.4899e-06, 5.3000e-07,  ..., 5.8555e-06,
          1.0296e-06, 2.5838e-06]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[2.3940e-04, 2.6255e-04, 5.7701e-04,  ..., 2.6871e-04,
          5.0139e-04, 5.9431e-04],
         [7.4519e-04, 2.3940e-04, 1.6277e-04,  ..., 6.9689e-04,
          4.7147e-04, 4.5467e-04],
         [5.4611e-04, 1.6277e-04, 3.9869e-04,  ..., 7.8178e-04,
          7.6083e-04, 5.4909e-04],
         ...,
         [7.4317e-04, 4.8743e-04, 9.9838e-04,  ..., 6.1088e-04,
          9.0983e-04, 5.0447e-04],
         [9.8176e-04, 4.8743e-04, 7.7586e-04,  ..., 8.0634e-04,
          8.6618e-04, 8.5353e-04],
         [9.8176e-04, 1.3090e-03, 6.1340e-04,  ..., 7.7391e-04,
          7.7953e-04, 1.0033e-03]],

        [[5.7701e-04, 8.7763e-04, 6.0086e-04,  ..., 7.6033e-04,
          4.1745e-04, 4.3351e-04],
         [8.5496e-04, 7.4519e-04, 6.0086e-04,  ..., 7.1830e-04,
          4.8179e-04, 4.3878e-03],
         [8.5496e-04, 5.4611e-04, 4.3959e-04,  ..., 8.6332e-04,
          1.9557e-04, 4.0894e-04],
         ...,
         [2.7989e-04, 2.7122e-04, 7.5276e-04,  ..., 7.9598e-04,
          4.9708e-04, 6.0179e-04],
         [6.2194e-04, 2.7122e-04, 6.6986e-04,  ..., 7.6332e-04,
          8.5904e-04, 1.0006e-03],
         [6.2194e-04, 5.9488e-04, 6.1340e-04,  ..., 3.3606e-04,
          1.0056e-03, 4.3885e-04]],

        [[5.6666e-04, 5.6751e-04, 4.8458e-04,  ..., 1.4325e-03,
          6.8281e-03, 7.2763e-03],
         [3.4845e-04, 5.6751e-04, 3.1779e-04,  ..., 1.9520e-04,
          4.8205e-04, 4.6793e-03],
         [3.4845e-04, 3.0331e-04, 2.4569e-04,  ..., 5.1133e-04,
          4.6359e-03, 6.5834e-03],
         ...,
         [3.4214e-04, 1.9306e-04, 7.5276e-04,  ..., 8.3218e-04,
          3.3606e-04, 8.2499e-04],
         [3.4214e-04, 4.6287e-04, 1.1256e-03,  ..., 7.6983e-04,
          1.1036e-03, 8.5714e-04],
         [4.6287e-04, 4.5372e-04, 3.8193e-04,  ..., 9.0630e-04,
          6.4250e-04, 7.1501e-04]],

        ...,

        [[8.4475e-04, 3.6125e-04, 4.1181e-03,  ..., 4.2959e-04,
          1.0140e-03, 1.8193e-03],
         [1.2070e-03, 1.1583e-03, 9.5006e-04,  ..., 7.7370e-03,
          5.0470e-03, 2.0649e-03],
         [1.0473e-03, 7.0742e-04, 5.6792e-04,  ..., 5.7802e-04,
          7.5690e-04, 4.2071e-03],
         ...,
         [3.8448e-04, 4.5095e-04, 4.2179e-04,  ..., 5.1885e-04,
          3.7452e-04, 3.4545e-04],
         [7.5783e-04, 4.2179e-04, 3.8375e-04,  ..., 1.8627e-04,
          3.7972e-04, 9.4735e-04],
         [6.9484e-04, 6.3949e-04, 2.1568e-04,  ..., 7.1754e-04,
          1.1094e-03, 7.1070e-04]],

        [[4.1181e-03, 1.1514e-02, 4.5380e-03,  ..., 3.6931e-03,
          9.7967e-04, 8.0259e-03],
         [9.5006e-04, 2.0377e-04, 4.3753e-04,  ..., 6.7124e-04,
          5.6405e-03, 7.9479e-04],
         [5.6792e-04, 2.9480e-04, 7.1022e-04,  ..., 5.0125e-03,
          4.4924e-04, 7.9906e-03],
         ...,
         [3.6491e-04, 5.2796e-04, 1.6434e-04,  ..., 2.4694e-04,
          5.7802e-05, 3.5872e-04],
         [7.3541e-04, 3.8375e-04, 4.6391e-04,  ..., 5.9919e-04,
          3.7612e-04, 5.5393e-04],
         [2.1568e-04, 3.6098e-04, 5.4102e-04,  ..., 3.9493e-04,
          7.4549e-04, 6.4445e-04]],

        [[1.1514e-02, 7.5624e-03, 8.1262e-03,  ..., 7.8358e-03,
          8.2724e-03, 8.1206e-03],
         [9.2358e-04, 6.9529e-04, 4.3753e-04,  ..., 8.5011e-04,
          5.7069e-03, 2.6902e-03],
         [7.1022e-04, 1.1287e-03, 5.2481e-04,  ..., 5.0075e-04,
          5.6612e-04, 5.0559e-03],
         ...,
         [8.2014e-04, 6.1602e-04, 5.2796e-04,  ..., 2.2623e-04,
          1.5020e-05, 5.0176e-04],
         [8.2014e-04, 7.3541e-04, 6.1778e-04,  ..., 7.1690e-04,
          7.8264e-04, 1.1809e-03],
         [5.1068e-04, 5.7939e-04, 4.4755e-04,  ..., 6.9982e-04,
          1.1627e-03, 2.0020e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:1.6009597778320312 loss2:537.7964477539062
Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([44, 73]) torch.Size([44, 73, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[   0.0000,    0.0000,    0.0000,    0.0000,    0.0000,    0.0000,
            0.0000,    0.0000,    0.0000,    0.0000],
        [   0.0000,    0.0000,    0.0000,    0.0000,    0.0000,    0.0000,
            0.0000,    0.0000,    0.0000,    0.0000],
        [  -0.7839,   -0.8652,   -0.8167,    0.6343,    0.5586,   -1.0617,
            0.8623,   -0.8948,   -0.8346,   -0.8360],
        [ -11.3279,    3.5417,    9.1272,   -4.5410,   -5.2129,    7.9614,
            2.6317,  -12.9691,  -18.2022,    6.1765],
        [ -30.0596,    5.5179,   -4.1550,  -30.0857,  -21.7394,  -24.7835,
          -37.3379,  -28.5103,   19.3545,   33.8045],
        [  38.3797,  -80.8902,  -12.9708,   17.8179,   65.2402,   32.0066,
           24.5525,   63.9775,   51.4801,  -15.7446],
        [ -24.5700,  -88.1938,    2.7877,   44.8326,  -66.7526,  -53.5586,
           29.3533,  -23.4016,   -6.0444,  -41.1651],
        [  57.0272,   30.0798,  -53.0506,  -84.3512,  -66.8979, -101.4159,
          -41.9689,   16.9170,   53.3592,   95.3388],
        [ -38.3953,    2.5592, -104.6348,   30.7174,   57.3007,    4.1667,
           46.8147,   87.1379,   27.3815,   88.4354],
        [  23.2406,   -9.2989,   -9.4422,   59.0337, -104.7311,   20.3670,
          104.0620,  -61.1264,  -62.5860,  -61.8232]]) 

MatU.grad[0:10,35:45]: 
tensor([[[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[  286.3845,   179.2401],
         [  109.1640,   241.4054],
         [ -279.3989,   233.5961],
         [  133.1712,   351.3878],
         [   77.4026,   334.7872],
         [  -84.1639,   310.5848],
         [ -234.8701,   163.5443],
         [  176.1571,   381.9478],
         [  -82.7520,   452.3797],
         [  111.1579,    40.3538]],

        [[  338.2518,   682.4932],
         [  703.3271,  -670.2258],
         [  -44.5732, -1145.2397],
         [  745.1601,     7.0294],
         [  -97.8341,  1031.7915],
         [ -470.3111,  1008.5728],
         [  428.4101,  1063.9683],
         [  739.2626,   870.3554],
         [  134.3453,    22.2169],
         [  911.7767,  -636.8617]],

        [[-3974.1284,  -180.6053],
         [   82.3580, -2647.8328],
         [ 4906.0049, -1168.3912],
         [-3629.9248, -3574.1240],
         [-1610.4897, -2658.4131],
         [ 2145.9182, -2011.7992],
         [ 4143.1616,  1087.8627],
         [-1335.4352, -2035.2930],
         [-2631.6238,  2152.5002],
         [-2367.7312, -2103.4314]],

        [[-4299.2881,  2162.0791],
         [ 1475.0374,  -346.7511],
         [ 2815.1172,   335.2370],
         [-2491.3481, -2326.2781],
         [ 2664.3752,  3154.2517],
         [ 4922.8516, -1651.0521],
         [-3425.3843, -2274.5012],
         [ -180.1714,  3977.3914],
         [ 4655.6543,  -727.6606],
         [-4433.9238,  -842.8591]],

        [[-1673.4412, -3990.4912],
         [-2190.8538,  2425.1270],
         [-4237.8789,  -423.3657],
         [  -88.0555,  3275.5051],
         [-1110.1016,  5432.5850],
         [ -113.9934,  3509.6826],
         [  497.2708, -2045.7787],
         [-1027.6377,  5201.1831],
         [ 5064.5391,   182.0222],
         [ -616.4365,  -122.4159]],

        [[ 2242.0046,  3988.2119],
         [ -522.0794, -3740.3850],
         [ 4364.4194,  -367.9346],
         [ -919.0369, -2235.3477],
         [-1176.1868, -4597.0674],
         [ 2793.9763,   251.7669],
         [-3763.8411, -1568.1874],
         [-2052.3320, -4022.5959],
         [ 3934.4221, -3392.0918],
         [-4528.8809, -1431.1924]],

        [[  -21.4790,  2995.3889],
         [ -735.6566,  1929.6154],
         [ 4776.4795,  -603.9272],
         [-3021.1777, -1701.4717],
         [   71.0128,  -419.3293],
         [ 4910.1240,  3034.6191],
         [-4708.6997, -4060.1226],
         [-3853.1289,  1578.2917],
         [-2573.5779,  4799.0571],
         [ 1594.0291,  5145.0132]]]) 

MatD.grad: 
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.0288e+02, -1.1116e+02],
         [ 6.8774e+01,  3.0183e+02],
         [ 3.8140e+02,  2.5152e+02],
         [ 4.9953e+01,  4.0393e+02],
         [ 3.6884e+01,  1.2835e+02],
         [ 8.5361e+01, -1.7452e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.1090e+02, -1.0316e+02],
         [-2.4030e+02, -3.1817e+02],
         [-9.8388e+01,  3.3088e+02],
         [ 9.2585e+02,  1.7091e+01],
         [ 1.2578e+02, -4.6107e+02],
         [-3.3714e+02, -2.7707e+01],
         [ 7.5663e+02, -6.8768e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.0012e+02, -1.1474e+02],
         [ 4.4572e+02, -5.3396e+02],
         [ 1.8370e+02, -2.2349e+02],
         [ 1.7208e+03, -3.2229e+03],
         [-4.3668e+02, -4.3659e+03],
         [-3.4235e+03, -2.7311e+03],
         [ 2.7161e+03,  2.9875e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 4.3240e+02, -4.4643e+00],
         [ 7.8217e+02, -4.5616e+02],
         [-2.3550e+03,  2.7491e+03],
         [ 3.6238e+03,  3.0162e+03],
         [-5.1092e+03, -8.9742e+01],
         [ 1.3549e+03, -2.5075e+02],
         [ 2.6235e+03,  5.0276e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 2.5722e+02,  2.2697e+01],
         [ 8.1892e+02, -6.7407e+02],
         [-1.8255e+03, -2.5993e+03],
         [ 1.4439e+03,  2.8510e+03],
         [-1.5382e+03,  1.2649e+03],
         [ 3.0395e+03, -4.0331e+02],
         [ 5.1598e+03, -2.7332e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 2.3609e+01, -3.6292e+02],
         [ 3.9990e+02,  7.4069e+01],
         [ 3.8511e+02,  3.9561e+03],
         [ 1.7622e+03, -1.8733e+03],
         [-1.5444e+03, -9.5580e+02],
         [-6.7431e+02,  2.8416e+02],
         [ 3.7137e+03, -3.7555e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.4478e+02,  4.0307e+02],
         [ 1.0349e+03,  5.2326e+02],
         [-3.5862e+03,  1.2147e+01],
         [ 3.7406e+02,  4.6072e+03],
         [-2.1279e+03,  8.3794e+02],
         [-4.4402e+03, -4.0793e+01],
         [ 4.7574e+03,  1.6410e+03]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[-1.3042e+03, -2.0251e+03],
         [-4.9464e+03, -1.4636e+03],
         [ 2.8628e+03, -3.3159e+03],
         [-2.9518e+03, -1.9176e+03],
         [ 3.1402e+03,  1.6032e+03],
         [ 1.0631e+03,  1.9748e+03],
         [-2.3651e+02, -3.6515e+03],
         [ 2.3302e+03, -1.0588e+01],
         [-1.7654e+03,  1.7871e+03],
         [-1.1762e+03,  2.0745e+02]],

        [[-2.5420e+03, -1.6016e+03],
         [-6.0411e+03, -5.1456e+02],
         [ 4.2401e+03,  2.5205e+03],
         [-1.3191e+03, -3.5766e+03],
         [ 2.8100e+03,  4.7869e+02],
         [ 1.1570e+03, -6.4031e+02],
         [ 1.2366e+03, -2.3783e+03],
         [-1.3246e+03, -2.1935e+03],
         [-2.5008e+02,  9.6196e+02],
         [ 7.8312e+02,  7.1077e+01]],

        [[-1.9302e+03, -5.1925e+03],
         [-2.5864e+03,  4.1299e+03],
         [ 1.5662e+02,  3.6159e+03],
         [ 1.9065e+03, -3.6280e+03],
         [ 2.5117e+02, -5.8609e+03],
         [-3.5455e+02, -4.4095e+03],
         [-1.0542e+02, -1.7299e+03],
         [-1.7291e+02,  1.0305e+03],
         [-1.1957e+02, -8.7841e+02],
         [ 6.3209e+02, -1.5555e+02]],

        [[ 3.5407e+03,  8.5393e+02],
         [ 5.2467e+02, -3.7538e+03],
         [ 1.0632e+03, -1.5431e+02],
         [-6.2598e+03,  3.0001e+02],
         [ 1.1928e+03,  5.2858e+03],
         [-3.3160e+02, -1.7088e+02],
         [ 5.3813e+02,  5.2550e+02],
         [-5.6877e+02, -4.4379e+02],
         [ 1.3404e+02,  4.0306e+02],
         [ 6.7417e+02,  9.5844e+02]],

        [[ 1.6021e+03, -3.5193e+03],
         [-4.0339e+03,  1.1750e+03],
         [ 3.4874e+03,  2.4205e+01],
         [-1.5931e+03, -8.2868e+02],
         [-3.7243e+03, -3.4244e+02],
         [ 1.2568e+03, -4.1601e+01],
         [-4.5038e+02, -5.4416e+02],
         [-6.1911e+02, -4.7473e+00],
         [ 1.4541e+03,  7.8466e+02],
         [-4.5187e+03, -1.1181e+03]],

        [[-6.8898e+02,  3.6801e+03],
         [-2.3979e+03,  3.4080e+03],
         [ 3.5046e+03,  3.2278e+03],
         [-2.9532e+02,  5.8465e+01],
         [-1.9788e+02, -5.4064e+03],
         [ 1.5925e+02, -7.5919e+02],
         [ 1.5151e+02, -6.6884e+02],
         [ 4.2399e+01, -2.4579e+01],
         [ 3.8914e+02, -3.3774e+03],
         [-3.0897e+02, -4.7940e+03]],

        [[ 2.4670e+03, -8.2176e+02],
         [ 4.9571e+02,  1.0346e+03],
         [-6.6040e+02, -2.6066e+03],
         [-5.9969e+03,  3.0840e+02],
         [ 8.9564e+02,  5.1553e+03],
         [ 6.2123e+02,  8.0189e+02],
         [ 3.9888e+03,  2.7290e+03],
         [-3.7556e+03,  1.7792e+02],
         [-1.4994e+03,  3.0390e+03],
         [ 3.7649e+03,  4.1776e+03]],

        [[ 1.9957e+03, -2.6459e+03],
         [-1.5662e+03, -7.2161e+02],
         [ 2.7615e+03, -1.2209e+03],
         [ 7.9799e+02, -1.6394e+03],
         [-4.5170e+03,  1.5295e+03],
         [ 2.6368e+03,  5.2472e+03],
         [-5.5487e+02,  4.0151e+03],
         [ 2.2732e+02,  4.5205e+02],
         [ 5.2489e+01,  3.3100e+03],
         [-8.8273e+02,  5.4556e+03]],

        [[-8.3496e+00,  5.0912e+03],
         [-6.9808e+02, -3.8746e+03],
         [-4.3969e+02, -3.9910e+03],
         [ 2.1900e+03, -5.0195e+03],
         [ 1.2794e+03, -5.8922e+03],
         [ 3.8072e+01, -3.9465e+03],
         [-1.1220e+03, -6.3300e+03],
         [ 8.8142e+02, -5.4812e+03],
         [-3.5937e+02, -3.7817e+03],
         [-1.0474e+03, -6.5147e+03]],

        [[-5.7351e+03, -1.0647e+03],
         [-2.2505e+02,  5.5169e+03],
         [-3.4956e+03, -1.9643e+02],
         [ 5.2261e+02,  4.6268e+03],
         [ 4.2335e+03,  3.6638e+03],
         [-4.4992e+03, -1.4660e+02],
         [-6.2627e+01,  4.3550e+03],
         [ 4.6150e+03,  3.8404e+03],
         [-4.8044e+03,  2.0927e+02],
         [ 1.5328e+02,  4.4179e+03]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[-2496.2322,  2370.4802],
         [ 2763.7104, -2531.5874],
         [-3433.7905,  1367.6952],
         [ 2072.9680,   842.9191],
         [ -175.3469,  3929.5869],
         [-2736.7349,  2780.8704],
         [ 1975.6104,  2814.7278],
         [-2007.6310,  4620.6191],
         [-1571.0815, -4432.6968],
         [-2561.1045,  2032.6219]],

        [[-3167.5227, -4513.4292],
         [  578.8589,  4149.5737],
         [ 3952.3921,  1405.9949],
         [-3399.4326,  2422.7170],
         [ -316.6412, -4153.1934],
         [-4633.5815,  2685.9114],
         [ 4165.8560, -1470.6958],
         [ 1102.5339, -3894.5942],
         [ 3065.0635,  4746.0879],
         [ 3570.9961,  1926.2252]],

        [[ 3086.7598, -2373.8315],
         [-4007.0015, -3380.8074],
         [  149.7518, -4782.1265],
         [ -762.5225, -1440.5978],
         [ 4156.7358, -1508.6161],
         [-3722.0818, -2796.5979],
         [ -967.6550, -2658.2800],
         [ 2878.6875, -3767.9338],
         [-3264.2009, -3863.9109],
         [ 4643.3154, -2487.3284]],

        [[ 1681.6543,  5328.6411],
         [-4955.0879,   845.0663],
         [ 1384.4823,  3361.5137],
         [ 2804.7410, -3961.1995],
         [ 3129.0273,  2424.8604],
         [-2497.8145,  3412.8381],
         [-1901.8668,  5562.7056],
         [-2395.4702,  1787.4917],
         [-1706.9421,  1225.2915],
         [ -191.8067,  3525.0315]],

        [[-3330.0217, -4122.0142],
         [-2366.5386,  4300.3115],
         [-4086.9023,  3427.8081],
         [ 2540.7788,  3379.3521],
         [ 4181.1626,  4013.7053],
         [ 2377.7708, -4745.9004],
         [-5483.3701, -1676.7584],
         [ -852.0743,  4839.3789],
         [ 4707.3149,  2433.1848],
         [-5425.2861,  1085.2009]],

        [[ 5136.4858,   668.6844],
         [-1271.0201, -2573.4727],
         [ 4370.9893, -1948.1445],
         [-2629.2332, -1642.9702],
         [-3322.8660, -3473.3804],
         [ 3895.5022, -3234.6064],
         [  377.4544, -3902.3604],
         [-2447.2957, -4051.1077],
         [ 4738.8887, -3476.7817],
         [-3071.4453, -2935.4153]],

        [[ 1307.0476,  5210.9507],
         [ 2676.9702, -4132.7622],
         [ -431.5089,  1310.2646],
         [-1583.2135, -5263.1206],
         [-3882.3145,  2144.5093],
         [ 4551.5898,  1525.6167],
         [-4106.9170,  3120.7258],
         [  734.7366,  1765.1097],
         [ 2830.9492,  1880.8068],
         [-2929.7932,  4427.4570]],

        [[-3180.8237, -3614.9368],
         [ 4009.0757,  2661.4941],
         [-4277.5093, -4495.2769],
         [  755.1224,  4329.7446],
         [-2323.0532,  4839.8154],
         [ 4056.1841,  3074.3196],
         [-4742.4033, -1688.8907],
         [ 1205.3756,  4636.6968],
         [ 5036.2266,  2138.8362],
         [-3394.6619, -2060.6531]],

        [[-1564.0702,   948.4181],
         [-5343.5767,  -780.1418],
         [ 4570.5181,  3461.6790],
         [-3042.0674, -2895.3909],
         [ 3925.9424, -1945.4747],
         [ 2459.7114, -3023.1318],
         [ 1936.1687, -4937.1758],
         [-1212.7841, -4685.3965],
         [-2009.2908, -2638.0383],
         [ 2335.3057, -3918.2029]],

        [[-3302.3271,  3372.3574],
         [ 2264.5020,  2766.0930],
         [-1831.2648, -1333.9293],
         [-2692.3257,  4075.7754],
         [ 1638.6801,  2847.0173],
         [  217.5106, -1272.1880],
         [-2136.8215,  4185.0557],
         [-1595.5896,  2734.7239],
         [ -874.6345, -2145.5339],
         [ 4275.9180,   372.1432]]]) 

t:2, loss.item(): 10757.529296875
Optimized result :
MatD: 
has nan? False 
tensor([[0.0152, 0.0149, 0.0147,  ..., 0.0118, 0.0110, 0.0105],
        [0.0147, 0.0154, 0.0147,  ..., 0.0112, 0.0110, 0.0106],
        [0.0147, 0.0149, 0.0147,  ..., 0.0111, 0.0111, 0.0105],
        ...,
        [0.0200, 0.0208, 0.0200,  ..., 0.0122, 0.0123, 0.0128],
        [0.0196, 0.0217, 0.0200,  ..., 0.0122, 0.0128, 0.0127],
        [0.0208, 0.0213, 0.0213,  ..., 0.0122, 0.0135, 0.0125]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[-2.2614e-04, -2.1949e-04,  4.4563e-04,  ..., -7.7569e-04,
         -4.6269e-04, -4.6269e-04],
        [ 6.7873e-04, -6.7873e-04, -2.1313e-04,  ..., -2.4694e-04,
         -3.5071e-04, -3.5071e-04],
        [ 2.1949e-04, -2.1949e-04, -2.1313e-04,  ...,  1.0000e-10,
         -5.8480e-04, -5.8480e-04],
        ...,
        [ 8.3333e-04, -8.3333e-04, -1.1321e-03,  ...,  1.5056e-04,
          4.7483e-04,  4.7483e-04],
        [ 2.1313e-03, -1.7391e-03,  1.2766e-03,  ...,  6.2539e-04,
         -1.6228e-04, -1.6228e-04],
        [ 4.4326e-04,  1.0000e-10,  1.0000e-10,  ...,  1.3184e-03,
         -1.0135e-03, -1.0135e-03]], grad_fn=<SelectBackward>)

Epoch 2 finished. Total time: 795.5099756717682;  Epoch time: 377.52216482162476 












test_counter in loss_omega_mat(): 321
test_counter in loss_omega_mat(): 642
test_counter in loss_omega_mat(): 963
test_counter in loss_omega_mat(): 1284
test_counter in loss_omega_mat(): 1605
test_counter in loss_omega_mat(): 1926
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7571, 0.7568],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7569],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7571],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7572]],

        [[0.9458, 0.9458, 0.9457,  ..., 0.7565, 0.7515, 0.7515],
         [0.9459, 0.9459, 0.9457,  ..., 0.7570, 0.7567, 0.7522],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7567, 0.7525],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7574],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7572]],

        [[0.9458, 0.9454, 0.9452,  ..., 0.7557, 0.7357, 0.7332],
         [0.9456, 0.9454, 0.9453,  ..., 0.7520, 0.7471, 0.7325],
         [0.9456, 0.9456, 0.9456,  ..., 0.7570, 0.7524, 0.7384],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7574],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7574],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7572, 0.7572]],

        ...,

        [[0.9367, 0.9323, 0.9296,  ..., 0.7238, 0.7172, 0.7080],
         [0.9455, 0.9454, 0.9384,  ..., 0.7345, 0.7280, 0.7107],
         [0.9459, 0.9457, 0.9456,  ..., 0.7504, 0.7500, 0.7341],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7572, 0.7570, 0.7569]],

        [[0.9296, 0.9293, 0.9248,  ..., 0.7311, 0.7303, 0.7210],
         [0.9384, 0.9377, 0.9293,  ..., 0.7382, 0.7306, 0.7163],
         [0.9457, 0.9456, 0.9454,  ..., 0.7500, 0.7463, 0.7348],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9458, 0.9458,  ..., 0.7573, 0.7573, 0.7573],
         [0.9459, 0.9458, 0.9458,  ..., 0.7569, 0.7569, 0.7568]],

        [[0.9293, 0.9289, 0.9252,  ..., 0.7312, 0.7246, 0.6996],
         [0.9375, 0.9293, 0.9293,  ..., 0.7470, 0.7180, 0.7162],
         [0.9454, 0.9454, 0.9445,  ..., 0.7494, 0.7360, 0.7315],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7565, 0.7564],
         [0.9459, 0.9458, 0.9458,  ..., 0.7570, 0.7566, 0.7565],
         [0.9459, 0.9458, 0.9458,  ..., 0.7567, 0.7564, 0.7563]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[9.8065e-08, 5.2110e-08, 2.0012e-07,  ..., 2.5651e-07,
          3.4046e-10, 1.2251e-06],
         [3.2885e-07, 6.9382e-08, 4.2007e-09,  ..., 1.7884e-08,
          2.3130e-07, 1.5570e-07],
         [6.3882e-08, 1.0855e-07, 1.0625e-07,  ..., 8.5086e-07,
          8.3813e-08, 6.2742e-10],
         ...,
         [3.9728e-09, 2.0545e-08, 4.8345e-07,  ..., 7.0610e-08,
          8.2852e-08, 9.6150e-07],
         [5.9115e-12, 3.0795e-09, 6.5057e-08,  ..., 1.3876e-09,
          5.4960e-08, 1.1344e-06],
         [6.1444e-11, 3.3758e-08, 1.5397e-07,  ..., 4.5819e-07,
          1.6752e-06, 3.9120e-08]],

        [[1.0352e-06, 1.9231e-07, 1.5495e-07,  ..., 6.3265e-08,
          2.0493e-07, 3.8243e-06],
         [2.8065e-07, 3.3680e-07, 1.9703e-07,  ..., 2.9222e-06,
          2.2538e-08, 3.8089e-06],
         [5.3901e-08, 3.1889e-08, 3.4236e-08,  ..., 4.0681e-07,
          5.5789e-08, 2.7296e-06],
         ...,
         [1.2105e-08, 1.3083e-08, 2.9781e-07,  ..., 3.5465e-08,
          1.1811e-09, 1.1916e-07],
         [1.1592e-07, 1.0661e-08, 4.3735e-07,  ..., 2.7052e-07,
          1.0715e-07, 8.3470e-08],
         [5.1646e-08, 4.0511e-08, 3.2155e-07,  ..., 2.0250e-07,
          1.9532e-07, 7.9064e-09]],

        [[8.6417e-07, 3.2504e-07, 4.0388e-07,  ..., 1.9149e-06,
          2.0888e-06, 2.6187e-06],
         [2.3063e-07, 1.0227e-06, 4.8869e-08,  ..., 1.1628e-08,
          2.7670e-06, 7.1162e-05],
         [1.8564e-08, 3.2964e-09, 3.4681e-08,  ..., 2.1479e-09,
          2.6967e-06, 1.6760e-06],
         ...,
         [3.1704e-08, 2.6065e-07, 1.1553e-09,  ..., 1.3633e-07,
          4.2210e-07, 1.7348e-07],
         [9.6681e-08, 1.1635e-07, 3.8933e-07,  ..., 1.2038e-06,
          2.6501e-07, 6.6758e-07],
         [1.9167e-08, 1.0299e-08, 1.8065e-08,  ..., 7.8523e-08,
          3.4062e-07, 1.3183e-06]],

        ...,

        [[1.9682e-07, 2.9988e-07, 3.8106e-06,  ..., 1.5033e-04,
          4.0284e-07, 1.4447e-04],
         [1.2082e-07, 3.2196e-09, 1.3282e-07,  ..., 1.1361e-04,
          4.4938e-08, 8.6219e-05],
         [1.7186e-07, 2.4666e-09, 7.8888e-07,  ..., 6.5378e-08,
          3.0112e-06, 4.7157e-07],
         ...,
         [5.2953e-07, 1.4476e-07, 2.5963e-07,  ..., 3.7304e-06,
          1.5878e-06, 7.8361e-10],
         [6.3642e-07, 4.5856e-09, 3.8101e-07,  ..., 5.4160e-07,
          2.7086e-06, 3.3988e-07],
         [4.8270e-08, 1.0279e-07, 2.8105e-07,  ..., 1.5412e-08,
          2.1255e-07, 1.3732e-09]],

        [[3.3987e-06, 7.7817e-05, 3.2964e-05,  ..., 4.2453e-06,
          2.4596e-04, 3.9290e-04],
         [6.4825e-07, 1.6725e-06, 1.0467e-06,  ..., 5.0220e-10,
          8.8632e-05, 8.4649e-05],
         [9.3138e-08, 5.4207e-07, 4.1319e-08,  ..., 6.6814e-08,
          3.9747e-06, 8.1578e-05],
         ...,
         [6.1654e-07, 1.7829e-09, 2.5965e-07,  ..., 1.6813e-06,
          4.8148e-07, 7.8592e-07],
         [1.2295e-07, 2.3920e-07, 1.1109e-07,  ..., 7.0452e-09,
          6.8315e-08, 1.5664e-08],
         [3.0910e-07, 3.6005e-09, 3.2435e-08,  ..., 1.7680e-06,
          1.8444e-09, 3.0901e-07]],

        [[1.7266e-04, 2.6287e-05, 1.2416e-05,  ..., 1.9510e-05,
          2.0186e-04, 4.9597e-05],
         [1.1009e-06, 7.1813e-10, 2.3087e-06,  ..., 7.3313e-07,
          9.2386e-05, 6.0413e-05],
         [6.6358e-07, 1.1258e-09, 2.6131e-06,  ..., 5.9843e-07,
          1.0586e-09, 2.1129e-06],
         ...,
         [5.0470e-09, 2.7887e-07, 8.4322e-07,  ..., 9.8165e-07,
          1.1778e-06, 7.5391e-08],
         [8.4585e-08, 2.2382e-08, 4.8337e-08,  ..., 1.2353e-06,
          1.7627e-06, 1.4483e-06],
         [5.8036e-07, 2.3492e-08, 7.1912e-07,  ..., 1.6238e-06,
          9.3802e-07, 3.5946e-07]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[3.2556e-04, 5.1195e-05, 3.1724e-04,  ..., 1.5494e-04,
          8.2759e-04, 6.7926e-04],
         [2.5572e-04, 5.1195e-05, 9.6775e-04,  ..., 5.7136e-04,
          1.5098e-04, 3.4893e-04],
         [2.4184e-04, 2.5308e-04, 2.5572e-04,  ..., 9.1233e-04,
          8.0318e-05, 5.4367e-04],
         ...,
         [9.6835e-05, 2.3128e-04, 5.1393e-04,  ..., 3.8612e-04,
          3.7342e-04, 4.9466e-04],
         [9.6835e-05, 7.7680e-04, 4.2115e-04,  ..., 5.9871e-04,
          8.2548e-04, 6.8811e-04],
         [3.3943e-04, 7.7680e-04, 1.0429e-03,  ..., 4.4704e-04,
          3.4397e-04, 8.8091e-04]],

        [[7.4944e-04, 7.0620e-04, 6.8451e-04,  ..., 5.0206e-04,
          4.0439e-04, 4.2187e-04],
         [1.0217e-03, 9.6775e-04, 6.8451e-04,  ..., 8.5183e-04,
          3.4972e-04, 3.7813e-03],
         [2.4184e-04, 5.2730e-05, 1.0217e-03,  ..., 4.2396e-04,
          3.4591e-04, 2.7808e-04],
         ...,
         [2.8717e-04, 4.4268e-04, 5.0798e-04,  ..., 5.6047e-04,
          3.6180e-04, 3.3142e-04],
         [2.8717e-04, 7.8817e-04, 1.4809e-04,  ..., 1.7618e-04,
          6.4343e-04, 3.1249e-04],
         [3.3943e-04, 5.1950e-04, 1.4809e-04,  ..., 2.6992e-04,
          1.1542e-03, 6.3099e-04]],

        [[4.2605e-04, 4.4932e-04, 3.2342e-04,  ..., 1.5073e-03,
          6.1212e-03, 6.3887e-03],
         [6.9639e-04, 4.4932e-04, 7.6180e-04,  ..., 3.0946e-04,
          5.8040e-04, 3.8850e-03],
         [2.0844e-04, 5.5094e-05, 6.9639e-04,  ..., 2.0212e-04,
          4.3944e-03, 6.3421e-03],
         ...,
         [4.4268e-04, 2.3567e-04, 7.3758e-04,  ..., 1.3966e-04,
          4.5030e-04, 3.0202e-04],
         [2.2614e-04, 4.5658e-04, 2.3567e-04,  ..., 5.0052e-04,
          6.4673e-04, 7.3009e-04],
         [2.2614e-04, 4.6031e-04, 5.1950e-04,  ..., 6.7115e-04,
          6.0126e-04, 3.9370e-04]],

        ...,

        [[4.1209e-04, 4.7381e-04, 4.0459e-03,  ..., 7.6902e-03,
          9.4606e-04, 1.5783e-03],
         [5.4846e-04, 4.7289e-04, 8.3616e-04,  ..., 7.4005e-03,
          4.4143e-03, 2.1075e-03],
         [1.3640e-04, 5.0057e-04, 4.6289e-04,  ..., 2.9253e-04,
          6.7413e-04, 4.0030e-03],
         ...,
         [7.2684e-04, 3.6515e-04, 5.1975e-04,  ..., 6.9197e-04,
          6.2323e-04, 6.1562e-04],
         [7.2684e-04, 6.7840e-04, 8.0773e-04,  ..., 4.9516e-04,
          5.7694e-04, 4.5872e-04],
         [3.1192e-04, 6.7840e-04, 2.8211e-04,  ..., 3.4768e-04,
          6.3089e-04, 2.1235e-04]],

        [[4.0459e-03, 1.0538e-02, 4.3057e-03,  ..., 8.6117e-04,
          3.4934e-03, 7.8370e-03],
         [8.3616e-04, 5.8811e-04, 7.2739e-04,  ..., 9.8361e-04,
          5.1907e-03, 1.2484e-03],
         [5.0057e-04, 8.8566e-04, 6.8291e-04,  ..., 4.9208e-03,
          3.1617e-04, 6.6924e-03],
         ...,
         [6.1165e-04, 4.1852e-04, 3.3285e-04,  ..., 4.4626e-04,
          3.7768e-04, 3.4264e-04],
         [4.1852e-04, 5.1042e-04, 5.5610e-04,  ..., 4.0808e-04,
          5.0417e-04, 7.5769e-04],
         [2.8211e-04, 7.5396e-04, 4.3172e-04,  ..., 3.1298e-04,
          7.7746e-04, 9.0974e-04]],

        [[1.0538e-02, 6.4069e-03, 7.2226e-03,  ..., 6.7697e-03,
          7.5046e-03, 6.7518e-03],
         [5.9970e-04, 1.6551e-04, 7.2739e-04,  ..., 8.6540e-04,
          4.9845e-03, 2.0127e-03],
         [6.8291e-04, 3.5598e-04, 6.1500e-04,  ..., 4.2652e-04,
          1.0673e-03, 4.0708e-03],
         ...,
         [5.2126e-04, 7.2723e-04, 6.4022e-04,  ..., 2.3964e-04,
          5.9129e-04, 4.5620e-04],
         [6.4022e-04, 8.6705e-04, 5.5610e-04,  ..., 2.4138e-04,
          2.0965e-04, 8.7728e-04],
         [2.4874e-04, 7.5396e-04, 6.5494e-04,  ..., 3.7561e-04,
          1.1280e-03, 1.6987e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:1.7335968017578125 loss2:464.5644226074219
Finish constructing loss, calculating backward() ... 
