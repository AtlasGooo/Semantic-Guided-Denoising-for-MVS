DIR_NAME: g:\Workspaces\Anaconda_ws\Semantic_Denoising_MVS\scripts 

DEVICE: cuda? True

Graph params:
(pLambda,pAlpha,pCigma_int,pCigma_spa,pB,pK,pQ): 
(20,15,0.07,3,9,20,3)

MatI: 
tensor([[ 63.,  62.,  64.,  ..., 114., 122., 115.],
        [ 65.,  63.,  67.,  ..., 115., 125., 119.],
        [ 62.,  73.,  67.,  ..., 116., 119., 116.],
        ...,
        [ 83.,  66.,  77.,  ...,  85.,  80.,  81.],
        [ 87.,  55.,  82.,  ...,  73.,  78.,  74.],
        [ 71.,  69.,  73.,  ...,  72.,  85.,  88.]])
MatC: 
tensor([[0.9529, 0.9686, 0.9804,  ..., 0.9882, 0.9961, 0.9961],
        [0.9137, 0.9451, 0.9490,  ..., 0.9882, 0.9961, 0.9961],
        [0.8510, 0.8549, 0.9098,  ..., 0.9922, 0.9922, 0.9922],
        ...,
        [0.9490, 0.8941, 0.9098,  ..., 0.9804, 0.9804, 0.9843],
        [0.9490, 0.9176, 0.9216,  ..., 0.9804, 0.9804, 0.9804],
        [0.9373, 0.9216, 0.9333,  ..., 0.9725, 0.9804, 0.9843]])
debug:
MatD.shape: torch.Size([59, 98]) 
has nan? False 
MatD: 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0149,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]]) 

MatU.shape: torch.Size([59, 98, 2]) 
has nan? False 
MatUx: 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]]) 

Optimize & Adam params:
(n_iter,lr,betas,eps):
(20,0.0008,(0.9, 0.999),1e-08)










test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
test_counter in loss_omega_mat(): 4046
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9456, 0.9453, 0.9450,  ..., 0.6405, 0.6065, 0.6065],
         [0.4517, 0.4407, 0.4255,  ..., 0.2921, 0.2921, 0.2918],
         [0.4407, 0.4254, 0.4209,  ..., 0.2917, 0.2887, 0.2750],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7571],
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7570, 0.7568],
         [0.9459, 0.9459, 0.9457,  ..., 0.7569, 0.7568, 0.7564]],

        [[0.9456, 0.9455, 0.9454,  ..., 0.6408, 0.6408, 0.6407],
         [0.9455, 0.9453, 0.9452,  ..., 0.6400, 0.6065, 0.6065],
         [0.9453, 0.9452, 0.9452,  ..., 0.6399, 0.6065, 0.6065],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7571, 0.7571],
         [0.9459, 0.9459, 0.9457,  ..., 0.7572, 0.7571, 0.7569]],

        [[0.9455, 0.9455, 0.9454,  ..., 0.7569, 0.7569, 0.6408],
         [0.9455, 0.9453, 0.9453,  ..., 0.7562, 0.6407, 0.6407],
         [0.9453, 0.9453, 0.9452,  ..., 0.6408, 0.6407, 0.6406],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7572, 0.7571],
         [0.9459, 0.9459, 0.9457,  ..., 0.7572, 0.7571, 0.7571]],

        ...,

        [[0.9458, 0.9458, 0.9458,  ..., 0.7571, 0.7569, 0.7565],
         [0.9459, 0.9458, 0.9458,  ..., 0.7573, 0.7564, 0.7490],
         [0.9459, 0.9458, 0.9452,  ..., 0.7571, 0.7449, 0.7447],
         ...,
         [0.9459, 0.9459, 0.9453,  ..., 0.7567, 0.7565, 0.7564],
         [0.9459, 0.9459, 0.9452,  ..., 0.7566, 0.7564, 0.7563],
         [0.9459, 0.9457, 0.9451,  ..., 0.7564, 0.7564, 0.7562]],

        [[0.9458, 0.9458, 0.9458,  ..., 0.7569, 0.7565, 0.7560],
         [0.9458, 0.9458, 0.9458,  ..., 0.7543, 0.7515, 0.7455],
         [0.9454, 0.9452, 0.9452,  ..., 0.7506, 0.7455, 0.7405],
         ...,
         [0.9458, 0.9455, 0.9454,  ..., 0.7565, 0.7564, 0.7563],
         [0.9455, 0.9455, 0.9453,  ..., 0.7565, 0.7564, 0.7564],
         [0.9455, 0.9454, 0.9454,  ..., 0.7564, 0.7563, 0.7562]],

        [[0.9458, 0.9458, 0.9458,  ..., 0.7569, 0.7565, 0.7539],
         [0.9458, 0.9458, 0.9458,  ..., 0.7520, 0.7500, 0.7431],
         [0.9452, 0.9449, 0.9444,  ..., 0.7475, 0.7442, 0.7371],
         ...,
         [0.9457, 0.9455, 0.9454,  ..., 0.7566, 0.7566, 0.7558],
         [0.9455, 0.9454, 0.9453,  ..., 0.7567, 0.7565, 0.7562],
         [0.9454, 0.9454, 0.9452,  ..., 0.7566, 0.7565, 0.7563]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[1.5306e-06, 4.0484e-08, 3.8611e-07,  ..., 1.6194e-07,
          2.7048e-06, 1.0837e-06],
         [6.7664e-07, 5.9629e-07, 1.1162e-06,  ..., 2.2855e-06,
          1.0239e-06, 3.6436e-07],
         [4.1929e-06, 1.8933e-07, 1.6268e-06,  ..., 1.7672e-05,
          1.1506e-05, 1.2208e-05],
         ...,
         [1.6670e-07, 9.5653e-08, 9.8029e-09,  ..., 4.4213e-08,
          6.6680e-07, 5.8263e-08],
         [1.9661e-07, 9.5653e-08, 1.9661e-07,  ..., 4.6043e-07,
          3.0338e-07, 1.7094e-07],
         [1.6773e-06, 2.6592e-07, 2.6592e-07,  ..., 2.6592e-07,
          7.5769e-06, 1.2975e-06]],

        [[2.8325e-07, 1.7654e-07, 1.7654e-07,  ..., 2.0375e-06,
          2.1904e-06, 2.9109e-06],
         [1.7654e-07, 4.1929e-06, 4.1929e-06,  ..., 9.3287e-06,
          2.3838e-05, 1.5889e-06],
         [1.7654e-07, 1.3507e-05, 1.7654e-07,  ..., 1.7102e-05,
          1.9209e-05, 4.6486e-05],
         ...,
         [1.6670e-07, 2.5735e-07, 1.0000e-20,  ..., 6.6680e-07,
          8.3830e-07, 6.6680e-07],
         [1.6670e-07, 1.6670e-07, 1.6670e-07,  ..., 7.2539e-07,
          6.6680e-07, 9.6858e-08],
         [4.0742e-07, 1.3124e-06, 9.0385e-07,  ..., 1.0699e-06,
          2.9083e-07, 5.5747e-10]],

        [[1.9859e-07, 1.0000e-20, 1.0000e-20,  ..., 1.7654e-07,
          4.1929e-06, 2.3963e-06],
         [3.8611e-07, 3.8611e-07, 1.7654e-07,  ..., 2.1381e-06,
          4.2425e-06, 2.7653e-06],
         [1.5049e-06, 3.3422e-06, 1.0146e-06,  ..., 3.3566e-06,
          8.2579e-06, 2.4823e-06],
         ...,
         [1.6670e-07, 9.4222e-09, 2.5538e-07,  ..., 1.0103e-06,
          3.6291e-07, 3.7277e-07],
         [6.6680e-07, 5.4362e-07, 1.0825e-07,  ..., 2.4146e-06,
          6.9943e-07, 7.1822e-06],
         [9.0016e-07, 1.3535e-06, 9.0016e-07,  ..., 6.8514e-06,
          2.4383e-06, 4.3517e-06]],

        ...,

        [[1.5747e-07, 4.0484e-08, 4.0485e-08,  ..., 9.7911e-07,
          4.0485e-08, 1.6194e-07],
         [3.5764e-07, 3.2603e-07, 3.2603e-07,  ..., 3.0471e-06,
          1.9090e-06, 2.3852e-06],
         [1.4890e-07, 1.6194e-07, 3.4467e-07,  ..., 6.2140e-07,
          8.3810e-05, 9.9396e-06],
         ...,
         [2.1588e-08, 2.1588e-08, 1.5951e-06,  ..., 6.6560e-07,
          5.8572e-07, 1.0033e-06],
         [3.3333e-07, 1.8526e-07, 2.4237e-06,  ..., 7.8320e-08,
          3.9491e-06, 6.0170e-07],
         [2.2668e-08, 8.8498e-08, 3.7071e-06,  ..., 4.9573e-06,
          2.5146e-06, 4.4657e-06]],

        [[1.4091e-07, 1.3674e-07, 1.4091e-07,  ..., 1.8350e-06,
          2.5155e-10, 1.8782e-06],
         [4.0485e-08, 2.3852e-06, 1.3041e-06,  ..., 1.2908e-06,
          3.4103e-08, 1.5350e-06],
         [3.1941e-07, 1.6667e-07, 1.6194e-07,  ..., 1.4457e-06,
          6.6375e-06, 1.3566e-05],
         ...,
         [3.5399e-07, 3.3753e-07, 3.3753e-07,  ..., 2.4492e-06,
          5.1727e-06, 3.8973e-06],
         [2.8112e-06, 6.5969e-07, 6.5969e-07,  ..., 3.6938e-06,
          2.0413e-06, 2.4941e-06],
         [2.0518e-06, 1.6852e-07, 1.6852e-07,  ..., 1.1838e-05,
          8.9742e-09, 3.4217e-06]],

        [[4.0484e-08, 1.5307e-07, 4.0485e-08,  ..., 6.7664e-07,
          4.0022e-07, 1.4854e-07],
         [4.2865e-08, 2.6486e-08, 3.1247e-11,  ..., 1.0357e-06,
          3.4010e-11, 3.1382e-06],
         [3.8686e-06, 1.6667e-07, 4.7259e-06,  ..., 1.1962e-04,
          5.8869e-07, 1.7361e-05],
         ...,
         [1.6539e-07, 3.0779e-08, 2.6495e-07,  ..., 6.0406e-06,
          2.3641e-07, 2.2810e-06],
         [2.1612e-06, 1.0115e-06, 9.3442e-06,  ..., 2.5958e-05,
          1.3193e-05, 1.4419e-05],
         [9.9629e-06, 2.4096e-06, 6.2709e-07,  ..., 1.2029e-06,
          9.2564e-08, 2.1429e-07]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[1.4447e-03, 1.0451e-03, 9.4000e-04,  ..., 1.3741e-03,
          2.2025e-04, 2.8949e-04],
         [6.2341e-04, 1.0789e-03, 2.8710e-03,  ..., 2.8455e-04,
          4.0957e-04, 1.6510e-03],
         [2.9354e-03, 1.7905e-03, 3.0949e-03,  ..., 1.3044e-03,
          3.1642e-04, 2.1427e-03],
         ...,
         [1.4002e-04, 3.2474e-04, 3.0928e-04,  ..., 8.6235e-04,
          5.7877e-04, 1.0050e-03],
         [1.1545e-03, 1.6672e-04, 8.5170e-04,  ..., 1.0256e-03,
          9.5909e-04, 1.3004e-03],
         [1.1545e-03, 5.4969e-04, 1.6475e-03,  ..., 1.4687e-03,
          1.3399e-03, 1.8780e-03]],

        [[1.6916e-03, 1.6275e-03, 4.2017e-04,  ..., 1.5583e-03,
          9.6858e-04, 1.4184e-03],
         [1.6275e-03, 1.9322e-03, 3.6392e-03,  ..., 2.7127e-03,
          5.4322e-04, 6.7511e-04],
         [3.3638e-03, 3.6392e-03, 2.0000e-03,  ..., 3.0134e-03,
          5.7905e-04, 7.1304e-04],
         ...,
         [9.7068e-05, 1.4002e-04, 4.0829e-04,  ..., 5.8048e-04,
          3.2474e-04, 5.8928e-04],
         [8.1658e-04, 8.9497e-04, 8.5170e-04,  ..., 1.0329e-03,
          6.8010e-04, 1.2181e-03],
         [3.1803e-04, 8.9497e-04, 1.6475e-03,  ..., 4.7689e-04,
          1.0415e-03, 9.5993e-04]],

        [[1.3390e-03, 6.2138e-04, 7.5010e-04,  ..., 1.0409e-03,
          2.6156e-03, 2.0440e-03],
         [6.2138e-04, 9.0859e-04, 1.9322e-03,  ..., 9.6626e-04,
          8.1964e-04, 1.4872e-03],
         [1.1100e-03, 3.3638e-03, 4.4393e-04,  ..., 1.6498e-03,
          1.4442e-03, 1.0255e-03],
         ...,
         [9.7068e-05, 4.1967e-04, 3.2116e-04,  ..., 5.2944e-04,
          8.8985e-04, 1.9192e-03],
         [3.2116e-04, 4.7709e-04, 8.4281e-04,  ..., 8.2922e-04,
          1.1643e-03, 1.2898e-03],
         [1.6177e-04, 4.7709e-04, 8.4218e-04,  ..., 2.7444e-04,
          1.3063e-03, 1.2212e-03]],

        ...,

        [[5.9803e-04, 6.0541e-04, 5.7102e-04,  ..., 1.2877e-03,
          5.6933e-04, 4.5514e-04],
         [1.2345e-03, 9.9077e-04, 1.6588e-03,  ..., 9.9859e-04,
          2.4975e-03, 9.9547e-03],
         [2.7692e-04, 9.9077e-04, 1.8476e-04,  ..., 7.0254e-04,
          1.0741e-02, 1.9116e-03],
         ...,
         [4.5480e-04, 3.3018e-04, 1.4175e-03,  ..., 1.9264e-03,
          5.5091e-04, 1.4518e-04],
         [4.5480e-04, 5.9926e-04, 1.9996e-03,  ..., 1.6342e-03,
          4.4536e-04, 4.8397e-04],
         [5.9926e-04, 9.5845e-04, 1.6480e-03,  ..., 4.2364e-04,
          4.6592e-04, 2.1037e-04]],

        [[9.6886e-04, 5.7102e-04, 1.5466e-03,  ..., 5.4730e-04,
          1.4170e-03, 2.7519e-03],
         [5.1885e-04, 1.6588e-03, 1.5466e-03,  ..., 1.7099e-03,
          7.9408e-04, 9.3702e-04],
         [1.0392e-03, 2.3841e-03, 1.8476e-04,  ..., 9.5891e-03,
          5.1530e-03, 4.1035e-03],
         ...,
         [8.7857e-04, 1.3957e-03, 1.2949e-03,  ..., 1.1574e-03,
          1.2609e-03, 1.1344e-03],
         [1.3957e-03, 2.4663e-03, 3.0406e-03,  ..., 2.2475e-03,
          5.8121e-04, 6.0875e-04],
         [2.4663e-03, 2.6075e-03, 1.2366e-03,  ..., 2.4182e-03,
          8.6151e-04, 2.3963e-03]],

        [[6.2921e-04, 9.6886e-04, 2.8892e-04,  ..., 9.0827e-04,
          1.8388e-03, 2.1358e-03],
         [4.8241e-04, 5.1885e-04, 2.8892e-04,  ..., 5.2875e-03,
          9.0808e-03, 4.6511e-03],
         [2.3841e-03, 1.7771e-03, 4.0825e-04,  ..., 1.2952e-02,
          2.1800e-03, 3.9513e-03],
         ...,
         [4.6683e-04, 2.9728e-03, 1.2949e-03,  ..., 3.3386e-05,
          1.6342e-03, 1.2801e-03],
         [2.9728e-03, 3.1963e-03, 3.0406e-03,  ..., 1.9264e-03,
          1.7187e-03, 6.6912e-04],
         [3.1963e-03, 2.6075e-03, 1.4376e-03,  ..., 4.9722e-04,
          3.4729e-03, 2.4031e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:2117.10205078125


loss.item(): 42342.0390625


Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([59, 98]) torch.Size([59, 98, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 1.4040e+00,  4.5969e+00,  4.3504e+00,  3.1596e+00,  2.7795e+00,
          4.9879e-01,  7.4626e+00,  1.0229e+01,  5.2164e-01, -1.2337e+01],
        [-3.2908e+00, -2.6996e+00, -6.3937e+00,  2.4041e-01,  5.2687e+00,
          9.9426e+00,  9.1528e+00,  9.5734e+01,  2.0685e+01,  3.4522e+01],
        [ 5.8253e-01, -1.4882e+01, -2.7403e+01, -1.5991e+01,  9.0514e+01,
          1.9204e+01, -2.3588e+02,  1.9759e+02, -4.7065e+02,  2.7512e+02],
        [-2.0419e+01,  1.3843e+01, -1.4480e+00,  2.0883e+01,  7.2091e+01,
          6.1661e+02, -1.8561e+01,  5.3194e+02, -8.7543e+01, -5.7065e+02],
        [ 1.1780e+01, -8.4057e+00, -2.1878e+00,  5.5826e+02,  5.5497e+02,
          7.5882e+02,  9.4559e+02,  1.3442e+03, -7.7504e+01,  1.9060e+02],
        [-1.0509e+01,  1.9119e+01,  1.6656e+02,  5.7628e+02,  1.0117e+03,
         -6.6558e+02,  8.3293e+02,  1.6504e+03, -1.2158e+02,  1.4467e+03],
        [ 3.4112e+00,  4.3035e+00,  5.6407e+02,  8.0100e+02,  3.9340e+02,
         -1.2316e+04, -7.0243e+02,  1.1666e+03,  1.2916e+02, -1.0972e+03],
        [-2.7309e+00,  2.8706e+01,  8.9510e+01,  9.6643e+02,  6.4344e+02,
          1.1207e+02, -8.1050e+03,  6.9380e+02, -5.1177e+02, -1.1008e+04]]) 

MatU.grad[0:10,35:45]: 
tensor([[[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[  488.4095,  -366.9297],
         [ -669.2017,    71.2159],
         [  374.6219,   776.2484],
         [ -294.1638,   -17.2294],
         [  242.5247,  -696.9795],
         [  -58.0138,   -66.6124],
         [ -206.9245,   697.6710],
         [ -242.5362,   238.1314],
         [   74.8285,   885.1346],
         [ -127.0456,  -283.4349]],

        [[ 1543.2496,  1009.1642],
         [ 1303.6619,  -195.6516],
         [-1234.1196, -1467.2837],
         [-1981.4292,   196.3708],
         [ 1497.5709,   862.4662],
         [ 1155.4810,  -344.4296],
         [-2115.4038, -1212.0667],
         [ 2136.0027,  -559.6055],
         [-1850.0460, -1186.3042],
         [  354.0812,  1858.8131]],

        [[ 2210.4277,  3900.4443],
         [-1040.9576,  -238.3721],
         [ 2341.8484, -4946.6191],
         [-4916.2031,   934.8397],
         [  584.3933,  4231.1382],
         [ 2090.0999, -2345.0974],
         [-5333.9932, -1161.3107],
         [ 3911.3882, -1608.4668],
         [ 2946.4058,  2135.0596],
         [-5831.1982, -1651.4641]],

        [[-1047.1002, -3216.2261],
         [-5094.0908,  3077.8049],
         [ 7401.8989,  2344.9060],
         [  319.4274, -3756.7744],
         [-5282.9761,   669.3934],
         [  913.4145,  7076.0864],
         [-3815.3616, -3258.1069],
         [ 5318.5713,   660.4656],
         [-1944.1621,  3884.6665],
         [-3881.5125, -5592.5576]],

        [[ 3899.8762,  1878.6672],
         [-4770.8535, -1421.1271],
         [ 2603.7683,  1133.1582],
         [ 4018.7930, -6705.9194],
         [ 1804.8011,  -512.4644],
         [   23.8800,  1647.2366],
         [ -810.5209,  1781.8887],
         [ 6497.7886, -1626.0352],
         [-6848.3433, -1927.0774],
         [  463.5302,  7740.4448]],

        [[  681.0952, -1762.7388],
         [-3412.1528,  3873.1560],
         [-7057.1074, -3950.8953],
         [ 5743.1079,  3485.8254],
         [ 1817.3337,  -445.9574],
         [ -639.0045,  -790.1432],
         [  -13.4299,  1321.2570],
         [ 1678.1443,  -643.6706],
         [  344.3640,   -67.2569],
         [ -571.5283,  1584.8524]],

        [[ 5256.4580, -1593.1147],
         [-8533.4941, -3132.3455],
         [ 3120.1636,  5073.2856],
         [-3467.6357, -1094.8490],
         [ 1360.9430,  -766.7207],
         [ 1224.7362,    40.6601],
         [ -779.5754,  -494.8970],
         [ 1275.6321,  -185.7186],
         [ 1423.8760,   435.4611],
         [-1305.7228, -1457.9144]]]) 

MatD.grad: 
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0230,  ..., 0.0000, 0.0000, 0.0000],
        ...,
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.5104e+01, -1.8133e+02],
         [-1.3760e+02, -2.9040e+01],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.3836e+02,  1.3342e+02],
         [ 1.8736e+02,  2.5753e+02],
         [ 1.8013e+02,  2.9845e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 2.8946e+00,  1.0722e+02],
         [-9.5453e+01,  4.8873e+01],
         [ 1.8673e+02,  1.2909e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 3.1812e+02, -1.7186e+02],
         [-1.1609e+01, -7.6113e+02],
         [ 5.1946e+02, -2.5518e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 6.2298e+02, -1.2433e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.1863e+02, -1.3795e+02],
         [-1.4484e+02, -1.1576e+01],
         [ 1.0767e+03, -4.2871e+02],
         [-2.8417e+03, -1.7979e+03],
         [-9.9443e+02,  3.0312e+02],
         [ 1.3085e+03, -1.3710e+03],
         [-1.6516e+03, -9.2774e+02],
         [ 5.7884e+03,  1.1888e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-3.4918e+02,  3.0296e+02],
         [ 7.6466e+02,  1.2234e+03],
         [ 6.8378e+02,  3.5358e+03],
         [-7.0781e+03,  2.0812e+03],
         [ 4.7783e+03,  6.7455e+03],
         [-1.4222e+03,  5.1447e+03],
         [ 3.9792e+03,  6.0347e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 7.2209e+02,  4.4691e+02],
         [-1.2811e+02, -1.9317e+03],
         [ 1.2139e+03, -5.7005e+02],
         [-3.2343e+02, -4.8450e+03],
         [ 4.1284e+02, -8.1121e+03],
         [ 1.5664e+03, -1.1885e+03],
         [-5.3298e+03,  5.1230e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-8.2667e+02, -1.6158e+02],
         [ 1.9927e+03,  5.6075e+02],
         [-3.8258e+03, -3.4232e+03],
         [-4.6609e+03,  2.0153e+03],
         [ 7.9053e+03, -4.3701e+03],
         [ 5.9146e+03, -3.8692e+03],
         [-5.0497e+03, -6.3263e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-3.9239e+02, -4.7547e+01],
         [ 6.1872e+02,  1.9062e+03],
         [ 9.6613e+02,  3.8988e+03],
         [-8.5532e+03,  1.2323e+03],
         [ 5.5161e+03,  8.0422e+03],
         [ 6.5670e+03,  3.1895e+03],
         [ 1.0083e+02, -1.2246e+03]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[ 6085.4058, -1763.1036],
         [  203.7075, -4734.4751],
         [-3847.5552, -5839.2334],
         [-6450.4604, -3040.9045],
         [  995.2974,  2863.1287],
         [ 6322.7964,  6715.0708],
         [ -958.0494, -8297.8535],
         [  877.7407,  1107.7173],
         [ 5808.3491,  -618.4980],
         [-6293.2593, -4769.2236]],

        [[   54.3560,  3745.9407],
         [  -62.3601, -5888.5176],
         [-1287.7329, -1711.9138],
         [-1403.0248,  8377.7900],
         [ 4555.1958,   365.5328],
         [-5105.9614, -7077.4644],
         [ 7877.7563,  -901.4976],
         [-2028.6824,   575.0313],
         [ -824.5791,   160.2484],
         [ 4320.7627, -7119.3110]],

        [[-1951.2461, -8142.5654],
         [ 1203.6946, -9368.2324],
         [ 6441.2979,  1544.6545],
         [-7389.3472, -2452.2588],
         [-3240.8149,   858.7062],
         [  902.5228,   206.4946],
         [ 7628.4116,  3330.3630],
         [-2073.6057, -4026.4282],
         [-8197.6357,  1677.1085],
         [ 2418.2466,  8620.7852]],

        [[-4138.9038,  7771.9517],
         [ 8964.0811,  1545.1847],
         [ 2477.5459,  3369.7168],
         [-5044.4629,  1082.8652],
         [-3266.7092,   869.7668],
         [ 3263.2764,  8742.7256],
         [ 1670.2302,  1286.0901],
         [ 1471.5192,  5965.5742],
         [ 3586.7734,  1113.7111],
         [-2683.6223, -6118.0498]],

        [[-8588.2656,  1759.5277],
         [ 6743.4424,  6602.4478],
         [ -259.7581, -3656.4402],
         [-4762.1094,  1577.0031],
         [ 7270.9258, -2602.3076],
         [-3863.3193, -7997.8950],
         [ 6641.6226,  1555.2334],
         [-1334.2639, -4564.5029],
         [-6590.4097, -3130.9817],
         [ 7070.0264, -3633.4846]],

        [[-1456.8306, -7698.8882],
         [ -702.8896,  4201.1196],
         [ 2615.5559, -1564.2905],
         [-6591.6440, -1386.6331],
         [ -868.4171,  5680.4214],
         [ 5722.3203, -1668.1257],
         [ 2012.6616,  1941.0997],
         [-1254.0675, -2723.2053],
         [-5991.8511, -1487.7727],
         [ -179.8689,  2627.5122]],

        [[ 6724.5654,  5677.4380],
         [-2037.8027, -9212.4668],
         [ 2323.6797, -5871.7642],
         [-1541.4298, -1992.0266],
         [-5805.6758,    89.5079],
         [ 5138.3252, -7257.3027],
         [ -851.9716,  2153.3025],
         [ -806.7203, -1618.9185],
         [-1863.5905,  8287.6602],
         [   10.0203,  2408.1331]],

        [[-8878.1338,  1076.2074],
         [ 3545.9990,  7717.0312],
         [ 5190.4565,  3968.4841],
         [  277.1488,  3827.5591],
         [-8622.4482,  -373.6039],
         [ 6884.6616,  5842.8018],
         [-4187.4053, -1215.6926],
         [ 6261.4175, -4831.9282],
         [-6977.7114, -6191.7095],
         [ 5998.9731,  -407.8510]],

        [[  155.6281, -7685.4443],
         [-2360.6582,  3654.2246],
         [ 2616.7632,  -560.1222],
         [-1573.1027, -8747.9961],
         [  663.5370, -5622.1577],
         [  910.5487,   985.3317],
         [-4559.8999,  1733.7256],
         [ 3996.3665,  3546.7061],
         [ -885.3112, -7349.2622],
         [ 3841.5264, -1895.9860]],

        [[ 7817.4429,  5227.0288],
         [-3852.1631, -1895.3389],
         [-6431.2744, -4645.8281],
         [ 2515.7058,  6245.9565],
         [ 1913.0165,  7214.5547],
         [  339.1231, -7651.1733],
         [ -965.1330, -2780.6414],
         [-1289.5088,  7325.0713],
         [  950.5784,  5548.2544],
         [ 3757.2861,  -477.3417]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[ 6175.8022,  -478.3866],
         [-7587.3594,  -849.9658],
         [-1062.6890, -1106.5459],
         [ 8111.2983,  -611.9603],
         [-8166.3281, -4216.0811],
         [ 9644.0195,    94.1108],
         [-3329.2380, -6963.0508],
         [-6270.5396, -4398.2007],
         [ 6414.3174,  -765.9182],
         [-1460.4795,  2757.1946]],

        [[ 4001.0361, -3597.8718],
         [-6991.4263,  3887.0598],
         [   74.5539,   238.6547],
         [ 4999.9771,   654.5964],
         [-5746.9326,  1992.6533],
         [ 6087.3271,  1373.0909],
         [-1951.2338, -4020.6106],
         [-1213.0176,  8396.9668],
         [ 7182.1558,  3118.8313],
         [-2276.9080, -5228.7754]],

        [[ 5827.6069,  2809.4814],
         [-7673.0840, -2610.2444],
         [ 1054.5518,   503.6792],
         [ 5993.4487,   431.2729],
         [-4096.5068, -2285.0620],
         [  437.7522,  2566.6753],
         [ 7065.5601,  -314.3143],
         [-4373.3726, -5185.5591],
         [-1738.9078,   154.7133],
         [ 1133.4078,  3706.0791]],

        [[ 1726.8865, -2483.0337],
         [-5332.3008,   146.5570],
         [ 1183.8829,  5141.6191],
         [ 2259.2073, -6672.4746],
         [  380.1559, -6981.9839],
         [-1995.4907,  4761.2974],
         [  918.1640, -8706.4824],
         [  759.8815, -6585.2930],
         [  276.6362, -2593.3291],
         [ -362.5107,  1652.9321]],

        [[ 3444.7244,  -402.6013],
         [-2885.8369,  5037.9253],
         [-6255.0186, -1942.5427],
         [ -835.6013,  4249.8711],
         [ 6430.3965,  6461.0454],
         [-9376.3486,  -449.9320],
         [ 2396.2175,  7748.7368],
         [-1222.2690,   509.9801],
         [  843.5114,   889.4020],
         [ -908.7913,  -676.3972]],

        [[ 6056.3574,  2456.6631],
         [-7754.5176, -3302.7424],
         [-1693.0842,   633.6743],
         [ 8100.0752,  -231.0705],
         [-5946.2397, -1101.9531],
         [ 4362.9551,  1932.9824],
         [-5767.2808,   641.2990],
         [ 1938.3011,   -94.4991],
         [ -712.3793,  -858.3538],
         [-1039.7881,   193.5287]],

        [[ 2544.0137, -2974.4690],
         [-3472.3926, -2925.5862],
         [ -326.0244, -4101.4277],
         [ 5411.4878, -4365.6821],
         [-2055.0315, -6270.6104],
         [ 1874.3362,   620.5644],
         [  978.1645, -8012.8657],
         [  -23.5433, -1212.3604],
         [  542.3800, -1012.1290],
         [  -63.4033,  -213.7529]],

        [[ 3691.5034,  -570.8141],
         [-2160.5957,  4456.8008],
         [-1775.7124,  -327.4467],
         [  -90.9438,   -96.0389],
         [ 4430.0176,  5354.4531],
         [-8985.3721,  -334.0840],
         [ 1873.2202,  7512.6787],
         [ -837.8962,  -987.8543],
         [ 5936.8770,  3843.8989],
         [-5646.6812,  -277.8085]],

        [[ 7438.2222, -1082.0770],
         [-4901.9199, -3678.2180],
         [-1331.5200,  1705.8821],
         [ 4098.8047,  1170.3033],
         [-1434.9890,  1792.7404],
         [ 4176.8882,  2396.8904],
         [-6986.5752,  2920.5493],
         [ 4236.5977,  7723.0200],
         [  325.3952,  5745.5483],
         [ -486.7090,  1167.1925]],

        [[ 3282.2446,  7952.1367],
         [ -557.4296,  5654.8042],
         [  559.1349,  7784.6836],
         [ 1992.1462, -6539.8511],
         [ 1208.8906, -6433.9912],
         [ 3651.1384, -7444.0371],
         [ 2630.5547, -8847.3145],
         [  147.1337, -6056.2104],
         [-2458.5891, -9182.9678],
         [ 2343.1309, -8496.1992]]]) 

Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0141,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]],
       grad_fn=<SelectBackward>)

Epoch 0 finished. Total time: 303.77079916000366;  Epoch time: 303.77079916000366 












test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
test_counter in loss_omega_mat(): 4046
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9451, 0.9449, 0.9447,  ..., 0.6401, 0.6060, 0.6059],
         [0.4516, 0.4281, 0.4134,  ..., 0.2840, 0.2837, 0.2834],
         [0.4280, 0.4134, 0.4089,  ..., 0.2835, 0.2803, 0.2688],
         ...,
         [0.9455, 0.9453, 0.9453,  ..., 0.7568, 0.7567, 0.7565],
         [0.9456, 0.9455, 0.9455,  ..., 0.7568, 0.7568, 0.7567],
         [0.9456, 0.9456, 0.9456,  ..., 0.7568, 0.7565, 0.7564]],

        [[0.9455, 0.9455, 0.9452,  ..., 0.6408, 0.6405, 0.6402],
         [0.9455, 0.9455, 0.9452,  ..., 0.6405, 0.6059, 0.6055],
         [0.9455, 0.9454, 0.9452,  ..., 0.6402, 0.6061, 0.6058],
         ...,
         [0.9455, 0.9454, 0.9453,  ..., 0.7568, 0.7568, 0.7566],
         [0.9456, 0.9456, 0.9453,  ..., 0.7570, 0.7569, 0.7567],
         [0.9456, 0.9456, 0.9454,  ..., 0.7569, 0.7568, 0.7566]],

        [[0.9455, 0.9455, 0.9454,  ..., 0.7567, 0.7566, 0.6409],
         [0.9455, 0.9455, 0.9454,  ..., 0.7565, 0.6409, 0.6408],
         [0.9456, 0.9455, 0.9455,  ..., 0.6409, 0.6407, 0.6405],
         ...,
         [0.9454, 0.9454, 0.9453,  ..., 0.7568, 0.7567, 0.7567],
         [0.9456, 0.9456, 0.9455,  ..., 0.7570, 0.7568, 0.7567],
         [0.9456, 0.9455, 0.9455,  ..., 0.7569, 0.7569, 0.7567]],

        ...,

        [[0.9455, 0.9454, 0.9454,  ..., 0.7569, 0.7568, 0.7568],
         [0.9456, 0.9456, 0.9454,  ..., 0.7567, 0.7562, 0.7456],
         [0.9456, 0.9455, 0.9451,  ..., 0.7567, 0.7397, 0.7391],
         ...,
         [0.9458, 0.9457, 0.9457,  ..., 0.7569, 0.7569, 0.7564],
         [0.9457, 0.9457, 0.9454,  ..., 0.7570, 0.7565, 0.7564],
         [0.9455, 0.9455, 0.9454,  ..., 0.7565, 0.7565, 0.7558]],

        [[0.9456, 0.9454, 0.9453,  ..., 0.7568, 0.7567, 0.7564],
         [0.9454, 0.9454, 0.9453,  ..., 0.7528, 0.7487, 0.7411],
         [0.9452, 0.9451, 0.9450,  ..., 0.7479, 0.7391, 0.7332],
         ...,
         [0.9456, 0.9456, 0.9454,  ..., 0.7568, 0.7568, 0.7565],
         [0.9456, 0.9454, 0.9452,  ..., 0.7569, 0.7565, 0.7561],
         [0.9455, 0.9454, 0.9452,  ..., 0.7563, 0.7560, 0.7558]],

        [[0.9456, 0.9454, 0.9453,  ..., 0.7564, 0.7564, 0.7529],
         [0.9454, 0.9453, 0.9447,  ..., 0.7484, 0.7462, 0.7371],
         [0.9450, 0.9447, 0.9425,  ..., 0.7424, 0.7370, 0.7273],
         ...,
         [0.9455, 0.9455, 0.9452,  ..., 0.7565, 0.7560, 0.7556],
         [0.9455, 0.9451, 0.9451,  ..., 0.7564, 0.7560, 0.7558],
         [0.9454, 0.9452, 0.9451,  ..., 0.7563, 0.7561, 0.7559]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[1.0024e-06, 1.3522e-06, 3.1907e-08,  ..., 6.2689e-06,
          5.7057e-07, 2.8716e-07],
         [5.1001e-10, 7.7282e-10, 2.9540e-07,  ..., 7.8895e-07,
          1.9269e-06, 1.1535e-05],
         [1.2415e-07, 4.1417e-06, 1.0533e-07,  ..., 3.2539e-06,
          3.6968e-07, 7.4234e-07],
         ...,
         [1.5344e-07, 4.3711e-06, 8.0822e-07,  ..., 1.0206e-06,
          5.1148e-07, 2.5072e-06],
         [1.2716e-07, 4.4338e-07, 1.5461e-06,  ..., 1.8247e-06,
          1.4942e-07, 1.2208e-06],
         [8.0840e-08, 8.0839e-08, 4.2308e-10,  ..., 8.0840e-08,
          4.8526e-07, 1.5899e-06]],

        [[1.4427e-07, 1.4888e-06, 1.7748e-06,  ..., 3.1420e-06,
          2.9584e-06, 1.1265e-08],
         [1.4888e-06, 1.5566e-06, 1.2415e-07,  ..., 4.4036e-06,
          1.6666e-05, 1.2984e-06],
         [1.4427e-07, 1.4427e-07, 1.6260e-06,  ..., 6.4287e-06,
          1.9519e-05, 3.9315e-06],
         ...,
         [8.5675e-08, 1.5344e-07, 6.4000e-07,  ..., 2.5072e-06,
          2.6133e-06, 7.1169e-06],
         [1.5344e-07, 1.5344e-07, 3.9669e-06,  ..., 4.4062e-06,
          2.3891e-07, 1.0618e-07],
         [2.6148e-08, 2.2713e-08, 3.1036e-06,  ..., 6.0278e-07,
          3.5913e-09, 2.3163e-06]],

        [[6.4000e-07, 1.4427e-07, 6.4000e-07,  ..., 8.1091e-06,
          1.4427e-07, 2.7053e-09],
         [3.1906e-08, 1.4427e-07, 3.1906e-08,  ..., 2.6328e-06,
          7.5090e-06, 3.9590e-09],
         [1.8211e-07, 1.3765e-06, 1.0571e-06,  ..., 2.4823e-06,
          3.7108e-06, 5.3875e-08],
         ...,
         [8.6815e-08, 1.5344e-07, 3.5897e-06,  ..., 3.5891e-08,
          2.5011e-06, 7.1720e-06],
         [2.2182e-07, 2.7645e-06, 3.9304e-09,  ..., 7.9257e-07,
          5.4830e-07, 1.7425e-06],
         [2.1061e-06, 1.3206e-07, 2.2131e-08,  ..., 3.0089e-06,
          1.9113e-06, 7.0306e-07]],

        ...,

        [[1.6255e-07, 6.4936e-07, 3.5855e-07,  ..., 1.3072e-07,
          1.4063e-06, 1.5807e-07],
         [3.2471e-06, 5.2444e-08, 7.7282e-10,  ..., 1.3684e-06,
          1.0370e-06, 7.3205e-07],
         [1.5807e-07, 1.7150e-07, 4.5333e-08,  ..., 3.8554e-07,
          1.3351e-04, 5.5352e-06],
         ...,
         [2.1434e-07, 8.9667e-07, 4.2650e-07,  ..., 4.2178e-07,
          1.1715e-05, 2.6110e-06],
         [5.7278e-07, 4.9576e-08, 3.8793e-06,  ..., 1.8782e-06,
          1.3839e-05, 4.5350e-06],
         [2.5252e-07, 2.2526e-07, 9.0356e-07,  ..., 4.6669e-06,
          5.8287e-06, 2.0349e-06]],

        [[2.0887e-06, 1.8031e-07, 1.8509e-07,  ..., 9.5992e-07,
          1.5826e-06, 6.1488e-07],
         [1.5826e-06, 7.3205e-07, 3.5855e-07,  ..., 1.1300e-07,
          9.6957e-07, 4.1574e-06],
         [5.5149e-08, 1.5807e-07, 1.5347e-07,  ..., 1.4343e-06,
          3.1553e-06, 3.7006e-05],
         ...,
         [1.9460e-06, 4.7972e-08, 2.6679e-07,  ..., 1.3787e-06,
          1.5787e-08, 6.1949e-09],
         [5.2320e-07, 1.9282e-06, 2.5992e-06,  ..., 5.6610e-06,
          9.9974e-07, 1.1389e-06],
         [4.3483e-08, 1.5170e-07, 9.3625e-07,  ..., 3.1288e-07,
          2.4240e-07, 4.9740e-07]],

        [[2.5804e-06, 3.5855e-07, 4.0351e-06,  ..., 2.0524e-06,
          1.0024e-06, 1.7189e-07],
         [6.3109e-07, 9.2688e-07, 3.5160e-07,  ..., 1.9107e-06,
          6.3070e-07, 6.6126e-06],
         [1.3616e-06, 3.9671e-06, 1.8876e-06,  ..., 1.0276e-04,
          1.0032e-05, 2.4668e-05],
         ...,
         [1.5470e-07, 9.5148e-07, 3.5542e-06,  ..., 2.3669e-06,
          3.3368e-09, 5.0452e-07],
         [8.6469e-07, 4.3143e-07, 4.2332e-08,  ..., 7.2624e-06,
          8.9833e-06, 3.0998e-06],
         [7.1860e-07, 6.5748e-11, 5.7215e-07,  ..., 3.5977e-06,
          4.3922e-06, 3.2099e-06]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[1.2389e-03, 2.1084e-04, 8.6766e-04,  ..., 1.1578e-03,
          2.2025e-04, 5.8208e-11],
         [9.7992e-04, 1.0789e-03, 1.9410e-03,  ..., 1.4132e-03,
          1.1922e-03, 2.1050e-04],
         [1.3737e-03, 6.2358e-04, 1.2623e-03,  ..., 8.8235e-04,
          3.1642e-04, 1.1000e-03],
         ...,
         [1.5043e-03, 1.9796e-03, 1.2907e-03,  ..., 3.0991e-04,
          1.2416e-03, 1.9796e-03],
         [7.4830e-04, 3.3711e-04, 1.1105e-03,  ..., 6.4091e-04,
          1.3004e-03, 1.5033e-03],
         [1.3367e-03, 4.3517e-04, 1.1961e-03,  ..., 1.0891e-03,
          7.0310e-04, 4.6560e-04]],

        [[1.1798e-03, 2.7486e-05, 1.6916e-03,  ..., 1.3832e-03,
          8.7706e-04, 1.0116e-03],
         [2.7486e-05, 1.7206e-03, 2.3211e-03,  ..., 8.4480e-04,
          5.4322e-04, 6.7511e-04],
         [2.0246e-03, 1.4194e-03, 2.3211e-03,  ..., 9.3646e-04,
          7.1304e-04, 5.7905e-04],
         ...,
         [1.5043e-03, 1.5029e-03, 1.1917e-03,  ..., 1.7105e-03,
          1.1358e-03, 1.4146e-03],
         [1.4712e-03, 7.4830e-04, 8.9497e-04,  ..., 1.6794e-03,
          1.2000e-03, 4.0829e-04],
         [1.2824e-03, 4.3517e-04, 1.5849e-03,  ..., 9.5993e-04,
          1.6131e-03, 1.4668e-03]],

        [[1.0650e-03, 1.1798e-03, 1.7164e-03,  ..., 1.6879e-03,
          1.3459e-03, 1.3359e-03],
         [8.6792e-04, 1.7206e-03, 1.7164e-03,  ..., 3.9719e-04,
          7.8577e-04, 1.6040e-03],
         [1.0354e-03, 1.1100e-03, 2.0246e-03,  ..., 9.5966e-04,
          2.7921e-04, 8.6737e-04],
         ...,
         [1.0580e-03, 1.5029e-03, 3.2116e-04,  ..., 1.5359e-03,
          1.1917e-03, 1.5033e-03],
         [1.4712e-03, 1.1803e-03, 4.7709e-04,  ..., 1.0348e-03,
          3.0991e-04, 7.4466e-04],
         [1.6713e-03, 4.7709e-04, 1.6177e-04,  ..., 8.3333e-04,
          2.7444e-04, 7.2182e-04]],

        ...,

        [[1.0020e-03, 1.6952e-03, 1.5108e-03,  ..., 8.7665e-04,
          1.3436e-03, 1.8376e-03],
         [1.2780e-03, 6.5324e-04, 1.5108e-03,  ..., 6.8915e-04,
          1.0941e-03, 7.9680e-03],
         [6.5324e-04, 1.4117e-03, 1.8476e-04,  ..., 1.2298e-03,
          1.0052e-02, 1.4308e-03],
         ...,
         [2.4027e-04, 1.3148e-03, 4.5480e-04,  ..., 1.3226e-03,
          4.8080e-04, 6.9077e-04],
         [1.4317e-03, 4.5480e-04, 6.2252e-04,  ..., 1.1141e-03,
          8.3234e-04, 7.7179e-04],
         [1.0442e-03, 1.3437e-03, 1.5649e-03,  ..., 1.2696e-03,
          1.2453e-03, 1.9553e-03]],

        [[5.1962e-04, 8.7206e-04, 1.0290e-03,  ..., 1.2173e-03,
          1.3076e-03, 1.2128e-03],
         [8.7206e-04, 6.7718e-04, 5.1885e-04,  ..., 1.5330e-03,
          8.4825e-04, 1.2692e-03],
         [7.2462e-04, 1.8476e-04, 1.5941e-03,  ..., 9.3650e-03,
          3.8906e-03, 2.9752e-03],
         ...,
         [8.7857e-04, 8.9182e-04, 1.2068e-03,  ..., 7.2606e-04,
          3.4623e-04, 8.8123e-04],
         [8.9182e-04, 6.2252e-04, 8.6587e-04,  ..., 6.0875e-04,
          4.7832e-04, 1.0162e-03],
         [1.0442e-03, 8.7394e-04, 8.6587e-04,  ..., 8.3747e-04,
          1.2097e-03, 8.6151e-04]],

        [[1.0253e-03, 2.8892e-04, 1.3076e-03,  ..., 1.8388e-03,
          1.2181e-03, 2.1320e-03],
         [2.8892e-04, 5.1885e-04, 2.2526e-03,  ..., 5.2875e-03,
          9.0808e-03, 4.6511e-03],
         [1.5941e-03, 2.2526e-03, 4.0825e-04,  ..., 1.1497e-02,
          2.1800e-03, 1.7006e-03],
         ...,
         [4.6683e-04, 8.7704e-04, 1.0402e-03,  ..., 9.9635e-04,
          3.3386e-05, 1.0093e-03],
         [8.7704e-04, 7.8677e-04, 9.4218e-04,  ..., 6.9077e-04,
          9.4998e-04, 1.1689e-03],
         [8.7394e-04, 8.8974e-04, 9.4218e-04,  ..., 4.9722e-04,
          1.6643e-03, 1.0823e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:4.002379894256592 loss2:2193.380859375


loss.item(): 43871.62109375


Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([59, 98]) torch.Size([59, 98, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 4.9305e-01,  2.7850e+00,  3.7413e+00,  1.5251e+00,  1.6118e+00,
          1.4764e+00,  6.1220e+00,  1.0692e+01,  1.2303e+00, -1.3130e+01],
        [-4.1643e-01,  3.8169e+00, -9.4758e+00, -5.9781e+00,  7.3772e+00,
          1.4194e+01,  7.2701e+00,  1.0159e+02,  2.8405e+01,  4.6123e+01],
        [-7.7832e+00,  2.3681e+00, -1.2199e+01, -2.8205e+01,  5.5482e+01,
          2.0139e+01, -2.3706e+02,  2.0858e+02, -4.7547e+02,  2.7046e+02],
        [ 3.2529e+00, -4.0684e+01,  2.5849e+01,  3.4396e+01,  6.8748e+01,
          4.8143e+02,  1.5601e+02,  5.2142e+02, -1.7098e+02, -6.0785e+02],
        [-1.8559e+01,  5.1411e+01, -1.1523e+01,  5.5258e+02,  6.1496e+02,
          7.5333e+02,  9.6238e+02,  1.2085e+03, -4.6425e+01,  3.0248e+02],
        [ 6.6563e+00, -1.0258e+01,  1.2571e+02,  5.7519e+02,  1.0349e+03,
         -7.7369e+02,  8.3471e+02,  1.5907e+03, -1.9794e+02,  1.4247e+03],
        [-2.1295e+01, -2.5590e+01,  5.1136e+02,  7.5742e+02,  4.1515e+02,
         -1.1829e+04, -8.3418e+02,  1.1618e+03,  2.1923e+02, -1.1979e+03],
        [ 3.6760e+01,  2.4597e+01,  6.1464e+01,  9.5274e+02,  6.2552e+02,
          1.3459e+02, -7.6586e+03,  7.1270e+02, -6.8587e+02, -1.0500e+04]]) 

MatU.grad[0:10,35:45]: 
tensor([[[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[  504.6759,  -409.6099],
         [ -635.6779,  -254.8414],
         [  137.3429,   666.7742],
         [ -395.6017,   440.2488],
         [  -43.0012,  -650.0947],
         [  306.8904,   270.7020],
         [ -252.0256,   841.5665],
         [   89.7408,  -375.0392],
         [  -66.9873,   880.0291],
         [ -113.2238,  -296.0096]],

        [[ 1734.8342,   630.5952],
         [  151.3327,  1040.8732],
         [-1202.9509, -1441.0948],
         [-1986.4641,  -209.3164],
         [ 1612.1770,   776.7479],
         [ 1150.0140,    13.9521],
         [-2155.8420, -1188.1532],
         [ 2200.2520,  -371.2825],
         [-1842.7800, -1160.7235],
         [  269.1048,  1866.8799]],

        [[  139.2127,   542.9008],
         [ 3037.1748,  4424.7676],
         [ -167.1592, -2139.4429],
         [-3766.6072, -2351.5012],
         [  -34.4343,  3891.7791],
         [ 1769.5608, -1367.5897],
         [-5397.6318,  -428.8844],
         [ 3992.6672,  -267.4611],
         [ 2273.1279,    94.6855],
         [-5810.4546, -1536.1063]],

        [[ 3977.3557,   658.3707],
         [-3656.1318, -2987.1365],
         [ 8076.9946,  -201.0042],
         [-3602.6562,    33.9083],
         [-5026.1582, -1687.7380],
         [  534.8963,  7312.9414],
         [-4076.3496, -3132.6255],
         [ 5537.6865,  -828.0874],
         [-1201.7211,  3329.0476],
         [-3749.9944, -5763.6431]],

        [[  721.6628, -4062.8755],
         [ -512.7023,  4024.9639],
         [-1926.0417, -6606.9048],
         [ 3551.9028, -6750.1733],
         [ 1780.8293,  -294.8452],
         [ -170.9939,  1724.8218],
         [ -590.7049,  1698.2490],
         [ 7034.6133, -1182.1632],
         [-6772.6089, -1844.3927],
         [   12.7229,  7699.7021]],

        [[-4039.4119,  4206.5415],
         [ 2301.0630, -2871.5322],
         [-5970.1685,  1216.6539],
         [ 5575.5132,  2206.1687],
         [ 1733.3387,   -46.8367],
         [ -609.2409,  -759.0201],
         [  157.8118,  1212.9326],
         [ 1695.9540,  -347.7460],
         [  293.7190,    27.1321],
         [ -509.5007,  1459.0933]],

        [[ 1434.2218,  3886.3188],
         [-7523.7656,   829.7427],
         [-4095.7307, -3349.8140],
         [ 1261.4122,  5411.9771],
         [ -119.8744,  1258.6334],
         [ 1232.2351,  -318.3619],
         [ -738.8021,  -469.3481],
         [ 1098.9861,   402.9194],
         [ 1355.5433,   397.6638],
         [-1264.1342, -1410.1584]]]) 

MatD.grad: 
tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000, -0.8878,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.5091e+01, -1.8117e+02],
         [-1.2129e+01,  8.4318e+01],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.4669e+02, -1.2394e+02],
         [ 6.8597e+01,  3.0819e+02],
         [-3.7755e+02, -1.4880e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 9.0335e-01,  1.0422e+02],
         [-9.7875e+01, -3.5648e+01],
         [ 2.1884e+02,  6.0142e+01]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.2612e+02,  1.5827e+02],
         [ 3.0550e+02, -4.7196e+02],
         [-4.8067e+02,  7.1256e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-4.5907e+02,  6.0384e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.7966e+02,  4.8274e+02],
         [ 8.0986e+01,  1.6502e+02],
         [ 1.7787e+03,  1.4306e+03],
         [ 4.4438e+02, -1.4739e+03],
         [ 7.8243e+02, -4.7492e+02],
         [ 3.2936e+02,  5.1031e+02],
         [ 1.3121e+03, -3.9591e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 4.4013e+02, -4.0713e+02],
         [ 2.0518e+02,  1.2905e+03],
         [-4.5286e+03, -3.1796e+03],
         [-6.1589e+03, -3.2401e+03],
         [ 4.1374e+03,  6.6468e+03],
         [ 6.8522e+03, -2.1451e+03],
         [-3.5542e+02, -1.3696e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 6.6831e+01, -5.5014e+02],
         [ 8.4634e+02, -6.6792e+02],
         [-4.4932e+03,  5.0460e+03],
         [ 6.6079e+03,  2.0777e+02],
         [-5.7111e+03, -1.7802e+03],
         [-3.9785e+03,  6.1438e+03],
         [ 5.7169e+03, -3.9661e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 9.8626e+01,  3.3821e+02],
         [ 4.8473e+02, -6.4439e+02],
         [ 1.6709e+03,  1.9758e+03],
         [ 3.8497e+03, -6.1859e+03],
         [ 2.8809e+03,  1.1042e+03],
         [-1.4570e+03,  3.2184e+03],
         [ 6.9612e+03,  1.7787e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-5.2742e+01,  2.9196e+02],
         [-1.3225e+03,  5.4061e+00],
         [-6.2612e+03, -3.1425e+03],
         [-3.0003e+03, -6.0440e+03],
         [ 3.5965e+03,  6.3082e+03],
         [ 3.8630e+02, -6.1095e+03],
         [-4.8250e+03,  5.1765e+03]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[-1573.0448,  3950.4968],
         [-6777.3662,  1501.7931],
         [ 3094.2339,   142.3961],
         [ -394.9649,  3942.8906],
         [-7226.8530, -4521.1392],
         [ -960.0833,   497.7476],
         [ 6161.2710,  2822.6174],
         [-7378.1763, -3662.7151],
         [-5166.3086,  6153.4023],
         [ 2431.1597,  5097.2168]],

        [[-3832.1440, -4837.8496],
         [ 6439.9116,   678.4611],
         [ 4726.6396,  5219.8511],
         [ 4571.6611, -1356.0508],
         [-4576.8945, -5334.8428],
         [ 2868.9626,  3657.7808],
         [ -709.4603,  8422.6201],
         [ 6936.6011, -3604.8342],
         [ 6300.9111, -5695.1753],
         [-4662.6274,  4366.5952]],

        [[ 1222.2012, -7944.0747],
         [-1019.6780, -9377.1318],
         [-2815.2080, -3384.9324],
         [-1575.7010,  6169.6230],
         [ 6550.7852, -5074.4038],
         [-6610.0352, -4464.2651],
         [ -620.8932, -1227.8834],
         [ 6124.8696,  5663.9463],
         [ 3052.0452, -5670.3027],
         [-4974.1030,  -210.3725]],

        [[-3041.4446,  8202.1377],
         [ 9074.2754,   478.1915],
         [-6007.2192, -2166.9319],
         [ 1696.5953, -4526.3076],
         [ 5218.9111, -4111.0449],
         [-3973.3535,  2101.3975],
         [-5476.7676, -4860.7905],
         [-5479.6450, -1340.9806],
         [-5348.5151, -5610.2451],
         [ 3888.3953,  1242.6493]],

        [[-9058.0547,  -211.2825],
         [ 6687.0610,  6561.4219],
         [ 3118.1436,  2883.7017],
         [  200.6448, -5366.0146],
         [-3104.5386,  6124.5107],
         [ 3925.8887,  3892.7651],
         [-1602.8716, -5589.8516],
         [ 5405.7554,  4030.0017],
         [ 1008.3990,  5219.2573],
         [-4733.5708,  5798.6187]],

        [[ -268.5309, -7722.0112],
         [ 4944.9072,  -374.6653],
         [-5090.9194,  4186.6680],
         [  993.4457,  5733.0469],
         [ 6072.9956, -2523.3486],
         [-6185.7690,  5367.4453],
         [-6089.8892, -5831.1572],
         [ 6102.4019,  4623.6343],
         [ 2443.8103,  5804.8257],
         [ 4402.4727, -7291.2109]],

        [[ 6898.7422,  5408.6973],
         [ -343.6442, -9238.1084],
         [-4184.9448, -1950.6174],
         [ 5314.6289,  3587.8862],
         [ 1692.9880, -7012.8394],
         [-2403.4114, -1073.3303],
         [ 4666.4570, -6781.2544],
         [ 5485.8906,  5949.0679],
         [ 4545.7417, -4405.1118],
         [-6992.3062, -6261.7812]],

        [[-8995.4648, -1779.0715],
         [ 3165.9912,  7825.7417],
         [ 2053.7153,  -243.7022],
         [-5023.9976, -3006.4429],
         [-3735.0408,  4615.5356],
         [ 5142.2490,  1989.2319],
         [ 1722.9794,  4987.4639],
         [-3684.5684,  1997.2832],
         [   35.4415,  -209.0983],
         [-4898.7520,  5196.6406]],

        [[-3525.9102, -7620.5532],
         [ 4025.9583, -1688.9740],
         [-1132.0431,  4660.9917],
         [ 1967.9434, -8700.9062],
         [-4135.3892,  -958.2137],
         [-4411.0103, -4499.9849],
         [ 1847.5177, -6202.8130],
         [-2658.0872, -4203.9014],
         [ 6212.0654, -2374.4009],
         [-4629.3330,  3298.1548]],

        [[ 7951.1860,  4968.4902],
         [-2570.4241,  1504.4474],
         [-6209.6450, -3990.3704],
         [ 2140.6536,  6104.3223],
         [  881.1209,  7493.3350],
         [-2724.6174, -7153.9473],
         [ 3760.5430,   329.4623],
         [  253.0895,  7128.6440],
         [-2917.2153, -4213.9785],
         [ -843.9675,  2607.5854]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[-1.0290e+03,  3.5673e+03],
         [ 3.2447e+03,  4.6876e+03],
         [ 6.1427e+03,  4.7466e+03],
         [-1.3143e+03,  5.8396e+03],
         [-8.0656e+02,  1.0042e+03],
         [ 6.1026e+03, -6.5153e+03],
         [ 2.3311e+03, -5.2868e+01],
         [-9.7210e+02,  1.1742e+03],
         [-6.1417e+02,  5.7423e+03],
         [ 5.1851e+03, -2.9678e+03]],

        [[-1.5803e+03,  5.8571e+02],
         [ 3.4824e+03, -3.5623e+03],
         [-5.6539e+03, -5.8410e+03],
         [-2.1540e+03, -5.6537e+03],
         [ 4.6607e+03, -5.4443e+03],
         [-6.7804e+02, -5.4015e+03],
         [ 2.6484e+03,  2.8009e+03],
         [ 6.4370e+03,  4.2814e+03],
         [ 1.0918e+03, -4.8798e+03],
         [ 1.4271e+03, -1.5150e+03]],

        [[ 8.8114e+02, -2.9877e+03],
         [ 1.7315e+03,  3.4671e+03],
         [-6.4380e+03, -4.7899e+03],
         [-2.1227e+03, -4.1358e+03],
         [ 5.7491e+03,  6.0467e+03],
         [-5.8304e+03, -3.1290e+03],
         [ 2.8167e+03,  6.6443e+03],
         [-2.1805e+03, -1.3999e+03],
         [ 3.5839e+03, -5.2563e+03],
         [-3.5566e+03, -1.9128e+03]],

        [[-3.4828e+03,  2.6127e+03],
         [ 2.1344e+03, -5.6736e+03],
         [-5.9933e+03, -2.1857e+03],
         [-4.9942e+03,  4.9372e+03],
         [-4.2063e+03,  2.6093e+03],
         [ 4.9701e+03, -1.4513e+03],
         [ 3.4557e+02, -8.7272e+03],
         [-5.8143e+02, -6.5455e+03],
         [-5.2211e+01, -2.5806e+03],
         [-2.8435e+02,  1.5465e+03]],

        [[-1.3907e+03,  4.6173e+03],
         [ 3.8558e+03, -3.0534e+03],
         [ 3.1213e+03,  4.3246e+03],
         [ 6.4238e+03, -4.4872e+03],
         [ 2.8626e+03,  1.1174e+03],
         [-9.3057e+03,  8.2483e+02],
         [ 1.9148e+03,  7.8543e+03],
         [-6.4895e+02, -1.2818e+02],
         [ 8.0824e+02,  7.9178e+02],
         [-8.5330e+02, -6.6798e+02]],

        [[-6.4951e+01, -4.2562e+03],
         [-4.6229e+02,  1.4195e+03],
         [ 3.8906e+03, -8.2542e+03],
         [-2.5645e+03,  6.5434e+03],
         [ 6.7935e+02,  3.7164e+03],
         [ 5.5472e+02, -3.1316e+03],
         [-5.6682e+03, -9.3768e+02],
         [ 1.8757e+03, -7.4044e+01],
         [-6.7848e+02, -8.1630e+02],
         [-9.4125e+02,  6.1844e+00]],

        [[-3.6482e+03,  2.8626e+02],
         [ 2.6631e+03,  9.6243e+02],
         [ 5.6730e+03,  2.8108e+03],
         [-6.3611e+03,  3.5902e+03],
         [ 4.4066e+03,  5.5775e+02],
         [-1.6833e+03, -4.0345e+03],
         [-1.0819e+02, -8.0719e+03],
         [ 4.4628e+02, -1.1457e+03],
         [ 2.7285e+02, -9.8753e+02],
         [ 1.8338e+02, -1.0515e+02]],

        [[-1.8064e+03,  2.1806e+03],
         [ 2.4757e+03, -4.1437e+03],
         [ 4.5238e+03,  4.3946e+03],
         [ 5.6548e+03,  6.0024e+03],
         [-1.0290e+03, -4.1896e+02],
         [-8.8872e+03,  1.1271e+03],
         [ 1.5197e+03,  7.5962e+03],
         [ 4.4195e+02,  1.2022e+03],
         [ 5.9719e+03,  4.0496e+03],
         [-5.6583e+03,  2.9762e+02]],

        [[ 4.9706e+03,  1.6981e+03],
         [-2.8091e+03, -1.9184e+03],
         [ 4.4413e+03, -6.3783e+03],
         [-2.7476e+03, -3.3663e+03],
         [ 5.1112e+03, -1.9489e+03],
         [ 1.7260e+03,  3.0408e+02],
         [-6.6293e+03,  2.4979e+03],
         [ 4.0284e+03,  7.7949e+03],
         [-2.0899e+03,  5.8879e+03],
         [ 8.5146e+02,  6.1801e+02]],

        [[ 2.0032e+03,  8.1244e+03],
         [ 2.7579e+03,  5.6761e+03],
         [-1.2778e+03,  7.4490e+03],
         [-7.3607e+02, -5.5885e+03],
         [-7.8421e+02, -5.7694e+03],
         [ 3.4030e+03, -7.4659e+03],
         [ 2.1747e+03, -8.7814e+03],
         [-5.9129e+02, -5.9614e+03],
         [-1.7896e+03, -9.4169e+03],
         [ 1.6541e+03, -8.2647e+03]]]) 

Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0147,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]],
       grad_fn=<SelectBackward>)

Epoch 1 finished. Total time: 775.3354351520538;  Epoch time: 471.562641620636 












test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
test_counter in loss_omega_mat(): 4046
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9443, 0.9443, 0.9431,  ..., 0.6398, 0.6055, 0.6055],
         [0.4511, 0.4191, 0.4048,  ..., 0.2785, 0.2768, 0.2762],
         [0.4188, 0.4048, 0.3990,  ..., 0.2766, 0.2763, 0.2656],
         ...,
         [0.9457, 0.9456, 0.9456,  ..., 0.7568, 0.7567, 0.7567],
         [0.9457, 0.9456, 0.9456,  ..., 0.7570, 0.7569, 0.7567],
         [0.9456, 0.9456, 0.9455,  ..., 0.7568, 0.7568, 0.7558]],

        [[0.9455, 0.9453, 0.9452,  ..., 0.6404, 0.6402, 0.6400],
         [0.9452, 0.9452, 0.9451,  ..., 0.6402, 0.6056, 0.6053],
         [0.9453, 0.9453, 0.9451,  ..., 0.6399, 0.6059, 0.6054],
         ...,
         [0.9457, 0.9457, 0.9457,  ..., 0.7570, 0.7570, 0.7568],
         [0.9457, 0.9456, 0.9456,  ..., 0.7570, 0.7570, 0.7570],
         [0.9457, 0.9456, 0.9455,  ..., 0.7570, 0.7568, 0.7562]],

        [[0.9455, 0.9455, 0.9453,  ..., 0.7566, 0.7566, 0.6406],
         [0.9456, 0.9453, 0.9453,  ..., 0.7564, 0.6408, 0.6406],
         [0.9457, 0.9456, 0.9453,  ..., 0.6406, 0.6405, 0.6402],
         ...,
         [0.9458, 0.9457, 0.9457,  ..., 0.7570, 0.7570, 0.7570],
         [0.9458, 0.9457, 0.9457,  ..., 0.7571, 0.7571, 0.7570],
         [0.9457, 0.9456, 0.9456,  ..., 0.7570, 0.7570, 0.7566]],

        ...,

        [[0.9457, 0.9457, 0.9456,  ..., 0.7569, 0.7567, 0.7564],
         [0.9457, 0.9456, 0.9455,  ..., 0.7566, 0.7560, 0.7411],
         [0.9455, 0.9454, 0.9451,  ..., 0.7560, 0.7331, 0.7322],
         ...,
         [0.9459, 0.9459, 0.9456,  ..., 0.7570, 0.7568, 0.7568],
         [0.9459, 0.9457, 0.9455,  ..., 0.7570, 0.7567, 0.7567],
         [0.9457, 0.9457, 0.9456,  ..., 0.7566, 0.7558, 0.7549]],

        [[0.9457, 0.9456, 0.9455,  ..., 0.7567, 0.7567, 0.7561],
         [0.9456, 0.9455, 0.9452,  ..., 0.7509, 0.7454, 0.7348],
         [0.9451, 0.9449, 0.9449,  ..., 0.7448, 0.7312, 0.7235],
         ...,
         [0.9459, 0.9457, 0.9455,  ..., 0.7569, 0.7568, 0.7568],
         [0.9457, 0.9455, 0.9455,  ..., 0.7569, 0.7567, 0.7566],
         [0.9456, 0.9456, 0.9455,  ..., 0.7566, 0.7557, 0.7548]],

        [[0.9456, 0.9455, 0.9452,  ..., 0.7558, 0.7556, 0.7514],
         [0.9455, 0.9452, 0.9445,  ..., 0.7438, 0.7415, 0.7294],
         [0.9449, 0.9445, 0.9403,  ..., 0.7364, 0.7280, 0.7148],
         ...,
         [0.9458, 0.9456, 0.9455,  ..., 0.7569, 0.7556, 0.7538],
         [0.9456, 0.9455, 0.9454,  ..., 0.7568, 0.7564, 0.7551],
         [0.9455, 0.9455, 0.9454,  ..., 0.7561, 0.7558, 0.7557]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[2.6649e-07, 1.8577e-06, 9.1850e-10,  ..., 8.0512e-06,
          3.1924e-07, 2.6467e-07],
         [7.3443e-07, 3.1882e-07, 1.1905e-06,  ..., 1.0291e-06,
          1.5031e-07, 8.0475e-06],
         [4.8945e-06, 3.5645e-06, 1.7593e-06,  ..., 1.3441e-05,
          3.0453e-07, 2.6927e-06],
         ...,
         [6.5025e-07, 7.9553e-07, 1.1042e-06,  ..., 6.7501e-07,
          1.3639e-06, 3.3128e-06],
         [6.2507e-07, 2.5823e-08, 1.8247e-07,  ..., 3.6497e-06,
          2.5074e-06, 3.9220e-07],
         [2.3546e-07, 5.7631e-07, 6.8834e-07,  ..., 6.8277e-07,
          2.7816e-06, 1.2306e-07]],

        [[2.4683e-07, 4.8857e-07, 2.3192e-06,  ..., 2.8203e-06,
          5.8909e-07, 1.3227e-06],
         [9.7935e-07, 3.0087e-06, 2.8921e-06,  ..., 5.5579e-06,
          4.0349e-06, 5.9854e-07],
         [5.0044e-08, 1.5926e-08, 1.1754e-06,  ..., 2.7630e-07,
          1.9489e-06, 1.7214e-07],
         ...,
         [8.6878e-07, 1.2090e-08, 4.8684e-08,  ..., 2.7235e-08,
          5.1983e-06, 7.2906e-07],
         [4.0787e-07, 1.6938e-06, 3.7599e-07,  ..., 8.2445e-07,
          1.2410e-06, 1.4360e-06],
         [1.4928e-07, 2.2568e-06, 6.3547e-07,  ..., 2.9734e-06,
          1.7754e-06, 1.8830e-08]],

        [[4.9831e-07, 1.7905e-07, 1.8161e-07,  ..., 2.3517e-07,
          5.1540e-07, 1.2602e-06],
         [5.1008e-07, 9.3034e-08, 7.1608e-07,  ..., 1.5986e-06,
          8.3381e-06, 4.7147e-06],
         [5.2989e-08, 8.5343e-07, 3.6415e-09,  ..., 2.9408e-06,
          3.0509e-08, 3.2046e-07],
         ...,
         [5.1756e-07, 8.5232e-07, 3.3975e-07,  ..., 5.7821e-08,
          8.0247e-06, 1.4066e-06],
         [7.5360e-07, 2.2930e-07, 1.2728e-06,  ..., 4.4734e-07,
          3.0762e-06, 2.4157e-06],
         [2.9083e-07, 1.0398e-06, 3.5422e-07,  ..., 2.1509e-06,
          2.2624e-06, 5.5236e-07]],

        ...,

        [[1.2524e-07, 4.4998e-07, 3.6975e-07,  ..., 1.4789e-06,
          2.9560e-06, 2.1466e-06],
         [1.2271e-06, 2.7154e-07, 3.5648e-07,  ..., 3.7105e-06,
          2.3685e-06, 5.1279e-06],
         [1.5037e-06, 5.2868e-07, 2.4742e-07,  ..., 5.1051e-06,
          1.4545e-04, 1.9496e-06],
         ...,
         [1.9143e-07, 1.5412e-07, 5.1925e-08,  ..., 6.6804e-06,
          2.3063e-08, 9.0510e-07],
         [9.4045e-07, 8.6306e-07, 1.8001e-07,  ..., 5.1443e-06,
          1.4069e-08, 1.8592e-06],
         [3.8092e-07, 1.0935e-07, 2.7851e-07,  ..., 4.4503e-08,
          4.5375e-09, 1.2798e-07]],

        [[3.8686e-09, 1.3121e-07, 1.1252e-09,  ..., 6.5600e-07,
          2.2386e-06, 1.5918e-06],
         [1.0380e-06, 3.9066e-07, 9.0183e-07,  ..., 8.5669e-08,
          1.5947e-06, 4.8602e-06],
         [4.5586e-07, 3.9297e-07, 2.1929e-06,  ..., 1.1236e-07,
          4.4069e-07, 3.9100e-05],
         ...,
         [1.3371e-07, 4.7517e-09, 1.3087e-07,  ..., 2.1210e-06,
          3.6870e-08, 1.9419e-07],
         [1.7777e-07, 4.7670e-08, 2.4545e-06,  ..., 2.7563e-06,
          1.9658e-06, 5.0286e-06],
         [3.3665e-07, 7.0836e-08, 8.5086e-07,  ..., 5.4331e-07,
          1.4223e-07, 9.5174e-07]],

        [[2.6941e-06, 5.5355e-07, 3.2841e-07,  ..., 7.7340e-07,
          2.2320e-06, 3.6270e-07],
         [9.7806e-08, 1.7965e-08, 2.5971e-06,  ..., 2.3545e-07,
          3.7894e-06, 2.3823e-07],
         [1.3128e-07, 4.5661e-06, 4.1616e-07,  ..., 1.3391e-04,
          4.3205e-05, 6.3165e-05],
         ...,
         [6.3857e-08, 1.5217e-06, 2.0482e-06,  ..., 1.0395e-07,
          7.8743e-07, 4.5431e-06],
         [2.7400e-06, 9.2760e-08, 7.6891e-08,  ..., 3.5299e-09,
          7.9593e-07, 4.0844e-06],
         [2.9445e-06, 3.6119e-09, 1.5604e-06,  ..., 9.8664e-07,
          1.1262e-06, 9.7185e-08]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[1.0119e-03, 8.8513e-04, 8.8646e-04,  ..., 8.1400e-04,
          1.6433e-04, 8.3474e-04],
         [5.7431e-04, 5.0967e-04, 7.2307e-04,  ..., 4.2806e-04,
          7.9904e-05, 8.7542e-04],
         [4.5160e-04, 1.4038e-03, 8.8310e-04,  ..., 9.3397e-05,
          7.1441e-04, 3.5081e-04],
         ...,
         [8.0584e-04, 1.3493e-03, 6.8671e-04,  ..., 1.2187e-03,
          1.0306e-03, 1.2289e-04],
         [1.4341e-03, 1.1774e-03, 6.8671e-04,  ..., 1.4110e-03,
          1.0795e-03, 6.4513e-04],
         [1.1774e-03, 7.2492e-04, 9.6456e-04,  ..., 9.9392e-04,
          1.1603e-03, 8.8395e-04]],

        [[6.5293e-04, 6.3966e-04, 3.3454e-04,  ..., 1.0133e-03,
          8.0804e-04, 7.0992e-04],
         [8.9684e-04, 3.3454e-04, 6.1986e-04,  ..., 6.0067e-04,
          4.1070e-04, 2.5909e-04],
         [5.8050e-05, 1.0070e-03, 6.1986e-04,  ..., 6.3868e-04,
          5.9845e-04, 5.5969e-04],
         ...,
         [8.0584e-04, 8.8498e-04, 7.8887e-04,  ..., 7.4877e-04,
          1.6267e-03, 1.1603e-03],
         [1.4341e-03, 4.5861e-04, 1.2686e-03,  ..., 4.6205e-04,
          9.8505e-04, 4.5753e-04],
         [7.8711e-04, 4.5861e-04, 9.6456e-04,  ..., 1.4827e-03,
          1.0736e-03, 1.2139e-03]],

        [[8.4351e-04, 6.5293e-04, 7.2966e-04,  ..., 4.3615e-04,
          3.6410e-04, 3.3434e-04],
         [9.1340e-04, 3.5482e-04, 7.2966e-04,  ..., 2.7388e-04,
          8.0937e-04, 1.3655e-03],
         [1.3359e-04, 3.1778e-04, 3.5482e-04,  ..., 9.0785e-04,
          3.3677e-04, 3.4272e-04],
         ...,
         [7.2386e-04, 5.0727e-04, 7.8887e-04,  ..., 5.9048e-04,
          5.6516e-04, 1.4827e-03],
         [7.7747e-04, 2.6491e-04, 5.0727e-04,  ..., 1.1114e-03,
          1.1125e-03, 7.2612e-04],
         [2.6491e-04, 9.5263e-04, 9.4060e-05,  ..., 5.8559e-04,
          6.6583e-04, 7.6839e-04]],

        ...,

        [[1.0829e-03, 9.4910e-04, 9.8446e-04,  ..., 6.4852e-04,
          6.0485e-04, 1.2748e-03],
         [1.2650e-03, 1.1840e-03, 5.6127e-04,  ..., 6.4050e-04,
          3.4646e-04, 7.3300e-03],
         [6.5206e-04, 8.4223e-04, 2.4239e-04,  ..., 9.8521e-04,
          9.4156e-03, 1.1519e-03],
         ...,
         [5.3553e-04, 6.0867e-04, 5.8772e-04,  ..., 5.7328e-04,
          4.3265e-04, 4.8063e-04],
         [5.3553e-04, 7.1923e-04, 1.1926e-03,  ..., 7.1988e-04,
          1.2843e-03, 1.2078e-03],
         [4.9032e-04, 7.1923e-04, 2.2201e-04,  ..., 3.5340e-04,
          3.7031e-04, 6.0302e-04]],

        [[3.4302e-04, 9.8446e-04, 1.0718e-03,  ..., 1.8459e-03,
          1.4281e-03, 5.1243e-04],
         [1.1840e-03, 5.8820e-04, 1.2524e-03,  ..., 1.7679e-03,
          9.1935e-04, 1.7295e-03],
         [2.4239e-04, 5.7376e-04, 1.2190e-03,  ..., 8.0029e-03,
          2.1955e-03, 1.2682e-03],
         ...,
         [5.1882e-04, 1.1532e-03, 1.0694e-03,  ..., 5.6581e-04,
          1.2612e-03, 5.8109e-04],
         [1.1532e-03, 9.3186e-04, 1.1183e-03,  ..., 3.3302e-04,
          1.2050e-03, 1.0156e-03],
         [2.2201e-04, 7.7849e-04, 9.3186e-04,  ..., 6.9027e-04,
          4.8879e-04, 8.2470e-04]],

        [[4.2895e-04, 1.0718e-03, 4.5362e-04,  ..., 1.0147e-03,
          8.3847e-04, 1.6299e-03],
         [5.8820e-04, 4.5362e-04, 7.4494e-04,  ..., 3.8528e-03,
          7.5750e-03, 2.8617e-03],
         [5.7376e-04, 7.4494e-04, 5.4204e-04,  ..., 9.5911e-03,
          2.1531e-03, 1.0765e-03],
         ...,
         [5.9717e-04, 7.0221e-04, 1.0694e-03,  ..., 8.3305e-04,
          6.6878e-04, 1.2297e-03],
         [7.0221e-04, 1.0497e-03, 1.1540e-03,  ..., 4.8063e-04,
          8.3177e-04, 1.1582e-03],
         [1.0410e-03, 1.3015e-03, 1.1540e-03,  ..., 1.3126e-04,
          5.6385e-04, 1.5489e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:4.443251609802246 loss2:1817.3865966796875


loss.item(): 36352.171875


Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([59, 98]) torch.Size([59, 98, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-4.7305e-02,  1.9295e+00,  2.4575e+00,  1.1555e+00,  1.6632e+00,
          1.6416e+00,  5.4400e+00,  1.1049e+01,  3.3827e+00, -1.3698e+01],
        [-1.0053e+00,  2.4258e+00, -4.5787e+00, -5.4258e+00,  3.3798e-01,
          1.1207e+01,  8.5945e+00,  9.6414e+01,  3.3451e+01,  5.3273e+01],
        [-1.5863e+01,  2.0790e+01,  1.5401e+01, -2.0492e+01,  3.6502e+01,
          2.6640e+01, -2.3908e+02,  1.9950e+02, -4.7446e+02,  2.6002e+02],
        [ 2.4551e+01, -1.7237e+01,  1.0741e+01,  2.1790e+01,  6.0293e+01,
          4.6125e+02,  2.1440e+02,  4.8856e+02, -2.4482e+02, -6.0874e+02],
        [-6.8199e+00,  3.7572e+01,  2.7219e+01,  5.2130e+02,  6.2697e+02,
          7.1922e+02,  9.6556e+02,  1.1588e+03, -1.3731e+02,  3.9244e+02],
        [ 2.7742e+01, -4.7472e+00,  1.0313e+02,  5.4028e+02,  1.0353e+03,
         -8.7660e+02,  8.1520e+02,  1.5357e+03, -2.3371e+02,  1.3843e+03],
        [-2.7176e+00,  2.6309e+01,  4.6908e+02,  7.2780e+02,  4.3376e+02,
         -1.1355e+04, -9.5330e+02,  1.1439e+03,  2.8754e+02, -1.2872e+03],
        [ 2.5823e+01, -8.8802e+00,  4.0673e+01,  9.2354e+02,  6.2867e+02,
          1.6136e+02, -7.2237e+03,  7.1993e+02, -8.2417e+02, -1.0011e+04]]) 

MatU.grad[0:10,35:45]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 1.6307e+02,  6.2409e+02],
         [-5.0449e+02, -1.8735e+02],
         [ 1.2442e+01,  6.7088e+02],
         [ 4.5152e+02,  1.1721e+02],
         [-4.6289e+02, -6.0382e+02],
         [ 3.9844e+02,  1.4301e+02],
         [-8.5861e+01,  8.1779e+02],
         [ 4.3349e+02, -1.2235e+02],
         [-9.3467e+01,  8.5301e+02],
         [-1.1485e+02, -2.8662e+02]],

        [[ 1.6981e+03, -3.4850e+02],
         [-8.7064e+02, -1.2120e+02],
         [-6.0153e+02, -4.3130e+02],
         [-1.9518e+03, -4.3267e+02],
         [ 1.7902e+03,  4.5816e+02],
         [ 1.1332e+03,  1.7016e+02],
         [-2.1816e+03, -1.0981e+03],
         [ 2.2094e+03, -2.0210e+02],
         [-1.8370e+03, -1.1214e+03],
         [ 1.1085e+02,  1.8476e+03]],

        [[-3.0453e+03, -4.6003e+03],
         [ 1.9996e+03, -4.0324e+02],
         [-4.4781e+03,  2.5973e+03],
         [ 1.5583e+03, -1.6908e+03],
         [-2.8144e+03,  1.7238e+03],
         [ 7.5536e+02,  8.5817e+02],
         [-5.4045e+03,  2.4985e+02],
         [ 3.4662e+03,  6.0005e+02],
         [ 2.3523e+03, -1.9295e+03],
         [-5.8140e+03, -1.2802e+03]],

        [[ 1.2252e+03,  4.6317e+03],
         [ 3.1479e+03, -4.1698e+03],
         [ 5.5009e+03, -5.7221e+03],
         [-2.8138e+02,  3.3273e+03],
         [-4.0204e+03, -2.3122e+03],
         [-1.6174e+02,  7.3590e+03],
         [-4.1047e+03, -2.6821e+03],
         [ 5.4710e+03, -1.1349e+03],
         [ 3.1043e+00,  3.1891e+03],
         [-3.8286e+03, -6.1084e+03]],

        [[-4.8038e+03, -1.4089e+03],
         [ 6.2122e+03,  6.6261e+02],
         [-5.9997e+03, -3.1791e+03],
         [-3.2198e+03, -2.6448e+03],
         [ 1.7583e+03, -1.0366e+01],
         [-8.6218e+01,  1.6594e+03],
         [-2.7563e+02,  1.6014e+03],
         [ 7.0561e+03, -6.6075e+02],
         [-6.7293e+03, -1.6531e+03],
         [-2.5657e+02,  7.5958e+03]],

        [[-1.7813e+03,  2.4215e+03],
         [ 5.9344e+03, -4.0523e+03],
         [ 6.5607e+02,  6.7523e+03],
         [-1.7652e+02, -3.6424e+03],
         [ 1.7254e+03, -8.4393e-01],
         [-5.8040e+02, -7.2783e+02],
         [ 1.5262e+01,  1.2319e+03],
         [ 1.6888e+03, -1.6316e+02],
         [ 2.6220e+02,  2.5693e+01],
         [-4.1390e+02,  1.3493e+03]],

        [[-6.5613e+03,  3.1186e+03],
         [-2.4533e+02,  7.6895e+03],
         [-5.0737e+03, -3.4578e+03],
         [ 4.6805e+03,  4.0074e+03],
         [-1.5818e+03,  8.5737e+02],
         [ 1.1871e+03, -2.9556e+02],
         [-7.0001e+02, -4.4333e+02],
         [ 1.1736e+03,  3.4780e+02],
         [ 1.2609e+03,  3.3654e+02],
         [-1.2193e+03, -1.3640e+03]]]) 

MatD.grad: 
tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000, -0.9213,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.4000e+02,  1.1574e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-5.2308e+01, -1.8466e+02],
         [-2.3763e+02,  1.9974e+02],
         [-2.4816e+02, -3.1795e+02],
         [ 0.0000e+00,  0.0000e+00],
         [-2.1009e-01,  1.0108e+02],
         [ 5.2547e+01, -8.6256e+01],
         [-9.1973e+00, -2.2645e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-3.0412e+02,  1.5856e+02],
         [-5.8552e+02,  2.1871e+02],
         [-8.7878e+02,  3.6139e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.5059e+02,  1.3056e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-4.7954e+01, -1.3120e+01],
         [-9.8318e+02,  6.2919e+02],
         [ 4.1636e+03,  1.3870e+03],
         [ 1.3953e+03, -6.5455e+02],
         [-8.7205e+02,  1.3252e+03],
         [ 1.5244e+03,  9.3954e+02],
         [-3.9034e+03, -7.0862e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-2.8727e+02, -1.8839e+02],
         [-1.4765e+03,  3.2399e+01],
         [-1.5962e+03, -5.6840e+03],
         [-5.0084e+01, -4.3422e+03],
         [ 1.0817e+03,  3.1988e+03],
         [ 4.3833e+03, -5.4448e+03],
         [-3.8770e+03, -5.9819e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-7.7079e+02, -3.0649e+02],
         [-5.4445e+02,  4.4739e+02],
         [-3.7544e+03,  1.4248e+03],
         [ 3.0729e+03,  6.7611e+03],
         [-1.3979e+03,  4.2594e+03],
         [ 4.3636e+02,  1.5884e+03],
         [ 7.6456e+03, -4.2804e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.9228e+02,  2.5364e+02],
         [-1.7757e+03, -7.2434e+02],
         [ 5.7451e+03,  4.0435e+03],
         [ 6.1880e+03, -4.7079e+03],
         [-4.7866e+03,  7.2219e+03],
         [-5.8937e+03,  3.5009e+03],
         [ 7.2091e+03,  6.1389e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 5.4320e+02, -2.0104e+02],
         [-1.4557e+03, -1.2709e+03],
         [-2.6469e+03, -5.4143e+03],
         [ 5.3435e+03, -1.9545e+03],
         [-3.9751e+03, -3.1551e+03],
         [-5.8391e+03, -4.2118e+03],
         [ 1.3811e+03, -7.1478e+02]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[-7193.7671,   979.4439],
         [-3719.7561,  5067.6865],
         [ 2648.8875,  8034.2979],
         [ 7564.4707,  3574.2859],
         [-3225.6208, -5974.4814],
         [-4459.4082, -7833.4136],
         [ 2301.7551,  6941.2573],
         [-4499.3408, -2821.9653],
         [-5715.0679,  2760.9365],
         [ 6077.2256,  5358.3843]],

        [[ 2067.7661, -4998.0781],
         [ 1494.9198,  5069.0825],
         [ -570.8287,  2202.5928],
         [  745.7264, -6807.6338],
         [-4745.2065,   687.0604],
         [ 5479.9546,  6094.3525],
         [-6073.7690,  5921.9077],
         [ 4340.8979, -1479.2776],
         [ 2367.3708,  -582.0099],
         [-4919.0371,  6119.7690]],

        [[ 2255.8623, -7612.5820],
         [-1483.8536, -9218.8438],
         [-6490.6074, -2076.7095],
         [ 5588.2295,  1888.1614],
         [ 2554.3555,  -332.3428],
         [ -796.1672,  1214.2831],
         [-6280.7500, -5974.4204],
         [ 3931.8103,  4474.9272],
         [ 6866.4990, -3618.8691],
         [-2394.3145, -5793.8501]],

        [[-1029.8691,  8611.4971],
         [ 9068.7578,  -981.5869],
         [-4269.8813, -4255.9619],
         [ 5384.0859, -1467.7756],
         [ 3321.2693, -1127.0778],
         [-2859.8213, -6314.1289],
         [-1762.7654, -2107.2959],
         [ -626.0665, -8453.4131],
         [-4094.1946, -1356.1749],
         [ 2713.6982,  7731.4995]],

        [[-8922.1201, -1807.2280],
         [ 6605.9023,  6469.3984],
         [ -418.9014,  5402.0503],
         [ 7118.4717, -2855.6365],
         [-7670.6362,  3905.9556],
         [ 4339.6279,  5905.2319],
         [-7929.1909, -1823.5577],
         [ 1343.3802,  7265.3369],
         [ 8360.1680,  3300.4124],
         [-5611.8789,  4907.9844]],

        [[ 1141.0570, -7613.0005],
         [ 2444.4656, -1851.8549],
         [-3727.7529,  2472.4719],
         [ 5978.7886,  2687.7371],
         [ 1162.6843, -8001.2422],
         [-5054.4341,  3035.4746],
         [-3792.9946, -3718.1619],
         [ 1406.9200,  3624.6792],
         [ 7206.0371,   133.6268],
         [  967.1193, -5245.2529]],

        [[ 6809.5835,  5328.4307],
         [ 1241.0835, -9196.8594],
         [-3878.9729,  4683.2817],
         [ 3210.0161,  2512.0823],
         [ 6147.6230, -3700.4712],
         [-5776.9136,  5599.3193],
         [ 1129.7859, -4925.9653],
         [ 1100.2032,   726.0565],
         [ 3841.1326, -7085.6392],
         [-3461.9675, -6215.5093]],

        [[-9083.2168, -1899.3619],
         [ 1972.9292,  8211.4893],
         [-4361.4648, -3385.4255],
         [-1112.4388, -5194.0659],
         [ 3122.4482,  1348.7360],
         [-1389.0038, -3196.4026],
         [ 7293.5405,   380.6262],
         [-4620.2568,  5238.3696],
         [ 5936.6782,  5801.3335],
         [-5653.8237,   980.8846]],

        [[-3686.4265, -7442.2827],
         [ 4219.4150, -2082.1130],
         [-3954.8501,  1412.2339],
         [ 1836.6180, -8969.1484],
         [ -822.9108,  2509.8203],
         [-2366.9395, -2128.9836],
         [ 4969.1299, -4724.5298],
         [-4332.9702, -3445.0981],
         [ 1496.8671,  5606.9570],
         [-2445.3704,  2380.9353]],

        [[ 7915.9282,  4807.5156],
         [ 4332.0083,  3039.9795],
         [-5625.6372, -1132.3583],
         [-2577.6960,  4180.9863],
         [-1383.7616,  7204.7803],
         [-1679.8483, -6969.3403],
         [ 1802.4120,  1409.9954],
         [ 1364.4860,  6899.4214],
         [ 1373.0074, -4858.3384],
         [-5692.0640,  -262.9919]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[-6503.9204,  -215.3793],
         [ 7554.3047,  2102.6929],
         [ 2912.3977,  2517.3269],
         [-5620.1294,  2437.4712],
         [ 7157.6714,  5958.2358],
         [  -91.8567, -3846.0254],
         [ 4157.1475,  5948.5078],
         [ 7699.8101,  3856.2744],
         [-6377.4399,   413.8180],
         [ 1331.3036, -4456.8862]],

        [[-3310.7637,  5495.5161],
         [ 4987.1992, -5728.7070],
         [-1102.2004, -2753.0820],
         [-7351.4019, -2268.2717],
         [ 7264.9067, -3589.9358],
         [-4770.5312, -2907.6062],
         [ 1220.6772,  3448.9729],
         [ 4020.3176, -4644.3174],
         [-3651.0754, -3137.7112],
         [ 3115.5674,  3294.8323]],

        [[-3185.0669, -3649.8674],
         [ 5015.0640,  4422.4961],
         [-3153.1494, -2344.3049],
         [-8460.2227,  -724.2772],
         [ 6447.1724,  3826.4961],
         [ -807.4036, -4905.3428],
         [-1918.3625,  2624.9055],
         [ 6593.6836,  2729.0615],
         [ 2643.9880, -3035.9275],
         [-1517.1378, -4108.1743]],

        [[ -347.4637,  3316.6650],
         [ 5675.5752, -1145.3234],
         [-2132.6218, -7886.9155],
         [-3463.0991,  6545.5474],
         [  968.8594,  6410.0713],
         [ 3869.1082, -4993.5796],
         [-1565.0764, -8650.6338],
         [ -382.9261, -6468.5142],
         [ -263.8694, -2488.3489],
         [ -154.8870,  1444.3440]],

        [[-3344.6228,   -42.5297],
         [ 3256.9583, -6574.3018],
         [ 4038.2993,  1703.2441],
         [ 1941.9681, -5044.1338],
         [-2360.7898, -3611.1819],
         [-9252.1533,   389.5973],
         [ 1270.6261,  7912.1338],
         [  205.5533,  -410.9148],
         [  769.0443,   752.0873],
         [ -788.6771,  -646.8237]],

        [[-2292.2395, -4185.3672],
         [ 5423.2461,  4241.1787],
         [ 2556.5530, -4712.3125],
         [-5277.5283,  1358.1310],
         [ 6853.4722,   464.1132],
         [-2834.2866,  -871.6396],
         [-5327.7314,  -557.9205],
         [ 1814.2568,   -58.0621],
         [ -673.2577,  -790.3549],
         [ -893.2084,   -47.8444]],

        [[ -629.3173,  4241.8979],
         [ 4230.2573,  4701.6084],
         [ -571.6837,  5325.1724],
         [-3938.7222,  5592.7349],
         [ 3951.8989,  5206.4404],
         [  439.9598,   -30.5937],
         [  259.9591, -8025.5234],
         [  298.7916, -1107.0302],
         [ -150.6016,  -942.1614],
         [   62.8805,   240.3484]],

        [[-1355.9813, -2069.5220],
         [ 3853.1189, -4677.0400],
         [ 4005.6023, -1287.4156],
         [ 1480.3405,   992.0209],
         [ -672.9548, -5007.0312],
         [-8930.0684,   764.7043],
         [  892.6953,  7861.5962],
         [ 1539.7632,   962.0940],
         [ 6040.3237,  4151.7612],
         [-5480.7812,   340.4106]],

        [[  344.2924,  -727.7507],
         [ 4882.9536,  3060.0393],
         [ 3699.3828, -5146.5869],
         [-1647.7557, -1718.2013],
         [ 4916.4570, -3198.6567],
         [ -993.0228, -4005.6802],
         [-6545.5259,  1705.3384],
         [ 3726.2065,  7893.6523],
         [-1291.4019,  5806.5254],
         [   60.5462,   189.8025]],

        [[  104.8503,  8102.5229],
         [ 2173.7939,  5358.7534],
         [  600.8133,  7304.4800],
         [-1279.7211, -2194.5637],
         [-1094.5662, -3858.1421],
         [ 2923.3081, -7458.7930],
         [ 1294.2271, -8716.2891],
         [  236.9799, -5836.7783],
         [ -969.4059, -9640.1270],
         [  201.9391, -7819.0552]]]) 

Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0154,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]],
       grad_fn=<SelectBackward>)

Epoch 2 finished. Total time: 1430.9087226390839;  Epoch time: 655.5702950954437 












test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
test_counter in loss_omega_mat(): 4046
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9436, 0.9436, 0.9412,  ..., 0.6391, 0.6053, 0.6048],
         [0.4502, 0.4130, 0.3978,  ..., 0.2749, 0.2720, 0.2717],
         [0.4124, 0.3977, 0.3950,  ..., 0.2722, 0.2716, 0.2637],
         ...,
         [0.9457, 0.9456, 0.9456,  ..., 0.7569, 0.7568, 0.7568],
         [0.9458, 0.9458, 0.9457,  ..., 0.7570, 0.7570, 0.7568],
         [0.9458, 0.9458, 0.9458,  ..., 0.7569, 0.7569, 0.7560]],

        [[0.9454, 0.9453, 0.9447,  ..., 0.6402, 0.6401, 0.6400],
         [0.9449, 0.9447, 0.9446,  ..., 0.6397, 0.6057, 0.6052],
         [0.9448, 0.9447, 0.9446,  ..., 0.6394, 0.6056, 0.6055],
         ...,
         [0.9459, 0.9458, 0.9458,  ..., 0.7571, 0.7571, 0.7570],
         [0.9459, 0.9458, 0.9458,  ..., 0.7571, 0.7571, 0.7570],
         [0.9459, 0.9458, 0.9458,  ..., 0.7571, 0.7566, 0.7564]],

        [[0.9454, 0.9453, 0.9453,  ..., 0.7565, 0.7564, 0.6403],
         [0.9455, 0.9449, 0.9447,  ..., 0.7561, 0.6407, 0.6406],
         [0.9455, 0.9450, 0.9448,  ..., 0.6407, 0.6402, 0.6395],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7572, 0.7571],
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7572, 0.7571],
         [0.9459, 0.9458, 0.9458,  ..., 0.7571, 0.7570, 0.7567]],

        ...,

        [[0.9458, 0.9458, 0.9458,  ..., 0.7567, 0.7561, 0.7557],
         [0.9457, 0.9457, 0.9452,  ..., 0.7561, 0.7557, 0.7354],
         [0.9454, 0.9451, 0.9450,  ..., 0.7554, 0.7254, 0.7244],
         ...,
         [0.9459, 0.9458, 0.9458,  ..., 0.7572, 0.7571, 0.7571],
         [0.9458, 0.9458, 0.9458,  ..., 0.7571, 0.7571, 0.7567],
         [0.9458, 0.9458, 0.9457,  ..., 0.7566, 0.7550, 0.7538]],

        [[0.9458, 0.9458, 0.9458,  ..., 0.7567, 0.7562, 0.7554],
         [0.9458, 0.9457, 0.9449,  ..., 0.7488, 0.7416, 0.7272],
         [0.9452, 0.9451, 0.9445,  ..., 0.7415, 0.7220, 0.7122],
         ...,
         [0.9459, 0.9458, 0.9458,  ..., 0.7571, 0.7571, 0.7570],
         [0.9458, 0.9458, 0.9457,  ..., 0.7571, 0.7570, 0.7568],
         [0.9458, 0.9458, 0.9457,  ..., 0.7568, 0.7562, 0.7540]],

        [[0.9458, 0.9456, 0.9455,  ..., 0.7553, 0.7552, 0.7508],
         [0.9458, 0.9449, 0.9446,  ..., 0.7390, 0.7362, 0.7217],
         [0.9452, 0.9442, 0.9383,  ..., 0.7298, 0.7182, 0.7013],
         ...,
         [0.9459, 0.9458, 0.9458,  ..., 0.7569, 0.7549, 0.7514],
         [0.9458, 0.9457, 0.9457,  ..., 0.7567, 0.7567, 0.7533],
         [0.9458, 0.9457, 0.9455,  ..., 0.7561, 0.7557, 0.7553]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[3.3682e-08, 5.3368e-07, 6.9984e-07,  ..., 8.7570e-08,
          4.2849e-07, 1.6655e-06],
         [1.2716e-06, 1.6670e-06, 1.1252e-06,  ..., 2.2882e-07,
          4.5958e-07, 7.8131e-06],
         [8.8038e-06, 2.4891e-06, 8.0928e-07,  ..., 5.5929e-07,
          1.6128e-05, 1.0392e-06],
         ...,
         [3.4853e-07, 8.2485e-08, 3.7751e-07,  ..., 6.9047e-07,
          4.9463e-07, 1.2938e-06],
         [4.8507e-07, 4.1330e-07, 5.2052e-10,  ..., 1.7771e-11,
          1.4550e-07, 1.3004e-06],
         [6.1744e-07, 5.4758e-07, 3.3760e-08,  ..., 7.9718e-09,
          2.3794e-06, 3.4320e-07]],

        [[2.8985e-09, 4.2850e-08, 3.9730e-06,  ..., 1.1363e-06,
          1.2321e-06, 1.0021e-07],
         [1.8811e-06, 5.3076e-06, 5.9863e-06,  ..., 1.9037e-06,
          2.2231e-07, 2.9728e-06],
         [1.3155e-07, 1.4950e-07, 9.4268e-06,  ..., 2.1631e-06,
          2.7202e-06, 6.5208e-06],
         ...,
         [1.2517e-10, 9.6650e-08, 2.9583e-07,  ..., 9.2644e-07,
          1.7212e-06, 3.8872e-10],
         [8.4823e-10, 2.7218e-07, 1.1062e-07,  ..., 1.4892e-07,
          5.5266e-08, 1.5258e-06],
         [6.2565e-07, 1.0201e-06, 1.2656e-09,  ..., 1.1316e-06,
          1.2869e-06, 1.0829e-06]],

        [[3.3838e-08, 7.2351e-07, 3.1122e-08,  ..., 2.0334e-06,
          3.0302e-08, 2.7864e-07],
         [3.2962e-07, 5.4704e-06, 3.2363e-07,  ..., 1.6494e-07,
          4.9763e-06, 3.9814e-07],
         [2.7929e-08, 1.6292e-07, 6.5524e-07,  ..., 2.3091e-08,
          1.5343e-06, 7.1421e-08],
         ...,
         [1.5303e-07, 1.5880e-07, 5.9124e-10,  ..., 1.2826e-06,
          2.1835e-10, 1.1466e-07],
         [1.6641e-07, 1.4421e-10, 1.4013e-08,  ..., 4.1833e-07,
          7.9459e-07, 8.6068e-07],
         [5.9342e-07, 4.8051e-09, 5.9396e-07,  ..., 4.3596e-07,
          2.4775e-06, 8.2416e-10]],

        ...,

        [[2.0098e-08, 2.8086e-07, 2.9164e-08,  ..., 1.5899e-07,
          2.0014e-07, 5.2577e-06],
         [4.4552e-08, 3.6235e-08, 5.1048e-07,  ..., 8.7466e-06,
          3.6803e-06, 8.6561e-06],
         [3.5796e-06, 1.5237e-07, 4.4331e-06,  ..., 6.7766e-06,
          1.5828e-04, 1.1394e-06],
         ...,
         [4.1760e-09, 6.3642e-07, 6.5190e-08,  ..., 2.0173e-07,
          1.9407e-08, 2.9768e-07],
         [8.9989e-07, 6.7670e-07, 1.2521e-10,  ..., 7.7044e-07,
          2.1581e-09, 1.2938e-06],
         [1.4717e-06, 2.9616e-08, 2.1431e-07,  ..., 5.3222e-07,
          3.1022e-06, 3.9252e-08]],

        [[2.7073e-08, 5.8041e-07, 9.9374e-07,  ..., 4.4135e-06,
          5.6103e-06, 2.4485e-06],
         [6.9531e-08, 7.3537e-08, 1.7773e-08,  ..., 1.9974e-06,
          4.0605e-06, 1.0568e-06],
         [1.2748e-07, 2.5988e-07, 5.9219e-06,  ..., 1.3410e-06,
          2.0039e-07, 4.5895e-05],
         ...,
         [3.7992e-07, 7.3182e-07, 1.1148e-07,  ..., 4.5282e-08,
          1.7764e-07, 5.7121e-07],
         [3.1167e-07, 2.5458e-07, 2.7932e-07,  ..., 2.2882e-06,
          4.6242e-08, 1.2365e-06],
         [7.2217e-07, 1.1822e-06, 9.0080e-08,  ..., 2.1431e-07,
          2.1961e-07, 4.0375e-06]],

        [[4.8160e-07, 8.3747e-08, 2.5593e-07,  ..., 1.7255e-06,
          3.4868e-09, 5.0358e-06],
         [1.7597e-07, 2.7078e-07, 2.2722e-06,  ..., 4.4366e-07,
          7.6472e-06, 2.3166e-06],
         [6.7858e-08, 3.2787e-06, 2.3912e-08,  ..., 1.8158e-04,
          9.3750e-05, 1.2119e-04],
         ...,
         [3.0987e-07, 5.8429e-08, 1.4586e-09,  ..., 4.5908e-10,
          3.7880e-07, 4.3274e-06],
         [1.4199e-07, 1.7298e-07, 2.2630e-08,  ..., 3.7573e-06,
          6.3658e-06, 2.6798e-09],
         [1.0443e-06, 1.7731e-06, 2.5105e-08,  ..., 8.9870e-07,
          1.3382e-08, 5.3019e-08]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[3.2075e-04, 5.3721e-04, 3.0225e-04,  ..., 7.0086e-04,
          1.6463e-04, 1.2507e-03],
         [3.0043e-04, 4.0677e-04, 1.1121e-03,  ..., 1.1039e-04,
          7.1858e-04, 8.5006e-04],
         [1.0031e-03, 1.0871e-03, 1.2757e-03,  ..., 5.8586e-04,
          4.6100e-04, 1.3008e-03],
         ...,
         [3.7295e-04, 6.1249e-04, 1.1882e-04,  ..., 2.3427e-04,
          3.1345e-04, 6.1051e-04],
         [1.0968e-03, 4.5546e-04, 1.2142e-03,  ..., 1.0131e-03,
          1.2610e-03, 9.9136e-04],
         [1.0216e-03, 4.5546e-04, 1.0365e-03,  ..., 8.5936e-04,
          6.0323e-04, 1.7096e-04]],

        [[7.0377e-04, 2.7847e-04, 4.5823e-04,  ..., 6.9115e-04,
          2.2727e-04, 8.2493e-04],
         [9.8404e-04, 4.5823e-04, 1.3920e-03,  ..., 6.9791e-04,
          6.6389e-05, 1.0081e-03],
         [1.5149e-03, 6.1660e-04, 1.3920e-03,  ..., 8.6050e-04,
          3.6190e-04, 2.4331e-04],
         ...,
         [5.0527e-04, 9.0952e-04, 2.1340e-04,  ..., 2.3921e-04,
          3.6962e-04, 6.5536e-04],
         [1.1545e-03, 6.4251e-04, 9.0952e-04,  ..., 5.4996e-04,
          9.1784e-04, 8.9756e-04],
         [1.1545e-03, 1.0216e-03, 1.2825e-03,  ..., 1.2236e-03,
          6.1549e-04, 7.0083e-04]],

        [[5.4235e-04, 1.0184e-03, 2.7847e-04,  ..., 5.2068e-05,
          4.9367e-04, 2.1348e-04],
         [5.0618e-04, 9.8404e-04, 9.7441e-04,  ..., 4.7902e-04,
          1.1211e-03, 3.0429e-04],
         [1.0611e-03, 8.7235e-04, 1.5149e-03,  ..., 7.7029e-04,
          8.5142e-04, 1.0670e-03],
         ...,
         [5.0527e-04, 7.6808e-04, 4.9939e-04,  ..., 4.6237e-04,
          5.8629e-04, 9.0262e-04],
         [4.5497e-04, 7.6808e-04, 6.4251e-04,  ..., 8.7099e-04,
          3.0113e-04, 1.7906e-04],
         [4.5497e-04, 6.5804e-04, 3.0336e-04,  ..., 9.0938e-04,
          8.4307e-04, 4.9410e-04]],

        ...,

        [[3.6356e-04, 2.9949e-04, 4.0197e-04,  ..., 5.6741e-04,
          4.6130e-04, 5.8989e-04],
         [7.7344e-04, 7.1446e-04, 4.9321e-04,  ..., 3.2698e-04,
          5.2275e-04, 6.7306e-03],
         [8.1136e-04, 2.3655e-04, 4.9776e-04,  ..., 4.8331e-04,
          8.4270e-03, 4.3270e-04],
         ...,
         [5.0472e-04, 2.7515e-04, 3.9961e-04,  ..., 5.8851e-04,
          8.2093e-04, 9.1779e-04],
         [8.4574e-04, 1.2200e-03, 1.1963e-03,  ..., 2.6951e-04,
          1.5427e-03, 4.5555e-04],
         [9.7600e-04, 1.2200e-03, 1.1227e-03,  ..., 8.6557e-04,
          7.6618e-04, 9.4122e-04]],

        [[3.6356e-04, 7.0153e-05, 4.4147e-04,  ..., 4.4568e-04,
          5.9339e-04, 4.8331e-04],
         [1.0421e-03, 7.7344e-04, 6.4473e-04,  ..., 1.1970e-03,
          8.0283e-04, 1.2561e-03],
         [8.5157e-04, 2.3655e-04, 1.0627e-03,  ..., 6.6011e-03,
          1.1240e-03, 1.5477e-04],
         ...,
         [1.0571e-03, 2.7515e-04, 8.6806e-04,  ..., 4.0073e-04,
          5.1714e-04, 6.0357e-04],
         [1.1963e-03, 1.2585e-03, 3.4870e-04,  ..., 1.9208e-04,
          9.9605e-04, 8.8210e-04],
         [1.3310e-03, 9.7600e-04, 1.0375e-03,  ..., 1.4831e-03,
          6.1462e-04, 1.3100e-03]],

        [[7.0153e-05, 5.5316e-04, 6.2821e-04,  ..., 7.0423e-04,
          2.2499e-04, 1.1143e-03],
         [1.0421e-03, 6.6100e-04, 9.5938e-04,  ..., 2.5671e-03,
          6.1079e-03, 1.0997e-03],
         [8.5157e-04, 8.3894e-04, 9.4519e-04,  ..., 7.8267e-03,
          1.9192e-03, 1.7514e-03],
         ...,
         [8.5838e-04, 8.6806e-04, 9.0845e-04,  ..., 4.6045e-04,
          6.0606e-04, 7.0613e-04],
         [1.2585e-03, 8.0379e-04, 1.6051e-03,  ..., 1.2277e-03,
          1.6663e-03, 5.8101e-04],
         [1.3310e-03, 1.6051e-03, 1.2267e-03,  ..., 9.6095e-04,
          7.5078e-04, 1.1133e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:4.458927154541016 loss2:1475.3446044921875


loss.item(): 29511.3515625


Finish constructing loss, calculating backward() ... 
