DIR_NAME: g:\Workspaces\Anaconda_ws\Semantic_Denoising_MVS\scripts 

cv_MatI numpy float32: 
[[ 63  64  65 ...  81 106 108]
 [ 63  62  65 ...  81 100 110]
 [ 61  64  62 ...  85 102 114]
 ...
 [ 62  62  62 ...  76  77  79]
 [ 62  62  64 ...  77  80  75]
 [ 63  63  63 ...  88  85  89]]
MatI: 
tensor([[ 63.,  64.,  65.,  ...,  81., 106., 108.],
        [ 63.,  62.,  65.,  ...,  81., 100., 110.],
        [ 61.,  64.,  62.,  ...,  85., 102., 114.],
        ...,
        [ 62.,  62.,  62.,  ...,  76.,  77.,  79.],
        [ 62.,  62.,  64.,  ...,  77.,  80.,  75.],
        [ 63.,  63.,  63.,  ...,  88.,  85.,  89.]])
MatI[0:10,35:45]: 
tensor([[ 67.,  68.,  87.,  86.,  85.,  87.,  86.,  85.,  87.,  85.],
        [ 68.,  69.,  76.,  79.,  83.,  83.,  87.,  85.,  78.,  79.],
        [ 68.,  73.,  67.,  82.,  79.,  83.,  95.,  84.,  83.,  83.],
        [ 68.,  69.,  69.,  77.,  85.,  85.,  87.,  94.,  76.,  85.],
        [ 68.,  69.,  74.,  79.,  83.,  82.,  94.,  97.,  89., 100.],
        [ 68.,  68.,  68.,  76.,  80.,  85.,  94.,  96., 103.,  98.],
        [ 68.,  67.,  67.,  77.,  86.,  79., 100.,  97.,  95., 111.],
        [ 67.,  67.,  73.,  66.,  75.,  81., 105., 101., 104., 113.],
        [ 66.,  66.,  67.,  76.,  69.,  69., 103., 112., 121., 111.],
        [ 66.,  67.,  66.,  69.,  69.,  74., 124., 105.,  99., 107.]]) 

debug:
MatD.shape: torch.Size([56, 123]) 
has nan? False 
MatD: 
tensor([[0.0159, 0.0156, 0.0154,  ..., 0.0123, 0.0094, 0.0093],
        [0.0159, 0.0161, 0.0154,  ..., 0.0123, 0.0100, 0.0091],
        [0.0164, 0.0156, 0.0161,  ..., 0.0118, 0.0098, 0.0088],
        ...,
        [0.0161, 0.0161, 0.0161,  ..., 0.0132, 0.0130, 0.0127],
        [0.0161, 0.0161, 0.0156,  ..., 0.0130, 0.0125, 0.0133],
        [0.0159, 0.0159, 0.0159,  ..., 0.0114, 0.0118, 0.0112]]) 

MatU.shape: torch.Size([56, 123, 2]) 
has nan? False 
MatUx: 
tensor([[-2.4802e-04, -2.4038e-04,  1.0088e-03,  ..., -2.9117e-03,
         -1.7470e-04, -1.7470e-04],
        [ 2.5602e-04, -7.4442e-04,  1.2821e-03,  ..., -2.3457e-03,
         -9.0909e-04, -9.0909e-04],
        [-7.6844e-04,  5.0403e-04,  2.6441e-04,  ..., -1.9608e-03,
         -1.0320e-03, -1.0320e-03],
        ...,
        [ 1.0000e-10,  1.0000e-10, -2.5601e-04,  ..., -1.7088e-04,
         -3.2878e-04, -3.2878e-04],
        [ 1.0000e-10, -5.0403e-04,  5.0403e-04,  ..., -4.8701e-04,
          8.3333e-04,  8.3333e-04],
        [ 1.0000e-10,  1.0000e-10,  2.5602e-04,  ...,  4.0107e-04,
         -5.2875e-04, -5.2875e-04]]) 




MatD[0:10,35:45]: 
tensor([[0.0149, 0.0147, 0.0115, 0.0116, 0.0118, 0.0115, 0.0116, 0.0118, 0.0115,
         0.0118],
        [0.0147, 0.0145, 0.0132, 0.0127, 0.0120, 0.0120, 0.0115, 0.0118, 0.0128,
         0.0127],
        [0.0147, 0.0137, 0.0149, 0.0122, 0.0127, 0.0120, 0.0105, 0.0119, 0.0120,
         0.0120],
        [0.0147, 0.0145, 0.0145, 0.0130, 0.0118, 0.0118, 0.0115, 0.0106, 0.0132,
         0.0118],
        [0.0147, 0.0145, 0.0135, 0.0127, 0.0120, 0.0122, 0.0106, 0.0103, 0.0112,
         0.0100],
        [0.0147, 0.0147, 0.0147, 0.0132, 0.0125, 0.0118, 0.0106, 0.0104, 0.0097,
         0.0102],
        [0.0147, 0.0149, 0.0149, 0.0130, 0.0116, 0.0127, 0.0100, 0.0103, 0.0105,
         0.0090],
        [0.0149, 0.0149, 0.0137, 0.0152, 0.0133, 0.0123, 0.0095, 0.0099, 0.0096,
         0.0088],
        [0.0152, 0.0152, 0.0149, 0.0132, 0.0145, 0.0145, 0.0097, 0.0089, 0.0083,
         0.0090],
        [0.0152, 0.0149, 0.0152, 0.0145, 0.0145, 0.0135, 0.0081, 0.0095, 0.0101,
         0.0093]]) 

MatU[0:10,35:45]: 
tensor([[[-2.1949e-04, -2.1949e-04],
         [-3.2116e-03, -2.1313e-04],
         [ 1.3365e-04,  1.6636e-03],
         [ 1.3680e-04,  1.0303e-03],
         [-2.7045e-04,  2.8349e-04],
         [ 1.3365e-04,  5.5394e-04],
         [ 1.3680e-04, -1.3365e-04],
         [-2.7045e-04,  1.0000e-10],
         [ 2.7045e-04,  1.3263e-03],
         [-1.3680e-04,  8.9352e-04]],

        [[-2.1313e-04,  1.0000e-10],
         [-1.3349e-03, -7.9412e-04],
         [-4.9967e-04,  1.7675e-03],
         [-6.1004e-04, -4.6311e-04],
         [ 1.0000e-10,  6.1004e-04],
         [-5.5394e-04,  1.0000e-10],
         [ 2.7045e-04, -9.6794e-04],
         [ 1.0558e-03,  1.4006e-04],
         [-1.6228e-04, -7.7232e-04],
         [-1.1640e-03, -6.1004e-04]],

        [[-1.0073e-03,  1.0000e-10],
         [ 1.2267e-03,  7.9412e-04],
         [-2.7303e-03, -4.3262e-04],
         [ 4.6311e-04,  7.9189e-04],
         [-6.1004e-04, -8.9352e-04],
         [-1.5219e-03, -2.8349e-04],
         [ 1.3784e-03,  9.6794e-04],
         [ 1.4343e-04, -1.2665e-03],
         [ 1.0000e-10,  1.1097e-03],
         [ 4.5181e-04, -2.8349e-04]],

        [[-2.1313e-04,  1.0000e-10],
         [ 1.0000e-10,  1.0000e-10],
         [-1.5057e-03, -9.7924e-04],
         [-1.2223e-03, -3.2878e-04],
         [ 1.0000e-10,  2.8349e-04],
         [-2.7045e-04,  4.3042e-04],
         [-8.5596e-04, -8.5596e-04],
         [ 2.5196e-03, -3.2902e-04],
         [-1.3932e-03, -1.9219e-03],
         [-2.7045e-04, -1.7647e-03]],

        [[-2.1313e-04,  1.0000e-10],
         [-9.7924e-04,  2.1313e-04],
         [-8.5529e-04,  1.1924e-03],
         [-6.1004e-04,  4.9967e-04],
         [ 1.4693e-04,  4.5181e-04],
         [-1.5568e-03, -4.3042e-04],
         [-3.2902e-04,  1.0000e-10],
         [ 9.2668e-04,  1.0739e-04],
         [-1.2360e-03, -1.5272e-03],
         [ 6.3830e-04,  2.0408e-04]],

        [[ 1.0000e-10,  1.0000e-10],
         [ 1.0000e-10,  2.1949e-04],
         [-1.5480e-03,  2.1949e-04],
         [-6.5789e-04, -1.7088e-04],
         [-7.3529e-04, -8.7209e-04],
         [-1.1264e-03,  8.9352e-04],
         [-2.2163e-04, -6.3830e-04],
         [-7.0793e-04, -1.0739e-04],
         [ 4.9534e-04,  8.1758e-04],
         [-6.8027e-04, -1.1951e-03]],

        [[ 2.1949e-04,  2.1949e-04],
         [ 1.0000e-10,  1.0000e-10],
         [-1.9384e-03, -1.2267e-03],
         [-1.3591e-03,  2.1645e-03],
         [ 1.0303e-03,  1.7054e-03],
         [-2.6582e-03, -3.1255e-04],
         [ 3.0928e-04, -4.7619e-04],
         [ 2.1704e-04, -4.0829e-04],
         [-1.5173e-03, -9.1093e-04],
         [ 1.3003e-03, -1.5945e-04]],

        [[ 1.0000e-10,  2.2614e-04],
         [-1.2267e-03,  2.2614e-04],
         [ 1.4529e-03,  1.2267e-03],
         [-1.8182e-03, -1.9936e-03],
         [-9.8765e-04,  1.1594e-03],
         [-2.8219e-03,  2.1471e-03],
         [ 3.7718e-04,  1.8493e-04],
         [-2.8560e-04, -9.7242e-04],
         [-7.6583e-04, -1.3509e-03],
         [ 9.5436e-04,  1.5945e-04]],

        [[ 1.0000e-10,  1.0000e-10],
         [-2.2614e-04, -2.2614e-04],
         [-1.7675e-03,  2.2614e-04],
         [ 1.3349e-03,  1.3349e-03],
         [ 1.0000e-10,  1.0000e-10],
         [-4.7840e-03, -9.7924e-04],
         [-7.8017e-04, -1.6442e-03],
         [-6.6411e-04,  5.9524e-04],
         [ 7.4455e-04,  1.8365e-03],
         [ 1.1951e-03,  3.3678e-04]],

        [[-2.2614e-04,  1.0000e-10],
         [ 2.2614e-04,  1.0000e-10],
         [-6.5876e-04, -1.0670e-03],
         [ 1.0000e-10,  4.3262e-04],
         [-9.7924e-04, -7.9412e-04],
         [-5.4490e-03,  7.7220e-04],
         [ 1.4593e-03,  2.6882e-04],
         [ 5.7720e-04,  2.8011e-04],
         [-7.5522e-04, -2.1010e-03],
         [ 5.5520e-04,  1.2925e-03]]]) 

test_counter in loss_omega_mat(): 688
test_counter in loss_omega_mat(): 1376
test_counter in loss_omega_mat(): 2064
test_counter in loss_omega_mat(): 2752
test_counter in loss_omega_mat(): 3440
test_counter in loss_omega_mat(): 4128
test_counter in loss_omega_mat(): 4816
test_counter in loss_omega_mat(): 5504
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9455, 0.9455, 0.9454,  ..., 0.8944, 0.8004, 0.8004],
         [0.9455, 0.9455, 0.9453,  ..., 0.8944, 0.8005, 0.8004],
         [0.9456, 0.9455, 0.9455,  ..., 0.8944, 0.8005, 0.8004],
         ...,
         [0.9457, 0.9456, 0.9454,  ..., 0.8942, 0.8005, 0.8002],
         [0.9458, 0.9457, 0.9454,  ..., 0.8942, 0.8006, 0.8005],
         [0.9458, 0.9457, 0.9457,  ..., 0.8943, 0.8006, 0.8005]],

        [[0.9458, 0.9455, 0.9455,  ..., 0.8944, 0.8005, 0.8004],
         [0.9458, 0.9455, 0.9453,  ..., 0.8944, 0.8005, 0.8004],
         [0.9458, 0.9456, 0.9455,  ..., 0.8944, 0.8005, 0.8005],
         ...,
         [0.9457, 0.9457, 0.9455,  ..., 0.8943, 0.8006, 0.8003],
         [0.9458, 0.9458, 0.9455,  ..., 0.8943, 0.8006, 0.8005],
         [0.9458, 0.9458, 0.9458,  ..., 0.8944, 0.8007, 0.8006]],

        [[0.9459, 0.9458, 0.9458,  ..., 0.8946, 0.8007, 0.8006],
         [0.9459, 0.9459, 0.9458,  ..., 0.8946, 0.8007, 0.8006],
         [0.9459, 0.9459, 0.9459,  ..., 0.8945, 0.8007, 0.8007],
         ...,
         [0.9458, 0.9457, 0.9457,  ..., 0.8942, 0.8005, 0.8005],
         [0.9458, 0.9458, 0.9458,  ..., 0.8945, 0.8006, 0.8006],
         [0.9458, 0.9458, 0.9458,  ..., 0.8945, 0.8006, 0.8006]],

        ...,

        [[0.9447, 0.9432, 0.9421,  ..., 0.8915, 0.7985, 0.7979],
         [0.9422, 0.9389, 0.9355,  ..., 0.8887, 0.7971, 0.7969],
         [0.9420, 0.9356, 0.9355,  ..., 0.8864, 0.7966, 0.7966],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.8947, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9458,  ..., 0.8939, 0.8007, 0.8007],
         [0.9458, 0.9456, 0.9450,  ..., 0.8935, 0.8004, 0.8003]],

        [[0.9444, 0.9421, 0.9415,  ..., 0.8887, 0.7993, 0.7981],
         [0.9371, 0.9341, 0.9335,  ..., 0.8854, 0.7946, 0.7941],
         [0.9331, 0.9331, 0.9306,  ..., 0.8834, 0.7938, 0.7935],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.8947, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9459,  ..., 0.8940, 0.8007, 0.8006],
         [0.9458, 0.9457, 0.9453,  ..., 0.8938, 0.8004, 0.8003]],

        [[0.9438, 0.9435, 0.9415,  ..., 0.8881, 0.7995, 0.7976],
         [0.9364, 0.9362, 0.9335,  ..., 0.8834, 0.7941, 0.7921],
         [0.9355, 0.9331, 0.9277,  ..., 0.8817, 0.7921, 0.7915],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.8944, 0.8007, 0.8007],
         [0.9459, 0.9458, 0.9457,  ..., 0.8938, 0.8006, 0.8006],
         [0.9458, 0.9457, 0.9455,  ..., 0.8937, 0.8003, 0.7998]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[4.0583e-06, 1.4488e-06, 6.5750e-07,  ..., 1.4488e-06,
          7.2304e-06, 1.1562e-06],
         [6.2988e-07, 1.2128e-05, 6.2988e-07,  ..., 2.2061e-06,
          1.8252e-07, 4.0583e-06],
         [6.9913e-08, 2.9861e-07, 6.9913e-08,  ..., 6.5750e-07,
          6.4328e-07, 7.4652e-08],
         ...,
         [3.0685e-07, 1.9878e-06, 3.0685e-07,  ..., 5.6655e-06,
          4.3867e-06, 2.5598e-06],
         [1.6086e-07, 1.4982e-07, 2.8675e-06,  ..., 5.6546e-06,
          2.7775e-06, 2.7311e-06],
         [7.3145e-08, 8.8773e-07, 7.3145e-08,  ..., 2.2914e-06,
          2.8930e-07, 1.8044e-06]],

        [[7.6233e-21, 6.5544e-08, 7.9310e-08,  ..., 1.4488e-06,
          6.5544e-08, 2.6217e-07],
         [6.9913e-08, 4.7835e-07, 6.9913e-08,  ..., 2.4652e-06,
          6.1597e-07, 7.0472e-11],
         [6.9913e-08, 6.9913e-08, 2.8905e-07,  ..., 8.8219e-07,
          6.9913e-08, 4.0000e-20],
         ...,
         [3.4281e-07, 1.6086e-07, 1.6086e-07,  ..., 9.1204e-07,
          2.9258e-07, 6.8242e-08],
         [1.6986e-10, 7.2493e-07, 7.2493e-07,  ..., 6.6567e-07,
          7.3145e-08, 2.0518e-06],
         [1.7863e-08, 1.7061e-08, 1.7863e-08,  ..., 4.7279e-07,
          1.7061e-08, 1.6852e-07]],

        [[2.7084e-07, 2.7084e-07, 2.7084e-07,  ..., 2.7084e-07,
          2.7084e-07, 1.0834e-06],
         [1.0000e-20, 1.0000e-20, 2.7084e-07,  ..., 6.9913e-08,
          2.7084e-07, 6.9913e-08],
         [6.5544e-08, 6.5544e-08, 6.9913e-08,  ..., 1.7037e-06,
          1.1009e-06, 2.7965e-07],
         ...,
         [7.2493e-07, 7.2493e-07, 1.2380e-06,  ..., 7.2493e-07,
          3.3616e-06, 1.5345e-06],
         [1.7863e-08, 1.7863e-08, 1.6867e-06,  ..., 5.8594e-06,
          5.1520e-07, 5.1957e-07],
         [7.6233e-21, 1.5834e-07, 7.6233e-21,  ..., 1.5346e-07,
          6.2855e-07, 1.5594e-07]],

        ...,

        [[2.6774e-06, 6.9913e-08, 2.6774e-06,  ..., 1.0607e-05,
          1.0710e-05, 9.5554e-07],
         [1.1292e-09, 2.3942e-05, 1.9264e-05,  ..., 3.6305e-05,
          1.0162e-06, 9.5769e-05],
         [2.3731e-06, 2.2881e-05, 1.4040e-05,  ..., 1.5553e-07,
          1.1032e-05, 4.8858e-05],
         ...,
         [1.0000e-20, 1.2023e-08, 1.0000e-20,  ..., 0.0000e+00,
          4.0000e-20, 4.0000e-20],
         [1.0000e-20, 1.0000e-20, 1.0000e-20,  ..., 1.2540e-08,
          1.2540e-08, 1.2023e-08],
         [4.0801e-06, 5.0351e-06, 1.2540e-08,  ..., 5.0351e-06,
          1.0636e-05, 1.3535e-05]],

        [[9.0995e-06, 2.6261e-06, 2.1502e-05,  ..., 9.0047e-06,
          3.4925e-05, 1.9332e-05],
         [4.2427e-05, 1.5688e-04, 1.9142e-05,  ..., 1.3960e-04,
          4.2827e-04, 1.3011e-04],
         [6.3063e-06, 8.6310e-05, 6.3063e-06,  ..., 4.7423e-05,
          2.3525e-04, 4.6193e-04],
         ...,
         [1.0000e-20, 1.2023e-08, 1.2023e-08,  ..., 1.2023e-08,
          1.2023e-08, 4.8092e-08],
         [1.2540e-08, 1.0000e-20, 1.2540e-08,  ..., 1.2540e-08,
          4.0000e-20, 5.0159e-08],
         [7.7023e-07, 2.6708e-07, 1.3020e-07,  ..., 6.4350e-06,
          3.9173e-06, 7.2729e-07]],

        [[1.4172e-06, 3.6465e-07, 7.6205e-06,  ..., 1.6267e-05,
          5.1625e-06, 6.2726e-06],
         [6.3063e-06, 8.5251e-08, 5.5358e-05,  ..., 3.4743e-06,
          2.4853e-05, 1.3702e-06],
         [2.7662e-05, 2.0674e-04, 2.2503e-05,  ..., 6.0384e-05,
          1.0088e-04, 8.1559e-06],
         ...,
         [4.8092e-08, 1.9862e-07, 1.0376e-20,  ..., 5.4374e-12,
          1.0821e-07, 1.0821e-07],
         [3.4199e-07, 5.4388e-12, 2.2355e-07,  ..., 2.9334e-07,
          1.3679e-06, 2.0280e-07],
         [8.0364e-08, 2.1554e-07, 4.7334e-09,  ..., 8.1354e-08,
          1.6625e-06, 3.7546e-07]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[2.1716e-03, 1.5117e-03, 2.0330e-03,  ..., 1.8984e-03,
          2.3247e-03, 1.4681e-03],
         [1.5455e-03, 3.3599e-03, 2.5029e-03,  ..., 1.8705e-03,
          2.1216e-03, 1.9825e-03],
         [3.8640e-04, 9.7781e-04, 8.4731e-04,  ..., 1.2037e-03,
          6.0308e-04, 3.6846e-04],
         ...,
         [1.5072e-03, 9.0618e-04, 2.3843e-03,  ..., 1.5692e-03,
          8.4213e-04, 1.3706e-03],
         [9.5853e-04, 2.4404e-04, 2.3843e-03,  ..., 2.4087e-03,
          5.6891e-04, 1.1947e-03],
         [4.0108e-04, 1.3706e-03, 5.6720e-04,  ..., 9.4457e-04,
          7.7370e-04, 1.3656e-04]],

        [[8.1756e-04, 5.7999e-04, 1.5117e-03,  ..., 2.3320e-03,
          8.1756e-04, 8.3392e-04],
         [5.7999e-04, 1.5455e-03, 3.6206e-04,  ..., 2.2603e-03,
          7.7649e-04, 9.4170e-04],
         [7.4195e-04, 5.8374e-04, 8.4731e-04,  ..., 1.8705e-03,
          2.6441e-04, 5.2042e-04],
         ...,
         [1.5072e-03, 7.5802e-04, 8.9383e-04,  ..., 9.6717e-04,
          3.0034e-04, 3.7813e-04],
         [9.5853e-04, 1.5006e-03, 5.2272e-04,  ..., 1.7027e-03,
          4.6867e-04, 7.4932e-04],
         [4.7768e-04, 4.0108e-04, 5.7018e-04,  ..., 8.0164e-04,
          3.0380e-06, 1.0417e-03]],

        [[0.0000e+00, 5.2042e-04, 1.0408e-03,  ..., 5.8374e-04,
          1.0739e-03, 8.3654e-04],
         [3.7393e-04, 5.8374e-04, 5.2042e-04,  ..., 3.6206e-04,
          5.7999e-04, 3.6804e-04],
         [5.2049e-04, 1.1637e-03, 5.8374e-04,  ..., 1.1040e-03,
          1.0739e-03, 5.8374e-04],
         ...,
         [1.9631e-03, 9.9069e-04, 7.5802e-04,  ..., 8.6185e-04,
          8.4839e-04, 8.4213e-04],
         [1.1468e-03, 7.4190e-04, 1.5006e-03,  ..., 1.2232e-03,
          1.6744e-03, 1.6406e-03],
         [4.7516e-04, 4.7768e-04, 9.8494e-04,  ..., 8.4527e-04,
          7.7370e-04, 5.5117e-04]],

        ...,

        [[1.6363e-03, 1.3988e-03, 4.4392e-03,  ..., 9.0658e-03,
          1.6363e-03, 3.0397e-03],
         [4.3885e-03, 3.2956e-03, 8.2018e-03,  ..., 6.8507e-03,
          5.4360e-03, 4.9190e-03],
         [3.7034e-03, 5.4594e-03, 8.2018e-03,  ..., 9.1725e-03,
          3.1913e-03, 5.1166e-03],
         ...,
         [1.0965e-04, 1.5507e-04, 0.0000e+00,  ..., 1.1198e-04,
          1.1198e-04, 1.5507e-04],
         [0.0000e+00, 1.1198e-04, 1.1198e-04,  ..., 2.0230e-03,
          1.5837e-04, 8.9956e-04],
         [1.1979e-03, 2.5040e-04, 2.1349e-03,  ..., 2.0230e-03,
          1.0154e-03, 1.3119e-03]],

        [[1.8265e-03, 4.4392e-03, 3.8523e-03,  ..., 6.8507e-03,
          2.1915e-03, 3.6447e-03],
         [1.1049e-02, 1.1516e-02, 1.2802e-02,  ..., 3.2489e-03,
          9.4673e-03, 9.6589e-03],
         [1.4966e-02, 1.2633e-02, 1.2414e-02,  ..., 7.1342e-03,
          1.0625e-02, 1.0323e-02],
         ...,
         [1.0965e-04, 2.4518e-04, 3.3602e-04,  ..., 6.2538e-04,
          2.4518e-04, 1.0965e-04],
         [1.1198e-04, 1.5673e-04, 4.8589e-04,  ..., 2.0230e-03,
          2.5256e-04, 0.0000e+00],
         [1.1979e-03, 1.8826e-04, 9.9689e-04,  ..., 1.7997e-03,
          1.1847e-03, 4.0605e-04]],

        [[1.5609e-03, 3.4938e-03, 3.8523e-03,  ..., 1.0425e-02,
          3.0256e-03, 1.4234e-03],
         [2.2328e-03, 2.8205e-03, 1.2802e-02,  ..., 7.1342e-03,
          5.6894e-03, 3.5747e-03],
         [7.3448e-04, 1.4966e-02, 1.0249e-02,  ..., 8.6707e-03,
          4.5902e-03, 6.1487e-03],
         ...,
         [2.4518e-04, 4.9881e-04, 9.9194e-04,  ..., 1.1278e-03,
          1.5507e-04, 1.1675e-04],
         [4.8589e-04, 4.7515e-04, 7.2748e-04,  ..., 6.3813e-04,
          5.9542e-04, 9.4823e-04],
         [5.8743e-04, 1.8826e-04, 6.4610e-04,  ..., 1.4246e-03,
          1.3119e-03, 9.9021e-04]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:308.89593505859375
t:0, Finish constructing loss
require grad ? True True False
MatD grad and MatUx grad: torch.Size([56, 123]) torch.Size([56, 123, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  2.8531e-02,  1.0069e-02, -5.6164e-03,
         -6.8602e-03,  0.0000e+00, -1.3019e-02,  0.0000e+00,  0.0000e+00],
        [-7.9057e-03,  7.6617e-02, -4.6708e-01, -2.2746e+00,  2.2248e+00,
         -3.8207e+00, -2.0736e+00,  1.1213e-02, -5.0626e-02,  1.4393e-02],
        [-2.2995e+00, -4.1615e+00, -3.4088e+00, -1.4933e+00, -1.1270e+01,
         -4.9649e+00,  4.3675e+00, -3.0918e+00,  1.1861e+01,  3.8570e+00],
        [ 4.5507e+00, -1.0943e+01, -2.5359e+01, -1.8497e+01, -1.4908e+01,
          9.5709e+00, -2.3998e+01, -1.0213e+01,  1.0509e+01, -1.5467e+01],
        [ 2.6567e+00,  5.8431e+00,  2.2961e+01, -2.0425e+00,  6.5308e-01,
          5.3385e+00, -1.2388e+01, -6.3493e+00, -1.7912e+01,  1.6755e+01],
        [-2.8631e+01,  2.6563e+01,  1.6486e+01, -1.4215e+00, -2.4552e+01,
          2.2947e+01, -3.2651e+01,  1.6781e+01,  2.9278e+01, -1.7231e+01],
        [-2.7575e+01, -9.2207e+00, -2.9644e+01,  3.3069e+01,  2.2273e+00,
         -5.0109e+00, -2.9410e+01,  1.3609e+01,  8.9336e+00, -1.4969e+01],
        [-6.1525e-01,  1.9934e+01,  1.1206e+01, -3.5147e+01,  1.7243e+01,
          2.0605e+01, -9.1955e+00, -1.8732e+01, -2.4653e+01, -2.6411e+01],
        [-1.6134e+01, -4.5558e+00,  2.3078e+01,  3.4181e+00,  3.3906e+00,
          6.0438e+00, -2.3879e+01,  3.1112e+01,  2.3437e+01, -1.4225e+01]]) 

MatU.grad[0:10,35:45]: 
tensor([[[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -21.1682,  -18.3460],
         [  27.0269,    7.3596],
         [ -13.7409,  -24.4213],
         [   6.4839,   27.2600],
         [  24.3691,   13.8145],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   8.1112,  -30.6161],
         [  81.8877,  -32.4648],
         [ -37.3525, -115.0722],
         [ -81.1614,  -80.0603],
         [  51.2107,    1.3030],
         [  25.1097,   34.4850],
         [ -44.6187,  -68.4019],
         [  92.7566,   -2.8219],
         [ -57.3830,  -73.9227],
         [  24.1442,  -67.8044]],

        [[-152.5885,  -81.2555],
         [-292.7151,   17.0295],
         [   1.1891,  465.1825],
         [  11.0146,  110.4164],
         [ 339.7263,  138.5498],
         [-322.0179, -122.9460],
         [   7.1066,  112.3537],
         [ 386.6537,   77.7744],
         [-331.0944, -278.1118],
         [ 180.8136,  180.0251]],

        [[ 100.8399, -167.0968],
         [ 233.1552,  211.6442],
         [-418.9594,  -15.2354],
         [  80.5120, -130.9604],
         [  19.0190, -496.8433],
         [-180.5923,  309.1177],
         [  38.0769, -300.1615],
         [-325.9818,  230.0143],
         [ 200.2093,  487.4330],
         [-210.9280, -366.7648]],

        [[ 517.2060,  143.1422],
         [ 142.0777, -237.2816],
         [-328.9656, -358.0960],
         [-220.4418,  485.3964],
         [ 477.7474,  289.0978],
         [-433.3799, -133.5745],
         [ 473.4475, -138.7328],
         [ 168.3708,  -38.7123],
         [-567.0809, -156.2738],
         [ 556.1782,  -82.1143]],

        [[  64.2818,  156.6932],
         [-392.3367,  111.4632],
         [ 538.0710,  219.7252],
         [-260.5640, -521.0628],
         [  -3.5091,  168.7507],
         [-292.1360,  400.1038],
         [ 315.3364,  260.6717],
         [  15.8342, -295.3777],
         [-267.8812, -363.2106],
         [ 269.8493,   95.0713]],

        [[ 257.4803,  -78.1146],
         [ -45.9963, -286.1932],
         [-521.8000,  127.3283],
         [ 392.1863,  336.5464],
         [ 260.2842, -146.6652],
         [-421.6036, -232.1585],
         [-103.9639, -432.3133],
         [-330.1266,  350.4733],
         [ 157.2704,  600.7153],
         [ 455.5799,  137.3251]],

        [[ -46.6861,  104.0443],
         [ 518.7349,   22.3042],
         [-153.0560, -523.3743],
         [  36.3028,  213.2493],
         [ -45.5791, -313.6373],
         [-399.4607,  212.5197],
         [ 524.0701,  176.7964],
         [  -2.0626,   14.5235],
         [-201.7064, -506.4336],
         [ -26.1573,  332.3099]]]) 

MatD.grad: 
tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0062,  ..., -0.0036,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ..., -0.0016,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -25.1473,   12.3675],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  30.8086,    5.5489],
         [   2.2527,   -0.7114],
         [   4.3664,  -77.6345],
         [   4.2337,   42.2887],
         [ -55.2333,    8.0960],
         [ -86.5710,   22.1447],
         [   0.0000,   95.7439]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  64.0888,    3.9505],
         [-407.8800,  -95.4192],
         [ 433.3497,  228.9656],
         [-190.8247, -326.6885],
         [  15.5905, -293.7907],
         [  28.2269,  130.8685],
         [  58.7893,   34.9703]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   8.5999,   26.6598],
         [  15.1269,   56.9748],
         [-205.1369, -230.3159],
         [ 167.1736,  396.5114],
         [-133.9834,  286.8222],
         [ 360.7518, -338.6215],
         [ -67.8633,   96.7189],
         [   6.4492,   51.9253]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -86.9130,   21.7799],
         [ 428.4470,  -57.2126],
         [ -37.4446,   15.7689],
         [-573.8359, -194.1752],
         [ 495.4641,  328.4255],
         [-136.6944,  113.7896],
         [  37.1139,  116.1030]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -26.4949,   -9.1213],
         [-108.9822,  -41.1062],
         [ 418.7496,  -17.3605],
         [-246.1085, -325.9621],
         [   6.4405, -382.7556],
         [ 295.1322,  -31.3387],
         [-117.0083, -539.9286],
         [ -44.2817, -599.4843]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -50.6275,   17.5509],
         [ 115.5602,  441.4322],
         [-357.1584,  149.5788],
         [ 213.9831,  530.5530],
         [ -35.0624,  411.1417],
         [-115.6168,  482.3217],
         [ 406.3480,  268.9928]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  28.0230,    0.0000],
         [  52.8140,  -95.5321],
         [-420.1584, -169.0260],
         [ 347.1792,  181.6841],
         [  73.4931, -219.7966],
         [  -0.8798, -230.0406],
         [-420.8524,  -75.7105],
         [ 453.6130,  -88.8010]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[ 1.7974e-01,  2.9222e+01],
         [ 1.2248e+02,  5.2969e+01],
         [ 2.2012e+02,  6.2837e+01],
         [ 3.3048e+02,  4.0411e+01],
         [-1.7783e+02, -1.4514e+02],
         [-5.4796e+01, -5.1698e+02],
         [-9.5690e+01, -1.5824e+02],
         [ 2.9313e+02, -4.6419e+02],
         [ 4.1325e+01, -8.4748e+01],
         [-4.0339e+02, -4.7108e+02]],

        [[-2.7582e+01,  5.5383e+02],
         [ 2.1105e+02,  1.3623e+01],
         [ 1.8729e+02,  4.0067e+01],
         [ 6.2448e+01, -4.7135e+02],
         [-4.5785e+02, -3.8612e+02],
         [ 3.1958e+02,  6.9711e+01],
         [-3.8121e+02,  3.1896e+02],
         [ 5.8744e+02,  2.4247e+02],
         [-4.0454e+02, -1.5378e+02],
         [-1.1952e+02,  4.8911e+02]],

        [[-4.9937e+02,  7.3115e+00],
         [ 2.1737e+02, -3.6985e+01],
         [-4.8150e+02, -2.4368e+02],
         [-2.5291e+02,  3.9539e+02],
         [ 9.5742e+01,  4.3631e+02],
         [ 2.3445e+02,  4.7450e+02],
         [-1.8940e+02, -5.0231e+02],
         [-3.1107e+01,  1.2102e+02],
         [ 3.7469e+02,  3.4484e+02],
         [ 5.6646e+01, -4.6271e+02]],

        [[-4.2860e+02,  1.5571e+00],
         [-6.4475e+01,  9.1655e+01],
         [ 4.4819e+02, -2.0344e+01],
         [-2.6129e+00, -2.7519e+02],
         [ 3.0089e+02, -3.9935e+02],
         [-4.8645e+02, -3.5723e+02],
         [ 4.7661e+02,  3.3600e+02],
         [ 2.4831e+02, -2.7941e+02],
         [-4.9651e+02, -2.2610e+02],
         [ 8.2879e+01,  2.5232e+01]],

        [[-1.9420e+02, -5.2006e+02],
         [-1.9557e+02,  4.8839e+02],
         [ 1.0268e+02,  6.4994e+01],
         [-3.6923e+02, -9.7833e+01],
         [-2.0464e+02,  4.0286e+02],
         [ 2.7306e+02, -8.0581e+00],
         [-2.3192e+02,  1.3188e+02],
         [ 1.4888e+02,  4.3288e+02],
         [-2.7641e+02, -1.8493e+02],
         [ 4.6385e+02, -1.1510e+02]],

        [[ 4.9980e+02,  3.4325e+02],
         [-4.9212e+02, -2.9023e+02],
         [-7.3827e+00,  4.2173e+02],
         [ 3.8549e+02,  3.0550e+01],
         [-4.7902e+02,  1.8081e+02],
         [ 3.2196e+02,  5.1159e+02],
         [ 1.0121e+02, -4.4275e+02],
         [-5.9044e+02, -2.6302e+02],
         [-1.8934e+02,  3.4287e+02],
         [ 4.4407e+02,  3.5967e+02]],

        [[ 2.1581e+00, -3.9437e+02],
         [ 1.8648e+02,  4.6733e+01],
         [-3.2765e+02, -2.7009e+02],
         [ 5.3942e+02, -2.2900e+02],
         [-1.8121e+00, -5.8925e+02],
         [-4.7461e+02, -3.1865e+02],
         [ 1.8683e+02,  1.6104e+02],
         [ 1.8649e+02, -2.1393e+02],
         [ 1.3461e+02, -3.1739e+02],
         [-2.8251e+02, -4.5321e+02]],

        [[ 4.3959e+02, -1.0784e+01],
         [-1.4402e+02,  2.4044e+02],
         [-4.6880e+02,  1.0984e+02],
         [-5.4400e+01,  4.1627e+02],
         [ 2.5386e+02,  5.2379e+02],
         [-1.3159e+02, -1.0169e+02],
         [-2.7941e+02,  1.9592e+02],
         [ 2.8347e+01,  5.0141e+02],
         [-3.0958e+02,  4.7126e+02],
         [ 3.3950e+02,  5.3772e+02]],

        [[ 5.8442e+02,  1.4433e+02],
         [-1.3802e+02, -2.0984e+02],
         [ 1.1879e+01, -5.5126e+02],
         [ 1.1639e+02, -2.6875e+02],
         [-3.5247e+02,  1.7962e+02],
         [ 1.7473e+02, -7.4226e+01],
         [ 4.3454e+02, -9.1815e+01],
         [-5.9726e+01, -4.1643e+02],
         [ 1.7342e+01,  2.1112e+02],
         [-1.4864e+02, -2.1174e+01]],

        [[ 1.1433e+01, -1.7955e+01],
         [-4.8835e+02, -2.7362e+02],
         [ 3.3647e+02,  4.8021e+02],
         [ 3.8788e+02,  3.4932e+01],
         [-4.3154e+02, -9.4846e+01],
         [ 9.3885e+01, -5.0616e+02],
         [ 7.1225e+01,  3.9719e+02],
         [ 5.4754e+02, -1.5860e+02],
         [-1.3305e+02, -4.9013e+02],
         [-4.8057e+02, -3.6938e+02]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[ 132.4102,   79.8967],
         [ 104.6957, -472.8951],
         [-419.7933, -448.2411],
         [ -58.7280,  424.7520],
         [ 231.3188, -343.6718],
         [-239.9074,  160.6665],
         [ 334.1654,   54.7130],
         [  56.3212,  283.6293],
         [ 111.4950,  -60.5618],
         [-256.1548, -212.8604]],

        [[-404.5586, -402.0443],
         [  67.7845,  393.1137],
         [ 365.6425,  -33.6631],
         [-627.8022,   69.1289],
         [ 437.1218,  432.7571],
         [ -92.7931, -180.7819],
         [ 434.1141, -110.8228],
         [-209.6978, -541.3244],
         [ -38.1593,  475.2143],
         [ 119.2975, -434.6550]],

        [[ 401.7371,   44.9809],
         [ -90.3588, -313.2233],
         [ 267.4791,  423.5932],
         [ -88.3712, -402.2978],
         [-233.6637, -319.5455],
         [-495.3538,  101.0742],
         [ -30.9899,  194.3427],
         [ 438.8662,  136.4588],
         [-263.2509,  428.1879],
         [ 286.2605,  215.8224]],

        [[ -76.2977,  531.5784],
         [ 555.0746,  -36.9698],
         [-382.5121, -417.0177],
         [ -65.5767,  458.2043],
         [ 160.9645,  -98.6024],
         [-112.0126,  211.2028],
         [ 225.6758,    6.6948],
         [ 522.2899, -109.7905],
         [-409.9463, -343.1366],
         [-184.3017,  -71.4430]],

        [[-451.9771, -435.0675],
         [ -99.7726,  282.9023],
         [ 365.2589, -119.7121],
         [-477.9939,   73.6263],
         [ 499.0964, -331.6176],
         [  18.1039, -263.1258],
         [-494.6060, -139.7411],
         [ 227.8131,  241.6537],
         [ -33.9120, -431.4945],
         [ -60.7310, -109.6896]],

        [[ 251.2548,  -36.0051],
         [-164.2974, -434.7388],
         [ 374.7854,  310.6174],
         [-564.1057, -201.6200],
         [ 385.3519,  426.0919],
         [-283.4595,   50.7515],
         [ 233.3277,  153.5232],
         [-455.2837,  120.6840],
         [ 457.4269,   -1.5295],
         [ 102.2140,  316.5961]],

        [[-115.0217, -378.5111],
         [ 516.1429,  212.3507],
         [-220.7613,  139.9895],
         [-129.8403,  243.1015],
         [ -96.9419, -195.9207],
         [ 220.2427,  -98.2079],
         [ 428.1636,  -59.0269],
         [-294.2498, -355.9556],
         [ 220.0377,  457.6323],
         [-336.9909, -151.3562]],

        [[ 413.2727,  393.7720],
         [ 361.8648,  -81.9196],
         [-110.9737, -356.8065],
         [-381.2832, -279.3464],
         [  20.7515,  541.2260],
         [ 113.2710,  302.7433],
         [-466.7428,  -26.8655],
         [ 462.1254,  241.9475],
         [-134.0093, -501.1757],
         [  55.6113, -275.6498]],

        [[  84.5870,  196.2096],
         [ -38.1758,   73.8121],
         [ -17.7774, -404.2994],
         [ 339.2535,  291.9791],
         [   3.3189, -294.6374],
         [-379.0632, -356.9613],
         [ 268.3663,   89.6013],
         [-273.5667,  161.2067],
         [ 282.7651, -126.4932],
         [  72.0546,  462.0330]],

        [[ -58.4827, -324.0867],
         [-463.3585,  167.9108],
         [ 442.6017,  -94.3397],
         [-211.4283, -564.5096],
         [-327.2800,   -4.1652],
         [ 159.1702,   96.3507],
         [ 468.4067,   98.3498],
         [-491.4150,  -36.0108],
         [ 541.2932,   -8.5234],
         [-478.6802, -171.2464]]]) 

t:0, loss.item(): 3088.95947265625
Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0156, 0.0154,  ..., 0.0123, 0.0094, 0.0093],
        [0.0159, 0.0161, 0.0154,  ..., 0.0123, 0.0100, 0.0091],
        [0.0164, 0.0156, 0.0156,  ..., 0.0123, 0.0098, 0.0088],
        ...,
        [0.0161, 0.0161, 0.0161,  ..., 0.0137, 0.0130, 0.0127],
        [0.0161, 0.0161, 0.0156,  ..., 0.0130, 0.0125, 0.0133],
        [0.0159, 0.0159, 0.0159,  ..., 0.0114, 0.0118, 0.0112]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[-2.4802e-04, -2.4038e-04,  1.0088e-03,  ..., -2.9117e-03,
         -1.7470e-04, -1.7470e-04],
        [ 2.5602e-04, -7.4442e-04,  1.2821e-03,  ..., -2.3457e-03,
         -9.0909e-04, -9.0909e-04],
        [-7.6844e-04,  5.0403e-04,  2.6441e-04,  ..., -1.9608e-03,
         -1.0320e-03, -1.0320e-03],
        ...,
        [ 1.0000e-10,  1.0000e-10, -2.5601e-04,  ..., -1.7088e-04,
         -3.2878e-04, -3.2878e-04],
        [ 1.0000e-10, -5.0403e-04,  5.0403e-04,  ..., -4.8701e-04,
          8.3333e-04,  8.3333e-04],
        [ 1.0000e-10,  1.0000e-10,  2.5602e-04,  ...,  4.0107e-04,
         -5.2875e-04, -5.2875e-04]], grad_fn=<SelectBackward>)  








test_counter in loss_omega_mat(): 688
test_counter in loss_omega_mat(): 1376
test_counter in loss_omega_mat(): 2064
test_counter in loss_omega_mat(): 2752
test_counter in loss_omega_mat(): 3440
test_counter in loss_omega_mat(): 4128
test_counter in loss_omega_mat(): 4816
test_counter in loss_omega_mat(): 5504
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9455, 0.9455, 0.9452,  ..., 0.8939, 0.8004, 0.8002],
         [0.9457, 0.9456, 0.9455,  ..., 0.8942, 0.8006, 0.8004],
         [0.9457, 0.9457, 0.9456,  ..., 0.8943, 0.8006, 0.8005],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.8943, 0.8004, 0.8002],
         [0.9458, 0.9457, 0.9457,  ..., 0.8942, 0.8005, 0.8003],
         [0.9457, 0.9457, 0.9453,  ..., 0.8940, 0.8004, 0.8002]],

        [[0.9457, 0.9456, 0.9455,  ..., 0.8941, 0.8005, 0.8004],
         [0.9457, 0.9457, 0.9456,  ..., 0.8944, 0.8006, 0.8005],
         [0.9458, 0.9457, 0.9457,  ..., 0.8944, 0.8006, 0.8006],
         ...,
         [0.9458, 0.9458, 0.9458,  ..., 0.8946, 0.8005, 0.8004],
         [0.9458, 0.9457, 0.9457,  ..., 0.8944, 0.8005, 0.8004],
         [0.9457, 0.9457, 0.9457,  ..., 0.8942, 0.8005, 0.8004]],

        [[0.9458, 0.9458, 0.9456,  ..., 0.8943, 0.8005, 0.8005],
         [0.9458, 0.9458, 0.9457,  ..., 0.8944, 0.8006, 0.8005],
         [0.9458, 0.9458, 0.9458,  ..., 0.8945, 0.8006, 0.8005],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.8944, 0.8005, 0.8004],
         [0.9458, 0.9457, 0.9457,  ..., 0.8945, 0.8005, 0.8004],
         [0.9458, 0.9457, 0.9457,  ..., 0.8944, 0.8005, 0.8004]],

        ...,

        [[0.9444, 0.9442, 0.9439,  ..., 0.8917, 0.7989, 0.7986],
         [0.9433, 0.9401, 0.9381,  ..., 0.8905, 0.7980, 0.7975],
         [0.9432, 0.9385, 0.9381,  ..., 0.8883, 0.7977, 0.7973],
         ...,
         [0.9456, 0.9455, 0.9454,  ..., 0.8944, 0.8006, 0.8003],
         [0.9456, 0.9455, 0.9454,  ..., 0.8941, 0.8005, 0.8002],
         [0.9456, 0.9455, 0.9451,  ..., 0.8935, 0.8001, 0.8001]],

        [[0.9442, 0.9439, 0.9433,  ..., 0.8892, 0.7993, 0.7987],
         [0.9384, 0.9359, 0.9352,  ..., 0.8851, 0.7956, 0.7947],
         [0.9352, 0.9349, 0.9334,  ..., 0.8852, 0.7952, 0.7943],
         ...,
         [0.9456, 0.9456, 0.9454,  ..., 0.8944, 0.8005, 0.8003],
         [0.9456, 0.9456, 0.9455,  ..., 0.8944, 0.8005, 0.8002],
         [0.9456, 0.9456, 0.9455,  ..., 0.8936, 0.8002, 0.8001]],

        [[0.9443, 0.9433, 0.9432,  ..., 0.8898, 0.7993, 0.7986],
         [0.9370, 0.9368, 0.9352,  ..., 0.8853, 0.7936, 0.7918],
         [0.9356, 0.9349, 0.9290,  ..., 0.8835, 0.7914, 0.7914],
         ...,
         [0.9457, 0.9456, 0.9456,  ..., 0.8940, 0.8003, 0.8003],
         [0.9457, 0.9457, 0.9456,  ..., 0.8942, 0.8002, 0.8002],
         [0.9457, 0.9457, 0.9456,  ..., 0.8935, 0.8002, 0.8001]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[4.9514e-07, 4.9514e-07, 2.2938e-06,  ..., 7.7803e-08,
          7.2304e-06, 5.6658e-09],
         [8.6231e-08, 8.6231e-08, 1.4136e-06,  ..., 5.1154e-06,
          4.0583e-06, 1.8252e-07],
         [5.5503e-08, 6.0673e-07, 5.5502e-08,  ..., 3.5773e-08,
          5.2820e-07, 3.9186e-08],
         ...,
         [1.1108e-06, 2.1518e-09, 2.9094e-09,  ..., 1.4458e-07,
          1.1978e-06, 3.5992e-07],
         [1.2753e-08, 9.7873e-09, 3.7396e-08,  ..., 2.9648e-07,
          4.4435e-07, 1.4380e-07],
         [5.2692e-08, 4.6899e-07, 3.1115e-07,  ..., 9.6447e-07,
          2.8930e-07, 2.1436e-06]],

        [[2.5000e-07, 2.5000e-07, 6.1093e-07,  ..., 3.0708e-06,
          6.5543e-08, 2.6217e-07],
         [5.5503e-08, 5.2354e-07, 5.5502e-08,  ..., 1.8482e-07,
          7.0499e-11, 4.6296e-08],
         [5.5503e-08, 2.4168e-07, 1.5267e-06,  ..., 3.0493e-18,
          1.0000e-06, 6.9912e-08],
         ...,
         [1.2076e-06, 7.3106e-09, 2.5305e-07,  ..., 1.4033e-08,
          2.1290e-06, 6.8242e-08],
         [3.5903e-08, 2.6320e-07, 4.2065e-07,  ..., 5.5876e-07,
          1.0817e-06, 7.3145e-08],
         [1.2010e-06, 1.3421e-07, 3.9768e-07,  ..., 7.4512e-07,
          7.5583e-07, 3.0022e-06]],

        [[4.1718e-10, 9.5956e-07, 5.2354e-07,  ..., 4.9978e-08,
          1.6687e-09, 3.2172e-06],
         [2.5000e-07, 4.1724e-10, 2.5000e-07,  ..., 6.9912e-08,
          2.8295e-07, 6.9914e-08],
         [5.5503e-08, 5.7156e-07, 5.9528e-08,  ..., 4.8266e-07,
          5.3999e-08, 2.7084e-07],
         ...,
         [1.5003e-07, 1.2350e-07, 3.8682e-10,  ..., 7.2493e-07,
          6.9467e-07, 5.7000e-08],
         [1.3421e-07, 6.3799e-07, 1.1120e-07,  ..., 2.2260e-10,
          5.3733e-07, 7.9653e-08],
         [9.0917e-07, 1.2146e-06, 2.5000e-07,  ..., 7.5056e-07,
          1.5594e-07, 1.4573e-06]],

        ...,

        [[1.8572e-08, 5.5503e-08, 1.8572e-08,  ..., 5.0931e-06,
          9.5554e-07, 5.5351e-07],
         [2.1753e-07, 1.9299e-05, 1.5125e-05,  ..., 1.6203e-05,
          4.0323e-06, 6.0624e-05],
         [1.0826e-06, 1.0781e-05, 1.0543e-05,  ..., 1.5553e-07,
          1.7460e-06, 3.5879e-05],
         ...,
         [2.2500e-06, 1.5237e-07, 2.5000e-07,  ..., 8.4703e-20,
          1.0000e-06, 1.2313e-06],
         [2.5000e-07, 2.5000e-07, 2.2500e-06,  ..., 1.2540e-08,
          1.2365e-06, 0.0000e+00],
         [2.3102e-06, 5.5338e-07, 1.5056e-07,  ..., 4.5895e-06,
          7.1772e-06, 5.1136e-06]],

        [[6.3330e-06, 4.4966e-06, 9.8412e-06,  ..., 7.6831e-07,
          1.5286e-05, 2.1279e-05],
         [3.6163e-05, 1.2155e-04, 2.3767e-05,  ..., 1.3960e-04,
          3.4949e-04, 1.0830e-04],
         [7.7270e-05, 9.0675e-06, 9.0675e-06,  ..., 1.1810e-04,
          2.0557e-04, 3.7996e-04],
         ...,
         [2.2500e-06, 1.5237e-07, 3.7167e-07,  ..., 1.2023e-08,
          3.1709e-06, 0.0000e+00],
         [3.7452e-07, 1.5056e-07, 1.5056e-07,  ..., 2.7793e-07,
          1.0000e-06, 1.2365e-06],
         [1.4260e-07, 2.8210e-10, 1.9368e-08,  ..., 2.7593e-09,
          1.3604e-06, 4.3185e-10]],

        [[1.0788e-08, 5.1100e-06, 4.7676e-07,  ..., 1.6267e-05,
          1.0707e-05, 1.2282e-05],
         [4.3273e-08, 4.0451e-06, 3.5287e-05,  ..., 3.4743e-06,
          1.5883e-05, 2.9093e-08],
         [2.2653e-05, 1.9261e-04, 1.8010e-05,  ..., 7.6925e-05,
          1.4868e-05, 6.4706e-05],
         ...,
         [2.5000e-07, 1.1116e-06, 1.6402e-06,  ..., 1.0047e-06,
          4.5031e-07, 4.5031e-07],
         [7.3909e-10, 7.3908e-10, 7.1902e-09,  ..., 2.9334e-07,
          6.8958e-07, 2.0280e-07],
         [1.8593e-07, 4.6878e-08, 1.2768e-09,  ..., 8.1353e-08,
          1.4997e-07, 8.3733e-08]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[1.5117e-03, 2.5296e-03, 1.2987e-03,  ..., 8.7188e-04,
          1.3715e-03, 1.4681e-03],
         [1.1246e-03, 1.5455e-03, 2.5296e-03,  ..., 1.6156e-03,
          1.2031e-03, 1.7542e-03],
         [7.7644e-04, 1.1246e-03, 3.3740e-04,  ..., 1.5649e-03,
          3.6846e-04, 8.6138e-04],
         ...,
         [1.1395e-03, 1.1093e-03, 1.1033e-03,  ..., 6.4325e-04,
          5.0843e-04, 7.2257e-04],
         [2.4404e-04, 4.3572e-04, 1.1033e-03,  ..., 2.7979e-04,
          5.6891e-04, 3.3599e-04],
         [4.0108e-04, 5.9212e-04, 3.8167e-04,  ..., 8.6018e-04,
          6.9149e-04, 1.2425e-03]],

        [[5.3674e-04, 3.3989e-04, 1.5117e-03,  ..., 1.1129e-03,
          3.3989e-04, 5.4363e-04],
         [7.8680e-04, 5.3674e-04, 9.0794e-04,  ..., 9.9900e-04,
          5.2563e-04, 2.2372e-04],
         [8.7811e-04, 7.8680e-04, 7.0203e-04,  ..., 1.1054e-03,
          1.1091e-03, 2.6441e-04],
         ...,
         [7.5802e-04, 1.1395e-03, 9.5369e-04,  ..., 4.9531e-04,
          7.4115e-04, 7.8386e-04],
         [5.4217e-04, 4.3572e-04, 8.5576e-04,  ..., 5.5742e-04,
          2.0936e-04, 4.6867e-04],
         [8.5576e-04, 9.5068e-04, 4.0108e-04,  ..., 1.1641e-03,
          3.0380e-06, 7.8386e-04]],

        [[5.8208e-11, 1.1091e-03, 3.3989e-04,  ..., 9.0107e-04,
          3.3540e-04, 5.7985e-04],
         [9.0107e-04, 1.1091e-03, 7.8167e-04,  ..., 7.8680e-04,
          1.2031e-03, 3.6804e-04],
         [9.0107e-04, 4.7965e-04, 4.8131e-04,  ..., 3.1028e-04,
          3.6846e-04, 2.3098e-04],
         ...,
         [7.5802e-04, 1.3184e-04, 6.3856e-04,  ..., 8.7899e-04,
          1.3091e-03, 5.0843e-04],
         [7.4190e-04, 6.2214e-04, 1.2059e-03,  ..., 1.1136e-03,
          5.6891e-04, 8.1559e-04],
         [7.4190e-04, 9.5068e-04, 9.5261e-04,  ..., 2.7556e-04,
          4.8409e-04, 4.6541e-04]],

        ...,

        [[6.3628e-04, 1.3988e-03, 3.0265e-03,  ..., 8.5676e-03,
          2.1174e-03, 1.4234e-03],
         [4.3799e-03, 3.2956e-03, 7.1361e-03,  ..., 5.5570e-03,
          4.4954e-03, 3.9256e-03],
         [3.3374e-03, 4.0779e-03, 7.1361e-03,  ..., 8.1725e-03,
          3.1913e-03, 3.9167e-03],
         ...,
         [8.9035e-04, 8.9708e-04, 1.0000e-03,  ..., 1.0063e-03,
          1.3374e-03, 8.9708e-04],
         [1.1198e-04, 8.8802e-04, 1.0000e-03,  ..., 5.2729e-04,
          1.5837e-04, 4.3004e-04],
         [1.3090e-03, 2.5040e-04, 1.1374e-03,  ..., 6.7629e-04,
          1.2797e-03, 1.6149e-04]],

        [[1.8265e-03, 3.0265e-03, 2.5216e-03,  ..., 2.2520e-03,
          1.1940e-03, 2.6109e-03],
         [1.0065e-02, 1.0831e-02, 1.1507e-02,  ..., 3.2489e-03,
          8.1666e-03, 8.7039e-03],
         [1.1704e-02, 1.3565e-02, 1.1462e-02,  ..., 8.6491e-03,
          9.2290e-03, 9.3644e-03],
         ...,
         [8.9035e-04, 1.1842e-03, 1.5673e-04,  ..., 4.7065e-04,
          1.0965e-04, 2.3909e-04],
         [5.3895e-04, 1.1198e-04, 5.4120e-04,  ..., 3.8805e-04,
          7.8169e-04, 4.0260e-04],
         [1.3090e-03, 1.8826e-04, 5.4120e-04,  ..., 9.1093e-04,
          4.1767e-04, 1.1108e-03]],

        [[2.4994e-03, 2.5216e-03, 7.3720e-04,  ..., 9.9602e-03,
          1.8967e-03, 1.4234e-03],
         [1.8300e-03, 2.4617e-03, 1.1507e-02,  ..., 7.1342e-03,
          4.3476e-03, 2.3936e-03],
         [7.3448e-04, 1.3565e-02, 9.0872e-03,  ..., 7.7287e-03,
          5.7379e-03, 3.3157e-03],
         ...,
         [1.4102e-03, 9.5362e-04, 1.1842e-03,  ..., 1.1278e-03,
          1.1675e-04, 8.9708e-04],
         [5.7812e-04, 7.4691e-04, 5.3895e-04,  ..., 6.3813e-04,
          4.3004e-04, 2.3982e-04],
         [5.7812e-04, 5.6391e-04, 1.8826e-04,  ..., 4.3667e-04,
          9.9021e-04, 1.2797e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:285.9790954589844
t:1, Finish constructing loss
