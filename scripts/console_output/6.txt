DIR_NAME: g:\Workspaces\Anaconda_ws\Semantic_Denoising_MVS\scripts 

cv_MatI numpy float32: 
[[ 63  64  65 ...  81 106 108]
 [ 63  62  65 ...  81 100 110]
 [ 61  64  62 ...  85 102 114]
 ...
 [ 62  62  62 ...  76  77  79]
 [ 62  62  64 ...  77  80  75]
 [ 63  63  63 ...  88  85  89]]
MatI: 
tensor([[ 63.,  64.,  65.,  ...,  81., 106., 108.],
        [ 63.,  62.,  65.,  ...,  81., 100., 110.],
        [ 61.,  64.,  62.,  ...,  85., 102., 114.],
        ...,
        [ 62.,  62.,  62.,  ...,  76.,  77.,  79.],
        [ 62.,  62.,  64.,  ...,  77.,  80.,  75.],
        [ 63.,  63.,  63.,  ...,  88.,  85.,  89.]])
MatI[0:10,35:45]: 
tensor([[ 67.,  68.,  87.,  86.,  85.,  87.,  86.,  85.,  87.,  85.],
        [ 68.,  69.,  76.,  79.,  83.,  83.,  87.,  85.,  78.,  79.],
        [ 68.,  73.,  67.,  82.,  79.,  83.,  95.,  84.,  83.,  83.],
        [ 68.,  69.,  69.,  77.,  85.,  85.,  87.,  94.,  76.,  85.],
        [ 68.,  69.,  74.,  79.,  83.,  82.,  94.,  97.,  89., 100.],
        [ 68.,  68.,  68.,  76.,  80.,  85.,  94.,  96., 103.,  98.],
        [ 68.,  67.,  67.,  77.,  86.,  79., 100.,  97.,  95., 111.],
        [ 67.,  67.,  73.,  66.,  75.,  81., 105., 101., 104., 113.],
        [ 66.,  66.,  67.,  76.,  69.,  69., 103., 112., 121., 111.],
        [ 66.,  67.,  66.,  69.,  69.,  74., 124., 105.,  99., 107.]]) 

debug:
MatD.shape: torch.Size([56, 123]) 
has nan? False 
MatD: 
tensor([[0.0159, 0.0156, 0.0154,  ..., 0.0123, 0.0094, 0.0093],
        [0.0159, 0.0161, 0.0154,  ..., 0.0123, 0.0100, 0.0091],
        [0.0164, 0.0156, 0.0161,  ..., 0.0118, 0.0098, 0.0088],
        ...,
        [0.0161, 0.0161, 0.0161,  ..., 0.0132, 0.0130, 0.0127],
        [0.0161, 0.0161, 0.0156,  ..., 0.0130, 0.0125, 0.0133],
        [0.0159, 0.0159, 0.0159,  ..., 0.0114, 0.0118, 0.0112]]) 

MatU.shape: torch.Size([56, 123, 2]) 
has nan? False 
MatUx: 
tensor([[-2.4802e-04, -2.4038e-04,  1.0088e-03,  ..., -2.9117e-03,
         -1.7470e-04, -1.7470e-04],
        [ 2.5602e-04, -7.4442e-04,  1.2821e-03,  ..., -2.3457e-03,
         -9.0909e-04, -9.0909e-04],
        [-7.6844e-04,  5.0403e-04,  2.6441e-04,  ..., -1.9608e-03,
         -1.0320e-03, -1.0320e-03],
        ...,
        [ 1.0000e-10,  1.0000e-10, -2.5601e-04,  ..., -1.7088e-04,
         -3.2878e-04, -3.2878e-04],
        [ 1.0000e-10, -5.0403e-04,  5.0403e-04,  ..., -4.8701e-04,
          8.3333e-04,  8.3333e-04],
        [ 1.0000e-10,  1.0000e-10,  2.5602e-04,  ...,  4.0107e-04,
         -5.2875e-04, -5.2875e-04]]) 




MatD[0:10,35:45]: 
tensor([[0.0149, 0.0147, 0.0115, 0.0116, 0.0118, 0.0115, 0.0116, 0.0118, 0.0115,
         0.0118],
        [0.0147, 0.0145, 0.0132, 0.0127, 0.0120, 0.0120, 0.0115, 0.0118, 0.0128,
         0.0127],
        [0.0147, 0.0137, 0.0149, 0.0122, 0.0127, 0.0120, 0.0105, 0.0119, 0.0120,
         0.0120],
        [0.0147, 0.0145, 0.0145, 0.0130, 0.0118, 0.0118, 0.0115, 0.0106, 0.0132,
         0.0118],
        [0.0147, 0.0145, 0.0135, 0.0127, 0.0120, 0.0122, 0.0106, 0.0103, 0.0112,
         0.0100],
        [0.0147, 0.0147, 0.0147, 0.0132, 0.0125, 0.0118, 0.0106, 0.0104, 0.0097,
         0.0102],
        [0.0147, 0.0149, 0.0149, 0.0130, 0.0116, 0.0127, 0.0100, 0.0103, 0.0105,
         0.0090],
        [0.0149, 0.0149, 0.0137, 0.0152, 0.0133, 0.0123, 0.0095, 0.0099, 0.0096,
         0.0088],
        [0.0152, 0.0152, 0.0149, 0.0132, 0.0145, 0.0145, 0.0097, 0.0089, 0.0083,
         0.0090],
        [0.0152, 0.0149, 0.0152, 0.0145, 0.0145, 0.0135, 0.0081, 0.0095, 0.0101,
         0.0093]]) 

MatU[0:10,35:45]: 
tensor([[[-2.1949e-04, -2.1949e-04],
         [-3.2116e-03, -2.1313e-04],
         [ 1.3365e-04,  1.6636e-03],
         [ 1.3680e-04,  1.0303e-03],
         [-2.7045e-04,  2.8349e-04],
         [ 1.3365e-04,  5.5394e-04],
         [ 1.3680e-04, -1.3365e-04],
         [-2.7045e-04,  1.0000e-10],
         [ 2.7045e-04,  1.3263e-03],
         [-1.3680e-04,  8.9352e-04]],

        [[-2.1313e-04,  1.0000e-10],
         [-1.3349e-03, -7.9412e-04],
         [-4.9967e-04,  1.7675e-03],
         [-6.1004e-04, -4.6311e-04],
         [ 1.0000e-10,  6.1004e-04],
         [-5.5394e-04,  1.0000e-10],
         [ 2.7045e-04, -9.6794e-04],
         [ 1.0558e-03,  1.4006e-04],
         [-1.6228e-04, -7.7232e-04],
         [-1.1640e-03, -6.1004e-04]],

        [[-1.0073e-03,  1.0000e-10],
         [ 1.2267e-03,  7.9412e-04],
         [-2.7303e-03, -4.3262e-04],
         [ 4.6311e-04,  7.9189e-04],
         [-6.1004e-04, -8.9352e-04],
         [-1.5219e-03, -2.8349e-04],
         [ 1.3784e-03,  9.6794e-04],
         [ 1.4343e-04, -1.2665e-03],
         [ 1.0000e-10,  1.1097e-03],
         [ 4.5181e-04, -2.8349e-04]],

        [[-2.1313e-04,  1.0000e-10],
         [ 1.0000e-10,  1.0000e-10],
         [-1.5057e-03, -9.7924e-04],
         [-1.2223e-03, -3.2878e-04],
         [ 1.0000e-10,  2.8349e-04],
         [-2.7045e-04,  4.3042e-04],
         [-8.5596e-04, -8.5596e-04],
         [ 2.5196e-03, -3.2902e-04],
         [-1.3932e-03, -1.9219e-03],
         [-2.7045e-04, -1.7647e-03]],

        [[-2.1313e-04,  1.0000e-10],
         [-9.7924e-04,  2.1313e-04],
         [-8.5529e-04,  1.1924e-03],
         [-6.1004e-04,  4.9967e-04],
         [ 1.4693e-04,  4.5181e-04],
         [-1.5568e-03, -4.3042e-04],
         [-3.2902e-04,  1.0000e-10],
         [ 9.2668e-04,  1.0739e-04],
         [-1.2360e-03, -1.5272e-03],
         [ 6.3830e-04,  2.0408e-04]],

        [[ 1.0000e-10,  1.0000e-10],
         [ 1.0000e-10,  2.1949e-04],
         [-1.5480e-03,  2.1949e-04],
         [-6.5789e-04, -1.7088e-04],
         [-7.3529e-04, -8.7209e-04],
         [-1.1264e-03,  8.9352e-04],
         [-2.2163e-04, -6.3830e-04],
         [-7.0793e-04, -1.0739e-04],
         [ 4.9534e-04,  8.1758e-04],
         [-6.8027e-04, -1.1951e-03]],

        [[ 2.1949e-04,  2.1949e-04],
         [ 1.0000e-10,  1.0000e-10],
         [-1.9384e-03, -1.2267e-03],
         [-1.3591e-03,  2.1645e-03],
         [ 1.0303e-03,  1.7054e-03],
         [-2.6582e-03, -3.1255e-04],
         [ 3.0928e-04, -4.7619e-04],
         [ 2.1704e-04, -4.0829e-04],
         [-1.5173e-03, -9.1093e-04],
         [ 1.3003e-03, -1.5945e-04]],

        [[ 1.0000e-10,  2.2614e-04],
         [-1.2267e-03,  2.2614e-04],
         [ 1.4529e-03,  1.2267e-03],
         [-1.8182e-03, -1.9936e-03],
         [-9.8765e-04,  1.1594e-03],
         [-2.8219e-03,  2.1471e-03],
         [ 3.7718e-04,  1.8493e-04],
         [-2.8560e-04, -9.7242e-04],
         [-7.6583e-04, -1.3509e-03],
         [ 9.5436e-04,  1.5945e-04]],

        [[ 1.0000e-10,  1.0000e-10],
         [-2.2614e-04, -2.2614e-04],
         [-1.7675e-03,  2.2614e-04],
         [ 1.3349e-03,  1.3349e-03],
         [ 1.0000e-10,  1.0000e-10],
         [-4.7840e-03, -9.7924e-04],
         [-7.8017e-04, -1.6442e-03],
         [-6.6411e-04,  5.9524e-04],
         [ 7.4455e-04,  1.8365e-03],
         [ 1.1951e-03,  3.3678e-04]],

        [[-2.2614e-04,  1.0000e-10],
         [ 2.2614e-04,  1.0000e-10],
         [-6.5876e-04, -1.0670e-03],
         [ 1.0000e-10,  4.3262e-04],
         [-9.7924e-04, -7.9412e-04],
         [-5.4490e-03,  7.7220e-04],
         [ 1.4593e-03,  2.6882e-04],
         [ 5.7720e-04,  2.8011e-04],
         [-7.5522e-04, -2.1010e-03],
         [ 5.5520e-04,  1.2925e-03]]]) 

test_counter in loss_omega_mat(): 688
test_counter in loss_omega_mat(): 1376
test_counter in loss_omega_mat(): 2064
test_counter in loss_omega_mat(): 2752
test_counter in loss_omega_mat(): 3440
test_counter in loss_omega_mat(): 4128
test_counter in loss_omega_mat(): 4816
test_counter in loss_omega_mat(): 5504
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9455, 0.9455, 0.9454,  ..., 0.8944, 0.8004, 0.8004],
         [0.9455, 0.9455, 0.9453,  ..., 0.8944, 0.8005, 0.8004],
         [0.9456, 0.9455, 0.9455,  ..., 0.8944, 0.8005, 0.8004],
         ...,
         [0.9457, 0.9456, 0.9454,  ..., 0.8942, 0.8005, 0.8002],
         [0.9458, 0.9457, 0.9454,  ..., 0.8942, 0.8006, 0.8005],
         [0.9458, 0.9457, 0.9457,  ..., 0.8943, 0.8006, 0.8005]],

        [[0.9458, 0.9455, 0.9455,  ..., 0.8944, 0.8005, 0.8004],
         [0.9458, 0.9455, 0.9453,  ..., 0.8944, 0.8005, 0.8004],
         [0.9458, 0.9456, 0.9455,  ..., 0.8944, 0.8005, 0.8005],
         ...,
         [0.9457, 0.9457, 0.9455,  ..., 0.8943, 0.8006, 0.8003],
         [0.9458, 0.9458, 0.9455,  ..., 0.8943, 0.8006, 0.8005],
         [0.9458, 0.9458, 0.9458,  ..., 0.8944, 0.8007, 0.8006]],

        [[0.9459, 0.9458, 0.9458,  ..., 0.8946, 0.8007, 0.8006],
         [0.9459, 0.9459, 0.9458,  ..., 0.8946, 0.8007, 0.8006],
         [0.9459, 0.9459, 0.9459,  ..., 0.8945, 0.8007, 0.8007],
         ...,
         [0.9458, 0.9457, 0.9457,  ..., 0.8942, 0.8005, 0.8005],
         [0.9458, 0.9458, 0.9458,  ..., 0.8945, 0.8006, 0.8006],
         [0.9458, 0.9458, 0.9458,  ..., 0.8945, 0.8006, 0.8006]],

        ...,

        [[0.9447, 0.9432, 0.9421,  ..., 0.8915, 0.7985, 0.7979],
         [0.9422, 0.9389, 0.9355,  ..., 0.8887, 0.7971, 0.7969],
         [0.9420, 0.9356, 0.9355,  ..., 0.8864, 0.7966, 0.7966],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.8947, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9458,  ..., 0.8939, 0.8007, 0.8007],
         [0.9458, 0.9456, 0.9450,  ..., 0.8935, 0.8004, 0.8003]],

        [[0.9444, 0.9421, 0.9415,  ..., 0.8887, 0.7993, 0.7981],
         [0.9371, 0.9341, 0.9335,  ..., 0.8854, 0.7946, 0.7941],
         [0.9331, 0.9331, 0.9306,  ..., 0.8834, 0.7938, 0.7935],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.8947, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9459,  ..., 0.8940, 0.8007, 0.8006],
         [0.9458, 0.9457, 0.9453,  ..., 0.8938, 0.8004, 0.8003]],

        [[0.9438, 0.9435, 0.9415,  ..., 0.8881, 0.7995, 0.7976],
         [0.9364, 0.9362, 0.9335,  ..., 0.8834, 0.7941, 0.7921],
         [0.9355, 0.9331, 0.9277,  ..., 0.8817, 0.7921, 0.7915],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.8944, 0.8007, 0.8007],
         [0.9459, 0.9458, 0.9457,  ..., 0.8938, 0.8006, 0.8006],
         [0.9458, 0.9457, 0.9455,  ..., 0.8937, 0.8003, 0.7998]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[4.0583e-06, 1.4488e-06, 6.5750e-07,  ..., 1.4488e-06,
          7.2304e-06, 1.1562e-06],
         [6.2988e-07, 1.2128e-05, 6.2988e-07,  ..., 2.2061e-06,
          1.8252e-07, 4.0583e-06],
         [6.9913e-08, 2.9861e-07, 6.9913e-08,  ..., 6.5750e-07,
          6.4328e-07, 7.4652e-08],
         ...,
         [3.0685e-07, 1.9878e-06, 3.0685e-07,  ..., 5.6655e-06,
          4.3867e-06, 2.5598e-06],
         [1.6086e-07, 1.4982e-07, 2.8675e-06,  ..., 5.6546e-06,
          2.7775e-06, 2.7311e-06],
         [7.3145e-08, 8.8773e-07, 7.3145e-08,  ..., 2.2914e-06,
          2.8930e-07, 1.8044e-06]],

        [[7.6233e-21, 6.5544e-08, 7.9310e-08,  ..., 1.4488e-06,
          6.5544e-08, 2.6217e-07],
         [6.9913e-08, 4.7835e-07, 6.9913e-08,  ..., 2.4652e-06,
          6.1597e-07, 7.0472e-11],
         [6.9913e-08, 6.9913e-08, 2.8905e-07,  ..., 8.8219e-07,
          6.9913e-08, 4.0000e-20],
         ...,
         [3.4281e-07, 1.6086e-07, 1.6086e-07,  ..., 9.1204e-07,
          2.9258e-07, 6.8242e-08],
         [1.6986e-10, 7.2493e-07, 7.2493e-07,  ..., 6.6567e-07,
          7.3145e-08, 2.0518e-06],
         [1.7863e-08, 1.7061e-08, 1.7863e-08,  ..., 4.7279e-07,
          1.7061e-08, 1.6852e-07]],

        [[2.7084e-07, 2.7084e-07, 2.7084e-07,  ..., 2.7084e-07,
          2.7084e-07, 1.0834e-06],
         [1.0000e-20, 1.0000e-20, 2.7084e-07,  ..., 6.9913e-08,
          2.7084e-07, 6.9913e-08],
         [6.5544e-08, 6.5544e-08, 6.9913e-08,  ..., 1.7037e-06,
          1.1009e-06, 2.7965e-07],
         ...,
         [7.2493e-07, 7.2493e-07, 1.2380e-06,  ..., 7.2493e-07,
          3.3616e-06, 1.5345e-06],
         [1.7863e-08, 1.7863e-08, 1.6867e-06,  ..., 5.8594e-06,
          5.1520e-07, 5.1957e-07],
         [7.6233e-21, 1.5834e-07, 7.6233e-21,  ..., 1.5346e-07,
          6.2855e-07, 1.5594e-07]],

        ...,

        [[2.6774e-06, 6.9913e-08, 2.6774e-06,  ..., 1.0607e-05,
          1.0710e-05, 9.5554e-07],
         [1.1292e-09, 2.3942e-05, 1.9264e-05,  ..., 3.6305e-05,
          1.0162e-06, 9.5769e-05],
         [2.3731e-06, 2.2881e-05, 1.4040e-05,  ..., 1.5553e-07,
          1.1032e-05, 4.8858e-05],
         ...,
         [1.0000e-20, 1.2023e-08, 1.0000e-20,  ..., 0.0000e+00,
          4.0000e-20, 4.0000e-20],
         [1.0000e-20, 1.0000e-20, 1.0000e-20,  ..., 1.2540e-08,
          1.2540e-08, 1.2023e-08],
         [4.0801e-06, 5.0351e-06, 1.2540e-08,  ..., 5.0351e-06,
          1.0636e-05, 1.3535e-05]],

        [[9.0995e-06, 2.6261e-06, 2.1502e-05,  ..., 9.0047e-06,
          3.4925e-05, 1.9332e-05],
         [4.2427e-05, 1.5688e-04, 1.9142e-05,  ..., 1.3960e-04,
          4.2827e-04, 1.3011e-04],
         [6.3063e-06, 8.6310e-05, 6.3063e-06,  ..., 4.7423e-05,
          2.3525e-04, 4.6193e-04],
         ...,
         [1.0000e-20, 1.2023e-08, 1.2023e-08,  ..., 1.2023e-08,
          1.2023e-08, 4.8092e-08],
         [1.2540e-08, 1.0000e-20, 1.2540e-08,  ..., 1.2540e-08,
          4.0000e-20, 5.0159e-08],
         [7.7023e-07, 2.6708e-07, 1.3020e-07,  ..., 6.4350e-06,
          3.9173e-06, 7.2729e-07]],

        [[1.4172e-06, 3.6465e-07, 7.6205e-06,  ..., 1.6267e-05,
          5.1625e-06, 6.2726e-06],
         [6.3063e-06, 8.5251e-08, 5.5358e-05,  ..., 3.4743e-06,
          2.4853e-05, 1.3702e-06],
         [2.7662e-05, 2.0674e-04, 2.2503e-05,  ..., 6.0384e-05,
          1.0088e-04, 8.1559e-06],
         ...,
         [4.8092e-08, 1.9862e-07, 1.0376e-20,  ..., 5.4374e-12,
          1.0821e-07, 1.0821e-07],
         [3.4199e-07, 5.4388e-12, 2.2355e-07,  ..., 2.9334e-07,
          1.3679e-06, 2.0280e-07],
         [8.0364e-08, 2.1554e-07, 4.7334e-09,  ..., 8.1354e-08,
          1.6625e-06, 3.7546e-07]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[2.1716e-03, 1.5117e-03, 2.0330e-03,  ..., 1.8984e-03,
          2.3247e-03, 1.4681e-03],
         [1.5455e-03, 3.3599e-03, 2.5029e-03,  ..., 1.8705e-03,
          2.1216e-03, 1.9825e-03],
         [3.8640e-04, 9.7781e-04, 8.4731e-04,  ..., 1.2037e-03,
          6.0308e-04, 3.6846e-04],
         ...,
         [1.5072e-03, 9.0618e-04, 2.3843e-03,  ..., 1.5692e-03,
          8.4213e-04, 1.3706e-03],
         [9.5853e-04, 2.4404e-04, 2.3843e-03,  ..., 2.4087e-03,
          5.6891e-04, 1.1947e-03],
         [4.0108e-04, 1.3706e-03, 5.6720e-04,  ..., 9.4457e-04,
          7.7370e-04, 1.3656e-04]],

        [[8.1756e-04, 5.7999e-04, 1.5117e-03,  ..., 2.3320e-03,
          8.1756e-04, 8.3392e-04],
         [5.7999e-04, 1.5455e-03, 3.6206e-04,  ..., 2.2603e-03,
          7.7649e-04, 9.4170e-04],
         [7.4195e-04, 5.8374e-04, 8.4731e-04,  ..., 1.8705e-03,
          2.6441e-04, 5.2042e-04],
         ...,
         [1.5072e-03, 7.5802e-04, 8.9383e-04,  ..., 9.6717e-04,
          3.0034e-04, 3.7813e-04],
         [9.5853e-04, 1.5006e-03, 5.2272e-04,  ..., 1.7027e-03,
          4.6867e-04, 7.4932e-04],
         [4.7768e-04, 4.0108e-04, 5.7018e-04,  ..., 8.0164e-04,
          3.0380e-06, 1.0417e-03]],

        [[0.0000e+00, 5.2042e-04, 1.0408e-03,  ..., 5.8374e-04,
          1.0739e-03, 8.3654e-04],
         [3.7393e-04, 5.8374e-04, 5.2042e-04,  ..., 3.6206e-04,
          5.7999e-04, 3.6804e-04],
         [5.2049e-04, 1.1637e-03, 5.8374e-04,  ..., 1.1040e-03,
          1.0739e-03, 5.8374e-04],
         ...,
         [1.9631e-03, 9.9069e-04, 7.5802e-04,  ..., 8.6185e-04,
          8.4839e-04, 8.4213e-04],
         [1.1468e-03, 7.4190e-04, 1.5006e-03,  ..., 1.2232e-03,
          1.6744e-03, 1.6406e-03],
         [4.7516e-04, 4.7768e-04, 9.8494e-04,  ..., 8.4527e-04,
          7.7370e-04, 5.5117e-04]],

        ...,

        [[1.6363e-03, 1.3988e-03, 4.4392e-03,  ..., 9.0658e-03,
          1.6363e-03, 3.0397e-03],
         [4.3885e-03, 3.2956e-03, 8.2018e-03,  ..., 6.8507e-03,
          5.4360e-03, 4.9190e-03],
         [3.7034e-03, 5.4594e-03, 8.2018e-03,  ..., 9.1725e-03,
          3.1913e-03, 5.1166e-03],
         ...,
         [1.0965e-04, 1.5507e-04, 0.0000e+00,  ..., 1.1198e-04,
          1.1198e-04, 1.5507e-04],
         [0.0000e+00, 1.1198e-04, 1.1198e-04,  ..., 2.0230e-03,
          1.5837e-04, 8.9956e-04],
         [1.1979e-03, 2.5040e-04, 2.1349e-03,  ..., 2.0230e-03,
          1.0154e-03, 1.3119e-03]],

        [[1.8265e-03, 4.4392e-03, 3.8523e-03,  ..., 6.8507e-03,
          2.1915e-03, 3.6447e-03],
         [1.1049e-02, 1.1516e-02, 1.2802e-02,  ..., 3.2489e-03,
          9.4673e-03, 9.6589e-03],
         [1.4966e-02, 1.2633e-02, 1.2414e-02,  ..., 7.1342e-03,
          1.0625e-02, 1.0323e-02],
         ...,
         [1.0965e-04, 2.4518e-04, 3.3602e-04,  ..., 6.2538e-04,
          2.4518e-04, 1.0965e-04],
         [1.1198e-04, 1.5673e-04, 4.8589e-04,  ..., 2.0230e-03,
          2.5256e-04, 0.0000e+00],
         [1.1979e-03, 1.8826e-04, 9.9689e-04,  ..., 1.7997e-03,
          1.1847e-03, 4.0605e-04]],

        [[1.5609e-03, 3.4938e-03, 3.8523e-03,  ..., 1.0425e-02,
          3.0256e-03, 1.4234e-03],
         [2.2328e-03, 2.8205e-03, 1.2802e-02,  ..., 7.1342e-03,
          5.6894e-03, 3.5747e-03],
         [7.3448e-04, 1.4966e-02, 1.0249e-02,  ..., 8.6707e-03,
          4.5902e-03, 6.1487e-03],
         ...,
         [2.4518e-04, 4.9881e-04, 9.9194e-04,  ..., 1.1278e-03,
          1.5507e-04, 1.1675e-04],
         [4.8589e-04, 4.7515e-04, 7.2748e-04,  ..., 6.3813e-04,
          5.9542e-04, 9.4823e-04],
         [5.8743e-04, 1.8826e-04, 6.4610e-04,  ..., 1.4246e-03,
          1.3119e-03, 9.9021e-04]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:308.89593505859375
t:0, Finish constructing loss
require grad ? True True False
MatD grad and MatUx grad: torch.Size([56, 123]) torch.Size([56, 123, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  2.8531e-02,  1.0069e-02, -5.6164e-03,
         -6.8602e-03,  0.0000e+00, -1.3019e-02,  0.0000e+00,  0.0000e+00],
        [-7.9057e-03,  7.6617e-02, -4.6708e-01, -2.2746e+00,  2.2248e+00,
         -3.8207e+00, -2.0736e+00,  1.1213e-02, -5.0626e-02,  1.4393e-02],
        [-2.2995e+00, -4.1615e+00, -3.4088e+00, -1.4933e+00, -1.1270e+01,
         -4.9649e+00,  4.3675e+00, -3.0918e+00,  1.1861e+01,  3.8570e+00],
        [ 4.5507e+00, -1.0943e+01, -2.5359e+01, -1.8497e+01, -1.4908e+01,
          9.5709e+00, -2.3998e+01, -1.0213e+01,  1.0509e+01, -1.5467e+01],
        [ 2.6567e+00,  5.8431e+00,  2.2961e+01, -2.0425e+00,  6.5308e-01,
          5.3385e+00, -1.2388e+01, -6.3493e+00, -1.7912e+01,  1.6755e+01],
        [-2.8631e+01,  2.6563e+01,  1.6486e+01, -1.4215e+00, -2.4552e+01,
          2.2947e+01, -3.2651e+01,  1.6781e+01,  2.9278e+01, -1.7231e+01],
        [-2.7575e+01, -9.2207e+00, -2.9644e+01,  3.3069e+01,  2.2273e+00,
         -5.0109e+00, -2.9410e+01,  1.3609e+01,  8.9336e+00, -1.4969e+01],
        [-6.1525e-01,  1.9934e+01,  1.1206e+01, -3.5147e+01,  1.7243e+01,
          2.0605e+01, -9.1955e+00, -1.8732e+01, -2.4653e+01, -2.6411e+01],
        [-1.6134e+01, -4.5558e+00,  2.3078e+01,  3.4181e+00,  3.3906e+00,
          6.0438e+00, -2.3879e+01,  3.1112e+01,  2.3437e+01, -1.4225e+01]]) 

MatU.grad[0:10,35:45]: 
tensor([[[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -21.1682,  -18.3460],
         [  27.0269,    7.3596],
         [ -13.7409,  -24.4213],
         [   6.4839,   27.2600],
         [  24.3691,   13.8145],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   8.1112,  -30.6161],
         [  81.8877,  -32.4648],
         [ -37.3525, -115.0722],
         [ -81.1614,  -80.0603],
         [  51.2107,    1.3030],
         [  25.1097,   34.4850],
         [ -44.6187,  -68.4019],
         [  92.7566,   -2.8219],
         [ -57.3830,  -73.9227],
         [  24.1442,  -67.8044]],

        [[-152.5885,  -81.2555],
         [-292.7151,   17.0295],
         [   1.1891,  465.1825],
         [  11.0146,  110.4164],
         [ 339.7263,  138.5498],
         [-322.0179, -122.9460],
         [   7.1066,  112.3537],
         [ 386.6537,   77.7744],
         [-331.0944, -278.1118],
         [ 180.8136,  180.0251]],

        [[ 100.8399, -167.0968],
         [ 233.1552,  211.6442],
         [-418.9594,  -15.2354],
         [  80.5120, -130.9604],
         [  19.0190, -496.8433],
         [-180.5923,  309.1177],
         [  38.0769, -300.1615],
         [-325.9818,  230.0143],
         [ 200.2093,  487.4330],
         [-210.9280, -366.7648]],

        [[ 517.2060,  143.1422],
         [ 142.0777, -237.2816],
         [-328.9656, -358.0960],
         [-220.4418,  485.3964],
         [ 477.7474,  289.0978],
         [-433.3799, -133.5745],
         [ 473.4475, -138.7328],
         [ 168.3708,  -38.7123],
         [-567.0809, -156.2738],
         [ 556.1782,  -82.1143]],

        [[  64.2818,  156.6932],
         [-392.3367,  111.4632],
         [ 538.0710,  219.7252],
         [-260.5640, -521.0628],
         [  -3.5091,  168.7507],
         [-292.1360,  400.1038],
         [ 315.3364,  260.6717],
         [  15.8342, -295.3777],
         [-267.8812, -363.2106],
         [ 269.8493,   95.0713]],

        [[ 257.4803,  -78.1146],
         [ -45.9963, -286.1932],
         [-521.8000,  127.3283],
         [ 392.1863,  336.5464],
         [ 260.2842, -146.6652],
         [-421.6036, -232.1585],
         [-103.9639, -432.3133],
         [-330.1266,  350.4733],
         [ 157.2704,  600.7153],
         [ 455.5799,  137.3251]],

        [[ -46.6861,  104.0443],
         [ 518.7349,   22.3042],
         [-153.0560, -523.3743],
         [  36.3028,  213.2493],
         [ -45.5791, -313.6373],
         [-399.4607,  212.5197],
         [ 524.0701,  176.7964],
         [  -2.0626,   14.5235],
         [-201.7064, -506.4336],
         [ -26.1573,  332.3099]]]) 

MatD.grad: 
tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0062,  ..., -0.0036,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ..., -0.0016,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -25.1473,   12.3675],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  30.8086,    5.5489],
         [   2.2527,   -0.7114],
         [   4.3664,  -77.6345],
         [   4.2337,   42.2887],
         [ -55.2333,    8.0960],
         [ -86.5710,   22.1447],
         [   0.0000,   95.7439]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  64.0888,    3.9505],
         [-407.8800,  -95.4192],
         [ 433.3497,  228.9656],
         [-190.8247, -326.6885],
         [  15.5905, -293.7907],
         [  28.2269,  130.8685],
         [  58.7893,   34.9703]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   8.5999,   26.6598],
         [  15.1269,   56.9748],
         [-205.1369, -230.3159],
         [ 167.1736,  396.5114],
         [-133.9834,  286.8222],
         [ 360.7518, -338.6215],
         [ -67.8633,   96.7189],
         [   6.4492,   51.9253]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -86.9130,   21.7799],
         [ 428.4470,  -57.2126],
         [ -37.4446,   15.7689],
         [-573.8359, -194.1752],
         [ 495.4641,  328.4255],
         [-136.6944,  113.7896],
         [  37.1139,  116.1030]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -26.4949,   -9.1213],
         [-108.9822,  -41.1062],
         [ 418.7496,  -17.3605],
         [-246.1085, -325.9621],
         [   6.4405, -382.7556],
         [ 295.1322,  -31.3387],
         [-117.0083, -539.9286],
         [ -44.2817, -599.4843]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -50.6275,   17.5509],
         [ 115.5602,  441.4322],
         [-357.1584,  149.5788],
         [ 213.9831,  530.5530],
         [ -35.0624,  411.1417],
         [-115.6168,  482.3217],
         [ 406.3480,  268.9928]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  28.0230,    0.0000],
         [  52.8140,  -95.5321],
         [-420.1584, -169.0260],
         [ 347.1792,  181.6841],
         [  73.4931, -219.7966],
         [  -0.8798, -230.0406],
         [-420.8524,  -75.7105],
         [ 453.6130,  -88.8010]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[ 1.7974e-01,  2.9222e+01],
         [ 1.2248e+02,  5.2969e+01],
         [ 2.2012e+02,  6.2837e+01],
         [ 3.3048e+02,  4.0411e+01],
         [-1.7783e+02, -1.4514e+02],
         [-5.4796e+01, -5.1698e+02],
         [-9.5690e+01, -1.5824e+02],
         [ 2.9313e+02, -4.6419e+02],
         [ 4.1325e+01, -8.4748e+01],
         [-4.0339e+02, -4.7108e+02]],

        [[-2.7582e+01,  5.5383e+02],
         [ 2.1105e+02,  1.3623e+01],
         [ 1.8729e+02,  4.0067e+01],
         [ 6.2448e+01, -4.7135e+02],
         [-4.5785e+02, -3.8612e+02],
         [ 3.1958e+02,  6.9711e+01],
         [-3.8121e+02,  3.1896e+02],
         [ 5.8744e+02,  2.4247e+02],
         [-4.0454e+02, -1.5378e+02],
         [-1.1952e+02,  4.8911e+02]],

        [[-4.9937e+02,  7.3115e+00],
         [ 2.1737e+02, -3.6985e+01],
         [-4.8150e+02, -2.4368e+02],
         [-2.5291e+02,  3.9539e+02],
         [ 9.5742e+01,  4.3631e+02],
         [ 2.3445e+02,  4.7450e+02],
         [-1.8940e+02, -5.0231e+02],
         [-3.1107e+01,  1.2102e+02],
         [ 3.7469e+02,  3.4484e+02],
         [ 5.6646e+01, -4.6271e+02]],

        [[-4.2860e+02,  1.5571e+00],
         [-6.4475e+01,  9.1655e+01],
         [ 4.4819e+02, -2.0344e+01],
         [-2.6129e+00, -2.7519e+02],
         [ 3.0089e+02, -3.9935e+02],
         [-4.8645e+02, -3.5723e+02],
         [ 4.7661e+02,  3.3600e+02],
         [ 2.4831e+02, -2.7941e+02],
         [-4.9651e+02, -2.2610e+02],
         [ 8.2879e+01,  2.5232e+01]],

        [[-1.9420e+02, -5.2006e+02],
         [-1.9557e+02,  4.8839e+02],
         [ 1.0268e+02,  6.4994e+01],
         [-3.6923e+02, -9.7833e+01],
         [-2.0464e+02,  4.0286e+02],
         [ 2.7306e+02, -8.0581e+00],
         [-2.3192e+02,  1.3188e+02],
         [ 1.4888e+02,  4.3288e+02],
         [-2.7641e+02, -1.8493e+02],
         [ 4.6385e+02, -1.1510e+02]],

        [[ 4.9980e+02,  3.4325e+02],
         [-4.9212e+02, -2.9023e+02],
         [-7.3827e+00,  4.2173e+02],
         [ 3.8549e+02,  3.0550e+01],
         [-4.7902e+02,  1.8081e+02],
         [ 3.2196e+02,  5.1159e+02],
         [ 1.0121e+02, -4.4275e+02],
         [-5.9044e+02, -2.6302e+02],
         [-1.8934e+02,  3.4287e+02],
         [ 4.4407e+02,  3.5967e+02]],

        [[ 2.1581e+00, -3.9437e+02],
         [ 1.8648e+02,  4.6733e+01],
         [-3.2765e+02, -2.7009e+02],
         [ 5.3942e+02, -2.2900e+02],
         [-1.8121e+00, -5.8925e+02],
         [-4.7461e+02, -3.1865e+02],
         [ 1.8683e+02,  1.6104e+02],
         [ 1.8649e+02, -2.1393e+02],
         [ 1.3461e+02, -3.1739e+02],
         [-2.8251e+02, -4.5321e+02]],

        [[ 4.3959e+02, -1.0784e+01],
         [-1.4402e+02,  2.4044e+02],
         [-4.6880e+02,  1.0984e+02],
         [-5.4400e+01,  4.1627e+02],
         [ 2.5386e+02,  5.2379e+02],
         [-1.3159e+02, -1.0169e+02],
         [-2.7941e+02,  1.9592e+02],
         [ 2.8347e+01,  5.0141e+02],
         [-3.0958e+02,  4.7126e+02],
         [ 3.3950e+02,  5.3772e+02]],

        [[ 5.8442e+02,  1.4433e+02],
         [-1.3802e+02, -2.0984e+02],
         [ 1.1879e+01, -5.5126e+02],
         [ 1.1639e+02, -2.6875e+02],
         [-3.5247e+02,  1.7962e+02],
         [ 1.7473e+02, -7.4226e+01],
         [ 4.3454e+02, -9.1815e+01],
         [-5.9726e+01, -4.1643e+02],
         [ 1.7342e+01,  2.1112e+02],
         [-1.4864e+02, -2.1174e+01]],

        [[ 1.1433e+01, -1.7955e+01],
         [-4.8835e+02, -2.7362e+02],
         [ 3.3647e+02,  4.8021e+02],
         [ 3.8788e+02,  3.4932e+01],
         [-4.3154e+02, -9.4846e+01],
         [ 9.3885e+01, -5.0616e+02],
         [ 7.1225e+01,  3.9719e+02],
         [ 5.4754e+02, -1.5860e+02],
         [-1.3305e+02, -4.9013e+02],
         [-4.8057e+02, -3.6938e+02]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[ 132.4102,   79.8967],
         [ 104.6957, -472.8951],
         [-419.7933, -448.2411],
         [ -58.7280,  424.7520],
         [ 231.3188, -343.6718],
         [-239.9074,  160.6665],
         [ 334.1654,   54.7130],
         [  56.3212,  283.6293],
         [ 111.4950,  -60.5618],
         [-256.1548, -212.8604]],

        [[-404.5586, -402.0443],
         [  67.7845,  393.1137],
         [ 365.6425,  -33.6631],
         [-627.8022,   69.1289],
         [ 437.1218,  432.7571],
         [ -92.7931, -180.7819],
         [ 434.1141, -110.8228],
         [-209.6978, -541.3244],
         [ -38.1593,  475.2143],
         [ 119.2975, -434.6550]],

        [[ 401.7371,   44.9809],
         [ -90.3588, -313.2233],
         [ 267.4791,  423.5932],
         [ -88.3712, -402.2978],
         [-233.6637, -319.5455],
         [-495.3538,  101.0742],
         [ -30.9899,  194.3427],
         [ 438.8662,  136.4588],
         [-263.2509,  428.1879],
         [ 286.2605,  215.8224]],

        [[ -76.2977,  531.5784],
         [ 555.0746,  -36.9698],
         [-382.5121, -417.0177],
         [ -65.5767,  458.2043],
         [ 160.9645,  -98.6024],
         [-112.0126,  211.2028],
         [ 225.6758,    6.6948],
         [ 522.2899, -109.7905],
         [-409.9463, -343.1366],
         [-184.3017,  -71.4430]],

        [[-451.9771, -435.0675],
         [ -99.7726,  282.9023],
         [ 365.2589, -119.7121],
         [-477.9939,   73.6263],
         [ 499.0964, -331.6176],
         [  18.1039, -263.1258],
         [-494.6060, -139.7411],
         [ 227.8131,  241.6537],
         [ -33.9120, -431.4945],
         [ -60.7310, -109.6896]],

        [[ 251.2548,  -36.0051],
         [-164.2974, -434.7388],
         [ 374.7854,  310.6174],
         [-564.1057, -201.6200],
         [ 385.3519,  426.0919],
         [-283.4595,   50.7515],
         [ 233.3277,  153.5232],
         [-455.2837,  120.6840],
         [ 457.4269,   -1.5295],
         [ 102.2140,  316.5961]],

        [[-115.0217, -378.5111],
         [ 516.1429,  212.3507],
         [-220.7613,  139.9895],
         [-129.8403,  243.1015],
         [ -96.9419, -195.9207],
         [ 220.2427,  -98.2079],
         [ 428.1636,  -59.0269],
         [-294.2498, -355.9556],
         [ 220.0377,  457.6323],
         [-336.9909, -151.3562]],

        [[ 413.2727,  393.7720],
         [ 361.8648,  -81.9196],
         [-110.9737, -356.8065],
         [-381.2832, -279.3464],
         [  20.7515,  541.2260],
         [ 113.2710,  302.7433],
         [-466.7428,  -26.8655],
         [ 462.1254,  241.9475],
         [-134.0093, -501.1757],
         [  55.6113, -275.6498]],

        [[  84.5870,  196.2096],
         [ -38.1758,   73.8121],
         [ -17.7774, -404.2994],
         [ 339.2535,  291.9791],
         [   3.3189, -294.6374],
         [-379.0632, -356.9613],
         [ 268.3663,   89.6013],
         [-273.5667,  161.2067],
         [ 282.7651, -126.4932],
         [  72.0546,  462.0330]],

        [[ -58.4827, -324.0867],
         [-463.3585,  167.9108],
         [ 442.6017,  -94.3397],
         [-211.4283, -564.5096],
         [-327.2800,   -4.1652],
         [ 159.1702,   96.3507],
         [ 468.4067,   98.3498],
         [-491.4150,  -36.0108],
         [ 541.2932,   -8.5234],
         [-478.6802, -171.2464]]]) 

t:0, loss.item(): 3088.95947265625
Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0156, 0.0154,  ..., 0.0123, 0.0094, 0.0093],
        [0.0159, 0.0161, 0.0154,  ..., 0.0123, 0.0100, 0.0091],
        [0.0164, 0.0156, 0.0156,  ..., 0.0123, 0.0098, 0.0088],
        ...,
        [0.0161, 0.0161, 0.0161,  ..., 0.0137, 0.0130, 0.0127],
        [0.0161, 0.0161, 0.0156,  ..., 0.0130, 0.0125, 0.0133],
        [0.0159, 0.0159, 0.0159,  ..., 0.0114, 0.0118, 0.0112]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[-2.4802e-04, -2.4038e-04,  1.0088e-03,  ..., -2.9117e-03,
         -1.7470e-04, -1.7470e-04],
        [ 2.5602e-04, -7.4442e-04,  1.2821e-03,  ..., -2.3457e-03,
         -9.0909e-04, -9.0909e-04],
        [-7.6844e-04,  5.0403e-04,  2.6441e-04,  ..., -1.9608e-03,
         -1.0320e-03, -1.0320e-03],
        ...,
        [ 1.0000e-10,  1.0000e-10, -2.5601e-04,  ..., -1.7088e-04,
         -3.2878e-04, -3.2878e-04],
        [ 1.0000e-10, -5.0403e-04,  5.0403e-04,  ..., -4.8701e-04,
          8.3333e-04,  8.3333e-04],
        [ 1.0000e-10,  1.0000e-10,  2.5602e-04,  ...,  4.0107e-04,
         -5.2875e-04, -5.2875e-04]], grad_fn=<SelectBackward>)  








test_counter in loss_omega_mat(): 688
test_counter in loss_omega_mat(): 1376
test_counter in loss_omega_mat(): 2064
test_counter in loss_omega_mat(): 2752
test_counter in loss_omega_mat(): 3440
test_counter in loss_omega_mat(): 4128
test_counter in loss_omega_mat(): 4816
test_counter in loss_omega_mat(): 5504
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9455, 0.9455, 0.9452,  ..., 0.8939, 0.8004, 0.8002],
         [0.9457, 0.9456, 0.9455,  ..., 0.8942, 0.8006, 0.8004],
         [0.9457, 0.9457, 0.9456,  ..., 0.8943, 0.8006, 0.8005],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.8943, 0.8004, 0.8002],
         [0.9458, 0.9457, 0.9457,  ..., 0.8942, 0.8005, 0.8003],
         [0.9457, 0.9457, 0.9453,  ..., 0.8940, 0.8004, 0.8002]],

        [[0.9457, 0.9456, 0.9455,  ..., 0.8941, 0.8005, 0.8004],
         [0.9457, 0.9457, 0.9456,  ..., 0.8944, 0.8006, 0.8005],
         [0.9458, 0.9457, 0.9457,  ..., 0.8944, 0.8006, 0.8006],
         ...,
         [0.9458, 0.9458, 0.9458,  ..., 0.8946, 0.8005, 0.8004],
         [0.9458, 0.9457, 0.9457,  ..., 0.8944, 0.8005, 0.8004],
         [0.9457, 0.9457, 0.9457,  ..., 0.8942, 0.8005, 0.8004]],

        [[0.9458, 0.9458, 0.9456,  ..., 0.8943, 0.8005, 0.8005],
         [0.9458, 0.9458, 0.9457,  ..., 0.8944, 0.8006, 0.8005],
         [0.9458, 0.9458, 0.9458,  ..., 0.8945, 0.8006, 0.8005],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.8944, 0.8005, 0.8004],
         [0.9458, 0.9457, 0.9457,  ..., 0.8945, 0.8005, 0.8004],
         [0.9458, 0.9457, 0.9457,  ..., 0.8944, 0.8005, 0.8004]],

        ...,

        [[0.9444, 0.9442, 0.9439,  ..., 0.8917, 0.7989, 0.7986],
         [0.9433, 0.9401, 0.9381,  ..., 0.8905, 0.7980, 0.7975],
         [0.9432, 0.9385, 0.9381,  ..., 0.8883, 0.7977, 0.7973],
         ...,
         [0.9456, 0.9455, 0.9454,  ..., 0.8944, 0.8006, 0.8003],
         [0.9456, 0.9455, 0.9454,  ..., 0.8941, 0.8005, 0.8002],
         [0.9456, 0.9455, 0.9451,  ..., 0.8935, 0.8001, 0.8001]],

        [[0.9442, 0.9439, 0.9433,  ..., 0.8892, 0.7993, 0.7987],
         [0.9384, 0.9359, 0.9352,  ..., 0.8851, 0.7956, 0.7947],
         [0.9352, 0.9349, 0.9334,  ..., 0.8852, 0.7952, 0.7943],
         ...,
         [0.9456, 0.9456, 0.9454,  ..., 0.8944, 0.8005, 0.8003],
         [0.9456, 0.9456, 0.9455,  ..., 0.8944, 0.8005, 0.8002],
         [0.9456, 0.9456, 0.9455,  ..., 0.8936, 0.8002, 0.8001]],

        [[0.9443, 0.9433, 0.9432,  ..., 0.8898, 0.7993, 0.7986],
         [0.9370, 0.9368, 0.9352,  ..., 0.8853, 0.7936, 0.7918],
         [0.9356, 0.9349, 0.9290,  ..., 0.8835, 0.7914, 0.7914],
         ...,
         [0.9457, 0.9456, 0.9456,  ..., 0.8940, 0.8003, 0.8003],
         [0.9457, 0.9457, 0.9456,  ..., 0.8942, 0.8002, 0.8002],
         [0.9457, 0.9457, 0.9456,  ..., 0.8935, 0.8002, 0.8001]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[4.9514e-07, 4.9514e-07, 2.2938e-06,  ..., 7.7803e-08,
          7.2304e-06, 5.6658e-09],
         [8.6231e-08, 8.6231e-08, 1.4136e-06,  ..., 5.1154e-06,
          4.0583e-06, 1.8252e-07],
         [5.5503e-08, 6.0673e-07, 5.5502e-08,  ..., 3.5773e-08,
          5.2820e-07, 3.9186e-08],
         ...,
         [1.1108e-06, 2.1518e-09, 2.9094e-09,  ..., 1.4458e-07,
          1.1978e-06, 3.5992e-07],
         [1.2753e-08, 9.7873e-09, 3.7396e-08,  ..., 2.9648e-07,
          4.4435e-07, 1.4380e-07],
         [5.2692e-08, 4.6899e-07, 3.1115e-07,  ..., 9.6447e-07,
          2.8930e-07, 2.1436e-06]],

        [[2.5000e-07, 2.5000e-07, 6.1093e-07,  ..., 3.0708e-06,
          6.5543e-08, 2.6217e-07],
         [5.5503e-08, 5.2354e-07, 5.5502e-08,  ..., 1.8482e-07,
          7.0499e-11, 4.6296e-08],
         [5.5503e-08, 2.4168e-07, 1.5267e-06,  ..., 3.0493e-18,
          1.0000e-06, 6.9912e-08],
         ...,
         [1.2076e-06, 7.3106e-09, 2.5305e-07,  ..., 1.4033e-08,
          2.1290e-06, 6.8242e-08],
         [3.5903e-08, 2.6320e-07, 4.2065e-07,  ..., 5.5876e-07,
          1.0817e-06, 7.3145e-08],
         [1.2010e-06, 1.3421e-07, 3.9768e-07,  ..., 7.4512e-07,
          7.5583e-07, 3.0022e-06]],

        [[4.1718e-10, 9.5956e-07, 5.2354e-07,  ..., 4.9978e-08,
          1.6687e-09, 3.2172e-06],
         [2.5000e-07, 4.1724e-10, 2.5000e-07,  ..., 6.9912e-08,
          2.8295e-07, 6.9914e-08],
         [5.5503e-08, 5.7156e-07, 5.9528e-08,  ..., 4.8266e-07,
          5.3999e-08, 2.7084e-07],
         ...,
         [1.5003e-07, 1.2350e-07, 3.8682e-10,  ..., 7.2493e-07,
          6.9467e-07, 5.7000e-08],
         [1.3421e-07, 6.3799e-07, 1.1120e-07,  ..., 2.2260e-10,
          5.3733e-07, 7.9653e-08],
         [9.0917e-07, 1.2146e-06, 2.5000e-07,  ..., 7.5056e-07,
          1.5594e-07, 1.4573e-06]],

        ...,

        [[1.8572e-08, 5.5503e-08, 1.8572e-08,  ..., 5.0931e-06,
          9.5554e-07, 5.5351e-07],
         [2.1753e-07, 1.9299e-05, 1.5125e-05,  ..., 1.6203e-05,
          4.0323e-06, 6.0624e-05],
         [1.0826e-06, 1.0781e-05, 1.0543e-05,  ..., 1.5553e-07,
          1.7460e-06, 3.5879e-05],
         ...,
         [2.2500e-06, 1.5237e-07, 2.5000e-07,  ..., 8.4703e-20,
          1.0000e-06, 1.2313e-06],
         [2.5000e-07, 2.5000e-07, 2.2500e-06,  ..., 1.2540e-08,
          1.2365e-06, 0.0000e+00],
         [2.3102e-06, 5.5338e-07, 1.5056e-07,  ..., 4.5895e-06,
          7.1772e-06, 5.1136e-06]],

        [[6.3330e-06, 4.4966e-06, 9.8412e-06,  ..., 7.6831e-07,
          1.5286e-05, 2.1279e-05],
         [3.6163e-05, 1.2155e-04, 2.3767e-05,  ..., 1.3960e-04,
          3.4949e-04, 1.0830e-04],
         [7.7270e-05, 9.0675e-06, 9.0675e-06,  ..., 1.1810e-04,
          2.0557e-04, 3.7996e-04],
         ...,
         [2.2500e-06, 1.5237e-07, 3.7167e-07,  ..., 1.2023e-08,
          3.1709e-06, 0.0000e+00],
         [3.7452e-07, 1.5056e-07, 1.5056e-07,  ..., 2.7793e-07,
          1.0000e-06, 1.2365e-06],
         [1.4260e-07, 2.8210e-10, 1.9368e-08,  ..., 2.7593e-09,
          1.3604e-06, 4.3185e-10]],

        [[1.0788e-08, 5.1100e-06, 4.7676e-07,  ..., 1.6267e-05,
          1.0707e-05, 1.2282e-05],
         [4.3273e-08, 4.0451e-06, 3.5287e-05,  ..., 3.4743e-06,
          1.5883e-05, 2.9093e-08],
         [2.2653e-05, 1.9261e-04, 1.8010e-05,  ..., 7.6925e-05,
          1.4868e-05, 6.4706e-05],
         ...,
         [2.5000e-07, 1.1116e-06, 1.6402e-06,  ..., 1.0047e-06,
          4.5031e-07, 4.5031e-07],
         [7.3909e-10, 7.3908e-10, 7.1902e-09,  ..., 2.9334e-07,
          6.8958e-07, 2.0280e-07],
         [1.8593e-07, 4.6878e-08, 1.2768e-09,  ..., 8.1353e-08,
          1.4997e-07, 8.3733e-08]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[1.5117e-03, 2.5296e-03, 1.2987e-03,  ..., 8.7188e-04,
          1.3715e-03, 1.4681e-03],
         [1.1246e-03, 1.5455e-03, 2.5296e-03,  ..., 1.6156e-03,
          1.2031e-03, 1.7542e-03],
         [7.7644e-04, 1.1246e-03, 3.3740e-04,  ..., 1.5649e-03,
          3.6846e-04, 8.6138e-04],
         ...,
         [1.1395e-03, 1.1093e-03, 1.1033e-03,  ..., 6.4325e-04,
          5.0843e-04, 7.2257e-04],
         [2.4404e-04, 4.3572e-04, 1.1033e-03,  ..., 2.7979e-04,
          5.6891e-04, 3.3599e-04],
         [4.0108e-04, 5.9212e-04, 3.8167e-04,  ..., 8.6018e-04,
          6.9149e-04, 1.2425e-03]],

        [[5.3674e-04, 3.3989e-04, 1.5117e-03,  ..., 1.1129e-03,
          3.3989e-04, 5.4363e-04],
         [7.8680e-04, 5.3674e-04, 9.0794e-04,  ..., 9.9900e-04,
          5.2563e-04, 2.2372e-04],
         [8.7811e-04, 7.8680e-04, 7.0203e-04,  ..., 1.1054e-03,
          1.1091e-03, 2.6441e-04],
         ...,
         [7.5802e-04, 1.1395e-03, 9.5369e-04,  ..., 4.9531e-04,
          7.4115e-04, 7.8386e-04],
         [5.4217e-04, 4.3572e-04, 8.5576e-04,  ..., 5.5742e-04,
          2.0936e-04, 4.6867e-04],
         [8.5576e-04, 9.5068e-04, 4.0108e-04,  ..., 1.1641e-03,
          3.0380e-06, 7.8386e-04]],

        [[5.8208e-11, 1.1091e-03, 3.3989e-04,  ..., 9.0107e-04,
          3.3540e-04, 5.7985e-04],
         [9.0107e-04, 1.1091e-03, 7.8167e-04,  ..., 7.8680e-04,
          1.2031e-03, 3.6804e-04],
         [9.0107e-04, 4.7965e-04, 4.8131e-04,  ..., 3.1028e-04,
          3.6846e-04, 2.3098e-04],
         ...,
         [7.5802e-04, 1.3184e-04, 6.3856e-04,  ..., 8.7899e-04,
          1.3091e-03, 5.0843e-04],
         [7.4190e-04, 6.2214e-04, 1.2059e-03,  ..., 1.1136e-03,
          5.6891e-04, 8.1559e-04],
         [7.4190e-04, 9.5068e-04, 9.5261e-04,  ..., 2.7556e-04,
          4.8409e-04, 4.6541e-04]],

        ...,

        [[6.3628e-04, 1.3988e-03, 3.0265e-03,  ..., 8.5676e-03,
          2.1174e-03, 1.4234e-03],
         [4.3799e-03, 3.2956e-03, 7.1361e-03,  ..., 5.5570e-03,
          4.4954e-03, 3.9256e-03],
         [3.3374e-03, 4.0779e-03, 7.1361e-03,  ..., 8.1725e-03,
          3.1913e-03, 3.9167e-03],
         ...,
         [8.9035e-04, 8.9708e-04, 1.0000e-03,  ..., 1.0063e-03,
          1.3374e-03, 8.9708e-04],
         [1.1198e-04, 8.8802e-04, 1.0000e-03,  ..., 5.2729e-04,
          1.5837e-04, 4.3004e-04],
         [1.3090e-03, 2.5040e-04, 1.1374e-03,  ..., 6.7629e-04,
          1.2797e-03, 1.6149e-04]],

        [[1.8265e-03, 3.0265e-03, 2.5216e-03,  ..., 2.2520e-03,
          1.1940e-03, 2.6109e-03],
         [1.0065e-02, 1.0831e-02, 1.1507e-02,  ..., 3.2489e-03,
          8.1666e-03, 8.7039e-03],
         [1.1704e-02, 1.3565e-02, 1.1462e-02,  ..., 8.6491e-03,
          9.2290e-03, 9.3644e-03],
         ...,
         [8.9035e-04, 1.1842e-03, 1.5673e-04,  ..., 4.7065e-04,
          1.0965e-04, 2.3909e-04],
         [5.3895e-04, 1.1198e-04, 5.4120e-04,  ..., 3.8805e-04,
          7.8169e-04, 4.0260e-04],
         [1.3090e-03, 1.8826e-04, 5.4120e-04,  ..., 9.1093e-04,
          4.1767e-04, 1.1108e-03]],

        [[2.4994e-03, 2.5216e-03, 7.3720e-04,  ..., 9.9602e-03,
          1.8967e-03, 1.4234e-03],
         [1.8300e-03, 2.4617e-03, 1.1507e-02,  ..., 7.1342e-03,
          4.3476e-03, 2.3936e-03],
         [7.3448e-04, 1.3565e-02, 9.0872e-03,  ..., 7.7287e-03,
          5.7379e-03, 3.3157e-03],
         ...,
         [1.4102e-03, 9.5362e-04, 1.1842e-03,  ..., 1.1278e-03,
          1.1675e-04, 8.9708e-04],
         [5.7812e-04, 7.4691e-04, 5.3895e-04,  ..., 6.3813e-04,
          4.3004e-04, 2.3982e-04],
         [5.7812e-04, 5.6391e-04, 1.8826e-04,  ..., 4.3667e-04,
          9.9021e-04, 1.2797e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:285.9790954589844
t:1, Finish constructing loss
require grad ? True True False
MatD grad and MatUx grad: torch.Size([56, 123]) torch.Size([56, 123, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  1.9749e-02,  1.5399e-02, -5.5467e-03,
         -6.8497e-03, -1.0516e-02, -1.4705e-02,  0.0000e+00,  0.0000e+00],
        [-6.2448e-03,  9.3658e-02, -5.5273e-02, -3.7878e+00, -3.1666e+00,
         -2.4342e+00, -5.0341e+00,  1.4972e-02, -9.8213e-02,  7.0761e-04],
        [ 2.7547e+00, -5.4817e-01, -5.4979e-01, -6.7310e+00, -1.0121e+01,
         -4.8061e+00, -1.1754e+01, -2.3207e+00,  1.7066e+01,  6.8544e+00],
        [-2.4114e+01,  2.5560e+01, -2.1696e+01, -1.4398e+01,  4.9286e+00,
         -1.2497e+01, -1.3913e+01, -1.3285e+01,  1.5470e+00,  6.8748e+00],
        [-3.2590e+01, -2.7012e+01,  5.3736e+00,  1.0644e+01, -1.4461e+01,
         -1.9036e+01,  1.3398e+01,  2.7966e+01,  1.6213e+00, -2.3953e+01],
        [ 1.6906e+01, -8.7864e+00,  8.7644e+00,  1.1573e+01, -1.3803e+01,
          1.6169e+01, -1.6960e+01, -2.6257e+01,  1.4051e+01, -6.1841e+00],
        [ 1.7184e+01,  2.9830e+01, -4.4137e+00,  3.3413e+01, -9.5710e+00,
          1.0754e+01, -1.2892e+01, -2.2641e+01, -2.7561e+01,  1.0436e+01],
        [ 1.7699e+01, -3.3000e+01, -1.7994e+00, -2.3823e+01,  4.2829e+00,
          2.2972e+01,  5.6318e+00,  1.0697e+01, -1.1752e+01,  5.1632e+00],
        [ 2.3407e+01,  3.5342e+01,  2.3150e+00, -1.2736e+01, -3.1322e+00,
         -2.0187e+00, -3.3027e+01,  8.4950e+00,  7.2840e+00,  1.0622e+01]]) 

MatU.grad[0:10,35:45]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 2.7013e+01,  7.3557e+00],
         [ 1.6123e+01, -2.2909e+01],
         [-2.0993e+01, -1.8557e+01],
         [ 2.4371e+01,  1.3816e+01],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-7.2751e+01,  3.5863e+01],
         [-1.6547e+00,  2.6213e+01],
         [-1.3267e+01, -7.2999e+01],
         [ 5.3868e+01, -6.0652e-02],
         [ 6.2965e+01, -4.3889e+01],
         [-5.5849e+00, -1.1812e+01],
         [ 5.1242e+01, -1.9471e+01],
         [ 9.0354e+01,  3.0690e+01],
         [-5.8055e+01, -7.3055e+01],
         [-5.1822e+01, -7.4287e+01]],

        [[ 3.8009e+02,  2.5591e+02],
         [ 9.0492e+01, -3.6759e+02],
         [-3.3930e+02,  3.4657e+02],
         [-1.4744e+02, -1.5018e+02],
         [ 3.0256e+02, -6.6344e+01],
         [-2.3396e+02,  1.9930e+02],
         [-2.8271e+02, -2.1098e+02],
         [ 4.0055e+02, -3.7858e+01],
         [-2.9541e+02, -2.6269e+02],
         [ 8.9167e+01,  1.0708e+02]],

        [[-2.2451e+02,  2.9143e+02],
         [-5.3488e+01, -2.7377e+02],
         [-1.2725e+02,  2.9929e+02],
         [-1.4761e+02,  8.3939e+01],
         [-2.5026e+02, -4.4150e+02],
         [ 8.8739e+01,  2.9184e+02],
         [-2.0192e+02, -1.8335e+01],
         [ 1.7385e+02, -2.0762e+02],
         [ 1.5195e+02,  4.5145e+02],
         [-9.4734e+01, -3.9139e+02]],

        [[ 9.9716e+01, -3.1639e+02],
         [-1.2464e+02,  3.4692e+02],
         [-3.1867e+02, -3.8580e+02],
         [-1.3453e+02,  5.2460e+02],
         [ 4.9286e+02,  2.6618e+02],
         [-4.5302e+02, -1.9481e+01],
         [ 3.4321e+02,  1.5439e+02],
         [-5.2789e+01,  3.0631e+02],
         [-5.5951e+02, -7.1317e+01],
         [ 5.3377e+02,  3.2876e+02]],

        [[-2.4866e+02, -3.3968e+02],
         [-2.9720e+02, -1.2430e+02],
         [ 5.5121e+02,  1.7241e+02],
         [-2.3617e+02, -5.6716e+02],
         [ 1.1773e+02,  1.1864e+02],
         [-2.9092e+02,  3.9273e+02],
         [ 2.6464e+02, -1.5826e+02],
         [-4.2550e+02, -1.4416e+02],
         [-4.9220e+01, -4.3085e+02],
         [ 1.9001e+02, -2.7240e+02]],

        [[-2.8532e+02,  4.9550e+02],
         [ 3.4254e+02,  2.5529e+02],
         [-5.1167e+02,  1.9063e+01],
         [ 4.3221e+02,  3.0311e+02],
         [ 6.1014e+01,  1.3268e+02],
         [-4.0317e+02, -1.5102e+02],
         [ 4.2371e+01, -4.2437e+02],
         [-8.3495e+01,  3.4579e+02],
         [-8.4499e+01,  5.8435e+02],
         [ 2.7212e+02, -6.1608e+01]],

        [[ 4.1252e+02, -3.6212e+02],
         [-1.0615e+02, -1.8819e+02],
         [ 1.4171e+02, -3.8031e+02],
         [-1.7491e+02,  8.9150e+01],
         [ 1.1329e+02, -1.4132e+02],
         [-3.9936e+02,  1.0227e+02],
         [ 4.1249e+02, -7.0144e+00],
         [ 3.5297e+02, -1.1352e+02],
         [-2.1922e+02, -4.9337e+02],
         [ 1.9694e+02,  3.4251e+02]]]) 

MatD.grad: 
tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0086,  ..., -0.0104,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0027,  ..., -0.0034,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  14.9104,  -23.7214],
         [  15.3389,   23.4504],
         [  19.8148,   19.8148]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  16.7952,  -26.3944],
         [  -4.7182,   27.4306],
         [ -34.0155,  -74.5009],
         [ -43.0558,  -52.7518],
         [  48.6537,  -69.1763],
         [  58.5267,  -22.1405],
         [  99.3018,   17.3224]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  13.6408,  -47.6087],
         [-382.1049,   26.2461],
         [ 464.9486,  192.5576],
         [ 216.6459,  -15.6452],
         [-398.9688,  296.8429],
         [-185.8237, -133.5968],
         [-312.9120,  -16.2576]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -15.6509,  -51.5483],
         [ 149.5536,  121.5563],
         [-379.3698, -156.8011],
         [ 372.2881, -175.4711],
         [-204.4655,  321.1889],
         [ 464.8336, -206.1100],
         [-287.0284, -293.0413]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -14.1891,  -24.1598],
         [ -13.1131,  -93.8489],
         [  91.4872,  392.1299],
         [ 241.6915, -508.1744],
         [  73.8871,  182.8384],
         [-131.9005, -281.5217],
         [ 349.7203, -316.4925],
         [-309.1285, -338.6275]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  16.8863,  -22.3590],
         [  20.4684,  -71.5108],
         [-118.6602,  393.9474],
         [ 414.8715,   48.0921],
         [-579.3858,   43.7795],
         [-308.7177,  470.9053],
         [ 276.6258,  278.6947],
         [ 343.5820,  283.9324]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  32.2686,  -85.5865],
         [-353.4383,   95.4699],
         [ 269.7845, -438.5907],
         [-262.6771,   40.9783],
         [ 429.3699, -141.3889],
         [ 243.4264, -255.9115],
         [-202.0665, -353.0320]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -49.1210,  -57.3844],
         [ 119.6814,  231.7641],
         [-199.4632, -482.0391],
         [-350.7506,  155.9464],
         [ 383.7360,  249.9837],
         [ 184.3368,  248.9249],
         [-177.9505,  367.1952]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[-227.9335, -254.8822],
         [-215.8185, -400.1635],
         [-140.5572, -444.9794],
         [-110.2054, -379.1975],
         [ 396.5994,  425.6781],
         [ 335.0099, -267.3478],
         [ 414.5064,  365.3237],
         [-295.1857, -147.0261],
         [-374.4145,  477.4883],
         [-194.7908, -523.9224]],

        [[ 586.3151,   45.2892],
         [-295.7093, -288.6982],
         [-119.4319, -111.7885],
         [-516.3603,  193.8908],
         [-108.5290, -176.9162],
         [-241.1245, -424.5326],
         [-211.1791, -227.5437],
         [ 477.4194,   -5.4304],
         [-259.6010,  193.5737],
         [ 539.5781,  300.7641]],

        [[ 213.8196, -266.8385],
         [-245.1445,  454.8739],
         [ 201.2010,  269.7584],
         [ 358.8752, -246.2731],
         [-382.8167,  131.0639],
         [  48.9872,  377.2400],
         [  41.4287, -343.3680],
         [ 561.6832, -227.5977],
         [ 119.7262, -121.8821],
         [-539.6324, -283.8291]],

        [[ 188.2596, -309.7383],
         [ 370.8246, -384.7513],
         [-318.9962,  360.9401],
         [ 510.9542,  180.9559],
         [-256.1401,   25.3599],
         [-499.4055, -328.2380],
         [ 360.8086,  206.5768],
         [-337.5727,  353.9831],
         [-283.0235,   38.5546],
         [-295.9613, -475.1518]],

        [[ 181.2721,  315.3719],
         [ 246.1489,   62.1993],
         [-506.8045, -319.2633],
         [ 168.0254,  504.7963],
         [ 277.9633,  -48.2236],
         [ -39.3119,  603.6995],
         [ 451.5774, -297.5152],
         [-481.6878, -256.5613],
         [ 139.8785,  235.7583],
         [ 221.2377,  255.8995]],

        [[ -44.9672,    3.6113],
         [ -60.9327,  434.6962],
         [ 442.5476, -175.3952],
         [-339.7832, -385.2943],
         [  -4.1760, -380.4196],
         [-108.9660,  282.1473],
         [-373.3592,  158.5595],
         [ 148.6302,  205.1022],
         [ 318.5391, -280.1642],
         [ 554.4847,  192.6389]],

        [[-459.2240,  306.4150],
         [-435.6090, -396.7445],
         [ 230.9139,  443.1377],
         [-161.4074,  399.9088],
         [ 390.5369, -162.5719],
         [  23.1464,  -18.3904],
         [-256.3766, -477.9222],
         [-275.6550,  254.0046],
         [-393.8342,  256.4534],
         [-104.1201, -341.6937]],

        [[-116.0853,  531.7642],
         [ 357.8927, -309.0910],
         [  -2.5589, -353.6357],
         [ 471.1596,    4.5150],
         [-414.3734,  -66.1088],
         [ 439.7294,  334.5992],
         [ 311.3737, -437.2764],
         [-311.5259,   40.6108],
         [ 190.0787,  116.2174],
         [ 185.9133,  569.7762]],

        [[-109.9292, -264.4807],
         [ 238.5307,  202.3077],
         [-228.7694, -526.4155],
         [-280.5154,  361.0625],
         [ 111.7367, -348.8969],
         [-366.4208,  379.0128],
         [  40.4388,  331.8419],
         [ 539.8941,   30.9806],
         [-371.8938, -260.3800],
         [ 151.8996,  443.1624]],

        [[-198.2453,  459.9187],
         [-505.0534, -198.9094],
         [ 357.9719,  494.9552],
         [ -40.2664, -284.3128],
         [ 128.4997,  240.1199],
         [-300.5106, -420.9656],
         [-240.0360, -183.7715],
         [ 374.7772,  205.0336],
         [ 168.7845, -510.8142],
         [-514.0316, -444.2925]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[-1.1900e+01, -4.7659e+01],
         [-3.1958e+02, -3.7332e+02],
         [-1.7917e+02, -2.0454e+02],
         [ 3.8058e+02, -2.3452e+01],
         [-5.4629e+02, -5.7491e+00],
         [ 2.5109e+01, -2.6995e+02],
         [ 2.9712e+02, -2.3485e+01],
         [-8.3764e+00,  2.3449e+02],
         [-4.3567e+01,  2.4301e+01],
         [ 2.3942e+01, -9.7765e+00]],

        [[-2.8068e+02, -5.4497e+02],
         [-9.4209e+01,  1.7876e+02],
         [-5.8725e+01,  5.5460e+02],
         [-4.6289e+02, -3.9007e+02],
         [ 3.0650e+02,  4.5372e+02],
         [ 1.2391e+02,  2.9516e+02],
         [ 4.7352e+02, -1.2164e+00],
         [-1.7834e+02, -5.7505e+02],
         [ 4.1927e+01,  4.8530e+02],
         [-1.8139e+02, -2.4728e+02]],

        [[ 2.2473e+02, -4.1261e+02],
         [ 3.3384e+02, -1.4179e+02],
         [-2.0023e+02,  2.3879e+01],
         [ 2.0127e+02, -1.6750e+01],
         [ 1.3911e+02,  1.5435e+02],
         [-2.2194e+02, -3.9886e+02],
         [ 1.1837e+01,  1.9334e+01],
         [ 4.3617e+02,  1.1823e+02],
         [-2.5510e+02,  4.2800e+02],
         [ 2.1969e+02,  2.1228e+02]],

        [[ 3.5841e+02,  3.4362e+02],
         [ 2.6592e+02,  5.3979e+02],
         [-2.9316e+02, -3.2817e+02],
         [ 3.7231e+02, -1.9910e+02],
         [-4.8539e+02,  3.5917e+02],
         [ 1.6297e+02, -3.2157e+02],
         [ 1.6929e+02, -5.4906e+01],
         [ 5.2655e+02, -8.9342e+01],
         [-4.0829e+02, -3.3910e+02],
         [-1.6177e+02,  2.3407e+00]],

        [[-4.1783e+02, -3.1158e+02],
         [ 5.4992e+02, -1.3936e+02],
         [ 4.4696e+00,  4.8518e+02],
         [-3.6805e+02, -4.3673e+02],
         [-8.7567e+01,  5.3396e+01],
         [-3.4049e+02,  1.8244e+02],
         [-4.8431e+02,  3.4425e+01],
         [ 2.1616e+02,  2.0816e+02],
         [-1.9271e+01, -4.3090e+02],
         [ 2.2116e+02,  1.3778e+02]],

        [[-2.0804e+02,  4.7716e+02],
         [ 1.4089e+02, -2.7195e+02],
         [-6.3351e+01,  1.6900e+02],
         [-6.1715e+02,  6.2653e+01],
         [ 2.0498e+02,  1.3914e+02],
         [ 1.8043e+02, -4.1878e+02],
         [ 2.5252e+02, -3.3220e+01],
         [-4.5595e+02,  9.1712e+01],
         [ 4.5693e+02,  4.1710e+01],
         [ 2.0983e+01,  3.3262e+02]],

        [[ 1.7951e+02, -2.3332e+02],
         [ 3.7820e+02,  4.4172e+01],
         [-3.8581e+01, -5.3752e+02],
         [ 2.2728e+02, -2.0715e+02],
         [ 4.5719e+02,  2.6239e+02],
         [-1.0961e+02,  3.8629e+02],
         [ 4.0809e+02,  9.7160e+01],
         [-2.8647e+02, -3.5872e+02],
         [ 2.1796e+02,  4.5424e+02],
         [-3.0677e+01,  9.2739e+01]],

        [[ 2.7150e+02,  6.8522e+01],
         [-2.2173e+02,  4.6226e+02],
         [ 2.9994e+02,  2.9087e+01],
         [-3.0314e+02, -1.3055e+02],
         [-3.3329e+02,  2.7925e+02],
         [-6.9530e+01,  1.3228e+01],
         [-4.6876e+02, -1.9896e-01],
         [ 4.6315e+02,  2.3424e+02],
         [-1.2069e+02, -5.0130e+02],
         [-1.8953e+02, -2.4970e+02]],

        [[-4.4975e+02, -3.0659e+02],
         [ 4.0299e+02, -4.7006e+02],
         [ 3.2354e+02, -1.1390e+02],
         [-2.7145e+01, -1.2799e+02],
         [-5.9736e+02, -7.9615e+01],
         [-9.9983e+01, -1.7289e+02],
         [ 2.5182e+02,  2.8818e+01],
         [-2.6568e+02,  1.2651e+02],
         [ 2.7490e+02, -1.0806e+02],
         [ 3.5528e+00,  4.6226e+02]],

        [[ 3.7212e+02,  2.7990e+02],
         [-1.5057e+02, -2.5191e+02],
         [ 2.4044e+02,  1.4348e+02],
         [-1.2442e+01, -5.9871e+02],
         [ 1.2366e+02,  4.6638e+02],
         [-9.7535e+01, -1.6028e+02],
         [ 5.0812e+02, -1.8961e+01],
         [-5.3395e+02,  9.4252e+01],
         [ 5.3772e+02,  6.2708e+00],
         [-1.7769e+02,  4.8082e+01]]]) 

t:1, loss.item(): 2859.791015625
Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0156, 0.0154,  ..., 0.0123, 0.0094, 0.0093],
        [0.0159, 0.0161, 0.0154,  ..., 0.0123, 0.0100, 0.0091],
        [0.0164, 0.0156, 0.0151,  ..., 0.0127, 0.0098, 0.0088],
        ...,
        [0.0161, 0.0161, 0.0158,  ..., 0.0141, 0.0130, 0.0127],
        [0.0161, 0.0161, 0.0156,  ..., 0.0130, 0.0125, 0.0133],
        [0.0159, 0.0159, 0.0159,  ..., 0.0114, 0.0118, 0.0112]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[-2.4802e-04, -2.4038e-04,  1.0088e-03,  ..., -2.9117e-03,
         -1.7470e-04, -1.7470e-04],
        [ 2.5602e-04, -7.4442e-04,  1.2821e-03,  ..., -2.3457e-03,
         -9.0909e-04, -9.0909e-04],
        [-7.6844e-04,  5.0403e-04,  2.6441e-04,  ..., -1.9608e-03,
         -1.0320e-03, -1.0320e-03],
        ...,
        [ 1.0000e-10,  1.0000e-10, -2.5601e-04,  ..., -1.7088e-04,
         -3.2878e-04, -3.2878e-04],
        [ 1.0000e-10, -5.0403e-04,  5.0403e-04,  ..., -4.8701e-04,
          8.3333e-04,  8.3333e-04],
        [ 1.0000e-10,  1.0000e-10,  2.5602e-04,  ...,  4.0107e-04,
         -5.2875e-04, -5.2875e-04]], grad_fn=<SelectBackward>)  








test_counter in loss_omega_mat(): 688
test_counter in loss_omega_mat(): 1376
test_counter in loss_omega_mat(): 2064
test_counter in loss_omega_mat(): 2752
test_counter in loss_omega_mat(): 3440
test_counter in loss_omega_mat(): 4128
test_counter in loss_omega_mat(): 4816
test_counter in loss_omega_mat(): 5504
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9456, 0.9453, 0.9443,  ..., 0.8931, 0.8002, 0.8000],
         [0.9458, 0.9458, 0.9453,  ..., 0.8938, 0.8006, 0.8005],
         [0.9458, 0.9458, 0.9458,  ..., 0.8939, 0.8007, 0.8005],
         ...,
         [0.9459, 0.9457, 0.9457,  ..., 0.8937, 0.8007, 0.8005],
         [0.9459, 0.9458, 0.9457,  ..., 0.8937, 0.8007, 0.8003],
         [0.9459, 0.9458, 0.9452,  ..., 0.8938, 0.8006, 0.8005]],

        [[0.9458, 0.9457, 0.9456,  ..., 0.8936, 0.8005, 0.8005],
         [0.9459, 0.9459, 0.9458,  ..., 0.8943, 0.8006, 0.8006],
         [0.9459, 0.9459, 0.9458,  ..., 0.8946, 0.8007, 0.8005],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.8946, 0.8007, 0.8006],
         [0.9459, 0.9459, 0.9459,  ..., 0.8945, 0.8007, 0.8004],
         [0.9459, 0.9459, 0.9458,  ..., 0.8941, 0.8007, 0.8006]],

        [[0.9459, 0.9457, 0.9457,  ..., 0.8942, 0.8006, 0.8005],
         [0.9459, 0.9459, 0.9459,  ..., 0.8945, 0.8006, 0.8006],
         [0.9459, 0.9459, 0.9459,  ..., 0.8946, 0.8007, 0.8006],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.8946, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9459,  ..., 0.8946, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9458,  ..., 0.8943, 0.8007, 0.8006]],

        ...,

        [[0.9450, 0.9448, 0.9441,  ..., 0.8915, 0.7995, 0.7988],
         [0.9445, 0.9412, 0.9400,  ..., 0.8911, 0.7991, 0.7977],
         [0.9443, 0.9405, 0.9400,  ..., 0.8890, 0.7990, 0.7979],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.8943, 0.8006, 0.8005],
         [0.9458, 0.9457, 0.9457,  ..., 0.8942, 0.8005, 0.8004],
         [0.9458, 0.9457, 0.9455,  ..., 0.8929, 0.8003, 0.8002]],

        [[0.9448, 0.9441, 0.9440,  ..., 0.8889, 0.7992, 0.7987],
         [0.9395, 0.9375, 0.9368,  ..., 0.8840, 0.7961, 0.7953],
         [0.9372, 0.9365, 0.9357,  ..., 0.8843, 0.7960, 0.7953],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.8944, 0.8005, 0.8004],
         [0.9457, 0.9457, 0.9457,  ..., 0.8943, 0.8004, 0.8003],
         [0.9458, 0.9458, 0.9457,  ..., 0.8931, 0.8003, 0.8002]],

        [[0.9444, 0.9441, 0.9429,  ..., 0.8895, 0.7988, 0.7985],
         [0.9381, 0.9369, 0.9368,  ..., 0.8843, 0.7925, 0.7920],
         [0.9365, 0.9351, 0.9300,  ..., 0.8840, 0.7907, 0.7907],
         ...,
         [0.9458, 0.9457, 0.9457,  ..., 0.8938, 0.8004, 0.8003],
         [0.9458, 0.9457, 0.9457,  ..., 0.8939, 0.8003, 0.8001],
         [0.9458, 0.9458, 0.9454,  ..., 0.8929, 0.8002, 0.8002]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[5.1427e-07, 1.5846e-08, 1.3394e-06,  ..., 1.3483e-06,
          1.3907e-07, 3.7368e-06],
         [2.0014e-07, 1.4675e-10, 1.1889e-08,  ..., 2.0638e-06,
          2.2448e-06, 1.7228e-07],
         [1.0342e-07, 1.4077e-07, 4.1090e-09,  ..., 1.8116e-07,
          8.3247e-09, 3.7095e-07],
         ...,
         [2.6271e-07, 1.0247e-06, 5.4809e-09,  ..., 5.9503e-07,
          3.9885e-07, 4.2562e-07],
         [6.2453e-11, 2.5485e-07, 8.7403e-08,  ..., 2.3165e-07,
          1.6146e-07, 2.4505e-07],
         [1.5146e-07, 5.6172e-07, 5.4691e-07,  ..., 1.3867e-06,
          1.1718e-07, 4.8790e-07]],

        [[1.6553e-10, 3.1734e-08, 1.0284e-07,  ..., 2.2180e-06,
          4.7023e-08, 6.5311e-09],
         [8.4693e-08, 7.3810e-08, 1.1011e-07,  ..., 2.9903e-07,
          2.4181e-09, 3.8452e-07],
         [2.5729e-07, 2.1520e-07, 5.1615e-08,  ..., 2.2928e-07,
          3.5387e-07, 1.3698e-06],
         ...,
         [2.3276e-09, 1.1925e-07, 4.1000e-10,  ..., 4.7329e-07,
          1.9349e-07, 4.5584e-08],
         [3.7333e-10, 1.3446e-07, 3.9020e-07,  ..., 1.0126e-08,
          5.9814e-08, 1.0452e-07],
         [5.6118e-07, 5.5531e-08, 4.0154e-08,  ..., 9.8358e-08,
          2.8556e-07, 1.7562e-06]],

        [[3.3991e-07, 3.4168e-07, 7.3700e-07,  ..., 1.8344e-06,
          7.2322e-07, 3.1545e-07],
         [1.6061e-13, 2.4382e-07, 1.1666e-07,  ..., 5.8029e-10,
          1.4750e-07, 9.7135e-07],
         [7.8611e-09, 2.5833e-07, 4.5166e-10,  ..., 2.1050e-07,
          7.9578e-08, 4.7366e-11],
         ...,
         [1.3943e-10, 5.7103e-08, 2.3346e-07,  ..., 3.0873e-07,
          1.5490e-09, 7.1163e-09],
         [5.0248e-09, 1.3029e-07, 1.6350e-08,  ..., 8.8637e-08,
          1.1282e-07, 1.8440e-07],
         [2.0835e-08, 1.0662e-07, 3.7043e-07,  ..., 2.5243e-07,
          4.6378e-09, 6.1031e-07]],

        ...,

        [[2.7453e-07, 1.1581e-06, 1.0829e-06,  ..., 2.3369e-06,
          9.9344e-07, 1.9795e-06],
         [1.2040e-08, 1.3842e-05, 1.7882e-05,  ..., 8.4636e-06,
          4.1941e-07, 3.5193e-05],
         [2.9522e-07, 6.9852e-06, 3.6406e-06,  ..., 2.0345e-07,
          5.0884e-07, 1.8700e-05],
         ...,
         [2.4900e-07, 3.2566e-07, 3.9117e-07,  ..., 1.4088e-08,
          8.6637e-08, 6.1561e-08],
         [3.0130e-07, 5.2331e-08, 2.3458e-07,  ..., 1.3506e-07,
          2.6194e-08, 3.8505e-06],
         [1.1895e-07, 3.9777e-07, 4.4916e-08,  ..., 1.1206e-06,
          3.6581e-06, 1.7531e-06]],

        [[5.8399e-06, 2.7928e-06, 2.9995e-06,  ..., 3.4017e-11,
          1.8327e-05, 3.7643e-06],
         [3.0297e-05, 9.1129e-05, 2.7640e-05,  ..., 1.3391e-04,
          2.7959e-04, 8.3060e-05],
         [5.6867e-05, 1.1409e-05, 1.1410e-05,  ..., 9.5550e-05,
          1.5816e-04, 7.3468e-05],
         ...,
         [2.4448e-07, 3.1292e-07, 1.0150e-06,  ..., 5.0184e-08,
          8.4132e-07, 4.3903e-06],
         [1.6437e-07, 1.1323e-07, 9.6661e-08,  ..., 1.3271e-07,
          1.9225e-07, 9.0997e-08],
         [2.0839e-07, 3.1602e-08, 2.4490e-07,  ..., 5.9641e-07,
          6.0822e-07, 4.8635e-09]],

        [[7.0764e-08, 1.2909e-06, 2.2831e-08,  ..., 1.1763e-07,
          9.1066e-06, 8.7488e-06],
         [3.3705e-07, 1.9902e-06, 2.0771e-05,  ..., 4.7563e-08,
          8.3272e-06, 5.1309e-07],
         [1.7542e-04, 1.9647e-05, 1.8665e-05,  ..., 6.0305e-05,
          3.4444e-05, 1.0970e-05],
         ...,
         [6.3246e-07, 1.1644e-06, 2.6261e-07,  ..., 4.3571e-07,
          2.8806e-07, 4.5073e-07],
         [1.0919e-08, 9.7088e-08, 1.4843e-10,  ..., 7.2701e-08,
          3.5711e-07, 2.9405e-07],
         [3.0724e-07, 4.3122e-08, 3.2645e-07,  ..., 3.0788e-07,
          2.2497e-07, 2.5768e-07]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[1.0533e-03, 1.5016e-03, 7.4155e-04,  ..., 8.3360e-04,
          9.2027e-04, 3.5752e-04],
         [7.8638e-04, 6.7733e-04, 1.5016e-03,  ..., 6.3747e-04,
          5.6437e-04, 9.1809e-04],
         [6.4882e-04, 6.7733e-04, 3.2849e-04,  ..., 1.2230e-03,
          1.3152e-04, 8.5852e-04],
         ...,
         [5.4018e-04, 4.1696e-05, 2.5913e-04,  ..., 2.6208e-04,
          5.1499e-04, 7.8882e-04],
         [3.7793e-04, 6.9844e-04, 2.5913e-04,  ..., 5.4821e-04,
          3.4906e-05, 2.1935e-04],
         [2.9915e-04, 6.9844e-04, 6.8443e-04,  ..., 5.1738e-04,
          6.5131e-04, 7.8882e-04]],

        [[6.1860e-04, 7.0540e-04, 1.0533e-03,  ..., 1.2168e-03,
          6.9436e-04, 5.4385e-04],
         [3.4782e-04, 2.2266e-04, 7.8638e-04,  ..., 7.8209e-04,
          6.7852e-04, 4.9124e-04],
         [5.5142e-04, 3.4782e-04, 6.4882e-04,  ..., 6.6979e-04,
          9.4785e-04, 6.9436e-04],
         ...,
         [5.4018e-04, 1.4207e-04, 5.2706e-04,  ..., 5.1105e-04,
          4.1115e-04, 5.8147e-04],
         [3.7793e-04, 3.8846e-04, 4.8952e-04,  ..., 2.2410e-04,
          2.4099e-04, 4.7646e-04],
         [4.8952e-04, 2.9915e-04, 7.1446e-04,  ..., 8.4367e-04,
          3.3178e-04, 5.8147e-04]],

        [[1.8823e-04, 6.5175e-04, 7.0540e-04,  ..., 4.2214e-04,
          4.8804e-04, 6.5076e-04],
         [6.5840e-04, 2.2266e-04, 3.7169e-04,  ..., 5.1724e-04,
          5.6437e-04, 4.0843e-04],
         [5.0304e-04, 5.5142e-04, 3.7169e-04,  ..., 6.0785e-04,
          1.3152e-04, 5.2163e-04],
         ...,
         [2.9859e-04, 1.4207e-04, 2.3490e-04,  ..., 7.7246e-04,
          3.8128e-04, 5.1499e-04],
         [9.4503e-05, 3.8846e-04, 1.4748e-04,  ..., 3.0013e-04,
          3.4906e-05, 4.0163e-04],
         [9.4503e-05, 5.6507e-04, 7.1446e-04,  ..., 1.6968e-04,
          6.8223e-04, 6.5131e-04]],

        ...,

        [[5.7722e-04, 1.6855e-03, 2.7108e-04,  ..., 8.0871e-03,
          1.2598e-03, 8.7807e-04],
         [3.9467e-03, 3.2633e-03, 6.1376e-03,  ..., 4.5659e-03,
          3.5548e-03, 3.0063e-03],
         [2.5000e-03, 2.7415e-03, 6.1376e-03,  ..., 7.1871e-03,
          2.5569e-03, 2.9070e-03],
         ...,
         [9.0626e-04, 8.7058e-04, 7.7352e-04,  ..., 4.9391e-04,
          7.1081e-04, 6.3832e-04],
         [8.9261e-04, 5.7242e-04, 6.0947e-04,  ..., 2.2989e-04,
          5.2278e-04, 7.9237e-04],
         [5.2917e-04, 5.0551e-04, 3.6602e-04,  ..., 5.5921e-04,
          2.3993e-04, 4.9560e-04]],

        [[1.6855e-03, 1.4723e-03, 1.6533e-03,  ..., 1.4256e-03,
          1.6823e-03, 2.2188e-04],
         [9.0860e-03, 9.5348e-03, 1.0252e-02,  ..., 2.6946e-03,
          7.0468e-03, 7.9468e-03],
         [1.0782e-02, 1.2591e-02, 1.0518e-02,  ..., 8.3142e-03,
          8.5919e-03, 1.2539e-02],
         ...,
         [8.7058e-04, 8.8003e-04, 1.1247e-03,  ..., 3.3557e-04,
          1.3154e-03, 5.6017e-04],
         [3.4514e-04, 5.6094e-05, 5.7242e-04,  ..., 4.9391e-04,
          7.5701e-04, 3.6504e-04],
         [1.9824e-04, 5.2917e-04, 3.4514e-04,  ..., 5.5031e-04,
          6.1096e-04, 7.0967e-04]],

        [[1.5265e-03, 1.4723e-03, 3.2489e-04,  ..., 9.4348e-04,
          8.7807e-04, 1.7726e-03],
         [1.4879e-03, 2.1522e-03, 1.0252e-02,  ..., 7.4793e-03,
          3.0802e-03, 1.5146e-03],
         [1.2591e-02, 6.0476e-04, 8.0612e-03,  ..., 2.6946e-03,
          6.6621e-03, 5.6111e-03],
         ...,
         [8.8003e-04, 8.5311e-04, 6.1778e-04,  ..., 4.2679e-04,
          3.1270e-04, 5.0029e-04],
         [5.1230e-04, 5.6094e-05, 6.1778e-04,  ..., 3.6787e-04,
          5.6842e-04, 2.8605e-04],
         [1.9824e-04, 5.1230e-04, 8.2454e-04,  ..., 2.8460e-04,
          4.9560e-04, 7.6262e-04]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:239.8206329345703
t:2, Finish constructing loss
require grad ? True True False
MatD grad and MatUx grad: torch.Size([56, 123]) torch.Size([56, 123, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  1.4452e-02, -4.1609e-03,
         -5.8985e-03, -9.1996e-03, -7.0362e-03,  0.0000e+00,  0.0000e+00],
        [-1.9066e-02,  7.9522e-02, -3.0815e-02,  2.9799e-02, -4.8819e+00,
          3.1577e-01, -5.0365e+00,  4.5876e-02, -9.3182e-02, -8.4427e-03],
        [ 4.4935e+00,  6.4666e+00,  4.5567e+00, -9.0148e+00, -8.4034e+00,
          2.7611e+00, -1.5393e+01,  2.3972e+00,  1.4085e+01,  5.3486e+00],
        [-3.1468e+01,  5.5382e+00, -3.3197e+00, -9.4439e+00, -4.7607e-01,
         -2.0714e+01,  1.3103e+01,  1.0045e+01, -3.4185e+01,  2.1610e+01],
        [-1.6997e+01, -8.8191e+00, -1.7911e+01, -1.4748e+00, -9.9196e+00,
         -2.2207e+01, -1.0621e+01, -4.0023e+00,  2.8370e+01, -9.8157e+00],
        [ 2.2157e+01, -2.5826e+01, -4.2441e+00, -8.0442e+00, -4.6482e+00,
         -4.4446e+00,  6.0929e+00, -3.5451e+01, -2.9312e+01,  3.1322e+01],
        [ 3.7555e+01,  2.7337e+01,  2.6100e+01,  2.2186e+01, -4.2108e-01,
          1.4098e+01,  1.2820e+00, -1.2683e+01, -1.7222e+01, -1.2664e+01],
        [ 2.6528e+00, -1.3884e+01, -3.1096e+01,  9.1801e+00, -6.0052e+00,
          2.1618e+01,  5.7645e+00,  1.3775e+01,  6.4010e+00,  3.3728e+01],
        [ 4.9298e+01,  1.5624e+01, -3.7623e+01,  1.3285e+01, -1.1343e+00,
          1.4474e+00, -3.1431e+01, -2.4059e+01, -1.1067e+01,  3.2817e+01]]) 

MatU.grad[0:10,35:45]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 2.5655e+01,  1.1216e+01],
         [-2.3480e+01, -1.5279e+01],
         [ 2.6421e+01,  9.2954e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-4.5947e+01,  7.3373e+01],
         [-4.1864e+01,  5.8483e+01],
         [ 2.7389e+01, -3.4832e+01],
         [ 6.7839e+01,  9.0518e+01],
         [-9.9767e+01,  5.4999e+01],
         [-1.1670e+02, -3.0831e+01],
         [ 1.1709e+01,  5.3290e+01],
         [ 9.4116e+01,  1.6109e+01],
         [-4.4680e+01, -8.3594e+01],
         [-8.5147e+01, -3.3225e+01]],

        [[ 3.0126e+02,  7.5636e+01],
         [ 2.4277e+02, -1.1327e+02],
         [-3.3331e+02,  4.0819e+01],
         [ 8.5995e+01, -1.3466e+02],
         [-1.7569e+02, -3.1716e+02],
         [ 9.5156e+01,  5.7066e+00],
         [-1.5354e+02, -1.4746e+02],
         [ 2.9560e+02, -6.2648e+01],
         [-1.0209e+02, -2.2815e+01],
         [-2.0565e+02, -3.3446e+02]],

        [[-5.1370e+01,  3.0086e+02],
         [-2.3598e+02, -3.4587e+02],
         [-2.3380e+01,  1.9780e+02],
         [-3.0755e+02,  3.0309e+02],
         [-2.2078e+02, -7.5705e+01],
         [ 2.9010e+02, -1.7599e+02],
         [ 1.2486e+02,  4.9567e+02],
         [ 2.9259e+02, -4.5408e+02],
         [-3.5912e+02,  1.9089e+02],
         [ 2.1681e+02, -3.8943e+01]],

        [[-4.3265e+02, -1.1218e+02],
         [-1.4522e+02,  3.9288e+02],
         [-3.3028e+02, -2.0579e+02],
         [ 3.5479e+01,  5.6070e+02],
         [ 4.9108e+02,  2.1013e+02],
         [-3.9873e+02,  1.7157e+02],
         [-2.3997e+02,  1.3123e+02],
         [-1.5342e+02, -1.8687e+02],
         [-4.2548e+02,  2.7027e+02],
         [ 4.1245e+02,  3.6654e+02]],

        [[-2.6417e+01, -8.7309e+01],
         [ 2.3523e+02, -2.6284e+02],
         [ 5.4940e+02,  7.3423e+01],
         [-1.9317e+02, -5.6420e+02],
         [ 9.9695e+00, -1.1793e+02],
         [-2.6172e+02,  4.1386e+02],
         [-1.1420e+02, -2.8187e+02],
         [-8.6929e+01,  2.1289e+02],
         [ 1.5246e+02, -1.9942e+02],
         [-2.6292e+02, -4.4645e+01]],

        [[-4.0238e+02,  2.6675e+02],
         [ 1.9935e+02,  3.9179e+02],
         [-3.7602e+02, -3.1126e+02],
         [ 4.0333e+02,  2.5733e+02],
         [-8.9983e+01,  2.7508e+02],
         [-3.9910e+02, -1.0331e+01],
         [ 1.1226e+02, -3.1044e+02],
         [ 2.4453e+02, -4.0810e+01],
         [-1.2587e+02,  5.7409e+02],
         [ 2.6217e+00, -7.8079e+01]],

        [[ 3.9739e+01, -2.6555e+02],
         [-4.5375e+02, -2.5478e-01],
         [ 1.9149e+01,  1.8398e+02],
         [ 1.1297e+02, -4.1842e+02],
         [ 4.9963e+01,  1.5904e+02],
         [-4.2015e+02, -1.1244e+02],
         [ 4.3148e+02, -1.7993e+02],
         [ 2.4310e+02,  6.5185e+01],
         [-1.1016e+02, -5.2283e+02],
         [ 7.9124e+01,  2.1357e+02]]]) 

MatD.grad: 
tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0149,  ..., -0.0078,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0023,  ..., -0.0047,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -18.8657,  -24.9243],
         [   4.5739,   25.8627],
         [ -34.8167,  -73.5159],
         [ -16.8567,  -63.0765],
         [  50.3445,  -57.9315],
         [  96.5103,  -38.8446],
         [ -77.7318,  -72.5418]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -17.9331,  -52.7443],
         [-305.7660,  135.9171],
         [ 506.5678,  -58.9408],
         [ 114.2146,  388.7082],
         [-174.2192,  306.3414],
         [-172.8830, -224.5239],
         [ -65.3951, -446.3673]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -14.6966,  -77.3396],
         [ 219.0522,  337.0473],
         [-170.0098, -330.7541],
         [ 242.5105, -495.9226],
         [-465.0898,  336.4214],
         [ 285.6637,  -59.9584],
         [ -30.9616,  142.8157]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  59.6134,  -63.0793],
         [-394.2234,   92.8480],
         [ 164.5874, -263.1091],
         [ 444.9547,  164.8478],
         [-338.9589, -352.5436],
         [ 424.7151, -194.0719],
         [-225.5682, -255.0757]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  52.0007,   77.0917],
         [-298.9439,  -22.7312],
         [ 167.1809,  504.0712],
         [-195.4409,  491.3055],
         [-324.4355,   60.0628],
         [ 341.6201,  381.4925],
         [ 172.2938,  385.3536]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  49.4084,  -18.4513],
         [  21.6102, -372.6161],
         [ 440.3272, -175.8545],
         [-277.9383, -378.6854],
         [ 105.2203, -481.3052],
         [ 346.7539, -309.5344],
         [-398.3739, -340.1086]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -59.6939,   67.0506],
         [ 420.3553,  237.9928],
         [-482.7009, -258.6304],
         [-270.3565,  453.5106],
         [ 146.0911,  315.5896],
         [ 490.6833,  157.9639],
         [-479.1014,  102.9192]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[  72.1175, -148.6413],
         [-116.3711,  -90.1577],
         [-294.9211,  -42.3554],
         [-506.6200,   -7.8011],
         [ 204.2807,  141.7383],
         [-133.6310,  398.4110],
         [  80.5029,  101.9195],
         [-351.6982,  491.6100],
         [-135.3454,  384.3162],
         [ 330.7603,  242.5695]],

        [[ 260.3061, -481.0537],
         [-211.8643,   48.7560],
         [-311.1044, -385.6865],
         [-174.6521,  342.9260],
         [ 398.8304,  349.6330],
         [-323.2444,  -60.7377],
         [ 455.7265, -319.6117],
         [ -61.5822, -452.0267],
         [ 331.0316,  -82.0610],
         [ 283.8165, -190.1231]],

        [[ 542.5182,  -26.5693],
         [-282.7404,  363.2130],
         [ 521.3729,  238.8895],
         [ 225.2491, -397.0349],
         [-154.9203, -497.3082],
         [-475.7317, -257.3658],
         [ 472.5018,  265.8636],
         [ 303.8852, -103.2353],
         [-536.9371, -301.0752],
         [-505.4008,  198.2301]],

        [[ 461.2278,   58.1143],
         [ -97.0297, -257.6631],
         [-465.9172,  265.1834],
         [ 133.2729,  403.7158],
         [-297.2484,  315.8506],
         [ -31.9070,  223.8280],
         [-226.0139, -407.6794],
         [-272.6141,  294.5071],
         [ 272.2130,  492.6208],
         [-240.4504, -366.5631]],

        [[ 126.4615,  305.4980],
         [ 281.9030, -469.9227],
         [-379.4303, -207.3605],
         [ 454.5081,  292.1815],
         [ 238.2507, -396.1809],
         [-383.0651,  394.4822],
         [ 435.4494, -137.7408],
         [-292.1928, -309.2506],
         [ 583.0958,  153.7839],
         [-389.6065,   95.5663]],

        [[-279.9420, -502.5659],
         [ 535.2581,  306.9134],
         [  68.6785, -358.4766],
         [-503.8476, -105.4987],
         [ 432.5568, -122.1444],
         [-431.6700, -342.4109],
         [ -39.3856,  437.4078],
         [ 305.6304,  340.6507],
         [  55.3445, -303.8799],
         [ -11.2075, -315.9958]],

        [[ -50.3675,  487.7958],
         [-304.4240,  -56.2837],
         [ 185.4007,  357.0714],
         [-425.2178,  307.7161],
         [  12.3135,  407.1765],
         [ 336.2510,  422.8412],
         [-288.6894, -365.3065],
         [-422.9128,  185.1737],
         [-237.8908,  429.6190],
         [ 496.6264,  387.4799]],

        [[-390.4437,  336.8436],
         [ 122.9242, -305.4428],
         [ 476.5665,  -85.2096],
         [  96.0725, -425.9528],
         [-310.3024, -336.5438],
         [ 298.8880,  133.6179],
         [ 458.1928, -362.0582],
         [ -58.5336, -244.3331],
         [ 297.9898, -373.5845],
         [-380.5401,  211.6316]],

        [[-343.5610, -280.5941],
         [ 261.6457,  272.8845],
         [-176.2840, -579.2918],
         [-133.5411,  403.2263],
         [ 356.2351, -269.3847],
         [-333.4975,   62.4131],
         [-523.4709,  235.2787],
         [ 297.2777,  553.5689],
         [ -94.3123, -439.5966],
         [ 383.5972,  256.1853]],

        [[ -47.5865,  324.4440],
         [-539.4128,  -24.7125],
         [ 363.5921,  559.4911],
         [-335.7524,  -79.0949],
         [ 161.0190,  125.9242],
         [  20.2228,    3.8887],
         [  -6.2716, -534.0982],
         [-453.6779,  152.0995],
         [ 277.4497,  205.4483],
         [-335.0399, -117.2287]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[-461.2563, -343.3300],
         [ -95.5553,  261.5182],
         [ 398.5152,  374.4933],
         [  67.2705, -610.4337],
         [-431.5405,  308.5265],
         [ 231.8793,  -14.0742],
         [ 315.4411,  -76.5745],
         [ -35.6735,  182.1637],
         [-126.3528,  146.8497],
         [ 296.6398,   -7.7215]],

        [[ 370.4688, -131.4958],
         [ 107.0479, -531.1245],
         [-445.1118,  295.4003],
         [-320.7775, -276.4256],
         [-215.0589, -201.9800],
         [ -53.8651,  151.1350],
         [ 465.7582,   76.3296],
         [-136.9034, -579.6299],
         [  55.7153,  478.4610],
         [-197.4761, -170.9560]],

        [[-348.9920, -188.2858],
         [  99.5665,  423.2412],
         [-152.1108, -504.8283],
         [ -28.7205,  549.1852],
         [ 263.4829,  318.4516],
         [ 169.7670, -181.3152],
         [   0.8641, -210.8627],
         [ 407.8723,   91.8222],
         [-227.4451,  447.1119],
         [ 134.6382,  181.8095]],

        [[ 267.0683, -212.8578],
         [ -61.0109,  168.1383],
         [ 470.7628,  250.1508],
         [ -96.5762, -306.2936],
         [-201.5704,   30.8323],
         [  -3.6215, -367.7548],
         [ 119.1459,   84.2195],
         [ 529.2144,  -70.2589],
         [-405.3677, -335.7208],
         [  96.9887,  139.9899]],

        [[  67.5828,   99.6331],
         [ 432.5329, -269.4851],
         [-199.3495,  213.0604],
         [ 169.5382, -258.0978],
         [-401.0051,  442.4415],
         [ -12.3845,  361.5054],
         [-388.0088,  154.0215],
         [ 264.0116,  192.5075],
         [  -0.7969, -427.7337],
         [ 148.9353,  -90.3831]],

        [[-231.8070,  224.2744],
         [ 327.0813,  325.9335],
         [-212.0968, -458.1267],
         [-501.4012,  263.8481],
         [-419.1880, -309.1136],
         [ 360.9477, -190.8714],
         [ 217.2911, -182.8371],
         [-454.0323,   67.4505],
         [ 453.6112,   40.3654],
         [-205.2272,  269.6664]],

        [[ 137.5079,  576.8636],
         [ -68.1168, -523.5927],
         [ 545.9821, -265.2090],
         [ 152.4037, -213.7709],
         [ 172.8216,  206.3520],
         [-236.4334,  283.9164],
         [ 398.3344,  109.2902],
         [-282.0116, -357.4147],
         [ 211.5985,  453.3094],
         [ 112.5749,  165.9055]],

        [[-261.9356, -410.0599],
         [-280.1784,   33.1097],
         [ 201.6136,  355.3170],
         [ 293.1859,  477.5064],
         [  68.8315, -257.1692],
         [-290.9709, -389.6985],
         [-466.2378,  154.1198],
         [ 462.4968,  228.7589],
         [-110.3881, -499.7599],
         [-142.0480,  126.5995]],

        [[-340.6301, -125.4882],
         [ 477.0045, -203.7629],
         [-136.1397,  218.4785],
         [-367.4224, -454.8746],
         [-401.9127,  347.6212],
         [ 160.0112,  345.2213],
         [ 233.2898, -138.9122],
         [-260.7269,  -21.2104],
         [ 262.1639,  -76.8721],
         [-366.5763,  332.0784]],

        [[ 133.9314,  434.9280],
         [ 209.5972, -289.4721],
         [-265.2502,  238.4720],
         [ 376.4796, -491.9062],
         [ 443.4789,  207.9238],
         [-357.6642,  -20.6135],
         [ 452.0820,  -98.7691],
         [-515.6706,   87.2059],
         [ 539.7857,   -3.4572],
         [-101.1173,  193.4571]]]) 

t:2, loss.item(): 2398.206298828125
Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0156, 0.0154,  ..., 0.0123, 0.0094, 0.0093],
        [0.0159, 0.0161, 0.0154,  ..., 0.0123, 0.0100, 0.0091],
        [0.0164, 0.0156, 0.0146,  ..., 0.0132, 0.0098, 0.0088],
        ...,
        [0.0161, 0.0161, 0.0153,  ..., 0.0146, 0.0130, 0.0127],
        [0.0161, 0.0161, 0.0156,  ..., 0.0130, 0.0125, 0.0133],
        [0.0159, 0.0159, 0.0159,  ..., 0.0114, 0.0118, 0.0112]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[-2.4802e-04, -2.4038e-04,  1.0088e-03,  ..., -2.9117e-03,
         -1.7470e-04, -1.7470e-04],
        [ 2.5602e-04, -7.4442e-04,  1.2821e-03,  ..., -2.3457e-03,
         -9.0909e-04, -9.0909e-04],
        [-7.6844e-04,  5.0403e-04,  2.6441e-04,  ..., -1.9608e-03,
         -1.0320e-03, -1.0320e-03],
        ...,
        [ 1.0000e-10,  1.0000e-10, -2.5601e-04,  ..., -1.7088e-04,
         -3.2878e-04, -3.2878e-04],
        [ 1.0000e-10, -5.0403e-04,  5.0403e-04,  ..., -4.8701e-04,
          8.3333e-04,  8.3333e-04],
        [ 1.0000e-10,  1.0000e-10,  2.5602e-04,  ...,  4.0107e-04,
         -5.2875e-04, -5.2875e-04]], grad_fn=<SelectBackward>)  








test_counter in loss_omega_mat(): 688
test_counter in loss_omega_mat(): 1376
test_counter in loss_omega_mat(): 2064
test_counter in loss_omega_mat(): 2752
test_counter in loss_omega_mat(): 3440
test_counter in loss_omega_mat(): 4128
test_counter in loss_omega_mat(): 4816
test_counter in loss_omega_mat(): 5504
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9456, 0.9454, 0.9434,  ..., 0.8923, 0.8002, 0.8001],
         [0.9458, 0.9458, 0.9454,  ..., 0.8932, 0.8007, 0.8006],
         [0.9458, 0.9458, 0.9458,  ..., 0.8931, 0.8007, 0.8006],
         ...,
         [0.9459, 0.9457, 0.9457,  ..., 0.8931, 0.8006, 0.8005],
         [0.9459, 0.9459, 0.9457,  ..., 0.8932, 0.8007, 0.8003],
         [0.9459, 0.9459, 0.9449,  ..., 0.8936, 0.8007, 0.8005]],

        [[0.9458, 0.9458, 0.9456,  ..., 0.8935, 0.8006, 0.8006],
         [0.9459, 0.9459, 0.9458,  ..., 0.8944, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9458,  ..., 0.8947, 0.8007, 0.8006],
         ...,
         [0.9459, 0.9459, 0.9457,  ..., 0.8946, 0.8007, 0.8005],
         [0.9459, 0.9459, 0.9459,  ..., 0.8946, 0.8007, 0.8003],
         [0.9459, 0.9459, 0.9459,  ..., 0.8939, 0.8007, 0.8005]],

        [[0.9459, 0.9458, 0.9458,  ..., 0.8942, 0.8006, 0.8006],
         [0.9459, 0.9459, 0.9459,  ..., 0.8947, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9459,  ..., 0.8947, 0.8007, 0.8007],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.8946, 0.8007, 0.8006],
         [0.9459, 0.9459, 0.9459,  ..., 0.8946, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9459,  ..., 0.8939, 0.8007, 0.8007]],

        ...,

        [[0.9453, 0.9449, 0.9442,  ..., 0.8915, 0.7998, 0.7986],
         [0.9449, 0.9423, 0.9416,  ..., 0.8913, 0.7997, 0.7982],
         [0.9448, 0.9420, 0.9416,  ..., 0.8902, 0.7997, 0.7985],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.8946, 0.8006, 0.8006],
         [0.9459, 0.9459, 0.9458,  ..., 0.8945, 0.8006, 0.8006],
         [0.9459, 0.9458, 0.9458,  ..., 0.8920, 0.8005, 0.8005]],

        [[0.9449, 0.9442, 0.9441,  ..., 0.8886, 0.7994, 0.7980],
         [0.9408, 0.9389, 0.9380,  ..., 0.8838, 0.7969, 0.7965],
         [0.9389, 0.9381, 0.9379,  ..., 0.8843, 0.7970, 0.7966],
         ...,
         [0.9459, 0.9458, 0.9458,  ..., 0.8944, 0.8005, 0.8005],
         [0.9459, 0.9458, 0.9458,  ..., 0.8944, 0.8004, 0.8004],
         [0.9459, 0.9458, 0.9458,  ..., 0.8925, 0.8004, 0.8004]],

        [[0.9441, 0.9439, 0.9429,  ..., 0.8886, 0.7986, 0.7970],
         [0.9395, 0.9380, 0.9372,  ..., 0.8832, 0.7926, 0.7913],
         [0.9377, 0.9352, 0.9318,  ..., 0.8838, 0.7916, 0.7911],
         ...,
         [0.9458, 0.9457, 0.9457,  ..., 0.8936, 0.8005, 0.8003],
         [0.9458, 0.9457, 0.9457,  ..., 0.8936, 0.8003, 0.8002],
         [0.9458, 0.9457, 0.9451,  ..., 0.8924, 0.8003, 0.8002]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[2.6080e-07, 1.4969e-07, 2.7877e-07,  ..., 2.3766e-06,
          6.5102e-12, 4.6464e-07],
         [7.3400e-11, 3.4749e-07, 6.0812e-07,  ..., 2.1932e-07,
          7.8216e-07, 4.0338e-07],
         [3.5954e-07, 7.1637e-08, 1.9517e-09,  ..., 9.5847e-08,
          1.9959e-07, 1.4586e-07],
         ...,
         [6.5781e-08, 7.9204e-07, 3.8155e-09,  ..., 9.9003e-07,
          1.6164e-10, 3.3260e-07],
         [7.5260e-09, 2.3615e-07, 1.0743e-09,  ..., 6.7535e-08,
          1.0318e-06, 7.9879e-07],
         [4.2263e-08, 7.7598e-08, 1.0398e-07,  ..., 4.4003e-07,
          5.0123e-07, 1.0807e-08]],

        [[1.3301e-07, 3.8618e-08, 2.0507e-08,  ..., 2.0486e-07,
          2.3608e-07, 9.8565e-10],
         [1.3181e-09, 1.3307e-08, 3.3657e-07,  ..., 9.5883e-09,
          7.2549e-09, 1.9481e-07],
         [2.2274e-07, 2.3322e-08, 1.3205e-07,  ..., 1.9073e-08,
          1.1941e-07, 3.8314e-09],
         ...,
         [3.3889e-07, 6.7069e-09, 5.6272e-08,  ..., 5.9822e-07,
          7.6263e-07, 6.5181e-08],
         [3.2388e-07, 1.4945e-08, 7.4621e-08,  ..., 1.6360e-07,
          2.9381e-07, 2.5416e-06],
         [1.7760e-08, 2.6649e-09, 2.6748e-08,  ..., 1.0489e-07,
          3.2142e-09, 1.0392e-07]],

        [[4.7038e-07, 4.5553e-08, 1.0511e-07,  ..., 1.8468e-06,
          3.7968e-07, 9.0808e-07],
         [1.6391e-10, 1.4325e-07, 1.5292e-07,  ..., 3.4357e-09,
          2.2072e-07, 1.5648e-08],
         [4.8595e-08, 2.8357e-08, 4.8642e-09,  ..., 2.3069e-07,
          8.4432e-08, 4.6671e-10],
         ...,
         [4.1964e-08, 7.4203e-09, 2.3267e-08,  ..., 9.8231e-07,
          4.7602e-08, 8.1975e-09],
         [7.2713e-07, 6.5820e-08, 2.5673e-08,  ..., 1.3230e-06,
          7.9754e-08, 7.4505e-07],
         [5.6736e-08, 7.2309e-09, 3.7402e-07,  ..., 2.7528e-09,
          1.6004e-07, 3.2245e-08]],

        ...,

        [[1.9437e-07, 1.5584e-06, 2.2528e-06,  ..., 2.7486e-06,
          4.5312e-07, 4.9028e-07],
         [2.2899e-11, 8.0310e-06, 1.4671e-05,  ..., 4.2256e-05,
          1.0428e-07, 2.0618e-05],
         [9.1637e-08, 2.6296e-06, 1.7089e-06,  ..., 5.3672e-07,
          1.0126e-08, 1.3039e-05],
         ...,
         [1.4189e-07, 4.3687e-08, 2.7834e-07,  ..., 4.1852e-07,
          2.2595e-07, 6.7685e-07],
         [1.3772e-07, 1.5930e-11, 1.3739e-07,  ..., 2.0498e-10,
          2.2410e-08, 1.5210e-06],
         [1.8352e-10, 7.1553e-09, 3.3173e-07,  ..., 9.8656e-07,
          1.5540e-07, 2.1295e-06]],

        [[4.5788e-06, 4.8432e-07, 1.1784e-07,  ..., 1.0034e-07,
          1.2056e-05, 1.0256e-06],
         [2.3571e-05, 6.8653e-05, 2.7377e-05,  ..., 1.1829e-04,
          2.2112e-04, 5.5181e-05],
         [4.5814e-05, 1.4038e-05, 1.4089e-04,  ..., 7.6006e-05,
          1.1877e-04, 2.5071e-04],
         ...,
         [7.3957e-08, 3.9163e-09, 7.5759e-08,  ..., 2.5737e-08,
          1.2986e-07, 1.7400e-06],
         [5.3679e-08, 5.3146e-08, 2.1636e-08,  ..., 3.6939e-08,
          3.0121e-07, 4.8594e-08],
         [1.4046e-08, 1.6206e-08, 3.5105e-07,  ..., 1.5331e-08,
          5.6731e-08, 8.3751e-07]],

        [[1.2074e-11, 3.1862e-07, 1.0248e-07,  ..., 1.1603e-06,
          3.2526e-06, 5.5454e-06],
         [1.9381e-07, 1.2824e-05, 1.6296e-07,  ..., 9.3489e-07,
          9.6023e-07, 1.8950e-06],
         [1.4678e-04, 1.9558e-05, 1.5348e-05,  ..., 5.3858e-05,
          2.2361e-05, 2.0203e-04],
         ...,
         [3.0258e-09, 3.5193e-08, 2.7312e-07,  ..., 1.7290e-07,
          9.8716e-09, 4.5999e-08],
         [1.6687e-08, 1.9688e-08, 9.6419e-08,  ..., 1.4303e-08,
          3.6439e-08, 9.1401e-07],
         [9.2544e-08, 8.2310e-11, 9.9745e-08,  ..., 2.3976e-07,
          2.0516e-08, 2.3120e-08]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[3.9367e-04, 6.2789e-04, 1.2446e-04,  ..., 1.1714e-03,
          3.3792e-04, 2.2430e-04],
         [6.4996e-04, 2.9774e-04, 6.2789e-04,  ..., 5.3291e-04,
          3.6224e-04, 7.5760e-04],
         [6.4996e-04, 3.3735e-04, 3.5480e-04,  ..., 4.9138e-04,
          3.0585e-04, 4.9721e-04],
         ...,
         [3.4014e-04, 7.7088e-04, 5.5406e-04,  ..., 3.3388e-04,
          4.0919e-05, 3.1045e-04],
         [3.7316e-04, 7.8254e-04, 5.5406e-04,  ..., 3.8792e-04,
          5.4571e-04, 2.1975e-04],
         [4.3774e-04, 7.8254e-04, 7.6574e-04,  ..., 6.7425e-04,
          2.8951e-04, 3.1045e-04]],

        [[2.6211e-04, 6.0347e-04, 3.9367e-04,  ..., 9.8262e-04,
          3.2577e-04, 3.9777e-04],
         [5.3478e-04, 2.9173e-04, 2.9774e-04,  ..., 4.8979e-04,
          5.5674e-04, 4.0294e-04],
         [3.3914e-04, 2.9173e-04, 1.7101e-04,  ..., 3.9613e-04,
          6.0369e-04, 3.2577e-04],
         ...,
         [3.8024e-04, 3.4014e-04, 1.7853e-04,  ..., 4.3075e-04,
          2.1324e-04, 1.7377e-04],
         [6.9900e-04, 7.5095e-05, 3.7316e-04,  ..., 2.0550e-04,
          5.3908e-04, 6.8610e-04],
         [1.5709e-04, 7.5095e-05, 4.3774e-04,  ..., 3.0358e-04,
          3.1872e-04, 1.7377e-04]],

        [[2.4465e-04, 4.4116e-04, 6.0347e-04,  ..., 1.8869e-04,
          6.7306e-04, 5.8395e-04],
         [4.8797e-04, 1.2719e-04, 5.3478e-04,  ..., 3.2569e-04,
          2.8725e-04, 3.1856e-04],
         [4.8797e-04, 3.3914e-04, 4.3633e-04,  ..., 3.0535e-04,
          2.2853e-04, 3.0585e-04],
         ...,
         [3.8024e-04, 1.6927e-04, 7.7774e-04,  ..., 7.8585e-04,
          6.2663e-04, 4.0919e-05],
         [6.9900e-04, 4.2959e-04, 6.1250e-04,  ..., 5.5239e-04,
          9.3077e-04, 5.4571e-04],
         [1.5709e-04, 1.8140e-04, 6.1250e-04,  ..., 3.4697e-04,
          3.6403e-04, 2.8951e-04]],

        ...,

        [[3.7044e-04, 8.9430e-04, 9.0348e-04,  ..., 7.2677e-03,
          3.9654e-04, 6.6320e-04],
         [3.2555e-03, 3.2353e-03, 5.1484e-03,  ..., 5.4967e-03,
          2.9922e-03, 2.5950e-03],
         [1.7928e-03, 1.6398e-03, 5.1484e-03,  ..., 6.2458e-03,
          1.8267e-03, 2.0726e-03],
         ...,
         [5.8532e-04, 7.5250e-04, 4.7016e-04,  ..., 3.1136e-04,
          8.9726e-05, 5.1713e-04],
         [7.5250e-04, 1.0334e-04, 4.5600e-04,  ..., 4.1566e-04,
          5.2003e-04, 3.2976e-04],
         [1.0334e-04, 4.6211e-04, 5.8048e-04,  ..., 1.2632e-03,
          6.5483e-04, 3.0283e-04]],

        [[8.9430e-04, 1.1015e-03, 5.5544e-04,  ..., 9.4625e-04,
          1.1538e-03, 1.1651e-03],
         [8.1132e-03, 8.3593e-03, 9.0595e-03,  ..., 2.5021e-03,
          6.2351e-03, 7.6514e-03],
         [9.8535e-03, 9.5855e-03, 1.3849e-02,  ..., 8.1035e-03,
          8.1705e-03, 7.4796e-03],
         ...,
         [4.7016e-04, 4.2711e-04, 5.0700e-04,  ..., 5.8667e-04,
          1.0391e-03, 9.4436e-04],
         [6.5456e-04, 5.0700e-04, 4.4691e-04,  ..., 2.9133e-04,
          6.1481e-04, 2.3206e-04],
         [6.5456e-04, 4.6211e-04, 3.6789e-04,  ..., 4.6048e-04,
          6.0842e-04, 3.1933e-04]],

        [[5.5544e-04, 1.2612e-03, 9.6928e-04,  ..., 8.9674e-04,
          6.6320e-04, 1.7605e-03],
         [1.2792e-03, 9.0595e-03, 1.6894e-03,  ..., 6.4449e-03,
          8.3948e-04, 1.9750e-03],
         [1.1355e-02, 6.5063e-04, 7.0121e-03,  ..., 2.5021e-03,
          5.7724e-03, 4.7521e-03],
         ...,
         [4.2711e-04, 1.7632e-04, 2.6219e-04,  ..., 4.9995e-04,
          3.7356e-04, 8.4471e-04],
         [2.1064e-04, 1.5951e-04, 1.7632e-04,  ..., 7.2781e-04,
          2.3634e-04, 2.5477e-04],
         [3.6789e-04, 1.5951e-04, 6.8577e-04,  ..., 5.5599e-04,
          1.9748e-04, 1.8424e-04]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:207.44683837890625
t:3, Finish constructing loss
require grad ? True True False
MatD grad and MatUx grad: torch.Size([56, 123]) torch.Size([56, 123, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  2.0438e-02, -3.9983e-03,
         -9.0490e-03, -7.3353e-03, -3.9309e-03,  0.0000e+00,  0.0000e+00],
        [-3.8860e-02,  8.4668e-02, -3.4503e-02,  2.7177e-02, -4.3650e+00,
          3.0317e+00,  1.5256e-01,  6.1946e-02, -1.0780e-01, -2.1205e-02],
        [-5.7975e+00,  6.5244e-01,  1.0716e+00, -5.0290e+00, -4.1010e+00,
          5.6178e+00, -1.2760e+01,  1.8803e+00,  6.0174e+00, -7.7998e-01],
        [-8.9901e+00, -2.5096e+01,  3.1666e+01,  1.0108e+01, -9.8358e+00,
         -1.8179e+01,  6.3312e+00,  2.3470e+01, -4.6442e+00,  1.9015e+01],
        [ 1.2927e+01,  1.2424e+01, -2.9986e+01, -2.2354e+01, -4.2739e+00,
         -1.6354e+01, -1.4893e+01, -3.4345e+01, -2.3523e+00,  4.8958e+00],
        [ 3.0093e+01, -2.6074e+01, -2.2966e+01, -2.4417e+01,  1.1861e+01,
         -3.0210e+01,  2.1193e+01, -9.3959e+00, -4.3120e+01,  1.0829e+01],
        [ 4.0233e+01,  2.1651e+00,  2.7748e+01, -3.9387e+00,  3.9722e+00,
          9.1650e+00,  1.0938e+01, -6.4387e+00,  1.5752e+01,  4.1815e+00],
        [-2.1535e+01,  1.5260e+01, -2.4432e+01,  3.7560e+01, -9.2640e+00,
          1.8978e+01, -4.0646e+00, -3.5498e+00,  1.1050e+01,  1.9426e+01],
        [ 3.9676e+01, -8.6522e+00, -2.1182e+01,  3.2765e-01,  1.1713e+01,
          5.9744e+00, -2.1828e+01, -4.4300e+01, -1.8796e+01,  2.2523e+01]]) 

MatU.grad[0:10,35:45]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 2.5036e+01,  1.2496e+01],
         [-2.4927e+01, -1.2782e+01],
         [-3.3470e+00, -2.7800e+01],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 7.9210e+01,  1.3192e+01],
         [-7.8758e+01,  3.0281e+01],
         [ 2.4792e+00,  4.8603e+01],
         [-2.7175e+01,  1.0196e+02],
         [-4.0608e+01, -2.3098e+01],
         [-4.6217e+01,  4.7909e+00],
         [-7.2891e+01,  7.8779e+01],
         [ 8.9093e+01, -3.0125e+01],
         [ 4.6484e+01, -1.4161e+01],
         [-4.9137e+01,  1.0875e+01]],

        [[ 2.1725e+01, -2.0575e+02],
         [ 7.5122e+01,  3.9823e+02],
         [-3.9991e+01, -4.2927e+02],
         [-1.3384e+02,  1.5054e+02],
         [-4.5682e+02, -6.3013e+01],
         [ 2.7096e+02, -1.9265e+02],
         [ 3.5917e+02,  1.9396e+02],
         [-3.5311e+02, -9.0541e+01],
         [ 2.0183e+02,  1.3360e+02],
         [-2.2892e+02, -3.5972e+02]],

        [[ 3.6547e+02, -9.9981e+01],
         [-4.3204e+02, -3.3688e+01],
         [ 1.9407e+02, -2.5750e+02],
         [-2.2023e+02, -7.0131e+01],
         [ 1.7827e+02,  3.9474e+02],
         [-4.7970e+01, -4.1860e+02],
         [ 1.3400e+02,  3.6626e+02],
         [ 9.8225e+01, -2.4724e+02],
         [-3.2474e+02, -3.7870e+02],
         [ 2.2259e+02,  4.8993e+02]],

        [[-5.9450e+02,  1.8810e+02],
         [-6.9108e+01,  8.7320e+01],
         [-1.3025e+02,  3.5921e+02],
         [ 3.3734e+02,  4.7370e+02],
         [ 2.9619e+02,  1.8585e+01],
         [-2.1365e+02,  3.0093e+02],
         [-4.2165e+02, -8.8107e+01],
         [-1.1319e+02, -6.4336e+01],
         [ 1.4888e+00,  2.8955e+00],
         [-2.5385e+02, -1.9508e+02]],

        [[ 4.1104e+02,  3.0981e+02],
         [ 3.8073e+02,  1.0084e+02],
         [ 3.1221e+02, -2.4947e+02],
         [-5.7743e+01, -4.4962e+02],
         [-2.6755e+02, -2.8875e+02],
         [-1.9275e+02,  4.3466e+02],
         [-2.2022e+02, -1.9678e+02],
         [ 6.7338e+01,  3.0604e+02],
         [ 3.0907e+02,  2.7325e+02],
         [-4.5722e+02,  2.4920e+02]],

        [[-2.7497e+01, -4.1460e+02],
         [-4.1901e+02,  2.5906e+01],
         [-1.9411e+01, -4.3394e+02],
         [ 1.1273e+02, -1.2805e-03],
         [-1.4408e+02,  1.4348e+02],
         [-4.2663e+02,  1.1499e+02],
         [ 1.0630e+02, -3.9566e+01],
         [ 2.5584e+02, -4.2600e+02],
         [ 8.2281e+01,  5.1713e+02],
         [-4.3175e+02, -1.4315e+02]],

        [[-2.6103e+02,  1.9844e+02],
         [-4.7554e+02,  2.3971e+02],
         [ 6.0174e+01,  4.5427e+02],
         [ 2.4490e+02, -2.8724e+02],
         [ 8.7485e+01,  3.3246e+02],
         [-4.2488e+02, -1.9647e+02],
         [ 2.2067e+02, -1.7490e+02],
         [ 1.1218e+02,  2.4352e+02],
         [ 1.7036e+02, -3.2401e+02],
         [-1.1313e+02, -1.8488e+02]]]) 

MatD.grad: 
tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0283,  ..., -0.0088,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0058,  ..., -0.0106,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -31.0558,   -3.3047],
         [   8.0696,    9.7312],
         [ -14.7425,  -43.0096],
         [  73.1987,   33.6529],
         [ -49.1120,  -15.5812],
         [ -14.9699,   -9.5690],
         [ -88.1308,  -84.5094]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -63.7018,   -7.6960],
         [-158.5871,  110.9963],
         [ 200.5541, -431.6954],
         [-142.0315,  460.1163],
         [ 340.9370,  150.9799],
         [ 338.3566, -227.0206],
         [ 109.4923, -348.8394]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -17.2319,  -22.4840],
         [ 226.8219,  254.2348],
         [ 398.3917, -214.4124],
         [-164.9484, -327.6565],
         [-404.2415,  204.9431],
         [-469.7196,  -88.6290],
         [ 307.5712,   -7.2337]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  91.2477,   20.6982],
         [-444.1708, -255.9517],
         [-363.3141,  269.9988],
         [ 501.2749,   24.7013],
         [-346.5298, -225.2037],
         [ -35.0368,  150.2498],
         [ 452.5138,  110.4984]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  37.1503,   85.7145],
         [-192.2164, -316.7014],
         [-217.7849,  474.3116],
         [ 414.3097,  502.9662],
         [  96.0596, -494.1335],
         [  34.1957,  438.1964],
         [-206.1131,  475.0350]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  -1.7436,   83.0780],
         [ 236.9837, -372.4371],
         [  69.8475,  246.8251],
         [ 174.7495, -435.1907],
         [-429.0021, -255.3566],
         [  95.4323,  -48.0242],
         [-366.9950,   94.7412]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -14.1287,   91.1867],
         [ 410.0075,  -26.4358],
         [-320.3172,  252.7177],
         [ 296.4112,  284.6714],
         [-394.9539,  333.9869],
         [ 416.3668, -226.3338],
         [-431.7459, -235.5182]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[ 113.7554,  180.1687],
         [ -26.8134,  172.3138],
         [-406.5388,  126.8095],
         [-479.3027,  254.9547],
         [-330.5916, -345.6507],
         [-213.1655,  524.4932],
         [ -87.2346, -170.3929],
         [  48.1930,  466.7540],
         [ 442.2477, -192.4895],
         [ 307.8452,  534.3223]],

        [[-131.2165, -575.5165],
         [ -36.8224,   58.7152],
         [-229.9781,  229.6326],
         [ 319.1042,  167.4585],
         [ 357.2964,  397.9247],
         [-230.3991,  177.9266],
         [ 569.6924, -150.0683],
         [-535.8099, -270.2700],
         [ 406.0473, -105.0699],
         [-356.3192, -473.7537]],

        [[ 454.7348,  377.2687],
         [-110.6938, -297.2477],
         [ 519.8884,  -95.3206],
         [-149.2316, -248.6135],
         [ 227.9770, -473.9791],
         [-293.5245, -497.4624],
         [ 345.8018,  452.1291],
         [-309.8911,  225.9496],
         [-444.7952,  -93.9985],
         [ -36.8027,  340.5208]],

        [[ 434.2623,  165.1817],
         [-411.6763,  348.7328],
         [-308.9317, -276.2924],
         [-466.7272,  213.1037],
         [-182.3597,  465.3286],
         [ 348.6424,  304.7878],
         [-426.6084, -291.6881],
         [ 234.6643, -193.9162],
         [ 576.8897,  118.0078],
         [ 330.6332,  241.6264]],

        [[  44.1495,   -2.3003],
         [  56.0082, -551.6310],
         [ 177.9355,  411.8369],
         [ 447.3409, -197.0342],
         [-132.0595, -307.9717],
         [-294.9960,  -17.4946],
         [-287.3653,  262.8369],
         [ 384.2171, -228.1993],
         [ -52.9364,  -78.3220],
         [-299.3821, -318.0454]],

        [[-317.3294, -434.5945],
         [ 548.0923,  -91.9135],
         [-496.2048, -284.1461],
         [ -66.1982,  358.9007],
         [ 416.7970,  200.7145],
         [-135.6399, -592.0618],
         [ 143.8642,  541.1813],
         [ 388.2946,  231.1581],
         [-426.4362,  154.4624],
         [-473.5904, -294.2130]],

        [[ 460.6582,  188.5126],
         [  73.6351,  455.4700],
         [ 132.8075, -132.0476],
         [-391.6121,  -66.3293],
         [-317.9168,  460.5902],
         [ 371.4843,  388.8922],
         [-174.2273,  176.8977],
         [-188.1529, -183.9693],
         [ 188.9764,  148.0882],
         [ 315.1567,  541.2579]],

        [[-311.3044, -354.9282],
         [-222.8445,  -68.9706],
         [ 530.1884,  182.8930],
         [-309.9271, -486.9203],
         [ 105.2144, -299.3726],
         [-333.0643, -172.0020],
         [ 122.8736,   80.3223],
         [ 372.1847, -352.3047],
         [  98.1939, -397.7503],
         [-289.6732, -344.7937]],

        [[-454.1843,   -4.3543],
         [ -52.9349,  129.2154],
         [ 217.3632, -564.7337],
         [ 290.5150,  107.6593],
         [  69.0192,  272.8146],
         [ 245.9302, -332.9563],
         [-310.8325, -415.3459],
         [-299.6409,  431.0135],
         [ 369.1436,  169.5930],
         [  -4.7763, -320.5012]],

        [[ 319.5323, -318.0600],
         [-385.8523,  353.0955],
         [ 219.8399,  595.0422],
         [-510.1816,  249.0712],
         [-189.8277, -293.9621],
         [ 102.9661,  608.6641],
         [ 363.7275, -118.8755],
         [-505.5178, -250.7774],
         [ -97.1430,  499.5005],
         [ 458.2041,  331.8204]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[-1.5397e+02, -8.7791e+01],
         [ 2.8730e+02,  2.6466e+02],
         [ 3.0271e+02,  3.6740e+02],
         [-4.6864e+02, -2.4216e+02],
         [-1.7493e+02,  3.3082e+02],
         [ 6.8345e+01,  1.0893e+02],
         [ 3.0651e+02, -4.1819e+01],
         [-9.9517e+00,  9.5489e+01],
         [ 1.5648e+00,  1.1358e+02],
         [ 3.5281e+02,  9.9328e+01]],

        [[ 3.8940e+02,  3.6062e+02],
         [-1.2243e+02, -5.5246e+02],
         [-1.9722e+02, -2.1485e+02],
         [ 4.2432e+02,  1.2798e+02],
         [-4.3693e+02, -4.2954e+02],
         [ 7.1058e-02, -1.7133e+02],
         [ 4.6060e+02,  9.8052e+01],
         [-8.9136e+01, -5.8071e+02],
         [ 2.0374e+01,  4.6541e+02],
         [ 9.8605e+01,  9.3903e+01]],

        [[-4.0137e+02,  2.2514e+02],
         [-1.0321e+02,  3.3851e+02],
         [ 1.9153e+02, -4.3464e+02],
         [-2.8236e+02,  4.3547e+02],
         [ 1.3545e+01,  1.1889e+02],
         [ 3.0929e+02,  1.9101e+02],
         [ 4.3560e+01, -2.1483e+02],
         [ 4.0340e+02,  6.4955e+01],
         [-2.1400e+02,  4.4730e+02],
         [-7.6454e+01,  3.8044e+01]],

        [[-4.2686e+01, -5.3438e+02],
         [-2.2577e+02, -2.4956e+02],
         [ 4.6317e+02,  4.6796e+02],
         [-4.0640e+02, -2.4651e+02],
         [ 1.0235e+02, -4.5604e+02],
         [-1.2268e+02, -1.0698e+02],
         [ 1.8253e+01, -4.1689e+01],
         [ 5.3103e+02, -4.8063e+01],
         [-4.0214e+02, -3.3209e+02],
         [ 3.4755e+02, -8.1455e+01]],

        [[ 4.6262e+02,  3.5497e+02],
         [ 1.3783e+02, -3.6531e+01],
         [-4.6831e+02, -6.0582e+01],
         [ 4.1261e+02,  2.6125e+02],
         [-4.9310e+02,  3.4140e+02],
         [ 1.4239e+02,  1.0558e+02],
         [-2.0002e+02,  2.3024e+02],
         [ 2.6106e+02,  1.6954e+02],
         [ 1.3944e+01, -4.2328e+02],
         [-1.6128e+02, -1.0849e+02]],

        [[ 3.0400e+02, -3.3138e+02],
         [ 8.0298e+01,  4.9854e+02],
         [-6.5331e+01, -5.6805e+02],
         [ 1.8129e+02,  1.2419e+02],
         [-5.1560e+02, -3.8058e+02],
         [ 3.3205e+02,  3.6470e+02],
         [-1.6168e+01, -1.7838e+02],
         [-4.4991e+02,  4.3134e+01],
         [ 4.5033e+02,  3.3851e+01],
         [-1.2085e+02,  1.9216e+01]],

        [[-1.1396e+02,  4.5860e+02],
         [-4.1673e+02, -3.1215e+02],
         [ 5.2598e+02,  5.6636e+01],
         [-3.6998e+02, -3.4922e+00],
         [-2.9841e+02,  9.5025e+01],
         [-7.7977e+01,  1.7127e+01],
         [ 4.1182e+02,  4.0616e+01],
         [-2.7843e+02, -3.5076e+02],
         [ 2.0294e+02,  4.5371e+02],
         [ 1.1962e+02,  4.3505e+01]],

        [[-2.9986e+02, -2.8960e+02],
         [ 1.4021e+02, -4.7908e+02],
         [-1.8637e+02,  1.8053e+02],
         [ 4.5389e+02,  3.7657e+02],
         [ 2.8121e+02, -4.8937e+02],
         [-1.3487e+02, -3.1528e+02],
         [-4.6380e+02,  1.4152e+02],
         [ 4.6204e+02,  2.2260e+02],
         [-1.0186e+02, -4.9754e+02],
         [-8.0568e+00,  3.7660e+02]],

        [[ 3.3481e+02,  2.0672e+01],
         [-1.2154e+02,  3.9584e+02],
         [-1.9478e+02,  3.7579e+02],
         [-2.0063e+02, -3.8796e+02],
         [-9.9254e+01,  3.8965e+02],
         [ 2.4558e+02,  4.4023e+02],
         [ 1.9669e+02, -1.6425e+02],
         [-2.5724e+02, -4.3110e+01],
         [ 2.4927e+02, -4.1851e+01],
         [-3.3726e+02, -9.9250e+01]],

        [[-3.4239e+02,  3.1938e+01],
         [ 4.9161e+02,  2.6551e+02],
         [-3.1311e+02, -8.2039e+01],
         [ 4.7158e+02,  6.2268e+01],
         [ 3.0936e+02, -2.7107e+02],
         [-1.8318e+02,  8.1591e+01],
         [ 4.3635e+02, -1.0372e+02],
         [-4.8256e+02, -2.0565e+01],
         [ 5.5059e+02, -4.3150e+00],
         [ 1.2932e+02,  9.7366e+01]]]) 

t:3, loss.item(): 2074.46826171875
Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0156, 0.0154,  ..., 0.0123, 0.0094, 0.0093],
        [0.0159, 0.0161, 0.0154,  ..., 0.0123, 0.0100, 0.0091],
        [0.0164, 0.0156, 0.0142,  ..., 0.0137, 0.0098, 0.0088],
        ...,
        [0.0161, 0.0161, 0.0149,  ..., 0.0151, 0.0130, 0.0127],
        [0.0161, 0.0161, 0.0156,  ..., 0.0130, 0.0125, 0.0133],
        [0.0159, 0.0159, 0.0159,  ..., 0.0114, 0.0118, 0.0112]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[-2.4802e-04, -2.4038e-04,  1.0088e-03,  ..., -2.9117e-03,
         -1.7470e-04, -1.7470e-04],
        [ 2.5602e-04, -7.4442e-04,  1.2821e-03,  ..., -2.3457e-03,
         -9.0909e-04, -9.0909e-04],
        [-7.6844e-04,  5.0403e-04,  2.6441e-04,  ..., -1.9608e-03,
         -1.0320e-03, -1.0320e-03],
        ...,
        [ 1.0000e-10,  1.0000e-10, -2.5601e-04,  ..., -1.7088e-04,
         -3.2878e-04, -3.2878e-04],
        [ 1.0000e-10, -5.0403e-04,  5.0403e-04,  ..., -4.8701e-04,
          8.3333e-04,  8.3333e-04],
        [ 1.0000e-10,  1.0000e-10,  2.5602e-04,  ...,  4.0107e-04,
         -5.2875e-04, -5.2875e-04]], grad_fn=<SelectBackward>)  








test_counter in loss_omega_mat(): 688
test_counter in loss_omega_mat(): 1376
test_counter in loss_omega_mat(): 2064
test_counter in loss_omega_mat(): 2752
test_counter in loss_omega_mat(): 3440
test_counter in loss_omega_mat(): 4128
test_counter in loss_omega_mat(): 4816
test_counter in loss_omega_mat(): 5504
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9456, 0.9456, 0.9431,  ..., 0.8917, 0.8004, 0.8003],
         [0.9459, 0.9458, 0.9456,  ..., 0.8927, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9458,  ..., 0.8923, 0.8007, 0.8007],
         ...,
         [0.9459, 0.9458, 0.9457,  ..., 0.8924, 0.8006, 0.8004],
         [0.9459, 0.9458, 0.9458,  ..., 0.8928, 0.8006, 0.8003],
         [0.9459, 0.9459, 0.9447,  ..., 0.8929, 0.8006, 0.8004]],

        [[0.9459, 0.9459, 0.9456,  ..., 0.8934, 0.8006, 0.8006],
         [0.9459, 0.9459, 0.9459,  ..., 0.8945, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9459,  ..., 0.8947, 0.8007, 0.8007],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.8946, 0.8007, 0.8004],
         [0.9459, 0.9458, 0.9458,  ..., 0.8946, 0.8006, 0.8002],
         [0.9459, 0.9459, 0.9459,  ..., 0.8932, 0.8006, 0.8004]],

        [[0.9459, 0.9459, 0.9459,  ..., 0.8941, 0.8006, 0.8006],
         [0.9459, 0.9459, 0.9459,  ..., 0.8947, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9459,  ..., 0.8948, 0.8007, 0.8007],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.8946, 0.8006, 0.8006],
         [0.9459, 0.9458, 0.9458,  ..., 0.8947, 0.8006, 0.8006],
         [0.9459, 0.9459, 0.9459,  ..., 0.8931, 0.8007, 0.8006]],

        ...,

        [[0.9454, 0.9449, 0.9444,  ..., 0.8916, 0.8002, 0.7992],
         [0.9451, 0.9434, 0.9430,  ..., 0.8915, 0.8000, 0.7988],
         [0.9450, 0.9431, 0.9430,  ..., 0.8911, 0.8000, 0.7992],
         ...,
         [0.9458, 0.9458, 0.9458,  ..., 0.8946, 0.8006, 0.8005],
         [0.9458, 0.9458, 0.9458,  ..., 0.8945, 0.8005, 0.8005],
         [0.9458, 0.9458, 0.9458,  ..., 0.8905, 0.8005, 0.8005]],

        [[0.9449, 0.9446, 0.9440,  ..., 0.8890, 0.7993, 0.7985],
         [0.9423, 0.9404, 0.9401,  ..., 0.8846, 0.7977, 0.7976],
         [0.9404, 0.9404, 0.9404,  ..., 0.8853, 0.7978, 0.7977],
         ...,
         [0.9458, 0.9458, 0.9458,  ..., 0.8944, 0.8005, 0.8005],
         [0.9458, 0.9458, 0.9458,  ..., 0.8943, 0.8005, 0.8005],
         [0.9458, 0.9458, 0.9457,  ..., 0.8916, 0.8004, 0.8003]],

        [[0.9440, 0.9433, 0.9429,  ..., 0.8883, 0.7979, 0.7952],
         [0.9410, 0.9392, 0.9378,  ..., 0.8834, 0.7932, 0.7920],
         [0.9389, 0.9358, 0.9343,  ..., 0.8843, 0.7930, 0.7923],
         ...,
         [0.9457, 0.9457, 0.9457,  ..., 0.8933, 0.8004, 0.8004],
         [0.9457, 0.9457, 0.9457,  ..., 0.8931, 0.8004, 0.8003],
         [0.9457, 0.9457, 0.9447,  ..., 0.8918, 0.8003, 0.8001]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[3.2271e-07, 6.8820e-10, 1.3696e-07,  ..., 1.8696e-06,
          3.0169e-07, 3.5250e-07],
         [3.2696e-10, 3.4848e-08, 3.6599e-07,  ..., 9.4885e-07,
          2.2289e-07, 1.9974e-07],
         [2.9589e-08, 6.9659e-08, 3.8027e-08,  ..., 3.6269e-07,
          1.3017e-08, 9.9601e-08],
         ...,
         [3.5286e-07, 5.3826e-08, 3.2642e-07,  ..., 7.8476e-07,
          7.8990e-08, 1.7107e-07],
         [6.0162e-08, 2.2811e-08, 8.7428e-08,  ..., 1.4785e-08,
          7.9063e-07, 8.6618e-07],
         [1.9513e-09, 3.0864e-10, 2.2971e-08,  ..., 6.9716e-08,
          3.0427e-07, 2.3308e-10]],

        [[3.6029e-08, 2.3835e-08, 1.2351e-07,  ..., 3.5930e-07,
          2.3182e-08, 3.8219e-09],
         [1.7514e-08, 4.1356e-08, 1.4386e-07,  ..., 1.5668e-07,
          4.8557e-08, 6.6107e-09],
         [3.1096e-08, 4.8692e-08, 5.3917e-07,  ..., 1.8102e-07,
          3.6800e-08, 7.2528e-07],
         ...,
         [1.1813e-06, 3.2366e-08, 1.7195e-07,  ..., 3.7227e-07,
          2.5906e-06, 2.2828e-07],
         [5.3458e-08, 7.1488e-08, 1.0223e-07,  ..., 4.5097e-07,
          6.6726e-08, 1.1435e-06],
         [1.6455e-07, 3.3450e-08, 2.0891e-07,  ..., 3.9288e-07,
          4.5077e-07, 2.1136e-07]],

        [[1.7319e-07, 1.3392e-08, 4.7369e-07,  ..., 6.4337e-07,
          9.6259e-07, 3.1165e-07],
         [1.0775e-07, 6.1112e-08, 3.2790e-07,  ..., 1.4738e-08,
          8.7379e-07, 2.1306e-11],
         [4.1206e-09, 4.5819e-08, 2.5488e-08,  ..., 3.0528e-07,
          3.1892e-09, 4.3657e-08],
         ...,
         [3.4422e-07, 5.0421e-10, 6.1444e-07,  ..., 1.1810e-06,
          1.8266e-09, 7.0983e-08],
         [4.0828e-08, 4.2810e-07, 1.4278e-07,  ..., 1.0333e-07,
          3.7255e-08, 5.2053e-07],
         [5.1336e-07, 6.4398e-07, 1.0284e-07,  ..., 1.6072e-07,
          1.1043e-07, 6.2889e-07]],

        ...,

        [[3.2536e-08, 9.7145e-07, 2.2916e-06,  ..., 3.1819e-06,
          1.7827e-07, 4.3543e-07],
         [1.9507e-08, 4.7610e-06, 9.0692e-06,  ..., 2.9826e-05,
          2.2751e-07, 1.2923e-05],
         [7.6224e-07, 5.3037e-07, 1.2664e-06,  ..., 6.3887e-07,
          7.3929e-07, 9.4879e-06],
         ...,
         [8.5661e-07, 7.5583e-07, 2.7118e-08,  ..., 1.8783e-07,
          1.8938e-06, 6.9039e-07],
         [3.1758e-08, 1.7056e-07, 1.7546e-08,  ..., 1.6665e-07,
          1.4045e-08, 1.4709e-07],
         [3.8075e-08, 2.3049e-08, 2.6466e-09,  ..., 5.3301e-08,
          3.0952e-07, 2.9536e-07]],

        [[2.5444e-06, 6.2411e-08, 5.3882e-07,  ..., 3.9687e-07,
          5.6883e-06, 4.8296e-06],
         [1.6047e-05, 6.7782e-06, 5.3779e-05,  ..., 1.0098e-04,
          3.1671e-05, 1.7482e-04],
         [1.5896e-05, 3.7189e-05, 1.0876e-04,  ..., 5.8757e-05,
          2.0300e-04, 9.0116e-05],
         ...,
         [2.9283e-07, 1.4833e-07, 1.7670e-07,  ..., 2.4418e-07,
          3.5976e-08, 6.2939e-11],
         [1.7955e-07, 1.1111e-08, 7.2883e-09,  ..., 2.9127e-09,
          3.2141e-07, 4.0291e-07],
         [7.4308e-08, 1.9151e-07, 6.1652e-08,  ..., 3.1548e-09,
          5.4166e-07, 1.2585e-06]],

        [[6.2082e-07, 5.7062e-07, 4.2651e-07,  ..., 1.9089e-06,
          5.6750e-07, 3.6231e-06],
         [7.0198e-08, 5.8175e-06, 1.4241e-08,  ..., 2.0880e-06,
          7.7832e-07, 1.3736e-06],
         [1.1756e-04, 1.8493e-05, 1.0117e-05,  ..., 1.3851e-05,
          1.2110e-05, 1.5904e-04],
         ...,
         [5.9120e-07, 7.3871e-09, 6.2137e-10,  ..., 6.6692e-08,
          2.0834e-07, 1.1699e-07],
         [5.6148e-08, 1.1723e-07, 3.4658e-08,  ..., 6.5697e-09,
          5.2822e-07, 3.8908e-07],
         [1.5831e-10, 9.6262e-09, 1.2219e-08,  ..., 1.1040e-09,
          3.2901e-08, 4.7707e-11]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[4.4147e-04, 3.9692e-04, 1.1581e-03,  ..., 1.6301e-03,
          3.1517e-04, 4.5358e-04],
         [3.7148e-04, 5.7661e-04, 4.4147e-04,  ..., 2.3159e-04,
          5.3815e-04, 7.0128e-04],
         [3.8903e-04, 3.7148e-04, 2.9362e-04,  ..., 4.1499e-04,
          2.1170e-04, 1.3654e-04],
         ...,
         [8.0423e-04, 7.1185e-04, 9.9945e-04,  ..., 4.8413e-04,
          4.0915e-04, 3.3144e-04],
         [5.1603e-04, 4.9094e-04, 7.1185e-04,  ..., 5.4247e-04,
          6.0174e-04, 2.9958e-04],
         [4.1601e-04, 5.1603e-04, 6.0682e-04,  ..., 9.5791e-04,
          2.9339e-04, 3.3144e-04]],

        [[1.1013e-04, 4.3127e-04, 3.9692e-04,  ..., 7.7703e-04,
          1.3895e-04, 3.1632e-04],
         [4.2147e-04, 4.8519e-04, 4.3127e-04,  ..., 3.4714e-04,
          3.3173e-04, 3.7537e-04],
         [5.3023e-04, 4.2147e-04, 4.2015e-04,  ..., 4.7257e-04,
          3.1488e-05, 5.4170e-04],
         ...,
         [5.0742e-04, 8.0423e-04, 6.1122e-04,  ..., 3.2110e-04,
          5.0317e-04, 4.7851e-04],
         [4.7293e-04, 5.9848e-04, 4.9094e-04,  ..., 3.8135e-04,
          2.9879e-04, 4.9175e-04],
         [4.7293e-04, 6.2131e-04, 4.1601e-04,  ..., 7.8876e-04,
          1.4742e-04, 4.7851e-04]],

        [[2.3411e-04, 1.1013e-04, 6.2538e-04,  ..., 5.1050e-04,
          3.1692e-04, 4.2288e-04],
         [5.9071e-04, 3.3933e-04, 4.8519e-04,  ..., 5.3964e-04,
          2.7677e-04, 7.4313e-05],
         [3.2252e-04, 5.9071e-04, 3.8792e-04,  ..., 2.6466e-04,
          5.1929e-04, 1.3654e-04],
         ...,
         [5.0742e-04, 1.9948e-05, 9.0711e-04,  ..., 3.8135e-04,
          9.0009e-04, 4.0915e-04],
         [7.6929e-04, 5.9848e-04, 4.4794e-04,  ..., 8.8828e-04,
          8.3317e-04, 6.0174e-04],
         [6.2131e-04, 7.6929e-04, 4.8478e-04,  ..., 3.1825e-04,
          1.0989e-04, 2.9339e-04]],

        ...,

        [[7.2337e-04, 8.8029e-04, 1.0574e-03,  ..., 6.4146e-03,
          6.4311e-04, 1.4996e-03],
         [2.5460e-03, 2.9388e-03, 4.1830e-03,  ..., 5.1692e-03,
          2.5887e-03, 2.1970e-03],
         [1.4220e-03, 1.2537e-03, 4.1830e-03,  ..., 5.4088e-03,
          1.2874e-03, 1.4996e-03],
         ...,
         [3.9104e-04, 3.1637e-04, 4.0945e-04,  ..., 6.3030e-04,
          7.2404e-04, 5.2104e-04],
         [2.8270e-04, 1.0122e-04, 2.7403e-04,  ..., 3.4644e-04,
          3.8587e-04, 1.5494e-04],
         [1.9993e-04, 2.8270e-04, 5.7571e-04,  ..., 1.5229e-03,
          3.8260e-04, 3.7921e-04]],

        [[8.8029e-04, 2.7335e-04, 4.0838e-04,  ..., 9.7979e-04,
          7.2834e-04, 1.2986e-03],
         [7.1530e-03, 1.2445e-02, 7.3260e-03,  ..., 2.3304e-03,
          7.2098e-03, 5.6899e-03],
         [8.6654e-03, 8.8902e-03, 1.2445e-02,  ..., 7.9010e-03,
          6.5675e-03, 7.5158e-03],
         ...,
         [3.9104e-04, 7.9134e-04, 3.4877e-04,  ..., 3.3828e-04,
          1.1431e-03, 6.5576e-04],
         [1.0122e-04, 4.2619e-04, 3.4877e-04,  ..., 2.5964e-04,
          2.0131e-04, 7.5493e-04],
         [4.2619e-04, 5.7571e-04, 3.8403e-04,  ..., 6.5811e-04,
          2.9706e-04, 4.4014e-04]],

        [[4.0838e-04, 1.6908e-03, 1.4083e-03,  ..., 8.2656e-04,
          6.0147e-04, 1.5829e-03],
         [9.6219e-04, 7.9547e-03, 1.0966e-03,  ..., 5.4512e-03,
          5.9006e-04, 2.2629e-03],
         [1.0114e-02, 6.1047e-04, 6.0020e-03,  ..., 6.0718e-03,
          5.0404e-03, 3.8773e-03],
         ...,
         [2.3945e-04, 4.1829e-04, 3.7311e-04,  ..., 7.8417e-04,
          6.1308e-04, 9.3496e-04],
         [7.6574e-05, 3.7311e-04, 2.7684e-04,  ..., 6.7712e-04,
          9.8723e-05, 9.2289e-05],
         [2.7684e-04, 3.8403e-04, 4.2389e-04,  ..., 8.9719e-04,
          3.4145e-04, 1.9847e-04]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:194.98580932617188
t:4, Finish constructing loss
