cv_MatI numpy float32: 
[[ 77.  87.  93. ... 227. 208. 166.]
 [ 95.  82.  98. ... 204. 188. 156.]
 [ 94.  99.  94. ... 239. 239. 213.]
 ...
 [ 50.  50.  51. ...  36.  40.  44.]
 [ 52.  51.  51. ...  44.  42.  45.]
 [ 51.  52.  50. ...  46.  40.  43.]]
MatI: 
tensor([[ 77.,  87.,  93.,  ..., 227., 208., 166.],
        [ 95.,  82.,  98.,  ..., 204., 188., 156.],
        [ 94.,  99.,  94.,  ..., 239., 239., 213.],
        ...,
        [ 50.,  50.,  51.,  ...,  36.,  40.,  44.],
        [ 52.,  51.,  51.,  ...,  44.,  42.,  45.],
        [ 51.,  52.,  50.,  ...,  46.,  40.,  43.]])
debug:
MatD.shape: torch.Size([55, 122]) 
has nan? False 
MatD: tensor([[0.0130, 0.0115, 0.0108,  ..., 0.0044, 0.0048, 0.0060],
        [0.0105, 0.0122, 0.0102,  ..., 0.0049, 0.0053, 0.0064],
        [0.0106, 0.0101, 0.0106,  ..., 0.0042, 0.0042, 0.0047],
        ...,
        [0.0200, 0.0200, 0.0196,  ..., 0.0278, 0.0250, 0.0227],
        [0.0192, 0.0196, 0.0196,  ..., 0.0227, 0.0238, 0.0222],
        [0.0196, 0.0192, 0.0200,  ..., 0.0217, 0.0250, 0.0233]]) 

MatU.shape: torch.Size([55, 122, 2]) 
has nan? False 
MatUx: tensor([[-1.4928e-03, -7.4156e-04, -1.1439e-04,  ...,  4.0241e-04,
          1.2164e-03,  1.2164e-03],
        [ 1.6688e-03, -1.9910e-03,  3.2223e-04,  ...,  4.1719e-04,
          1.0911e-03,  1.0911e-03],
        [-5.3729e-04,  5.3729e-04,  1.0000e-10,  ...,  1.0000e-10,
          5.1074e-04,  5.1074e-04],
        ...,
        [ 1.0000e-10, -3.9216e-04,  8.0032e-04,  ..., -2.7778e-03,
         -2.2727e-03, -2.2727e-03],
        [ 3.7707e-04,  1.0000e-10,  3.9216e-04,  ...,  1.0823e-03,
         -1.5873e-03, -1.5873e-03],
        [-3.7707e-04,  7.6923e-04, -3.9216e-04,  ...,  3.2609e-03,
         -1.7442e-03, -1.7442e-03]]) 




test_counter in loss_omega_mat(): 671
test_counter in loss_omega_mat(): 1342
test_counter in loss_omega_mat(): 2013
test_counter in loss_omega_mat(): 2684
test_counter in loss_omega_mat(): 3355
test_counter in loss_omega_mat(): 4026
test_counter in loss_omega_mat(): 4697
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: tensor([[[0.9458, 0.9458, 0.9457,  ..., 0.8945, 0.8006, 0.8006],
         [0.9458, 0.9458, 0.9457,  ..., 0.8945, 0.8006, 0.8006],
         [0.9458, 0.9458, 0.9457,  ..., 0.8943, 0.8006, 0.8006],
         ...,
         [0.9458, 0.9458, 0.9458,  ..., 0.8946, 0.8004, 0.8004],
         [0.9458, 0.9458, 0.9458,  ..., 0.8945, 0.8005, 0.8004],
         [0.9458, 0.9457, 0.9457,  ..., 0.8942, 0.8005, 0.8004]],

        [[0.9459, 0.9458, 0.9458,  ..., 0.8946, 0.8006, 0.8006],
         [0.9458, 0.9458, 0.9458,  ..., 0.8946, 0.8006, 0.8005],
         [0.9458, 0.9458, 0.9458,  ..., 0.8946, 0.8006, 0.8006],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.8943, 0.8005, 0.8005],
         [0.9458, 0.9457, 0.9457,  ..., 0.8944, 0.8005, 0.8003],
         [0.9456, 0.9454, 0.9453,  ..., 0.8941, 0.8004, 0.8004]],

        [[0.9459, 0.9459, 0.9459,  ..., 0.8947, 0.8007, 0.8006],
         [0.9459, 0.9459, 0.9459,  ..., 0.8946, 0.8007, 0.8006],
         [0.9459, 0.9459, 0.9458,  ..., 0.8946, 0.8006, 0.8006],
         ...,
         [0.9457, 0.9455, 0.9453,  ..., 0.8938, 0.8004, 0.8003],
         [0.9457, 0.9453, 0.9452,  ..., 0.8937, 0.8002, 0.8002],
         [0.9453, 0.9450, 0.9449,  ..., 0.8935, 0.8002, 0.8001]],

        ...,

        [[0.9424, 0.9413, 0.9411,  ..., 0.8885, 0.7965, 0.7952],
         [0.9428, 0.9420, 0.9413,  ..., 0.8886, 0.7975, 0.7958],
         [0.9449, 0.9447, 0.9447,  ..., 0.8897, 0.7995, 0.7991],
         ...,
         [0.9439, 0.9438, 0.9434,  ..., 0.8909, 0.7989, 0.7981],
         [0.9433, 0.9432, 0.9431,  ..., 0.8894, 0.7984, 0.7979],
         [0.9431, 0.9408, 0.9406,  ..., 0.8857, 0.7989, 0.7953]],

        [[0.9451, 0.9436, 0.9431,  ..., 0.8886, 0.7979, 0.7971],
         [0.9432, 0.9431, 0.9428,  ..., 0.8877, 0.7969, 0.7967],
         [0.9447, 0.9432, 0.9431,  ..., 0.8871, 0.7980, 0.7978],
         ...,
         [0.9443, 0.9437, 0.9434,  ..., 0.8905, 0.7989, 0.7986],
         [0.9449, 0.9437, 0.9430,  ..., 0.8890, 0.7999, 0.7981],
         [0.9452, 0.9437, 0.9412,  ..., 0.8860, 0.7998, 0.7989]],

        [[0.9455, 0.9451, 0.9436,  ..., 0.8877, 0.8000, 0.7981],
         [0.9443, 0.9434, 0.9432,  ..., 0.8871, 0.7979, 0.7973],
         [0.9434, 0.9431, 0.9424,  ..., 0.8879, 0.7975, 0.7952],
         ...,
         [0.9453, 0.9450, 0.9449,  ..., 0.8919, 0.8002, 0.7999],
         [0.9451, 0.9450, 0.9450,  ..., 0.8929, 0.8002, 0.7997],
         [0.9452, 0.9451, 0.9451,  ..., 0.8898, 0.8000, 0.7995]]],
       grad_fn=<SliceBackward>) 

mat_duij: tensor([[[3.0525e-06, 4.7106e-08, 4.7106e-08,  ..., 5.0769e-07,
          6.6843e-07, 3.2458e-06],
         [2.4690e-08, 5.1244e-08, 5.1244e-08,  ..., 4.7106e-08,
          1.4783e-06, 8.7114e-11],
         [1.1037e-08, 6.9618e-07, 6.9618e-07,  ..., 2.4843e-07,
          1.5074e-06, 3.5238e-07],
         ...,
         [2.3097e-09, 2.3097e-09, 3.2487e-07,  ..., 1.1499e-06,
          3.0394e-08, 3.8315e-07],
         [3.5542e-07, 4.5480e-07, 1.0861e-06,  ..., 2.1235e-06,
          1.3726e-06, 3.1989e-07],
         [8.3317e-07, 7.0615e-07, 7.9573e-07,  ..., 8.0410e-09,
          3.5209e-07, 3.6244e-06]],

        [[1.3660e-08, 3.2447e-07, 1.3660e-08,  ..., 4.6458e-07,
          8.3333e-07, 3.3007e-07],
         [1.3085e-08, 1.3085e-08, 5.1244e-08,  ..., 1.3418e-06,
          4.0000e-20, 1.3085e-08],
         [4.6066e-08, 1.0825e-07, 1.2540e-08,  ..., 4.3302e-07,
          5.9293e-07, 1.2540e-08],
         ...,
         [2.1168e-07, 5.9369e-07, 2.1168e-07,  ..., 1.0758e-08,
          8.5191e-07, 4.4271e-08],
         [1.2700e-07, 7.8153e-08, 8.2659e-10,  ..., 3.9397e-07,
          2.8820e-08, 1.0761e-07],
         [9.6376e-07, 3.5871e-07, 9.6917e-07,  ..., 3.5213e-06,
          7.5730e-07, 3.7198e-07]],

        [[1.3660e-08, 1.3660e-08, 1.3660e-08,  ..., 1.1291e-07,
          4.0000e-20, 3.1392e-07],
         [4.8024e-08, 1.1532e-08, 1.1532e-08,  ..., 3.0587e-07,
          4.5164e-07, 1.7695e-06],
         [4.3619e-07, 1.8089e-07, 1.4581e-08,  ..., 2.0447e-07,
          3.9799e-08, 9.8876e-07],
         ...,
         [3.1788e-07, 1.8160e-06, 3.8949e-08,  ..., 3.0044e-06,
          2.0679e-06, 2.7617e-06],
         [4.3089e-07, 3.5870e-08, 1.4879e-07,  ..., 1.9809e-06,
          3.6929e-06, 1.0091e-06],
         [7.7969e-06, 2.5696e-06, 1.4837e-06,  ..., 3.2126e-06,
          3.1157e-05, 2.2501e-07]],

        ...,

        [[1.3949e-05, 1.3949e-05, 1.9052e-05,  ..., 3.4135e-05,
          6.2947e-06, 2.1598e-05],
         [1.6207e-05, 1.6207e-05, 1.0023e-05,  ..., 6.0227e-05,
          9.0513e-06, 4.4506e-05],
         [1.2820e-06, 1.2820e-06, 1.0000e-20,  ..., 2.6605e-05,
          5.1279e-06, 1.8716e-07],
         ...,
         [3.5295e-05, 1.5031e-05, 2.0336e-06,  ..., 5.1731e-06,
          6.0073e-06, 4.7484e-05],
         [2.9278e-06, 1.3693e-05, 2.5682e-06,  ..., 9.3046e-07,
          4.4012e-06, 1.2144e-05],
         [3.0475e-06, 1.0821e-05, 8.2047e-07,  ..., 4.9467e-05,
          3.2819e-06, 6.9445e-07]],

        [[2.2746e-10, 2.1948e-06, 2.1948e-06,  ..., 2.7210e-05,
          9.3391e-07, 6.6090e-06],
         [1.5863e-05, 4.7465e-06, 3.0681e-05,  ..., 2.9859e-05,
          8.3573e-06, 1.0040e-04],
         [3.3558e-06, 8.3724e-06, 4.8948e-07,  ..., 2.1926e-05,
          5.7785e-08, 6.4085e-06],
         ...,
         [4.1854e-06, 6.0963e-06, 7.1981e-07,  ..., 1.8050e-08,
          1.4550e-06, 3.9190e-06],
         [3.0246e-06, 3.0246e-06, 1.3140e-06,  ..., 1.1167e-05,
          1.1656e-05, 7.3759e-06],
         [6.9445e-07, 1.8041e-05, 6.9445e-07,  ..., 5.2508e-09,
          8.2047e-07, 3.1467e-05]],

        [[1.5379e-07, 6.9445e-07, 6.1514e-07,  ..., 3.5105e-06,
          6.1514e-07, 1.5379e-07],
         [1.9141e-05, 1.9141e-05, 6.1514e-07,  ..., 6.9854e-05,
          6.9854e-05, 4.0393e-06],
         [6.3452e-05, 1.5863e-05, 1.5863e-05,  ..., 2.1926e-05,
          4.0314e-05, 1.5229e-04],
         ...,
         [2.5237e-07, 6.9445e-07, 6.9445e-07,  ..., 6.6992e-06,
          6.5188e-06, 1.7683e-06],
         [6.9445e-07, 4.4518e-06, 6.9445e-07,  ..., 1.9464e-07,
          1.5379e-07, 1.5123e-05],
         [3.0246e-06, 6.9445e-07, 6.9445e-07,  ..., 5.4210e-20,
          6.9445e-07, 2.7778e-06]]], grad_fn=<CopySlices>) 

mat_uij: tensor([[[1.6839e-03, 5.3579e-04, 6.0414e-04,  ..., 1.2454e-03,
          1.4993e-03, 2.6920e-04],
         [5.3579e-04, 9.9618e-04, 5.5359e-04,  ..., 1.0969e-03,
          1.1929e-03, 1.0216e-03],
         [9.9618e-04, 8.4637e-04, 1.4245e-03,  ..., 9.4588e-04,
          5.2475e-04, 1.4993e-03],
         ...,
         [7.2667e-04, 7.8632e-04, 8.2759e-04,  ..., 1.1969e-03,
          1.0438e-03, 7.3090e-04],
         [3.1729e-04, 7.2667e-04, 4.8135e-04,  ..., 9.0089e-04,
          1.2325e-03, 7.3874e-04],
         [3.1729e-04, 8.4192e-04, 1.1941e-03,  ..., 2.2067e-03,
          1.0167e-03, 1.0438e-03]],

        [[4.8543e-04, 5.6815e-04, 4.8367e-04,  ..., 1.1784e-03,
          3.2014e-04, 7.0936e-04],
         [3.4834e-04, 4.7028e-04, 4.8367e-04,  ..., 1.0861e-03,
          1.1198e-04, 9.7631e-04],
         [3.4834e-04, 5.8443e-04, 8.4637e-04,  ..., 8.0234e-04,
          7.0936e-04, 7.6516e-04],
         ...,
         [3.4364e-04, 7.8632e-04, 7.9062e-04,  ..., 9.9582e-04,
          1.3095e-03, 2.0815e-04],
         [3.4364e-04, 4.4192e-04, 1.0533e-03,  ..., 2.2641e-03,
          5.5815e-04, 1.5299e-03],
         [8.9714e-05, 7.3662e-04, 2.1640e-03,  ..., 1.2837e-03,
          1.0215e-03, 2.1926e-03]],

        [[2.6135e-04, 4.6854e-04, 4.1383e-04,  ..., 7.4329e-04,
          1.1945e-04, 2.3549e-04],
         [4.6854e-04, 6.0097e-04, 6.6648e-04,  ..., 5.6847e-04,
          7.2044e-04, 1.0216e-03],
         [6.0097e-04, 3.1819e-04, 5.8443e-04,  ..., 2.3647e-04,
          5.2475e-04, 2.3549e-04],
         ...,
         [7.9062e-04, 1.8896e-03, 1.1504e-03,  ..., 1.4112e-03,
          9.5217e-04, 4.9821e-04],
         [1.0533e-03, 2.8321e-03, 1.7444e-03,  ..., 2.4937e-03,
          2.1810e-03, 1.0865e-03],
         [2.1640e-03, 4.3940e-03, 3.1527e-03,  ..., 1.7610e-03,
          2.2380e-03, 6.1072e-04]],

        ...,

        [[2.8790e-03, 1.0310e-03, 1.6523e-03,  ..., 1.7823e-03,
          1.9089e-03, 3.2170e-03],
         [2.1706e-03, 2.0482e-03, 1.0310e-03,  ..., 2.2721e-03,
          4.0425e-03, 2.6081e-03],
         [6.9963e-04, 1.3310e-03, 1.1510e-03,  ..., 2.8938e-03,
          3.1725e-04, 1.6236e-03],
         ...,
         [5.0895e-03, 6.3275e-03, 3.6810e-03,  ..., 5.5320e-03,
          3.4019e-03, 6.0182e-03],
         [2.3515e-03, 5.7702e-03, 2.6554e-03,  ..., 5.9291e-03,
          1.1774e-03, 2.6603e-03],
         [2.6554e-03, 3.7062e-03, 2.7957e-03,  ..., 5.4876e-03,
          3.4019e-03, 7.2462e-05]],

        [[1.9014e-03, 7.9989e-04, 1.9342e-03,  ..., 2.2721e-03,
          2.8128e-03, 1.1578e-03],
         [2.4494e-03, 1.9342e-03, 2.1706e-03,  ..., 2.7283e-03,
          3.3106e-03, 3.1403e-03],
         [1.3310e-03, 2.4494e-03, 1.3537e-03,  ..., 3.3066e-03,
          2.0812e-03, 4.9259e-04],
         ...,
         [2.2956e-03, 4.4749e-04, 3.6810e-03,  ..., 3.0795e-03,
          3.4487e-03, 1.2822e-03],
         [2.5092e-03, 4.2365e-03, 3.0224e-03,  ..., 2.5121e-03,
          3.2048e-03, 3.4697e-03],
         [2.7273e-03, 4.2365e-03, 1.1428e-03,  ..., 5.0828e-03,
          1.9609e-03, 3.4487e-03]],

        [[3.9216e-04, 6.2540e-04, 7.9989e-04,  ..., 2.7283e-03,
          5.5459e-04, 1.6645e-03],
         [3.6120e-03, 5.3625e-03, 3.6120e-03,  ..., 3.3066e-03,
          3.6120e-03, 3.1499e-03],
         [5.3625e-03, 1.6633e-03, 4.0021e-03,  ..., 3.3152e-03,
          3.1517e-03, 4.0021e-03],
         ...,
         [1.0019e-03, 1.8054e-03, 1.5542e-03,  ..., 2.3070e-03,
          3.9216e-04, 2.7021e-03],
         [0.0000e+00, 1.8054e-03, 2.0588e-03,  ..., 9.1657e-04,
          1.2259e-03, 2.4151e-03],
         [2.7273e-03, 8.3333e-04, 0.0000e+00,  ..., 7.2462e-05,
          9.0869e-04, 0.0000e+00]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:361.84942626953125
t:0, Finish constructing loss
require grad ? True True False
MatD grad and MatUx grad: torch.Size([55, 122]) torch.Size([55, 122, 2]) 

Grads has nan? MatD.grad: True MatU.grad: True

MatD.grad: tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0011,  ...,  0.0034,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0159,  ..., -0.0032,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: tensor([[[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   8.2434,  -26.7819],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -14.4226,  -27.7909],
         [ -21.2554,  -60.6669],
         [  11.1104,  -76.2221],
         [ -41.0924,  -72.6599],
         [  32.4272,  -37.0012],
         [ -70.0381,   10.6973],
         [  84.6332,   27.9567]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -87.7286,  -27.6336],
         [ 277.0150,  335.8332],
         [ 157.8942,  279.6469],
         [-392.2069,  109.7473],
         [ 311.4900,  364.8397],
         [-318.5057, -209.7336],
         [ -77.2894,  393.3138]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -19.8137,  -19.8137],
         [-107.9814,  -42.0147],
         [ 235.8825,  182.7157],
         [ 107.5662,  -76.5289],
         [ 230.3810, -420.2605],
         [-393.3457, -281.4543],
         [ 524.0185,    0.8830],
         [-339.9969, -487.0916]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,   28.0243],
         [  68.3608,   -2.4610],
         [  -9.8875,  -71.7535],
         [-378.5028, -361.5365],
         [  72.6425,  451.9904],
         [-180.7674, -174.9291],
         [-147.5743,  433.1414],
         [-120.0312,    8.9251]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  82.6888,   25.9437],
         [-176.9458,  250.9576],
         [ 185.6121, -400.8556],
         [-385.7838,  397.4768],
         [ 452.1461,   -7.7220],
         [-376.8358, -525.0232],
         [  81.7267,  374.1667]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  88.2326,  -19.6274],
         [-426.4770, -165.2494],
         [ 594.0566, -109.5521],
         [-427.7379, -274.0957],
         [-109.1827,   95.9592],
         [ 344.9978, -264.0450],
         [-329.7517,   30.1288]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  67.7615,  -53.6071],
         [-335.7918,   61.1103],
         [ 346.0919, -152.4985],
         [ -67.0492, -289.7582],
         [-395.5011,  165.8901],
         [ 249.9027,  322.0029],
         [ 489.6053, -154.7839]]]) 

MatU.grad[10:20,10:20]: tensor([[[-3.7440e+02,  2.5908e+02],
         [ 3.4074e+02, -1.3784e+02],
         [-2.2742e+02,  2.2922e+02],
         [-6.8401e+00,  6.0329e+01],
         [ 4.7142e+01,  1.2640e+02],
         [ 3.9576e+02, -1.8658e+02],
         [-4.3826e+02,  3.3584e+01],
         [ 1.3730e+02,  9.3278e+01],
         [-3.2476e+02, -6.8903e+01],
         [ 2.1310e+02,  4.6270e+02]],

        [[-5.1841e+02, -3.3399e+02],
         [ 4.3165e+02,  3.5467e+02],
         [-3.3520e+02, -8.8316e+01],
         [ 3.0984e+01,  4.4861e+02],
         [-2.2620e+02, -1.5972e+02],
         [ 3.7829e+02,  2.3400e+01],
         [-1.9864e+02, -5.3211e+02],
         [-2.3271e+01,  1.5573e+02],
         [ 2.2665e+02,  3.2701e+02],
         [-3.0853e+01, -6.0795e+02]],

        [[-5.9929e+01,  1.7633e+02],
         [-1.5192e+02,  1.5119e+01],
         [ 3.4532e+02,  1.9459e+02],
         [-5.5278e+02, -2.4240e+02],
         [-6.9256e+01,  5.2162e+02],
         [-1.1253e+02,  3.5844e+02],
         [ 2.4573e+02,  5.0124e+02],
         [ 1.4946e+02, -4.7035e+02],
         [-5.8738e+02, -1.6340e+02],
         [ 2.6235e+02,  5.0156e+02]],

        [[-2.4036e+02, -4.7936e+02],
         [ 3.3736e+02, -2.7166e+02],
         [-3.6500e+02, -1.3554e+02],
         [ 3.0701e+02,  1.5916e+02],
         [-2.3112e+02, -3.9747e+01],
         [ 1.4757e+02,  1.1768e+02],
         [-5.3134e+02, -7.8741e+01],
         [ 3.7052e+02, -1.0048e+01],
         [ 4.9650e+01, -2.8617e+02],
         [-1.7852e+02,  1.8325e+01]],

        [[-1.0644e+02,  4.1471e+02],
         [ 4.8269e+02,  3.8753e+02],
         [-6.5338e+01, -1.9021e+02],
         [ 2.1225e+02, -6.3617e+01],
         [-2.4778e+01, -8.2463e+01],
         [-2.3327e+02, -3.8335e+02],
         [-4.1318e+02, -5.5250e+01],
         [ 1.8136e+02,  4.3373e+02],
         [ 3.0121e+02,  2.8827e+02],
         [-4.5155e+02, -1.3942e+02]],

        [[-2.0459e+01, -1.3351e+02],
         [-8.7867e+01, -1.1561e+02],
         [ 5.9724e+01, -3.6280e+01],
         [ 2.5901e+02,  1.0965e+01],
         [-3.2047e+02, -4.5259e+02],
         [-7.1805e+01,  1.6795e+02],
         [-1.5352e+02,  1.8662e+02],
         [ 1.8567e+01,  2.8970e+02],
         [-3.2133e+02,  3.7860e+02],
         [ 4.4202e+02, -1.8914e+02]],

        [[ 1.9439e+01, -8.5865e+00],
         [ 2.7646e+01, -3.7826e-01],
         [ 1.4828e+02,  1.9438e+01],
         [-5.0243e+02,  5.0976e+01],
         [ 3.5474e+02, -4.4678e+01],
         [ 1.2581e+02,  2.2664e+02],
         [ 3.4759e+02, -4.4908e+02],
         [ 8.0378e+01, -3.3508e+02],
         [-4.9663e+02, -3.2152e+02],
         [ 3.8096e+02,  1.2303e+02]],

        [[ 1.9439e+01,  1.9439e+01],
         [ 1.9439e+01,  1.9439e+01],
         [ 2.1092e+02,  1.9438e+01],
         [-5.8850e+02, -9.4655e+00],
         [ 5.5324e+02,  2.2618e+02],
         [-5.8766e+02, -2.8873e+02],
         [ 3.8248e+02,  3.8455e+02],
         [-2.4023e+02,  7.1779e+01],
         [-1.9023e+02,  4.6702e+02],
         [-6.0557e+01,  2.9722e+02]],

        [[ 1.9439e+01,  8.2077e+01],
         [ 2.6036e+01,  1.2842e+01],
         [ 2.1092e+02,  1.9438e+01],
         [-2.8539e+02,  4.4348e+01],
         [-8.8692e+01, -3.5921e+01],
         [-2.3043e+01,  2.9904e+02],
         [ 8.9450e+01,  2.4210e+00],
         [ 5.8766e+02,  1.4705e+02],
         [-3.8893e+02, -3.5272e+02],
         [ 3.6152e+02, -1.7654e+02]],

        [[-5.3690e+01,  1.1332e+02],
         [ 2.6036e+01,  4.0867e+01],
         [ 2.6680e+02,  4.1167e+01],
         [-3.9450e+02,  3.3949e+01],
         [ 2.7561e+02, -1.4135e+02],
         [-3.3336e+02, -6.3711e+00],
         [ 4.0969e+02, -6.7020e+01],
         [ 7.6795e+01, -4.6176e+02],
         [-2.5173e+02, -3.4113e+02],
         [ 3.9456e+02, -1.4605e+01]]]) 

MatU.grad[20:30,20:30]:  tensor([[[  71.8929,  411.3469],
         [-431.1114,  281.0072],
         [ -82.8471,  549.9717],
         [ 367.5332,  452.3549],
         [  33.3231,  191.1270],
         [-388.0816,  240.2012],
         [ 572.2632,   66.4062],
         [-197.5195, -412.2442],
         [-403.9071, -233.2500],
         [ 450.3151,  200.8209]],

        [[ 118.0487,   -2.3944],
         [ 405.8083, -336.6762],
         [ -59.7689, -599.9377],
         [-102.1749, -439.4637],
         [  -1.5453, -378.6924],
         [-409.4293, -358.8900],
         [ 315.7964,  189.5188],
         [  26.2328, -413.0199],
         [ 131.4319, -130.0295],
         [ -21.4118,  433.9216]],

        [[-305.0222, -215.5539],
         [-462.8045,   73.1550],
         [ 131.9863,  304.6233],
         [ 140.4590,   -8.6726],
         [  78.2878,  610.9185],
         [ 106.5162,  253.8360],
         [-324.1706,  -93.2016],
         [  43.7138,  529.8177],
         [ 392.5799,  435.5991],
         [-298.2386, -401.3481]],

        [[ 107.6413,  481.0048],
         [-241.4999,  355.4357],
         [-260.0898, -199.6254],
         [ 598.6940,  190.5568],
         [-362.2026, -512.0146],
         [-334.2593, -217.3222],
         [ 596.8870,   81.4544],
         [ 196.0536, -471.4843],
         [-421.0904, -433.1926],
         [-229.1611, -160.4564]],

        [[ -95.0603, -389.2314],
         [-360.6286, -485.6750],
         [ 245.5186,   89.0885],
         [-236.6392,  216.8079],
         [ 178.4537,  267.9821],
         [  60.7584,  207.4030],
         [  31.1875, -342.4353],
         [ -22.9647,   27.8988],
         [-185.1917,  420.6018],
         [  66.0407,  443.0984]],

        [[-384.5996,  -45.9775],
         [ 344.7473,    8.0973],
         [ 354.5758,   68.5572],
         [-270.5384, -397.4230],
         [ 143.1140, -557.8541],
         [-399.0326, -233.3461],
         [ 183.9003,  611.3515],
         [ 416.4691,  275.4779],
         [ -90.4153, -576.8116],
         [-246.3996, -226.5774]],

        [[-386.5713,  188.1760],
         [ 205.1535,  549.4082],
         [ -80.8638,  -74.1499],
         [-537.7294,  -51.7637],
         [ 256.5131,  541.5721],
         [ 547.9148,  163.0336],
         [-127.8227, -120.5219],
         [-505.2110, -224.0644],
         [ 465.9404,  145.0826],
         [-179.7950, -209.0981]],

        [[  97.8294,  -51.8656],
         [-529.2202, -230.6852],
         [ -23.3930,  446.9818],
         [ 247.7133,  136.7450],
         [ -19.5842, -238.4968],
         [ 291.2466, -216.2304],
         [-219.7025, -555.0639],
         [-159.7151,  224.9505],
         [  86.0160,  229.4617],
         [ 169.1188,  567.2178]],

        [[-294.8120, -422.6062],
         [ 306.2419,   90.1564],
         [-401.1770, -265.5277],
         [-134.1267,   30.4085],
         [  -8.8138,   13.3597],
         [-364.7153,  430.4828],
         [ 399.7776,  523.7211],
         [  11.2810, -310.3284],
         [ 310.2840, -368.6057],
         [-205.1370,  255.5353]],

        [[ 326.1305,   68.4658],
         [ -96.1839, -367.0756],
         [-274.2612,  -45.8917],
         [-278.0540,  251.5905],
         [ 420.1895,  389.4992],
         [  97.6465, -366.5350],
         [-497.5321, -261.5197],
         [ -78.4911,   65.7641],
         [ 605.9914,  149.6310],
         [-382.1125, -428.2687]]]) 

t:0, loss.item(): 3618.494140625
Optimized result :
MatD: 
has nan? True 
tensor([[0.0130, 0.0115, 0.0108,  ..., 0.0044, 0.0048, 0.0060],
        [0.0105, 0.0122, 0.0102,  ..., 0.0049, 0.0053, 0.0064],
        [0.0106, 0.0101, 0.0096,  ..., 0.0032, 0.0042, 0.0047],
        ...,
        [0.0200, 0.0200, 0.0186,  ..., 0.0288, 0.0250, 0.0227],
        [0.0192, 0.0196, 0.0196,  ..., 0.0227, 0.0238, 0.0222],
        [0.0196, 0.0192, 0.0200,  ..., 0.0217, 0.0250, 0.0233]],
       requires_grad=True) 

MatUx: 
 has nan? True 
tensor([[-1.4928e-03, -7.4156e-04, -1.1439e-04,  ...,  4.0241e-04,
          1.2164e-03,  1.2164e-03],
        [ 1.6688e-03, -1.9910e-03,  3.2223e-04,  ...,  4.1719e-04,
          1.0911e-03,  1.0911e-03],
        [-5.3729e-04,  5.3729e-04,  1.0000e-10,  ...,  1.0000e-10,
          5.1074e-04,  5.1074e-04],
        ...,
        [ 1.0000e-10, -3.9216e-04,  8.0032e-04,  ..., -2.7778e-03,
         -2.2727e-03, -2.2727e-03],
        [ 3.7707e-04,  1.0000e-10,  3.9216e-04,  ...,  1.0823e-03,
         -1.5873e-03, -1.5873e-03],
        [-3.7707e-04,  7.6923e-04, -3.9216e-04,  ...,  3.2609e-03,
         -1.7442e-03, -1.7442e-03]], grad_fn=<SelectBackward>)  





test_counter in loss_omega_mat(): 671
test_counter in loss_omega_mat(): 1342
test_counter in loss_omega_mat(): 2013
test_counter in loss_omega_mat(): 2684
test_counter in loss_omega_mat(): 3355
test_counter in loss_omega_mat(): 4026
test_counter in loss_omega_mat(): 4697
mat_omega_topk has nan? True 

mat_duij has nan? True 

mat_uij has nan? True 

mat_omega_topk: tensor([[[0.9452, 0.9452, 0.9448,  ..., 0.8927, 0.8003, 0.8000],
         [0.9454, 0.9452, 0.9441,  ..., 0.8921, 0.8000, 0.7998],
         [0.9454, 0.9454, 0.9442,  ..., 0.8925, 0.8001, 0.8000],
         ...,
         [0.9449, 0.9442, 0.9442,  ..., 0.8932, 0.7994, 0.7994],
         [0.9450, 0.9449, 0.9445,  ..., 0.8931, 0.7995, 0.7994],
         [0.9452, 0.9450, 0.9450,  ..., 0.8933, 0.8004, 0.7999]],

        [[0.9449, 0.9447, 0.9447,  ..., 0.8931, 0.7997, 0.7995],
         [0.9453, 0.9446, 0.9442,  ..., 0.8931, 0.7999, 0.7997],
         [0.9453, 0.9448, 0.9442,  ..., 0.8929, 0.8000, 0.7999],
         ...,
         [0.9449, 0.9448, 0.9446,  ..., 0.8931, 0.7995, 0.7991],
         [0.9449, 0.9449, 0.9449,  ..., 0.8930, 0.7997, 0.7992],
         [0.9450, 0.9450, 0.9450,  ..., 0.8930, 0.8000, 0.7991]],

        [[0.9447, 0.9446, 0.9444,  ..., 0.8930, 0.7998, 0.7992],
         [0.9448, 0.9446, 0.9442,  ..., 0.8931, 0.7999, 0.7998],
         [0.9449, 0.9446, 0.9443,  ..., 0.8932, 0.8000, 0.8000],
         ...,
         [0.9449, 0.9449, 0.9448,  ..., 0.8930, 0.7997, 0.7996],
         [0.9452, 0.9450, 0.9449,  ..., 0.8934, 0.8000, 0.7999],
         [0.9453, 0.9452, 0.9450,  ..., 0.8936, 0.7999, 0.7996]],

        ...,

        [[0.9443, 0.9438, 0.9426,  ..., 0.8894, 0.7978, 0.7976],
         [0.9444, 0.9439, 0.9432,  ..., 0.8905, 0.7984, 0.7978],
         [0.9446, 0.9445, 0.9444,  ..., 0.8910, 0.8000, 0.7997],
         ...,
         [0.9454, 0.9451, 0.9436,  ..., 0.8915, 0.7996, 0.7988],
         [0.9454, 0.9444, 0.9443,  ..., 0.8912, 0.7996, 0.7981],
         [0.9443, 0.9418, 0.9404,  ..., 0.8828, 0.7988, 0.7964]],

        [[0.9448, 0.9445, 0.9443,  ..., 0.8905, 0.7978, 0.7975],
         [0.9444, 0.9442, 0.9438,  ..., 0.8907, 0.7984, 0.7977],
         [0.9445, 0.9437, 0.9434,  ..., 0.8895, 0.7987, 0.7984],
         ...,
         [0.9455, 0.9452, 0.9450,  ..., 0.8920, 0.7999, 0.7998],
         [0.9455, 0.9454, 0.9453,  ..., 0.8924, 0.8001, 0.8001],
         [0.9453, 0.9453, 0.9418,  ..., 0.8833, 0.7999, 0.7998]],

        [[0.9454, 0.9453, 0.9445,  ..., 0.8907, 0.7998, 0.7981],
         [0.9447, 0.9444, 0.9442,  ..., 0.8895, 0.7985, 0.7974],
         [0.9441, 0.9435, 0.9426,  ..., 0.8902, 0.7982, 0.7972],
         ...,
         [0.9453, 0.9452, 0.9450,  ..., 0.8935, 0.7998, 0.7998],
         [0.9455, 0.9454, 0.9454,  ..., 0.8937, 0.8000, 0.7997],
         [0.9454, 0.9454, 0.9453,  ..., 0.8883, 0.7998, 0.7995]]],
       grad_fn=<SliceBackward>) 

mat_duij: tensor([[[1.5697e-06, 6.1303e-07, 1.5342e-06,  ..., 1.6576e-06,
          4.8329e-06, 2.7454e-06],
         [5.9850e-07, 1.3389e-06, 5.9850e-07,  ..., 3.1790e-06,
          7.8533e-07, 8.7105e-11],
         [2.7431e-08, 1.2212e-06, 4.6899e-06,  ..., 5.4807e-07,
          3.7390e-06, 5.9637e-07],
         ...,
         [9.0619e-07, 4.7035e-06, 9.0619e-07,  ..., 4.0873e-09,
          3.2271e-06, 3.0395e-08],
         [1.6308e-07, 1.6308e-07, 3.8332e-06,  ..., 6.4929e-06,
          7.8151e-07, 6.6101e-07],
         [2.5496e-08, 4.4435e-06, 4.3565e-06,  ..., 1.2276e-06,
          1.2177e-06, 4.8981e-06]],

        [[5.9067e-06, 7.7991e-07, 2.5319e-06,  ..., 1.1782e-07,
          1.0266e-05, 3.3007e-07],
         [1.2419e-06, 7.6930e-06, 1.2419e-06,  ..., 7.0839e-07,
          5.4905e-06, 1.5154e-05],
         [6.1681e-07, 4.5021e-07, 7.1341e-06,  ..., 1.8009e-06,
          3.5555e-06, 3.5646e-06],
         ...,
         [4.9706e-06, 2.9151e-07, 6.4512e-06,  ..., 1.2193e-05,
          3.2026e-06, 1.1611e-05],
         [9.4333e-07, 1.6373e-06, 8.8283e-06,  ..., 1.2328e-05,
          4.7079e-06, 1.0102e-06],
         [2.4139e-10, 4.0624e-06, 4.0735e-06,  ..., 4.5092e-06,
          4.3610e-06, 7.5730e-07]],

        [[6.4510e-06, 7.7991e-07, 8.3124e-06,  ..., 4.4812e-06,
          3.1392e-07, 2.3247e-06],
         [1.2263e-06, 7.9676e-07, 3.0979e-07,  ..., 8.9652e-06,
          2.4690e-08, 7.1277e-06],
         [3.3027e-07, 5.4735e-06, 3.3027e-07,  ..., 1.2587e-05,
          7.3951e-07, 4.8378e-06],
         ...,
         [1.2082e-07, 1.2082e-07, 1.9026e-07,  ..., 4.8063e-06,
          3.2832e-09, 1.2287e-06],
         [1.4147e-06, 6.5708e-07, 3.7733e-07,  ..., 4.6684e-06,
          4.3193e-06, 4.3213e-06],
         [3.6359e-07, 3.1753e-06, 3.2123e-06,  ..., 3.4510e-07,
          2.5022e-06, 3.0983e-06]],

        ...,

        [[7.4793e-06, 9.3650e-08, 2.2419e-05,  ..., 5.6297e-07,
          4.0062e-05, 2.0330e-05],
         [9.1553e-06, 1.0520e-09, 1.0522e-06,  ..., 3.3184e-05,
          1.0172e-06, 7.1357e-06],
         [1.0000e-06, 1.7489e-08, 1.7489e-08,  ..., 9.9730e-06,
          6.9956e-08, 1.2726e-05],
         ...,
         [1.8150e-07, 7.6914e-07, 5.8856e-06,  ..., 2.6693e-05,
          8.3571e-06, 2.0338e-07],
         [4.9066e-07, 3.6308e-07, 3.6308e-07,  ..., 8.7889e-07,
          9.5854e-09, 2.2048e-06],
         [5.5610e-07, 8.8743e-09, 8.3795e-08,  ..., 9.2006e-06,
          3.5497e-08, 6.9445e-07]],

        [[1.0304e-06, 2.3182e-07, 1.6997e-06,  ..., 2.7210e-05,
          3.2582e-07, 9.2028e-06],
         [2.0603e-05, 8.8974e-06, 1.0104e-05,  ..., 2.9859e-05,
          3.6238e-05, 2.3921e-05],
         [1.3645e-06, 9.0223e-08, 1.5159e-05,  ..., 2.1926e-05,
          5.0193e-06, 2.1565e-06],
         ...,
         [1.0938e-06, 9.1045e-07, 2.8189e-07,  ..., 1.8050e-08,
          1.4550e-06, 9.2242e-07],
         [2.1405e-08, 5.4632e-07, 5.4631e-07,  ..., 7.7467e-07,
          1.6490e-06, 1.1656e-05],
         [2.7778e-08, 1.5562e-06, 6.5868e-07,  ..., 3.7154e-06,
          2.5906e-06, 1.1973e-06]],

        [[1.9381e-06, 3.3611e-06, 3.1838e-06,  ..., 1.5005e-05,
          7.7524e-06, 1.3017e-05],
         [1.1391e-05, 3.1838e-06, 1.6583e-05,  ..., 6.9854e-05,
          1.6079e-05, 4.0422e-05],
         [2.4658e-05, 2.4829e-05, 8.8974e-06,  ..., 2.1926e-05,
          4.0314e-05, 6.9567e-05],
         ...,
         [2.7778e-08, 2.9870e-09, 2.2571e-06,  ..., 3.4608e-07,
          4.4919e-07, 1.5216e-07],
         [4.6944e-06, 2.7777e-08, 5.3255e-08,  ..., 4.0000e-06,
          1.2345e-08, 5.7224e-06],
         [2.7777e-08, 4.6944e-06, 5.4631e-07,  ..., 4.0000e-06,
          1.1167e-06, 1.0028e-05]]], grad_fn=<CopySlices>) 

mat_uij: tensor([[[1.3793e-03, 5.3579e-04, 1.1684e-03,  ..., 9.8216e-04,
          1.7445e-03, 8.0903e-04],
         [1.1111e-03, 5.3579e-04, 1.5915e-03,  ..., 1.7462e-03,
          1.7111e-03, 1.8122e-03],
         [1.0575e-03, 1.1111e-03, 2.0156e-03,  ..., 2.2385e-03,
          8.6026e-04, 1.4896e-03],
         ...,
         [1.3147e-03, 1.6116e-03, 7.2667e-04,  ..., 1.5339e-03,
          9.2227e-04, 9.6602e-04],
         [1.6835e-03, 1.7114e-03, 2.3924e-03,  ..., 1.4170e-03,
          1.8037e-03, 1.6341e-03],
         [1.1608e-03, 8.9714e-05, 1.6835e-03,  ..., 1.1678e-03,
          6.6271e-04, 2.0645e-03]],

        [[2.2669e-03, 2.3430e-03, 6.0414e-04,  ..., 1.8745e-03,
          1.6201e-03, 1.3469e-03],
         [3.4834e-04, 1.6914e-03, 1.7044e-03,  ..., 1.3818e-03,
          4.0074e-04, 7.4253e-04],
         [3.4834e-04, 1.0905e-03, 1.4688e-03,  ..., 1.2466e-03,
          1.3522e-03, 2.0636e-03],
         ...,
         [1.3147e-03, 7.9062e-04, 3.4364e-04,  ..., 1.4170e-03,
          1.8918e-03, 1.8070e-03],
         [2.1189e-03, 1.7114e-03, 1.3138e-03,  ..., 9.8677e-04,
          2.4188e-03, 1.2531e-03],
         [1.9813e-03, 6.6916e-04, 8.9714e-05,  ..., 7.2553e-04,
          1.0714e-03, 1.8070e-03]],

        [[2.3430e-03, 1.7903e-03, 1.7701e-03,  ..., 2.6613e-03,
          2.7482e-03, 1.3697e-03],
         [1.4940e-03, 2.2822e-03, 1.7044e-03,  ..., 1.8745e-03,
          5.1629e-04, 1.8122e-03],
         [1.6820e-03, 2.2822e-03, 2.5459e-03,  ..., 1.7854e-03,
          1.9782e-03, 1.4896e-03],
         ...,
         [2.1356e-03, 3.3116e-04, 7.9062e-04,  ..., 9.8677e-04,
          1.1666e-03, 7.0460e-04],
         [1.0125e-03, 7.4865e-04, 3.3116e-04,  ..., 1.0106e-03,
          7.1258e-04, 6.7515e-04],
         [1.7274e-03, 1.0125e-03, 1.9813e-03,  ..., 1.3207e-03,
          2.0645e-03, 7.0460e-04]],

        ...,

        [[1.6505e-03, 5.2406e-03, 1.2742e-03,  ..., 3.2390e-03,
          2.1462e-03, 1.9089e-03],
         [1.5770e-03, 1.1358e-03, 1.6352e-03,  ..., 3.8578e-04,
          2.0982e-03, 6.5528e-04],
         [8.9211e-04, 1.5633e-03, 1.3004e-03,  ..., 2.1514e-03,
          1.8090e-03, 1.6267e-03],
         ...,
         [3.3144e-03, 3.6080e-03, 2.4439e-03,  ..., 3.2408e-03,
          3.1950e-03, 2.6548e-03],
         [3.3144e-03, 3.1423e-04, 6.6706e-04,  ..., 2.4352e-03,
          1.1774e-03, 6.8627e-04],
         [6.6706e-04, 1.1119e-03, 3.7062e-03,  ..., 5.2310e-03,
          2.6548e-03, 7.2462e-05]],

        [[9.5299e-04, 1.3606e-03, 1.6505e-03,  ..., 3.8578e-04,
          9.9152e-04, 7.9107e-04],
         [1.5770e-03, 1.2933e-03, 1.9342e-03,  ..., 1.1992e-03,
          1.8621e-03, 1.9557e-03],
         [1.5633e-03, 1.0941e-03, 2.4494e-03,  ..., 3.3066e-03,
          1.0696e-03, 1.5074e-03],
         ...,
         [1.2622e-03, 9.0647e-04, 4.4749e-04,  ..., 1.1700e-03,
          1.5039e-03, 4.5042e-04],
         [1.2622e-03, 5.1239e-04, 1.5028e-03,  ..., 3.1599e-03,
          1.6746e-03, 2.5084e-03],
         [1.0715e-03, 1.5028e-03, 1.1119e-03,  ..., 5.0828e-03,
          1.5039e-03, 2.0547e-03]],

        [[3.9216e-04, 1.6180e-03, 1.3606e-03,  ..., 1.1992e-03,
          5.5459e-04, 2.2808e-03],
         [1.6383e-03, 1.6383e-03, 1.2933e-03,  ..., 3.3066e-03,
          2.2626e-03, 1.6383e-03],
         [2.5420e-03, 1.6633e-03, 2.0213e-03,  ..., 1.3629e-03,
          8.0323e-04, 2.0213e-03],
         ...,
         [1.4673e-03, 9.0647e-04, 1.0019e-03,  ..., 5.4134e-04,
          7.9959e-04, 1.4673e-03],
         [2.0009e-03, 0.0000e+00, 5.1239e-04,  ..., 2.3154e-03,
          9.7139e-04, 2.1140e-03],
         [0.0000e+00, 2.3154e-03, 1.0715e-03,  ..., 1.6369e-03,
          1.4673e-03, 1.0966e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:nan loss2:nan
t:1, Finish constructing loss
