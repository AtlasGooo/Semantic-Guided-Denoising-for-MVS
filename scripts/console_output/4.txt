cv_MatI numpy float32: 
[[ 62  61  62 ...  82  79  88]
 [ 62  63  64 ...  80  81  83]
 [ 61  63  63 ...  81  80 102]
 ...
 [ 62  62  62 ...  76  77  79]
 [ 62  62  64 ...  77  80  75]
 [ 63  63  63 ...  88  85  89]]
MatI: 
tensor([[ 62.,  61.,  62.,  ...,  82.,  79.,  88.],
        [ 62.,  63.,  64.,  ...,  80.,  81.,  83.],
        [ 61.,  63.,  63.,  ...,  81.,  80., 102.],
        ...,
        [ 62.,  62.,  62.,  ...,  76.,  77.,  79.],
        [ 62.,  62.,  64.,  ...,  77.,  80.,  75.],
        [ 63.,  63.,  63.,  ...,  88.,  85.,  89.]])
MatI[0:10,35:45]: 
tensor([[ 65.,  65.,  64.,  65.,  65.,  60.,  64.,  66.,  67.,  68.],
        [ 65.,  65.,  65.,  65.,  66.,  65.,  65.,  64.,  67.,  68.],
        [ 64.,  67.,  68.,  64., 125., 101., 125.,   1.,  99., 115.],
        [ 65.,  66.,  64.,  68.,  66., 106.,   1.,  65., 105.,  58.],
        [ 65.,  66.,  65.,  67.,  66.,  65.,  68.,  66.,  65.,  67.],
        [ 66.,  67.,  68.,  66., 125., 100., 115.,  65.,  98., 114.],
        [ 66.,  67.,  66.,  67.,  64., 105.,  66.,  65.,  66.,  67.],
        [ 65.,  66.,  65.,  65.,  56.,  50.,  48.,  54.,  50.,  49.],
        [ 47.,  75.,  77., 118., 125.,  77., 115., 124.,  76., 114.],
        [ 49.,  49.,  74.,  69.,  75.,  75.,  73.,  76.,  77.,  75.]]) 

debug:
MatD.shape: torch.Size([37, 123]) 
has nan? False 
MatD: 
tensor([[0.0161, 0.0164, 0.0161,  ..., 0.0122, 0.0127, 0.0114],
        [0.0161, 0.0159, 0.0156,  ..., 0.0125, 0.0123, 0.0120],
        [0.0164, 0.0159, 0.0159,  ..., 0.0123, 0.0125, 0.0098],
        ...,
        [0.0161, 0.0161, 0.0161,  ..., 0.0132, 0.0130, 0.0127],
        [0.0161, 0.0161, 0.0156,  ..., 0.0130, 0.0125, 0.0133],
        [0.0159, 0.0159, 0.0159,  ..., 0.0114, 0.0118, 0.0112]]) 

MatU.shape: torch.Size([37, 123, 2]) 
has nan? False 
MatUx: 
tensor([[ 2.6441e-04, -2.6441e-04, -2.5601e-04,  ...,  4.6311e-04,
         -1.2946e-03, -1.2946e-03],
        [-2.5601e-04, -2.4802e-04,  2.4802e-04,  ..., -1.5432e-04,
         -2.9749e-04, -2.9749e-04],
        [-5.2042e-04,  1.0000e-10,  5.2043e-04,  ...,  1.5432e-04,
         -2.6961e-03, -2.6961e-03],
        ...,
        [ 1.0000e-10,  1.0000e-10, -2.5601e-04,  ..., -1.7088e-04,
         -3.2878e-04, -3.2878e-04],
        [ 1.0000e-10, -5.0403e-04,  5.0403e-04,  ..., -4.8701e-04,
          8.3333e-04,  8.3333e-04],
        [ 1.0000e-10,  1.0000e-10,  2.5602e-04,  ...,  4.0107e-04,
         -5.2875e-04, -5.2875e-04]]) 




test_counter in loss_omega_mat(): 455
test_counter in loss_omega_mat(): 910
test_counter in loss_omega_mat(): 1365
test_counter in loss_omega_mat(): 1820
test_counter in loss_omega_mat(): 2275
test_counter in loss_omega_mat(): 2730
test_counter in loss_omega_mat(): 3185
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9460, 0.9459, 0.9459,  ..., 0.8948, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9459,  ..., 0.8948, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9459,  ..., 0.8948, 0.8007, 0.8007],
         ...,
         [0.9459, 0.9458, 0.9454,  ..., 0.8940, 0.8006, 0.8002],
         [0.9459, 0.9458, 0.9455,  ..., 0.8939, 0.8006, 0.8003],
         [0.9459, 0.9458, 0.9455,  ..., 0.8943, 0.8006, 0.8006]],

        [[0.9460, 0.9459, 0.9459,  ..., 0.8948, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9459,  ..., 0.8948, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9459,  ..., 0.8948, 0.8007, 0.8007],
         ...,
         [0.9458, 0.9456, 0.9455,  ..., 0.8939, 0.8006, 0.8001],
         [0.9458, 0.9456, 0.9454,  ..., 0.8935, 0.8006, 0.8001],
         [0.9458, 0.9458, 0.9454,  ..., 0.8939, 0.8007, 0.8004]],

        [[0.9459, 0.9459, 0.9459,  ..., 0.8948, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9459,  ..., 0.8948, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9459,  ..., 0.8948, 0.8007, 0.8007],
         ...,
         [0.9456, 0.9456, 0.9456,  ..., 0.8935, 0.8002, 0.8002],
         [0.9456, 0.9455, 0.9452,  ..., 0.8930, 0.8002, 0.7997],
         [0.9458, 0.9456, 0.9452,  ..., 0.8932, 0.8005, 0.8001]],

        ...,

        [[0.9447, 0.9432, 0.9421,  ..., 0.8915, 0.7985, 0.7979],
         [0.9422, 0.9389, 0.9355,  ..., 0.8887, 0.7971, 0.7969],
         [0.9420, 0.9356, 0.9355,  ..., 0.8864, 0.7966, 0.7966],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.8947, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9458,  ..., 0.8939, 0.8007, 0.8007],
         [0.9458, 0.9456, 0.9450,  ..., 0.8935, 0.8004, 0.8003]],

        [[0.9444, 0.9421, 0.9415,  ..., 0.8887, 0.7993, 0.7981],
         [0.9371, 0.9341, 0.9335,  ..., 0.8854, 0.7946, 0.7941],
         [0.9331, 0.9331, 0.9306,  ..., 0.8834, 0.7938, 0.7935],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.8947, 0.8007, 0.8007],
         [0.9459, 0.9459, 0.9459,  ..., 0.8940, 0.8007, 0.8006],
         [0.9458, 0.9457, 0.9453,  ..., 0.8938, 0.8004, 0.8003]],

        [[0.9438, 0.9435, 0.9415,  ..., 0.8881, 0.7995, 0.7976],
         [0.9364, 0.9362, 0.9335,  ..., 0.8834, 0.7941, 0.7921],
         [0.9355, 0.9331, 0.9277,  ..., 0.8817, 0.7921, 0.7915],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.8944, 0.8007, 0.8007],
         [0.9459, 0.9458, 0.9457,  ..., 0.8938, 0.8006, 0.8006],
         [0.9458, 0.9457, 0.9455,  ..., 0.8937, 0.8003, 0.7998]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[1.0000e-20, 1.0000e-20, 1.0000e-20,  ..., 4.0000e-20,
          4.0000e-20, 4.0000e-20],
         [1.0000e-20, 1.0000e-20, 1.0000e-20,  ..., 4.0000e-20,
          6.5544e-08, 6.1512e-08],
         [6.5544e-08, 6.5544e-08, 6.5544e-08,  ..., 6.5544e-08,
          4.0000e-20, 2.6217e-07],
         ...,
         [1.6585e-07, 4.9122e-07, 6.5282e-07,  ..., 3.1451e-07,
          6.6265e-08, 1.9554e-08],
         [3.6224e-06, 8.8138e-07, 8.8138e-07,  ..., 5.6621e-08,
          1.3589e-05, 6.5768e-08],
         [6.5260e-07, 2.2547e-07, 2.2547e-07,  ..., 2.1528e-07,
          1.6452e-06, 2.3720e-08]],

        [[1.0000e-20, 1.0000e-20, 1.0000e-20,  ..., 4.0000e-20,
          6.5544e-08, 4.0000e-20],
         [6.5544e-08, 7.6233e-21, 7.6233e-21,  ..., 2.6217e-07,
          2.6217e-07, 2.6217e-07],
         [7.6233e-21, 2.6217e-07, 2.6217e-07,  ..., 6.5544e-08,
          2.6217e-07, 6.5544e-08],
         ...,
         [3.3333e-07, 4.6862e-07, 6.2515e-06,  ..., 2.6612e-10,
          7.4145e-07, 1.0367e-05],
         [4.7690e-08, 2.1225e-06, 2.1225e-06,  ..., 4.5857e-06,
          1.9634e-06, 3.3157e-06],
         [2.3720e-08, 1.0273e-07, 1.0273e-07,  ..., 1.2913e-06,
          4.1091e-07, 2.2547e-07]],

        [[6.5544e-08, 6.5544e-08, 1.0000e-20,  ..., 6.5544e-08,
          2.6217e-07, 4.0000e-20],
         [2.6217e-07, 7.6233e-21, 2.6217e-07,  ..., 6.5544e-08,
          5.8989e-07, 5.8989e-07],
         [1.0000e-20, 6.5544e-08, 6.5544e-08,  ..., 0.0000e+00,
          4.0000e-20, 4.0000e-20],
         ...,
         [1.1117e-06, 6.9137e-07, 2.7732e-06,  ..., 3.0238e-06,
          6.7745e-06, 1.6086e-07],
         [4.5857e-06, 5.2633e-06, 5.2633e-06,  ..., 1.1213e-05,
          9.2682e-06, 1.7442e-05],
         [1.0000e-20, 1.0000e-20, 1.0000e-20,  ..., 5.2633e-06,
          2.7722e-08, 4.0000e-20]],

        ...,

        [[2.6774e-06, 6.9913e-08, 2.6774e-06,  ..., 1.0607e-05,
          1.0710e-05, 9.5554e-07],
         [1.1292e-09, 2.3942e-05, 1.9264e-05,  ..., 3.6305e-05,
          1.0162e-06, 9.5769e-05],
         [2.3731e-06, 2.2881e-05, 1.4040e-05,  ..., 1.5553e-07,
          1.1032e-05, 4.8858e-05],
         ...,
         [1.0000e-20, 1.2023e-08, 1.0000e-20,  ..., 0.0000e+00,
          4.0000e-20, 4.0000e-20],
         [1.0000e-20, 1.0000e-20, 1.0000e-20,  ..., 1.2540e-08,
          1.2540e-08, 1.2023e-08],
         [4.0801e-06, 5.0351e-06, 1.2540e-08,  ..., 5.0351e-06,
          1.0636e-05, 1.3535e-05]],

        [[9.0995e-06, 2.6261e-06, 2.1502e-05,  ..., 9.0047e-06,
          3.4925e-05, 1.9332e-05],
         [4.2427e-05, 1.5688e-04, 1.9142e-05,  ..., 1.3960e-04,
          4.2827e-04, 1.3011e-04],
         [6.3063e-06, 8.6310e-05, 6.3063e-06,  ..., 4.7423e-05,
          2.3525e-04, 4.6193e-04],
         ...,
         [1.0000e-20, 1.2023e-08, 1.2023e-08,  ..., 1.2023e-08,
          1.2023e-08, 4.8092e-08],
         [1.2540e-08, 1.0000e-20, 1.2540e-08,  ..., 1.2540e-08,
          4.0000e-20, 5.0159e-08],
         [7.7023e-07, 2.6708e-07, 1.3020e-07,  ..., 6.4350e-06,
          3.9173e-06, 7.2729e-07]],

        [[1.4172e-06, 3.6465e-07, 7.6205e-06,  ..., 1.6267e-05,
          5.1625e-06, 6.2726e-06],
         [6.3063e-06, 8.5251e-08, 5.5358e-05,  ..., 3.4743e-06,
          2.4853e-05, 1.3702e-06],
         [2.7662e-05, 2.0674e-04, 2.2503e-05,  ..., 6.0384e-05,
          1.0088e-04, 8.1559e-06],
         ...,
         [4.8092e-08, 1.9862e-07, 1.0376e-20,  ..., 5.4374e-12,
          1.0821e-07, 1.0821e-07],
         [3.4199e-07, 5.4388e-12, 2.2355e-07,  ..., 2.9334e-07,
          1.3679e-06, 2.0280e-07],
         [8.0364e-08, 2.1554e-07, 4.7334e-09,  ..., 8.1354e-08,
          1.6625e-06, 3.7546e-07]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0003, 0.0003],
         [0.0000, 0.0003, 0.0004,  ..., 0.0000, 0.0004, 0.0006],
         [0.0006, 0.0006, 0.0003,  ..., 0.0004, 0.0003, 0.0003],
         ...,
         [0.0006, 0.0013, 0.0016,  ..., 0.0015, 0.0009, 0.0015],
         [0.0011, 0.0014, 0.0023,  ..., 0.0021, 0.0011, 0.0014],
         [0.0006, 0.0004, 0.0009,  ..., 0.0015, 0.0002, 0.0005]],

        [[0.0000, 0.0003, 0.0004,  ..., 0.0000, 0.0004, 0.0002],
         [0.0004, 0.0007, 0.0007,  ..., 0.0004, 0.0003, 0.0004],
         [0.0004, 0.0006, 0.0007,  ..., 0.0003, 0.0000, 0.0006],
         ...,
         [0.0013, 0.0003, 0.0021,  ..., 0.0021, 0.0011, 0.0011],
         [0.0014, 0.0007, 0.0013,  ..., 0.0009, 0.0003, 0.0014],
         [0.0004, 0.0003, 0.0004,  ..., 0.0020, 0.0002, 0.0007]],

        [[0.0003, 0.0006, 0.0004,  ..., 0.0004, 0.0003, 0.0003],
         [0.0006, 0.0004, 0.0007,  ..., 0.0008, 0.0004, 0.0003],
         [0.0000, 0.0004, 0.0004,  ..., 0.0003, 0.0003, 0.0003],
         ...,
         [0.0012, 0.0003, 0.0013,  ..., 0.0009, 0.0009, 0.0015],
         [0.0007, 0.0009, 0.0017,  ..., 0.0016, 0.0014, 0.0009],
         [0.0003, 0.0013, 0.0002,  ..., 0.0023, 0.0007, 0.0004]],

        ...,

        [[0.0016, 0.0014, 0.0044,  ..., 0.0091, 0.0016, 0.0030],
         [0.0044, 0.0033, 0.0082,  ..., 0.0069, 0.0054, 0.0049],
         [0.0037, 0.0055, 0.0082,  ..., 0.0092, 0.0032, 0.0051],
         ...,
         [0.0001, 0.0002, 0.0000,  ..., 0.0001, 0.0001, 0.0002],
         [0.0000, 0.0001, 0.0001,  ..., 0.0020, 0.0002, 0.0009],
         [0.0012, 0.0003, 0.0021,  ..., 0.0020, 0.0010, 0.0013]],

        [[0.0018, 0.0044, 0.0039,  ..., 0.0069, 0.0022, 0.0036],
         [0.0110, 0.0115, 0.0128,  ..., 0.0032, 0.0095, 0.0097],
         [0.0150, 0.0126, 0.0124,  ..., 0.0071, 0.0106, 0.0103],
         ...,
         [0.0001, 0.0002, 0.0003,  ..., 0.0006, 0.0002, 0.0001],
         [0.0001, 0.0002, 0.0005,  ..., 0.0020, 0.0003, 0.0000],
         [0.0012, 0.0002, 0.0010,  ..., 0.0018, 0.0012, 0.0004]],

        [[0.0016, 0.0035, 0.0039,  ..., 0.0104, 0.0030, 0.0014],
         [0.0022, 0.0028, 0.0128,  ..., 0.0071, 0.0057, 0.0036],
         [0.0007, 0.0150, 0.0102,  ..., 0.0087, 0.0046, 0.0061],
         ...,
         [0.0002, 0.0005, 0.0010,  ..., 0.0011, 0.0002, 0.0001],
         [0.0005, 0.0005, 0.0007,  ..., 0.0006, 0.0006, 0.0009],
         [0.0006, 0.0002, 0.0006,  ..., 0.0014, 0.0013, 0.0010]]],
       grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:167.22467041015625
t:0, Finish constructing loss
require grad ? True True False
MatD grad and MatUx grad: torch.Size([37, 123]) torch.Size([37, 123, 2]) 

Grads has nan? MatD.grad: True 	MatU.grad: True

Where is nan? 
MatD.grad nan: 
tensor([[ 1, 39],
        [ 1, 40],
        [ 2, 39],
        [ 2, 40],
        [ 2, 42],
        [ 3, 39],
        [ 3, 40],
        [ 3, 41],
        [ 3, 42],
        [ 3, 43],
        [ 4, 38],
        [ 4, 39],
        [ 4, 40],
        [ 4, 41],
        [ 4, 42],
        [ 4, 43],
        [ 4, 44],
        [ 5, 38],
        [ 5, 39],
        [ 5, 40],
        [ 5, 41],
        [ 5, 42],
        [ 5, 43],
        [ 5, 44],
        [ 6, 40],
        [ 6, 41],
        [ 6, 42],
        [ 6, 43]]) 
MatU.grad nan: 
tensor([[ 4, 40,  0],
        [ 4, 40,  1],
        [ 4, 41,  0],
        [ 4, 41,  1]])

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,        -inf,        -inf,
                 inf,        -inf,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00, -1.5151e-03,  1.1746e-02,        -inf,         nan,
                 nan,        -inf,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-2.5408e+00,  1.1608e+00,  6.0020e-02,        -inf,         nan,
                 nan,         inf,         nan,         inf,  1.6388e+00],
        [-5.7525e+00, -8.0375e+00,        -inf,        -inf,         nan,
                 nan,         nan,         nan,         nan,         inf],
        [-1.1580e+01,  1.3476e+00,        -inf,         nan,         nan,
                 nan,         nan,         nan,         nan,         nan],
        [-1.0895e+01, -2.9082e+01,        -inf,         nan,         nan,
                 nan,         nan,         nan,         nan,         nan],
        [-4.9327e+00, -2.2827e+01,  1.0646e+01,        -inf,        -inf,
                 nan,         nan,         nan,         nan,         inf],
        [-6.9089e+00, -1.6273e+01,  1.7122e+00, -7.4919e-01, -2.7412e+01,
                -inf,        -inf,        -inf,        -inf, -3.6029e+01],
        [ 4.0034e+00, -1.1086e+01,  6.2267e-01, -2.4815e-01,  1.5668e+01,
          1.5518e+01,  1.8724e+01,  2.3229e+01,  1.6457e+01,  8.4656e+00],
        [-1.0217e+01, -2.4836e+00, -5.1007e+00,  1.2210e+01,  9.6448e+00,
          7.2811e+00,  2.1230e+01,  4.2550e+00, -2.1296e+00,  9.5128e+00]]) 

MatU.grad[0:10,35:45]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.2822e-42, -2.4845e-42],
         [-1.8063e-42,  2.1342e-42],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-2.8021e+01, -4.3754e-01],
         [-1.9821e+01,  1.9807e+01],
         [ 0.0000e+00,  0.0000e+00],
         [-2.7437e+01, -4.0023e+00],
         [ 3.1905e+00,  2.7361e+01],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-3.3736e+01,  6.8591e+01],
         [ 1.0719e+02,  5.0918e+01],
         [-1.0917e+02, -1.8888e+00],
         [ 5.5761e+01,  5.2028e+01],
         [-9.7077e+01,  7.2758e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-2.3626e-42, -2.3542e-42],
         [-2.4957e-42,  2.2855e-42],
         [ 2.4707e+01,  1.8578e+01],
         [-8.9584e+01,  2.0466e+01]],

        [[ 5.7981e+00, -2.4442e+02],
         [ 3.0026e+02, -2.2655e+02],
         [-1.5956e+02, -3.3961e+02],
         [ 1.1305e+02,  7.5059e+01],
         [ 7.6567e+01, -4.4063e+02],
         [        nan,         nan],
         [        nan,         nan],
         [-3.3539e+01, -9.7457e+00],
         [-2.5105e+00, -3.2560e+02],
         [ 8.9146e+01, -4.5761e+02]],

        [[-1.1062e+02, -3.1644e+01],
         [-7.6718e+01, -5.2303e+01],
         [ 3.6035e+02,  3.4435e+02],
         [-5.4285e+02, -6.6102e+01],
         [ 9.2925e+01,  3.7321e+02],
         [ 3.0643e+01, -1.7340e+02],
         [ 4.0775e+02,  1.6550e+02],
         [-4.3510e+02, -1.7965e+02],
         [-3.0497e+02,  2.8520e+02],
         [ 4.5107e+02,  3.8961e+02]],

        [[-7.5817e+00,  1.3039e+02],
         [ 2.4545e+02,  1.4031e+02],
         [-1.2652e+02,  2.7185e+02],
         [ 2.2923e+02,  1.1207e+02],
         [-4.2125e+02,  1.9135e+02],
         [ 2.7444e+02,  5.2792e+02],
         [ 2.2850e+01,  3.9816e+02],
         [-5.1944e+01, -6.8401e+01],
         [-3.2019e+01,  2.9036e+02],
         [ 1.6319e+02,  5.0844e+02]],

        [[ 8.3135e+00,  4.0074e+02],
         [ 1.8702e+02, -2.9058e+02],
         [-3.4913e+01, -3.6609e+02],
         [ 2.6223e+02, -4.2284e+02],
         [ 1.5375e+02, -5.2601e+02],
         [-3.5431e-01, -2.1885e+02],
         [-2.3798e+02, -5.6240e+02],
         [ 2.0400e+02, -4.7841e+02],
         [ 6.0749e+01, -1.7450e+02],
         [-1.9936e+02, -5.4095e+02]],

        [[-5.0566e+02, -2.1491e+02],
         [ 9.3641e+01,  5.3864e+02],
         [-3.7373e+02,  6.4907e+00],
         [-3.3990e+01,  5.5051e+02],
         [ 4.0324e+02,  3.8966e+02],
         [-4.4219e+02,  4.5874e+01],
         [-6.8464e+01,  4.7696e+02],
         [ 4.3373e+02,  3.8010e+02],
         [-4.4714e+02, -1.0346e+01],
         [-1.2956e+02,  4.8031e+02]],

        [[ 1.2142e+02,  2.2989e+02],
         [-3.3332e+02,  4.9094e+01],
         [ 4.0105e+02, -1.9742e+02],
         [-2.2922e+02, -3.2920e+02],
         [ 5.3944e+01, -2.5936e+02],
         [ 2.5842e+02, -4.5192e+02],
         [-2.2229e+02, -1.7420e+02],
         [ 6.4166e+01, -3.0883e+02],
         [ 1.5273e+02,  2.4284e+02],
         [-1.6056e+02,  1.2342e+01]]]) 

MatD.grad: 
tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0011,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ..., -0.0016,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 2.5146e+01,  1.2373e+01],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 8.6572e+01, -5.0170e+01],
         [-1.5903e+01, -7.4947e+01],
         [ 6.1507e+01, -4.4660e+01],
         [-4.1713e+01, -8.0559e+01],
         [ 8.9156e+01,  2.8103e+01]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.1222e+02, -8.0904e+01],
         [ 1.4050e+01, -2.8835e+01],
         [ 1.1707e+01,  4.1279e+02],
         [-4.5248e+02,  4.0540e+01],
         [ 4.0749e+02,  1.6348e+02],
         [-8.5250e+01, -1.5665e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00, -2.8025e+01],
         [-5.1135e+01, -1.9816e+01],
         [-5.5598e+01,  3.1258e+01],
         [ 4.0460e+02,  4.0460e+02],
         [-2.5852e+02, -4.5335e+02],
         [-3.9703e+02, -1.9901e+01],
         [ 1.6024e+02,  2.7147e+02],
         [ 2.6293e+02, -1.8960e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 4.2325e+00, -8.4796e+01],
         [ 3.9206e+02, -1.5010e+02],
         [-3.7719e+02, -4.2098e+02],
         [ 8.2120e+01, -1.4899e+02],
         [ 1.3886e+01, -6.7809e+01],
         [-2.0309e+02, -5.7344e+01],
         [ 5.8192e+02,  2.0451e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 6.1090e+01,  4.1991e+01],
         [-2.1455e+01,  4.2874e+02],
         [ 7.6156e+01,  1.0522e+02],
         [ 3.9773e+01,  2.9707e+02],
         [-2.9939e+01, -1.5030e+02],
         [ 2.4014e+02,  4.2041e+02],
         [ 2.6624e+02, -4.4338e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 7.7739e+01, -1.9394e-01],
         [-3.5255e+02,  1.6616e+02],
         [ 1.7306e+02,  2.7309e+02],
         [-3.3883e+02,  2.6611e+02],
         [ 4.9380e+02, -1.4257e+02],
         [-5.1911e+02, -3.6161e+02],
         [ 1.9150e+02,  3.4073e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 8.8842e+01,  6.1726e-01],
         [-2.4216e+02, -3.1910e+02],
         [ 3.3123e+02, -3.7228e+02],
         [-5.1855e+02, -3.3620e+02],
         [ 3.0953e+01, -4.3109e+01],
         [ 1.5645e+02, -1.4209e+02],
         [ 3.3396e+02, -5.8559e-01]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[-585.1490, -156.1891],
         [ 446.0198,  205.9089],
         [  94.7641, -463.1649],
         [-364.9140, -299.4767],
         [-127.3682,  128.7963],
         [ 199.5378,  -37.4100],
         [ 352.8670,    4.1646],
         [-542.7241, -183.6602],
         [ 139.7976,  123.4425],
         [ 196.6683,  469.2116]],

        [[-335.9976, -231.9882],
         [-230.3198,  215.9290],
         [ 153.8904,  530.4575],
         [  60.9625,  310.5788],
         [-102.1823, -447.5497],
         [ 135.2411,  488.3094],
         [ -66.0035, -476.1005],
         [-305.3351,  -25.9096],
         [ 479.3369,  271.2061],
         [-437.0287,  197.1397]],

        [[  59.5621,   42.1134],
         [ 566.5951,  -53.8259],
         [-294.4734, -488.9924],
         [-528.9927,  -45.1036],
         [ 487.8113,  402.9980],
         [-449.2108,  -85.6986],
         [ 334.7124, -175.4483],
         [  67.0285,  386.0750],
         [ 394.3261, -114.0574],
         [-427.5810, -434.4211]],

        [[ -73.8722,  -14.1169],
         [   7.5128,  -26.4452],
         [  17.6310,  -93.1054],
         [ 213.1668,   -9.4122],
         [ -37.8199,  112.9548],
         [-370.8240,  316.7086],
         [ 520.6078,  335.9236],
         [-187.3443, -234.8195],
         [-508.7582, -113.8677],
         [ 337.1807,  109.7878]],

        [[ -40.5527,  -75.1645],
         [ -51.4511,  595.7000],
         [  82.8548,  -39.9064],
         [ 176.7063,  492.0381],
         [ 149.2263, -414.8939],
         [-448.1221, -330.1252],
         [ 253.6831, -381.3142],
         [-210.6090,   -2.0768],
         [ -21.5262,   51.6931],
         [ 558.4421,  109.5957]],

        [[ 549.0851,  -61.2173],
         [-447.2078,   38.5029],
         [ 582.8112,    6.4967],
         [-409.4901, -462.3698],
         [ 199.6121,  -94.6824],
         [-463.4799,   74.6926],
         [ 367.8957,  256.8787],
         [-122.9251, -493.4527],
         [ 295.4229,  323.5256],
         [-321.4349, -341.3242]],

        [[ 563.3396,  -22.2103],
         [-238.1141, -437.3963],
         [-316.9209,  100.1968],
         [ -17.4543,  105.4394],
         [ 481.7838, -166.7807],
         [-336.6743, -225.6898],
         [-132.9661,  309.8182],
         [ 525.7461, -174.5236],
         [-539.3356,  -69.5723],
         [  21.4039,  385.2906]],

        [[ -40.3766,  504.1535],
         [ 303.3399,  -14.1553],
         [-327.0179,   94.2049],
         [-578.0860,   65.5105],
         [ 375.8995,  453.2036],
         [ 122.7732, -199.5042],
         [-466.5464, -225.9005],
         [ 450.5108,  412.1999],
         [ -44.7297, -277.0034],
         [ 544.0659,   36.1308]],

        [[-530.5098, -105.5383],
         [ 357.3361,   -9.6327],
         [-341.3911,   73.6799],
         [ 233.6259,   69.1233],
         [-453.2875,   33.4886],
         [ -75.8462,  382.5146],
         [ 312.3264,   18.5208],
         [-163.2765, -213.5188],
         [ 353.3139,  -66.3824],
         [-143.6073, -458.3197]],

        [[-341.4053, -119.4361],
         [ 445.3792,  -17.0563],
         [-297.0046, -528.3790],
         [  99.5799,  131.9403],
         [ 224.1152, -319.5041],
         [-336.1572, -219.9550],
         [  79.0160,  612.7747],
         [ -17.1195,  325.6225],
         [-384.5723,   78.3041],
         [ 290.5270,  515.0600]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[-580.0094,  -48.3845],
         [ 530.2443,  139.5760],
         [  42.5061, -611.5210],
         [-456.3491, -234.4474],
         [ 366.2870,  290.1114],
         [ -94.4237, -509.4729],
         [  43.6477,  155.7214],
         [ 303.0686,  -60.8727],
         [-228.6429, -465.5358],
         [ 269.9425,  -48.9645]],

        [[-300.5220,  -80.7906],
         [-486.2643,  267.1289],
         [ 266.7530,  540.4310],
         [ 170.4326,  285.4300],
         [-553.8574,  120.9174],
         [ 452.0792,  429.2332],
         [-407.0357, -208.4821],
         [-320.8405,  120.9005],
         [ 167.4250,  515.0928],
         [ 319.8752,  301.5030]],

        [[   0.8241,  391.9199],
         [ 180.9590, -371.0873],
         [  59.7414,   65.2093],
         [ -13.9742, -201.7873],
         [ 103.7282, -375.8524],
         [-237.7829, -257.3229],
         [  88.0271,   65.8599],
         [ 518.4298,   48.2502],
         [-443.5248, -129.3961],
         [  34.7165, -266.3802]],

        [[-568.0453, -211.1152],
         [ 444.4269,  182.0097],
         [-178.3371, -616.1036],
         [-363.7436,   76.0406],
         [  79.4518,  443.4744],
         [ 226.4285, -282.7781],
         [ 267.2921,  183.2096],
         [ 397.5135, -110.0801],
         [-256.6195, -451.0111],
         [ 162.2137,  177.6703]],

        [[-206.4733,  -63.1984],
         [-491.2246,  106.2400],
         [ 348.2343,  523.8224],
         [ 119.6435,  247.7246],
         [-583.9799,   59.1723],
         [ 478.7981,  405.3532],
         [-401.6851, -235.0026],
         [-434.6371,   95.9107],
         [ 394.8886,  306.6702],
         [  25.1685, -427.1767]],

        [[-155.2986,  388.5783],
         [ 415.9674, -117.9488],
         [ 107.2209, -233.6456],
         [-238.9571, -344.2982],
         [ 272.0084, -220.5640],
         [ -44.2508, -336.6951],
         [-215.7267,  175.1570],
         [ 224.5901, -190.3006],
         [-302.1725, -276.5007],
         [ 435.4228,  224.6984]],

        [[-554.1385, -171.0259],
         [ 195.1936,  156.9958],
         [ -25.6515, -598.2354],
         [-285.9476,   81.1334],
         [ 135.3000,  242.7513],
         [ 295.4141, -317.3106],
         [-145.2010,  538.9970],
         [ -11.5362,   47.5741],
         [ 214.1360, -232.4766],
         [ 269.2967, -126.3188]],

        [[-338.8760, -257.7783],
         [-540.1505,  236.3804],
         [ 404.8471,  370.1785],
         [ -59.2685,   63.2513],
         [-384.5937,   21.5927],
         [ 493.5225, -107.9725],
         [-389.3543, -418.4982],
         [-241.1287,  123.9418],
         [ 204.1706,  354.2538],
         [-431.7287,   18.3885]],

        [[ -14.8585,  -67.7941],
         [ 317.1995, -312.0332],
         [ -44.3659, -416.4389],
         [ -49.3311,  154.1482],
         [-163.7797,  502.9045],
         [ -15.3391,   93.8717],
         [   6.9507,  375.5336],
         [  26.0595,  284.5550],
         [-128.3557, -461.7674],
         [ 457.0745,  -75.7237]],

        [[-462.2928,  122.4199],
         [  85.8483,  237.4527],
         [  40.8550,  548.9706],
         [ 473.0669, -160.8629],
         [-262.6549, -413.3379],
         [ 385.4167,  -12.5595],
         [-225.9665, -341.3745],
         [-276.4047, -141.5362],
         [ 172.7603,  405.0842],
         [ 215.8787,  390.1227]]]) 

t:0, loss.item(): 1672.2467041015625
Optimized result :
MatD: 
has nan? True 
tensor([[0.0161, 0.0164, 0.0161,  ..., 0.0122, 0.0127, 0.0114],
        [0.0161, 0.0159, 0.0156,  ..., 0.0125, 0.0123, 0.0120],
        [0.0164, 0.0159, 0.0159,  ..., 0.0113, 0.0125, 0.0098],
        ...,
        [0.0161, 0.0161, 0.0161,  ..., 0.0142, 0.0130, 0.0127],
        [0.0161, 0.0161, 0.0156,  ..., 0.0130, 0.0125, 0.0133],
        [0.0159, 0.0159, 0.0159,  ..., 0.0114, 0.0118, 0.0112]],
       requires_grad=True) 

MatUx: 
 has nan? True 
tensor([[ 2.6441e-04, -2.6441e-04, -2.5601e-04,  ...,  4.6311e-04,
         -1.2946e-03, -1.2946e-03],
        [-2.5601e-04, -2.4802e-04,  2.4802e-04,  ..., -1.5432e-04,
         -2.9749e-04, -2.9749e-04],
        [-5.2042e-04,  1.0000e-10,  5.2043e-04,  ...,  1.5432e-04,
         -2.6961e-03, -2.6961e-03],
        ...,
        [ 1.0000e-10,  1.0000e-10, -2.5601e-04,  ..., -1.7088e-04,
         -3.2878e-04, -3.2878e-04],
        [ 1.0000e-10, -5.0403e-04,  5.0403e-04,  ..., -4.8701e-04,
          8.3333e-04,  8.3333e-04],
        [ 1.0000e-10,  1.0000e-10,  2.5602e-04,  ...,  4.0107e-04,
         -5.2875e-04, -5.2875e-04]], grad_fn=<SelectBackward>)  








test_counter in loss_omega_mat(): 455
test_counter in loss_omega_mat(): 910
test_counter in loss_omega_mat(): 1365
test_counter in loss_omega_mat(): 1820
test_counter in loss_omega_mat(): 2275
test_counter in loss_omega_mat(): 2730
test_counter in loss_omega_mat(): 3185
mat_omega_topk has nan? True 

mat_duij has nan? True 

mat_uij has nan? True 

mat_omega_topk: 
tensor([[[0.9451, 0.9449, 0.9446,  ..., 0.8925, 0.7994, 0.7993],
         [0.9450, 0.9449, 0.9440,  ..., 0.8925, 0.7995, 0.7993],
         [0.9450, 0.9447, 0.9440,  ..., 0.8925, 0.7996, 0.7996],
         ...,
         [0.9454, 0.9447, 0.9447,  ..., 0.8926, 0.8002, 0.7991],
         [0.9455, 0.9447, 0.9444,  ..., 0.8929, 0.8002, 0.7989],
         [0.9452, 0.9447, 0.9445,  ..., 0.8923, 0.7996, 0.7990]],

        [[0.9446, 0.9445, 0.9444,  ..., 0.8926, 0.7991, 0.7989],
         [0.9444, 0.9443, 0.9443,  ..., 0.8925, 0.7996, 0.7994],
         [0.9443, 0.9443, 0.9440,  ..., 0.8925, 0.7996, 0.7992],
         ...,
         [0.9456, 0.9454, 0.9445,  ..., 0.8932, 0.8002, 0.8001],
         [0.9456, 0.9455, 0.9446,  ..., 0.8928, 0.8002, 0.8000],
         [0.9455, 0.9452, 0.9449,  ..., 0.8932, 0.8001, 0.7998]],

        [[0.9448, 0.9447, 0.9447,  ..., 0.8927, 0.7996, 0.7996],
         [0.9447, 0.9447, 0.9446,  ..., 0.8929, 0.8000, 0.7993],
         [0.9447, 0.9444, 0.9443,  ..., 0.8933, 0.7996, 0.7996],
         ...,
         [0.9456, 0.9454, 0.9448,  ..., 0.8935, 0.8002, 0.8001],
         [0.9456, 0.9455, 0.9450,  ..., 0.8936, 0.8002, 0.8002],
         [0.9456, 0.9455, 0.9450,  ..., 0.8935, 0.8001, 0.8000]],

        ...,

        [[0.9447, 0.9445, 0.9435,  ..., 0.8910, 0.7989, 0.7988],
         [0.9437, 0.9407, 0.9401,  ..., 0.8912, 0.7978, 0.7970],
         [0.9435, 0.9405, 0.9401,  ..., 0.8893, 0.7980, 0.7974],
         ...,
         [0.9442, 0.9438, 0.9435,  ..., 0.8931, 0.8001, 0.7993],
         [0.9445, 0.9441, 0.9440,  ..., 0.8929, 0.7998, 0.7990],
         [0.9451, 0.9446, 0.9440,  ..., 0.8917, 0.7994, 0.7993]],

        [[0.9447, 0.9439, 0.9436,  ..., 0.8888, 0.7990, 0.7987],
         [0.9393, 0.9369, 0.9362,  ..., 0.8839, 0.7961, 0.7947],
         [0.9366, 0.9360, 0.9355,  ..., 0.8842, 0.7960, 0.7953],
         ...,
         [0.9442, 0.9442, 0.9438,  ..., 0.8932, 0.7996, 0.7996],
         [0.9448, 0.9446, 0.9445,  ..., 0.8931, 0.7997, 0.7997],
         [0.9453, 0.9451, 0.9446,  ..., 0.8920, 0.7996, 0.7993]],

        [[0.9442, 0.9439, 0.9421,  ..., 0.8890, 0.7988, 0.7985],
         [0.9375, 0.9367, 0.9362,  ..., 0.8840, 0.7925, 0.7909],
         [0.9360, 0.9347, 0.9297,  ..., 0.8839, 0.7905, 0.7902],
         ...,
         [0.9452, 0.9444, 0.9443,  ..., 0.8930, 0.7995, 0.7995],
         [0.9454, 0.9451, 0.9448,  ..., 0.8936, 0.7999, 0.7993],
         [0.9454, 0.9453, 0.9451,  ..., 0.8923, 0.7995, 0.7994]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[1.0000e-06, 1.0000e-06, 1.0000e-06,  ..., 5.4210e-20,
          2.2849e-06, 9.0000e-06],
         [1.0000e-06, 1.0000e-06, 1.0000e-06,  ..., 3.0415e-06,
          5.0536e-06, 4.0000e-06],
         [5.5351e-07, 5.5351e-07, 5.5351e-07,  ..., 1.4017e-05,
          3.0415e-06, 9.9913e-07],
         ...,
         [8.9480e-08, 3.5135e-07, 3.6874e-08,  ..., 1.1828e-05,
          3.4602e-06, 1.4255e-07],
         [3.7429e-09, 8.1590e-07, 4.7333e-06,  ..., 5.1306e-06,
          1.2458e-06, 9.8352e-08],
         [2.7580e-07, 2.7580e-07, 4.8056e-06,  ..., 1.4313e-06,
          7.8116e-07, 2.3720e-08]],

        [[1.0000e-06, 1.0000e-06, 9.0000e-06,  ..., 4.0000e-06,
          4.0000e-06, 6.5543e-08],
         [1.0000e-06, 5.5351e-07, 1.0000e-06,  ..., 1.2166e-05,
          2.6218e-07, 1.2166e-05],
         [6.1900e-06, 1.0000e-06, 1.0000e-06,  ..., 1.0446e-05,
          6.3979e-11, 2.2141e-06],
         ...,
         [2.8377e-06, 1.7864e-07, 2.8377e-06,  ..., 3.9350e-06,
          6.0872e-07, 2.5344e-06],
         [2.0874e-07, 6.1093e-07, 2.3812e-06,  ..., 2.5738e-06,
          1.1375e-06, 7.9386e-07],
         [4.6170e-07, 7.1569e-07, 4.6170e-07,  ..., 1.0270e-05,
          1.8468e-06, 6.8927e-06]],

        [[1.0000e-06, 5.5351e-07, 7.5295e-06,  ..., 3.0415e-06,
          7.0459e-11, 4.0000e-06],
         [6.1900e-06, 1.0000e-06, 1.0000e-06,  ..., 1.0446e-05,
          3.0415e-06, 1.0446e-05],
         [5.5351e-07, 1.0000e-06, 9.0000e-06,  ..., 5.4210e-20,
          4.0000e-06, 4.0000e-06],
         ...,
         [3.3543e-06, 2.9548e-09, 4.2204e-06,  ..., 1.3979e-05,
          5.7651e-06, 3.6335e-07],
         [1.3029e-06, 1.6749e-06, 4.9816e-07,  ..., 6.1965e-08,
          8.1561e-08, 1.0907e-06],
         [1.0000e-06, 1.0000e-06, 1.0000e-06,  ..., 2.8207e-06,
          1.1950e-05, 1.1064e-05]],

        ...,

        [[1.8597e-06, 5.4109e-07, 1.8597e-06,  ..., 1.5795e-06,
          9.5554e-07, 3.0415e-06],
         [9.3392e-07, 1.5156e-05, 1.1486e-05,  ..., 4.1019e-06,
          9.0484e-06, 3.3480e-05],
         [2.9213e-07, 3.1806e-06, 7.5458e-06,  ..., 1.5553e-07,
          4.6054e-07, 2.4899e-05],
         ...,
         [9.0000e-06, 7.9272e-07, 1.0000e-06,  ..., 1.2197e-19,
          4.0000e-06, 4.0000e-06],
         [1.0000e-06, 1.0000e-06, 1.0000e-06,  ..., 1.2540e-08,
          4.4605e-06, 5.4210e-20],
         [1.0403e-06, 5.7170e-07, 7.8858e-07,  ..., 9.8741e-06,
          2.8191e-06, 4.9460e-06]],

        [[6.8671e-06, 2.6800e-06, 4.0664e-06,  ..., 1.5244e-08,
          2.1279e-05, 3.6471e-06],
         [3.0400e-05, 9.0726e-05, 2.8892e-05,  ..., 1.3960e-04,
          2.7871e-04, 8.8486e-05],
         [6.8730e-05, 1.2329e-05, 1.2329e-05,  ..., 9.7361e-05,
          1.7790e-04, 7.5100e-05],
         ...,
         [9.0000e-06, 7.9272e-07, 1.2313e-06,  ..., 4.0093e-06,
          5.4210e-20, 1.0975e-07],
         [1.2365e-06, 7.8858e-07, 7.8858e-07,  ..., 4.4605e-06,
          4.0000e-06, 4.4605e-06],
         [2.3349e-07, 1.4975e-08, 4.0853e-07,  ..., 2.7593e-09,
          1.0026e-05, 1.3160e-06]],

        [[1.5692e-07, 3.0994e-06, 3.6282e-08,  ..., 9.7273e-08,
          2.0291e-05, 1.8251e-05],
         [5.0130e-07, 2.2838e-06, 1.9716e-05,  ..., 5.4069e-08,
          8.9121e-06, 6.8796e-07],
         [1.7898e-04, 1.8143e-05, 1.4016e-05,  ..., 5.3388e-05,
          2.3579e-05, 2.2366e-04],
         ...,
         [1.0000e-06, 1.0000e-06, 6.5246e-06,  ..., 4.0093e-06,
          8.9517e-06, 6.1263e-06],
         [2.7793e-07, 2.7793e-07, 1.7239e-07,  ..., 1.6984e-06,
          2.3717e-06, 7.3013e-06],
         [5.1339e-07, 2.8701e-07, 8.6713e-07,  ..., 1.4393e-06,
          1.9245e-06, 8.4546e-07]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[1.4142e-03, 2.0000e-03, 1.4142e-03,  ..., 2.4664e-03,
          7.2351e-04, 1.5992e-03],
         [1.7440e-03, 2.0000e-03, 1.7627e-03,  ..., 1.7627e-03,
          1.8230e-03, 2.5070e-03],
         [1.7440e-03, 1.5331e-03, 2.2925e-03,  ..., 1.7627e-03,
          1.0522e-03, 4.8865e-04],
         ...,
         [7.4836e-04, 6.2109e-04, 1.6446e-03,  ..., 1.4162e-03,
          5.8190e-04, 4.1779e-04],
         [1.0483e-03, 1.1855e-03, 2.6707e-04,  ..., 1.6998e-03,
          6.0980e-04, 1.7388e-03],
         [1.8614e-03, 2.0664e-03, 2.2566e-03,  ..., 1.5239e-03,
          1.9424e-03, 2.4981e-03]],

        [[2.6536e-03, 2.0000e-03, 2.0000e-03,  ..., 1.4142e-03,
          5.2042e-04, 1.7627e-03],
         [2.1043e-03, 1.7627e-03, 2.1043e-03,  ..., 2.4664e-03,
          2.2977e-03, 1.7440e-03],
         [2.1043e-03, 2.5614e-04, 1.7627e-03,  ..., 1.7627e-03,
          2.1156e-03, 1.1642e-10],
         ...,
         [2.6695e-04, 7.4836e-04, 1.0907e-03,  ..., 7.1241e-04,
          9.3790e-04, 1.9500e-03],
         [7.0139e-04, 1.0483e-03, 1.5979e-03,  ..., 7.8242e-04,
          1.5438e-03, 1.4106e-03],
         [3.2051e-04, 1.8614e-03, 1.8616e-03,  ..., 1.5330e-03,
          6.9207e-04, 1.1813e-03]],

        [[3.5645e-04, 2.2871e-03, 1.5098e-03,  ..., 1.7440e-03,
          2.2740e-03, 2.5602e-04],
         [1.5098e-03, 1.7627e-03, 2.2925e-03,  ..., 1.7627e-03,
          1.7627e-03, 1.7627e-03],
         [1.7627e-03, 1.7440e-03, 1.1642e-10,  ..., 1.7627e-03,
          2.0000e-03, 2.5602e-04],
         ...,
         [2.6695e-04, 1.9702e-03, 5.8488e-04,  ..., 1.2822e-03,
          5.8190e-04, 9.4474e-04],
         [7.0139e-04, 9.3320e-04, 1.2833e-03,  ..., 1.1838e-03,
          1.3451e-03, 6.0980e-04],
         [6.9301e-04, 3.2051e-04, 2.7161e-03,  ..., 2.1780e-03,
          9.4564e-04, 1.8202e-03]],

        ...,

        [[1.6164e-03, 1.3988e-03, 3.6372e-04,  ..., 8.1619e-03,
          1.3141e-03, 1.4234e-03],
         [4.5944e-03, 3.2956e-03, 6.2112e-03,  ..., 4.3391e-03,
          3.8556e-03, 2.9367e-03],
         [3.2498e-03, 2.7301e-03, 6.2112e-03,  ..., 7.1725e-03,
          3.1913e-03, 2.9156e-03],
         ...,
         [1.8904e-03, 1.8935e-03, 2.0000e-03,  ..., 2.0031e-03,
          2.7504e-03, 2.1161e-03],
         [1.1198e-04, 1.8880e-03, 1.7303e-04,  ..., 1.8312e-03,
          1.5837e-04, 1.4196e-03],
         [1.9979e-03, 2.5040e-04, 1.7303e-04,  ..., 6.7629e-04,
          1.8853e-03, 2.1161e-03]],

        [[1.6164e-03, 1.3700e-03, 1.8265e-03,  ..., 1.4023e-03,
          1.5707e-03, 2.2099e-04],
         [9.0847e-03, 1.0199e-02, 1.0243e-02,  ..., 3.2489e-03,
          6.9107e-03, 7.7602e-03],
         [1.0788e-02, 1.2167e-02, 1.0518e-02,  ..., 7.7904e-03,
          7.8401e-03, 1.2539e-02],
         ...,
         [1.8904e-03, 2.5970e-03, 1.5673e-04,  ..., 1.1201e-04,
          7.9667e-04, 1.7408e-03],
         [1.5313e-03, 1.8953e-03, 1.1198e-04,  ..., 2.0031e-03,
          1.7772e-03, 1.7140e-03],
         [1.8826e-04, 1.9979e-03, 1.8953e-03,  ..., 1.8426e-03,
          1.7408e-03, 1.6834e-03]],

        [[1.5124e-03, 1.3700e-03, 8.0653e-04,  ..., 2.2404e-03,
          1.4234e-03, 1.4285e-03],
         [8.6164e-04, 3.0223e-03, 1.0243e-02,  ..., 7.4765e-03,
          3.0717e-03, 1.6372e-03],
         [1.2167e-02, 7.3448e-04, 8.0066e-03,  ..., 3.2489e-03,
          5.4810e-03, 5.9941e-03],
         ...,
         [2.2346e-03, 2.0579e-03, 2.3601e-03,  ..., 1.1278e-03,
          1.4022e-03, 9.9021e-04],
         [1.6083e-03, 1.5003e-03, 1.5313e-03,  ..., 1.4325e-03,
          1.3532e-03, 2.4823e-03],
         [1.5136e-03, 1.8826e-04, 1.5003e-03,  ..., 1.8635e-03,
          9.9021e-04, 1.3897e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:nan loss2:nan
t:1, Finish constructing loss
