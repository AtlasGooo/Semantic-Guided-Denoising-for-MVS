DIR_NAME: g:\Workspaces\Anaconda_ws\Semantic_Denoising_MVS\scripts 

DEVICE: cuda? True

Graph params:
(pLambda,pAlpha,pCigma_int,pCigma_spa,pB,pK,pQ): 
(25,15,0.07,3,9,20,5)

cv_MatI numpy: 
[[ 63  62  64 ... 114 122 115]
 [ 65  63  67 ... 115 125 119]
 [ 62  73  67 ... 116 119 116]
 ...
 [ 83  66  77 ...  85  80  81]
 [ 87  55  82 ...  73  78  74]
 [ 71  69  73 ...  72  85  88]]
MatI: 
tensor([[ 63.,  62.,  64.,  ..., 114., 122., 115.],
        [ 65.,  63.,  67.,  ..., 115., 125., 119.],
        [ 62.,  73.,  67.,  ..., 116., 119., 116.],
        ...,
        [ 83.,  66.,  77.,  ...,  85.,  80.,  81.],
        [ 87.,  55.,  82.,  ...,  73.,  78.,  74.],
        [ 71.,  69.,  73.,  ...,  72.,  85.,  88.]])
MatI[0:10,35:45]: 
tensor([[ 91.,  89.,  84.,  86.,  89.,  85.,  84.,  89.,  84.,  83.],
        [101.,  95.,  93.,  89.,  88.,  84.,  89.,  89.,  81.,  88.],
        [ 75.,  93.,  95.,  95.,  92.,  87., 104.,  91.,  90.,  64.],
        [ 74.,  68.,  85.,  79.,  93.,  96.,  94., 132.,  95.,  93.],
        [ 82.,  69.,  66.,  78., 114.,  87.,  65., 114.,  55., 142.],
        [ 76.,  72.,  76.,  75.,  88.,  88.,  79., 131.,  81.,  61.],
        [ 73.,  75.,  85.,  74.,  75.,  97.,  83., 132.,  71.,  75.],
        [ 79.,  74.,  81.,  80.,  74.,  53., 102., 113.,  52., 142.],
        [ 78.,  77.,  81.,  94.,  83.,  10.,  59., 128.,  64.,  51.],
        [ 79.,  74.,  85.,  84.,  90.,  88.,  10., 131.,  66.,  10.]]) 

debug:
MatD.shape: torch.Size([59, 98]) 
has nan? False 
MatD: 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0149,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]]) 

MatU.shape: torch.Size([59, 98, 2]) 
has nan? False 
MatUx: 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]]) 

MatD[0:10,35:45]: 
tensor([[0.0110, 0.0112, 0.0119, 0.0116, 0.0112, 0.0118, 0.0119, 0.0112, 0.0119,
         0.0120],
        [0.0099, 0.0105, 0.0108, 0.0112, 0.0114, 0.0119, 0.0112, 0.0112, 0.0123,
         0.0114],
        [0.0133, 0.0108, 0.0105, 0.0105, 0.0109, 0.0115, 0.0096, 0.0110, 0.0111,
         0.0156],
        [0.0135, 0.0147, 0.0118, 0.0127, 0.0108, 0.0104, 0.0106, 0.0076, 0.0105,
         0.0108],
        [0.0122, 0.0145, 0.0152, 0.0128, 0.0088, 0.0115, 0.0154, 0.0088, 0.0182,
         0.0070],
        [0.0132, 0.0139, 0.0132, 0.0133, 0.0114, 0.0114, 0.0127, 0.0076, 0.0123,
         0.0164],
        [0.0137, 0.0133, 0.0118, 0.0135, 0.0133, 0.0103, 0.0120, 0.0076, 0.0141,
         0.0133],
        [0.0127, 0.0135, 0.0123, 0.0125, 0.0135, 0.0189, 0.0098, 0.0088, 0.0192,
         0.0070],
        [0.0128, 0.0130, 0.0123, 0.0106, 0.0120, 0.1000, 0.0169, 0.0078, 0.0156,
         0.0196],
        [0.0127, 0.0135, 0.0118, 0.0119, 0.0111, 0.0114, 0.1000, 0.0076, 0.0152,
         0.1000]]) 

MatU[0:10,35:45]: 
tensor([[[ 2.4694e-04, -1.0880e-03],
         [ 6.6881e-04, -7.0964e-04],
         [-2.7686e-04, -1.1521e-03],
         [-3.9195e-04, -3.9195e-04],
         [ 5.2875e-04,  1.2768e-04],
         [ 1.4006e-04,  1.4006e-04],
         [-6.6881e-04, -6.6881e-04],
         [ 6.6881e-04,  1.0000e-10],
         [ 1.4343e-04,  4.4092e-04],
         [ 1.8407e-03, -6.8456e-04]],

        [[ 6.2533e-04,  3.4323e-03],
         [ 2.2637e-04,  2.2637e-04],
         [ 4.8327e-04, -2.2637e-04],
         [ 1.2768e-04, -7.0964e-04],
         [ 5.4113e-04, -4.9407e-04],
         [-6.6881e-04, -4.1051e-04],
         [ 1.0000e-10, -1.6206e-03],
         [ 1.1097e-03, -2.4694e-04],
         [-9.8204e-04, -1.2346e-03],
         [ 2.5253e-03,  4.2614e-03]],

        [[-2.5806e-03,  1.8018e-04],
         [-2.2637e-04,  3.9532e-03],
         [ 1.0000e-10,  1.2384e-03],
         [ 3.4325e-04,  2.1319e-03],
         [ 6.2469e-04, -1.1688e-04],
         [-1.8789e-03, -1.0776e-03],
         [ 1.3736e-03,  1.0229e-03],
         [ 1.2210e-04, -3.4133e-03],
         [ 4.5139e-03, -5.8480e-04],
         [-2.9668e-03, -4.8723e-03]],

        [[ 1.1924e-03, -1.3184e-03],
         [-2.9412e-03, -2.1313e-04],
         [ 8.9352e-04,  3.3868e-03],
         [-1.9055e-03,  1.6228e-04],
         [-3.3602e-04, -1.9808e-03],
         [ 2.2163e-04,  1.0776e-03],
         [-3.0625e-03,  4.7463e-03],
         [ 2.9506e-03,  1.1962e-03],
         [ 2.2637e-04,  7.6555e-03],
         [-3.1769e-03, -3.7104e-03]],

        [[ 2.2976e-03,  9.6277e-04],
         [ 6.5876e-04, -6.0386e-04],
         [-2.3310e-03, -1.9936e-03],
         [-4.0486e-03,  5.1282e-04],
         [ 2.7223e-03,  2.5917e-03],
         [ 3.8904e-03, -1.3062e-04],
         [-6.6127e-03, -2.7264e-03],
         [ 9.4099e-03, -1.1383e-03],
         [-1.1140e-02, -5.8361e-03],
         [ 2.3035e-03,  9.3512e-03]],

        [[ 7.3099e-04,  5.4074e-04],
         [-7.3099e-04, -5.5556e-04],
         [ 1.7544e-04, -1.3932e-03],
         [-1.9697e-03,  1.8018e-04],
         [ 1.0000e-10,  1.9697e-03],
         [ 1.2946e-03, -1.0544e-03],
         [-5.0246e-03, -6.1004e-04],
         [ 4.7121e-03, -5.7830e-05],
         [ 4.0478e-03,  1.7388e-03],
         [-9.1471e-03, -3.0601e-03]],

        [[-3.6530e-04, -1.0404e-03],
         [-1.5686e-03,  1.8018e-04],
         [ 1.7488e-03,  5.8097e-04],
         [-1.8018e-04, -1.0135e-03],
         [-3.0241e-03,  1.8018e-04],
         [ 1.7389e-03,  8.5586e-03],
         [-4.4724e-03, -2.2443e-03],
         [ 6.5087e-03,  1.2738e-03],
         [-7.5117e-04,  5.1463e-03],
         [-5.3333e-03, -6.2911e-03]],

        [[ 8.5529e-04,  1.6228e-04],
         [-1.1678e-03, -5.2650e-04],
         [ 1.5432e-04,  1.0000e-10],
         [ 1.0135e-03, -1.8617e-03],
         [ 5.3544e-03, -1.4653e-03],
         [-9.0640e-03,  8.1132e-02],
         [-9.5436e-04,  7.1452e-03],
         [ 1.0381e-02, -1.0371e-03],
         [-1.2189e-02, -3.6058e-03],
         [ 1.8073e-03,  1.2566e-02]],

        [[ 1.6650e-04, -1.6228e-04],
         [-6.4133e-04,  5.2650e-04],
         [-1.7074e-03, -5.8097e-04],
         [ 1.4099e-03,  1.2665e-03],
         [ 8.7952e-02, -9.3708e-04],
         [-8.3051e-02, -8.8636e-02],
         [-9.1367e-03,  8.3051e-02],
         [ 7.8125e-03, -1.7891e-04],
         [ 3.9828e-03, -4.7348e-04],
         [-1.1671e-02,  8.0392e-02]],

        [[ 8.5529e-04,  1.0000e-10],
         [-1.7488e-03, -5.2650e-04],
         [ 1.4006e-04,  7.3529e-04],
         [-7.9365e-04,  1.4343e-04],
         [ 2.5253e-04, -2.4155e-04],
         [ 8.8636e-02,  1.3062e-04],
         [-9.2366e-02, -9.0196e-02],
         [ 7.5179e-03,  1.2160e-03],
         [ 8.4848e-02,  5.2566e-03],
         [-9.2424e-02, -9.3007e-02]]]) 

Optimize & Adam params:
(n_iter,lr,betas,eps):
(20,0.0005,(0.9, 0.999),1e-08)










test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.4402, 0.4251, 0.4203,  ..., 0.2737, 0.2727, 0.2685],
         [0.4405, 0.4251, 0.4204,  ..., 0.2728, 0.2688, 0.2645],
         [0.4405, 0.4251, 0.4204,  ..., 0.2736, 0.2728, 0.2683],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.7566, 0.7559, 0.7552],
         [0.9458, 0.9458, 0.9456,  ..., 0.7567, 0.7566, 0.7565],
         [0.9458, 0.9458, 0.9454,  ..., 0.7568, 0.7564, 0.7562]],

        [[0.9443, 0.9443, 0.9442,  ..., 0.6057, 0.6044, 0.5728],
         [0.9448, 0.9443, 0.9443,  ..., 0.5729, 0.5727, 0.5726],
         [0.9448, 0.9444, 0.9443,  ..., 0.6047, 0.6043, 0.5728],
         ...,
         [0.9457, 0.9457, 0.9454,  ..., 0.7564, 0.7555, 0.7551],
         [0.9456, 0.9455, 0.9455,  ..., 0.7567, 0.7566, 0.7563],
         [0.9455, 0.9455, 0.9454,  ..., 0.7568, 0.7568, 0.7564]],

        [[0.9445, 0.9444, 0.9444,  ..., 0.6401, 0.6400, 0.6396],
         [0.9448, 0.9448, 0.9446,  ..., 0.6398, 0.6395, 0.6059],
         [0.9448, 0.9448, 0.9447,  ..., 0.6400, 0.6397, 0.6396],
         ...,
         [0.9457, 0.9457, 0.9453,  ..., 0.7564, 0.7553, 0.7551],
         [0.9456, 0.9455, 0.9454,  ..., 0.7566, 0.7564, 0.7563],
         [0.9455, 0.9454, 0.9454,  ..., 0.7568, 0.7566, 0.7565]],

        ...,

        [[0.9457, 0.9451, 0.9450,  ..., 0.7565, 0.7444, 0.7443],
         [0.9374, 0.9367, 0.9336,  ..., 0.7503, 0.7390, 0.7255],
         [0.9361, 0.9281, 0.9273,  ..., 0.7421, 0.7178, 0.7157],
         ...,
         [0.9449, 0.9448, 0.9447,  ..., 0.7555, 0.7553, 0.7553],
         [0.9453, 0.9448, 0.9443,  ..., 0.7553, 0.7553, 0.7552],
         [0.9453, 0.9451, 0.9441,  ..., 0.7555, 0.7552, 0.7551]],

        [[0.9450, 0.9450, 0.9448,  ..., 0.7502, 0.7400, 0.7386],
         [0.9367, 0.9336, 0.9331,  ..., 0.7466, 0.7328, 0.7207],
         [0.9273, 0.9267, 0.9265,  ..., 0.7410, 0.7132, 0.7098],
         ...,
         [0.9452, 0.9449, 0.9447,  ..., 0.7554, 0.7543, 0.7543],
         [0.9453, 0.9449, 0.9443,  ..., 0.7555, 0.7539, 0.7537],
         [0.9453, 0.9452, 0.9441,  ..., 0.7552, 0.7547, 0.7544]],

        [[0.9450, 0.9442, 0.9442,  ..., 0.7472, 0.7354, 0.7304],
         [0.9348, 0.9331, 0.9315,  ..., 0.7421, 0.7302, 0.7114],
         [0.9267, 0.9251, 0.9247,  ..., 0.7345, 0.7252, 0.7041],
         ...,
         [0.9453, 0.9450, 0.9445,  ..., 0.7553, 0.7540, 0.7540],
         [0.9453, 0.9450, 0.9439,  ..., 0.7551, 0.7538, 0.7538],
         [0.9453, 0.9448, 0.9439,  ..., 0.7550, 0.7546, 0.7546]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[4.1929e-06, 2.6487e-06, 6.0901e-06,  ..., 1.1119e-05,
          2.8118e-05, 1.0944e-05],
         [1.7654e-07, 1.9825e-06, 6.0901e-06,  ..., 1.4576e-06,
          4.9123e-05, 8.1020e-05],
         [1.8716e-07, 6.3606e-08, 7.2725e-07,  ..., 2.6204e-08,
          1.2305e-06, 4.5459e-06],
         ...,
         [9.8030e-09, 1.0000e-20, 1.0000e-20,  ..., 3.6961e-08,
          4.0008e-08, 1.0000e-20],
         [1.6670e-07, 1.0000e-20, 1.6670e-07,  ..., 1.5876e-06,
          8.3830e-07, 2.5538e-07],
         [1.6670e-07, 1.6670e-07, 1.6670e-07,  ..., 1.2675e-06,
          9.0540e-08, 6.6680e-07]],

        [[3.8611e-07, 3.8611e-07, 3.8611e-07,  ..., 3.4750e-06,
          6.4661e-06, 3.8611e-07],
         [1.5049e-06, 1.5049e-06, 1.0146e-06,  ..., 3.5301e-06,
          1.7429e-05, 1.2165e-07],
         [2.1090e-07, 2.1090e-07, 4.8176e-08,  ..., 4.8176e-08,
          4.8948e-07, 2.5511e-06],
         ...,
         [1.0000e-20, 1.0000e-20, 1.0000e-20,  ..., 1.4226e-07,
          9.8030e-09, 1.6670e-07],
         [1.6670e-07, 2.5538e-07, 2.5538e-07,  ..., 1.7475e-06,
          4.5861e-08, 6.3151e-07],
         [5.4362e-07, 6.6680e-07, 1.0825e-07,  ..., 6.9943e-07,
          7.1822e-06, 2.2793e-06]],

        [[3.4467e-07, 6.7664e-07, 3.4467e-07,  ..., 1.2555e-06,
          5.0229e-06, 9.8151e-07],
         [3.1240e-06, 4.9907e-06, 3.1240e-06,  ..., 6.3893e-06,
          6.5400e-09, 9.5675e-06],
         [1.9051e-06, 8.9803e-07, 1.9051e-06,  ..., 1.0367e-05,
          1.0196e-05, 3.2582e-07],
         ...,
         [9.4222e-09, 1.6013e-07, 1.6013e-07,  ..., 1.4411e-08,
          1.4858e-06, 2.5920e-07],
         [1.4528e-06, 3.7689e-08, 1.4528e-06,  ..., 8.1405e-07,
          4.4922e-06, 6.7274e-06],
         [3.5546e-08, 1.4644e-07, 9.6858e-08,  ..., 1.7579e-06,
          8.2650e-08, 3.1192e-07]],

        ...,

        [[2.8718e-11, 1.5747e-07, 4.0484e-08,  ..., 4.0484e-08,
          1.5307e-07, 1.3913e-06],
         [3.8266e-08, 3.1247e-11, 3.8266e-08,  ..., 3.6111e-08,
          1.5307e-07, 3.6199e-08],
         [2.8718e-11, 2.8718e-11, 1.4890e-07,  ..., 3.4103e-08,
          3.6903e-06, 8.4015e-05],
         ...,
         [2.4314e-06, 2.4237e-06, 2.4237e-06,  ..., 8.9955e-06,
          1.4116e-07, 6.6997e-09],
         [1.9878e-06, 2.3234e-06, 1.0000e-20,  ..., 9.7174e-06,
          1.9878e-06, 8.0365e-08],
         [2.4237e-06, 3.1629e-06, 3.1629e-06,  ..., 3.5262e-07,
          4.4608e-06, 1.1628e-05]],

        [[3.2603e-07, 3.5764e-07, 5.9629e-07,  ..., 8.9561e-07,
          2.3852e-06, 1.9090e-06],
         [1.6194e-07, 1.4890e-07, 3.4467e-07,  ..., 6.2140e-07,
          9.9396e-06, 8.3810e-05],
         [3.6199e-08, 1.4890e-07, 5.9560e-07,  ..., 1.3924e-06,
          9.1560e-07, 1.6788e-05],
         ...,
         [1.3166e-11, 8.8498e-08, 2.5261e-06,  ..., 4.0050e-06,
          6.5768e-08, 8.6353e-08],
         [2.1588e-08, 2.1588e-08, 1.5951e-06,  ..., 1.0033e-06,
          3.3333e-07, 6.6560e-07],
         [3.3333e-07, 1.8526e-07, 2.4237e-06,  ..., 6.0170e-07,
          7.3145e-08, 7.8320e-08]],

        [[2.3852e-06, 1.3041e-06, 4.0485e-08,  ..., 3.4103e-08,
          1.2908e-06, 1.5350e-06],
         [3.1941e-07, 1.6194e-07, 1.6667e-07,  ..., 1.0126e-06,
          6.6375e-06, 1.3566e-05],
         [7.7184e-05, 4.3417e-05, 7.7471e-06,  ..., 2.4839e-04,
          2.0096e-04, 5.1030e-05],
         ...,
         [2.0518e-06, 8.0364e-08, 2.0074e-07,  ..., 2.9632e-06,
          4.6812e-06, 2.8332e-08],
         [3.3753e-07, 3.5399e-07, 8.0364e-08,  ..., 5.1727e-06,
          5.2026e-07, 3.8973e-06],
         [2.8112e-06, 6.5969e-07, 1.0229e-06,  ..., 1.7764e-06,
          2.4941e-06, 3.2395e-06]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[1.9322e-03, 2.3343e-03, 1.6808e-03,  ..., 3.1698e-03,
          1.6275e-03, 2.0733e-03],
         [3.3638e-03, 2.3575e-03, 3.1261e-03,  ..., 3.3135e-03,
          3.9059e-03, 2.7265e-03],
         [6.8758e-04, 2.5641e-04, 1.6470e-03,  ..., 8.7340e-04,
          1.4481e-03, 6.7233e-04],
         ...,
         [9.9010e-05, 4.0829e-04, 0.0000e+00,  ..., 2.6676e-04,
          1.0101e-04, 4.1967e-04],
         [8.1658e-04, 4.0829e-04, 9.7068e-05,  ..., 1.1311e-03,
          3.2474e-04, 3.2545e-04],
         [8.1658e-04, 8.9497e-04, 8.4281e-04,  ..., 4.0829e-04,
          5.8336e-04, 6.8010e-04]],

        [[9.0859e-04, 4.4393e-04, 6.2138e-04,  ..., 1.1563e-03,
          1.1098e-03, 2.0121e-04],
         [1.1100e-03, 1.0354e-03, 4.4393e-04,  ..., 8.0024e-04,
          2.9189e-03, 1.2474e-03],
         [6.5245e-04, 6.7040e-04, 1.0354e-03,  ..., 4.5924e-04,
          3.2577e-04, 6.2245e-04],
         ...,
         [0.0000e+00, 3.1826e-04, 4.1967e-04,  ..., 6.8027e-04,
          1.4002e-04, 6.1007e-04],
         [9.7068e-05, 1.0580e-03, 3.2116e-04,  ..., 1.0323e-04,
          4.0829e-04, 2.3322e-04],
         [4.7709e-04, 3.2116e-04, 8.4281e-04,  ..., 1.1643e-03,
          1.2898e-03, 7.9931e-04]],

        [[1.7751e-03, 6.6451e-04, 7.4197e-04,  ..., 2.0989e-03,
          1.0687e-03, 8.3171e-04],
         [2.0915e-03, 1.1100e-03, 2.9931e-04,  ..., 1.5381e-03,
          1.0006e-03, 1.3183e-03],
         [6.4815e-04, 6.5245e-04, 9.4928e-04,  ..., 8.2908e-04,
          7.6837e-04, 4.6001e-04],
         ...,
         [3.1826e-04, 1.4435e-03, 1.4247e-03,  ..., 7.7768e-04,
          1.1418e-03, 1.0520e-04],
         [2.0215e-03, 1.0580e-03, 8.4526e-04,  ..., 1.4915e-03,
          1.0131e-03, 1.2524e-03],
         [3.0165e-04, 8.4526e-04, 4.4340e-04,  ..., 6.7023e-04,
          7.2815e-04, 9.3246e-04]],

        ...,

        [[4.4262e-04, 1.9562e-04, 1.2345e-03,  ..., 9.6886e-04,
          4.3987e-04, 1.9592e-04],
         [5.5726e-04, 4.4015e-04, 2.7692e-04,  ..., 7.1190e-04,
          9.7163e-03, 9.7899e-03],
         [1.1392e-03, 4.3504e-04, 6.0844e-04,  ..., 5.6153e-04,
          1.3726e-02, 1.1073e-02],
         ...,
         [2.6382e-04, 1.1893e-04, 1.2923e-03,  ..., 1.5958e-03,
          3.0444e-03, 1.1574e-03],
         [2.6591e-04, 1.1893e-04, 1.4145e-03,  ..., 2.0130e-03,
          1.7634e-03, 5.8121e-04],
         [2.6591e-04, 3.9858e-04, 1.9996e-03,  ..., 2.4182e-03,
          1.8245e-03, 1.2609e-03]],

        [[1.6588e-03, 1.2345e-03, 6.0541e-04,  ..., 7.0436e-04,
          9.9547e-03, 2.4975e-03],
         [9.9077e-04, 2.7692e-04, 1.8476e-04,  ..., 7.0254e-04,
          1.9116e-03, 1.0741e-02],
         [6.0844e-04, 9.4306e-03, 4.2779e-04,  ..., 2.2079e-03,
          7.5111e-03, 3.8355e-03],
         ...,
         [7.6333e-04, 3.3018e-04, 1.2923e-03,  ..., 3.0159e-04,
          9.5161e-04, 1.2731e-03],
         [4.5480e-04, 3.3018e-04, 1.4175e-03,  ..., 1.4518e-04,
          1.4592e-03, 1.9264e-03],
         [4.5480e-04, 5.9926e-04, 1.9996e-03,  ..., 4.8397e-04,
          2.0469e-03, 1.6342e-03]],

        [[1.6588e-03, 1.5466e-03, 5.1885e-04,  ..., 7.9408e-04,
          1.7099e-03, 9.3702e-04],
         [1.0392e-03, 1.8476e-04, 2.3841e-03,  ..., 5.6153e-04,
          5.1530e-03, 4.1035e-03],
         [9.4306e-03, 8.0799e-03, 9.6688e-03,  ..., 9.6396e-03,
          9.6046e-03, 1.1736e-02],
         ...,
         [1.2875e-03, 8.7857e-04, 7.4686e-04,  ..., 2.0130e-03,
          1.6243e-03, 2.1893e-03],
         [1.3957e-03, 8.7857e-04, 5.2322e-04,  ..., 1.2609e-03,
          8.2593e-04, 1.1344e-03],
         [1.3957e-03, 2.4663e-03, 1.9139e-03,  ..., 1.2863e-03,
          6.0875e-04, 1.4814e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:1833.916015625


loss.item(): 45847.8984375


Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([59, 98]) torch.Size([59, 98, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  1.7038e-01,  8.0033e-01, -5.8254e-02, -1.1397e-01,
          7.3834e-01,  5.1148e-01,  9.2486e+00, -7.0958e+00,  3.8287e+00],
        [ 2.2022e+00,  1.2639e+01,  1.3785e+01,  1.6572e+01,  1.5803e+01,
         -3.6704e+00,  3.4025e+01, -9.3627e-01,  1.1260e+01, -6.7341e+01],
        [ 4.8088e+00, -2.2557e+01,  2.0771e+01, -5.1531e+00,  4.1560e+01,
          5.3618e+01,  1.2768e+01,  1.8730e+02,  5.7650e+01,  8.6304e+00],
        [ 6.4409e+01, -4.9389e+01, -9.5095e+01, -1.3839e+01,  1.9020e+02,
          2.8562e+02, -3.4490e+02,  3.0387e+02, -7.7783e+02,  5.5295e+02],
        [ 3.3527e+01, -5.0005e+01,  4.1496e+01,  2.3402e+02,  3.9418e+02,
          4.7917e+02,  5.3011e+02,  8.5850e+02,  8.4678e+01, -3.2010e+02],
        [-2.7776e+01, -5.3635e+00,  3.3225e+02,  1.7238e+02,  4.2313e+02,
          6.9462e+02,  5.5254e+02,  1.5250e+03,  6.4047e+02,  3.7285e+02],
        [ 6.6932e-01,  2.4739e+02,  3.4652e+02,  4.3317e+02,  1.8202e+03,
         -7.5647e+02,  6.5427e+02,  1.0183e+03, -1.2147e+03,  1.6458e+03],
        [-5.2614e+01,  2.2009e+02,  7.1599e+02,  7.3333e+02,  1.7796e+02,
         -1.1553e+04, -6.4731e+02,  1.2216e+03,  3.6399e+02, -5.6348e+02],
        [-5.3838e+01,  1.5025e+02,  6.1071e+02,  1.0491e+03,  3.1955e+02,
          2.7240e+02, -1.2360e+04,  1.0389e+03, -5.2620e+02, -1.4255e+04]]) 

MatU.grad[0:10,35:45]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-8.2831e+01,  5.6448e+01],
         [ 1.4193e+02, -1.4931e+02],
         [ 1.4800e+02, -1.9275e+01],
         [-3.2917e+02,  1.6022e+01],
         [ 1.2109e+02, -1.0750e+02],
         [ 1.1440e+02,  4.7837e+02],
         [ 9.0619e+01, -1.8819e+01]],

        [[ 9.0625e+02,  5.6879e+02],
         [ 4.4712e+02, -1.4769e+02],
         [-6.4384e+02, -7.2669e+02],
         [-9.5436e+02,  3.9214e+01],
         [ 4.5448e+02,  3.5576e+02],
         [ 4.0119e+02, -2.8817e+02],
         [-5.3240e+02, -5.1192e+02],
         [ 7.7806e+02, -2.4005e+02],
         [-9.5451e+02, -5.3447e+02],
         [ 3.6788e+02,  1.0424e+03]],

        [[ 6.3160e+02,  1.1390e+03],
         [-2.9490e+02, -5.4724e+01],
         [ 6.7659e+02, -1.5159e+03],
         [-1.3253e+03,  1.6542e+02],
         [-3.0885e+02,  6.7470e+02],
         [ 2.8193e+02, -4.6330e+02],
         [-7.7840e+02, -1.5023e+02],
         [ 7.0937e+02, -4.9565e+02],
         [ 8.1219e+02, -6.7381e+00],
         [-1.4908e+03, -5.2199e+02]],

        [[-1.2947e+03, -3.5405e+03],
         [-4.9965e+03,  2.7337e+03],
         [ 7.2001e+03,  2.0305e+03],
         [ 1.1486e+02, -9.5005e+02],
         [-1.4453e+03,  2.1896e+01],
         [ 6.2117e+02,  1.7933e+03],
         [-1.2591e+03, -8.2424e+02],
         [ 2.2780e+03,  4.5952e+02],
         [-1.2901e+03,  3.8561e+03],
         [-3.1327e+03, -4.9830e+03]],

        [[ 4.3748e+03,  2.0923e+03],
         [-3.8306e+03, -2.0227e+03],
         [ 2.9120e+03, -1.1623e+02],
         [ 8.2333e+02, -1.7097e+03],
         [ 1.2014e+03, -1.8936e+02],
         [-3.6324e+01,  1.0610e+03],
         [-4.3361e+02,  4.3168e+02],
         [ 5.2407e+02, -3.9265e+01],
         [-1.2717e+03, -3.8701e+02],
         [ 4.0003e+02,  2.3316e+03]],

        [[ 1.1053e+03, -2.2333e+03],
         [-4.0089e+03,  4.3799e+03],
         [-7.6537e+03, -4.0111e+03],
         [ 1.7475e+03,  1.4543e+03],
         [ 1.0909e+03, -1.1430e+02],
         [-4.0847e+02, -5.8060e+02],
         [ 6.4076e+01,  9.6724e+02],
         [ 2.7703e+02, -1.8338e-01],
         [ 4.4809e+02, -2.9578e+02],
         [-4.2187e+02,  1.6300e+03]],

        [[ 6.6826e+03, -2.1612e+03],
         [-9.7318e+03, -3.0044e+03],
         [ 2.7659e+03,  6.5463e+03],
         [-1.4165e+03, -4.0784e+01],
         [ 3.6548e+02, -5.2163e+02],
         [ 9.5325e+02,  1.3140e+01],
         [-6.0841e+02, -2.9237e+02],
         [ 3.7072e+02,  2.6457e+01],
         [ 7.8698e+02,  1.1190e+02],
         [-1.2629e+03, -1.5222e+03]]]) 

MatD.grad: 
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0230,  ..., 0.0000, 0.0000, 0.0000],
        ...,
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [   50.8999,  -102.7863],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [  -92.8863,   -96.4834],
         [  -89.5343,   -99.6054],
         [   73.2748,  -112.1241]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [  334.1001,  -125.0865],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [  109.4606,     0.0000],
         [  331.8907,   689.5707],
         [    0.0000,     0.0000],
         [-2021.2133,   725.4343],
         [ 1363.6840,  2023.6830],
         [ -256.9182,  2093.1848],
         [ 1649.0386,  2138.8901]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [  188.2302,   210.8251],
         [ -370.7094,  -806.8431],
         [   63.7762,   314.2718],
         [-1796.0066, -4227.5610],
         [   94.9596, -7733.3311],
         [ 2934.4360,   294.4337],
         [-4712.8535,  7456.6514]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [  869.1539,   295.7455],
         [-1212.7939,  -747.7189],
         [-5091.2930,  2750.6875],
         [ 8793.9326, -4329.8140],
         [ 7876.0342, -3876.2261],
         [-5932.3984, -7027.1670]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [  346.1440,   914.7792],
         [  145.3674,  1334.0370],
         [-9443.7324,  1299.1323],
         [ 6526.4912,  9620.0215],
         [ 8457.2578,  4021.6838],
         [   81.8119, -1482.4180]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[  7352.9150,  -2213.7229],
         [   255.8737,  -6148.7793],
         [ -4801.1436,  -7288.8306],
         [ -8052.5669,  -3798.8198],
         [  1239.8601,   3574.9031],
         [  7898.4541,   8390.9609],
         [ -1197.3308, -10368.9307],
         [  1096.7415,   1384.4912],
         [  7258.5205,   -772.8075],
         [ -7864.3369,  -5959.7490]],

        [[    63.8051,   4659.2427],
         [   -78.8684,  -7320.1836],
         [ -1602.4006,  -2127.2891],
         [ -1744.7147,  10432.5850],
         [  5684.9897,    455.3927],
         [ -6382.7783,  -8840.0068],
         [  9844.2744,  -1126.6528],
         [ -2535.4116,    718.6708],
         [ -1030.4109,    200.3082],
         [  5399.5322,  -8896.7051]],

        [[ -2432.1338, -10140.8037],
         [  1497.2988, -11663.1553],
         [  8014.2368,   1921.2006],
         [ -9187.0020,  -3051.4817],
         [ -4055.4277,   1070.5366],
         [  1120.4860,    257.6597],
         [  9533.2236,   4162.0889],
         [ -2591.3408,  -5031.7329],
         [-10244.5830,   2095.7344],
         [  3021.8359,  10773.0459]],

        [[ -5155.4536,   9679.6367],
         [ 11161.5566,   1922.0377],
         [  3083.9275,   4193.6958],
         [ -6275.7778,   1339.4850],
         [ -4090.3069,   1083.0054],
         [  4071.5757,  10918.7598],
         [  2087.0625,   1607.0916],
         [  1838.6868,   7455.0254],
         [  4482.4883,   1391.6036],
         [ -3353.7585,  -7645.6870]],

        [[-10690.8838,   2188.0720],
         [  8392.0479,   8216.2480],
         [  -321.8672,  -4552.8701],
         [ -5919.1494,   1958.4813],
         [  9067.1152,  -3249.2712],
         [ -4829.6572,  -9984.4453],
         [  8299.8789,   1943.4769],
         [ -1667.3090,  -5704.0728],
         [ -8235.8291,  -3912.8523],
         [  8835.0254,  -4540.5728]],

        [[ -1808.7563,  -9551.5059],
         [  -869.0338,   5211.4072],
         [  3241.0503,  -1939.5416],
         [ -8181.4990,  -1719.3425],
         [ -1087.6772,   7083.9351],
         [  7141.1450,  -2083.9021],
         [  2514.5649,   2425.2766],
         [ -1566.6538,  -3402.6306],
         [ -7487.5654,  -1859.3147],
         [  -224.7453,   3283.1677]],

        [[  8366.1328,   7061.7944],
         [ -2533.8984, -11459.0996],
         [  2888.0171,  -7304.9854],
         [ -1918.4309,  -2477.7664],
         [ -7245.4634,    110.8578],
         [  6411.6064,  -9058.2373],
         [ -1064.2748,   2696.4287],
         [ -1007.9014,  -2020.2407],
         [ -2324.9436,  10353.0439],
         [    15.3551,   3007.1880]],

        [[-11054.9043,   1338.5236],
         [  4411.8945,   9601.4717],
         [  6455.7378,   4936.0547],
         [   348.4695,   4766.6226],
         [-10737.8906,   -467.2135],
         [  8571.6562,   7274.5806],
         [ -5214.5103,  -1510.1151],
         [  7800.8999,  -6005.5786],
         [ -8700.2910,  -7709.4761],
         [  7490.6528,   -500.7440]],

        [[   197.1960,  -9565.5811],
         [ -2940.0276,   4541.6289],
         [  3263.4177,   -694.3085],
         [ -1947.0231, -10852.4756],
         [   821.0223,  -6978.1172],
         [  1138.0286,   1241.5372],
         [ -5648.9595,   2167.9756],
         [  4943.5493,   4418.8896],
         [ -1096.0343,  -9101.9199],
         [  4795.6567,  -2341.6035]],

        [[  9734.2080,   6507.7354],
         [ -4782.9238,  -2354.3906],
         [ -7985.4697,  -5765.8999],
         [  3114.5039,   7735.2246],
         [  2379.1973,   8941.5918],
         [   401.1013,  -9412.6133],
         [ -1197.6830,  -3397.5281],
         [ -1583.9839,   8994.9385],
         [  1179.7516,   6819.2866],
         [  4645.4814,   -589.2826]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[  7551.7632,   -600.5342],
         [ -9369.8848,  -1066.5881],
         [ -1317.6010,  -1387.1179],
         [ 10362.7861,   -764.5325],
         [-10258.1348,  -5466.6714],
         [ 12687.4727,    118.9922],
         [ -4347.3413,  -9121.0635],
         [ -7648.9565,  -6003.0483],
         [  5564.3623,  -1564.6608],
         [ -1322.3329,   3147.6580]],

        [[  4883.0156,  -4343.7842],
         [ -8597.5791,   4764.8145],
         [   100.5884,    532.4758],
         [  6389.9336,    912.6901],
         [ -7103.5527,   2219.5354],
         [  7839.2515,    664.8878],
         [ -3219.3845,  -6570.1079],
         [ -1191.7167,   8945.0195],
         [  7325.6284,   2119.8843],
         [ -2555.2427,  -5713.6812]],

        [[  7019.1001,   3345.9937],
         [ -9370.6982,  -3197.2163],
         [  1153.5114,    454.5039],
         [  7235.7261,    687.7620],
         [ -4830.0605,  -3403.1213],
         [   191.4811,   1868.8196],
         [  9014.8398,  -1840.4661],
         [ -1034.0583,  -1332.7482],
         [  -404.8094,   -274.5995],
         [  -253.6945,    641.3483]],

        [[  2145.5000,  -2910.7300],
         [ -6454.6182,    181.6546],
         [  2124.6746,   6531.0010],
         [  2354.2986,  -8460.0645],
         [   666.1816,  -9337.0186],
         [ -3976.7346,   4911.1367],
         [   309.2483,  -3057.2075],
         [    29.0333,  -1614.2257],
         [   139.7841,  -1376.1711],
         [  -151.9134,    788.1209]],

        [[  4106.0298,   -510.7851],
         [ -3487.0181,   6076.4326],
         [ -7893.0225,  -2178.9106],
         [ -1100.3704,   5683.1055],
         [  7804.5308,   8213.0410],
         [-10584.2021,  -1391.8070],
         [   746.7224,   2530.7100],
         [  -389.4469,    -19.4912],
         [   706.6669,    738.9536],
         [  -723.3167,   -519.3643]],

        [[  7244.2788,   2909.9614],
         [ -9382.2764,  -3978.8318],
         [ -2784.5098,    728.0964],
         [  9925.1475,   -275.6890],
         [ -8063.6816,  -1637.9614],
         [  5429.7051,   2046.3083],
         [ -1936.6699,    -54.1427],
         [  1181.3179,    -54.1318],
         [  -505.2237,   -666.5934],
         [  -590.3873,    171.9217]],

        [[  3121.1719,  -3541.0913],
         [ -4241.1382,  -3559.5073],
         [  -738.8192,  -5651.2168],
         [  6654.2700,  -5605.0093],
         [ -2428.2756,  -8233.2686],
         [  2330.2996,    985.5867],
         [  -197.0592,  -1971.8638],
         [    29.1669,   -817.6982],
         [   344.5836,   -775.6718],
         [  -257.4649,   -461.1807]],

        [[  4485.4053,   -687.3188],
         [ -2640.5894,   5448.1753],
         [ -1751.4169,   -304.2841],
         [  -233.4646,    110.4942],
         [  5870.2988,   6756.7607],
         [-10028.6670,    240.3442],
         [   612.2065,   2220.1777],
         [  -635.7777,    -98.1996],
         [  1936.8088,   1134.0980],
         [ -1825.9153,   -139.5412]],

        [[  9081.9072,  -1350.5651],
         [ -5957.3491,  -4495.9404],
         [ -1573.6827,   2331.6819],
         [  5042.5352,   1452.2856],
         [ -1771.6554,   2575.2031],
         [  5374.2974,   2651.9355],
         [ -8242.4336,   3485.8418],
         [  5209.1699,   8940.3164],
         [   316.1834,   6778.1460],
         [    54.3742,   1133.8662]],

        [[  4037.9814,   9790.4707],
         [  -684.1871,   6923.3643],
         [   673.1184,   9793.3398],
         [  2684.4397,  -8061.5767],
         [  1511.8110,  -7592.7939],
         [  4482.7222,  -8884.7822],
         [  3122.6375, -10121.2656],
         [  1048.1263,  -6602.5957],
         [ -3134.6812, -10359.0488],
         [  2769.2378,  -9283.4902]]]) 

Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0144,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]],
       grad_fn=<SelectBackward>)

Epoch 0 finished. Total time: 321.4977900981903;  Epoch time: 321.4977900981903 












test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.4319, 0.4172, 0.4122,  ..., 0.2686, 0.2675, 0.2631],
         [0.4325, 0.4171, 0.4126,  ..., 0.2678, 0.2637, 0.2593],
         [0.4326, 0.4172, 0.4130,  ..., 0.2686, 0.2678, 0.2633],
         ...,
         [0.9453, 0.9453, 0.9452,  ..., 0.7560, 0.7559, 0.7558],
         [0.9454, 0.9453, 0.9450,  ..., 0.7562, 0.7554, 0.7552],
         [0.9454, 0.9448, 0.9447,  ..., 0.7552, 0.7541, 0.7541]],

        [[0.9441, 0.9441, 0.9435,  ..., 0.6046, 0.6041, 0.5721],
         [0.9448, 0.9441, 0.9441,  ..., 0.5725, 0.5722, 0.5721],
         [0.9449, 0.9441, 0.9441,  ..., 0.6044, 0.6042, 0.5725],
         ...,
         [0.9453, 0.9453, 0.9453,  ..., 0.7564, 0.7560, 0.7557],
         [0.9454, 0.9453, 0.9451,  ..., 0.7565, 0.7562, 0.7562],
         [0.9454, 0.9450, 0.9447,  ..., 0.7561, 0.7555, 0.7553]],

        [[0.9442, 0.9441, 0.9441,  ..., 0.6391, 0.6390, 0.6385],
         [0.9449, 0.9448, 0.9442,  ..., 0.6396, 0.6391, 0.6056],
         [0.9450, 0.9449, 0.9442,  ..., 0.6400, 0.6398, 0.6393],
         ...,
         [0.9454, 0.9454, 0.9453,  ..., 0.7565, 0.7564, 0.7559],
         [0.9454, 0.9454, 0.9452,  ..., 0.7565, 0.7565, 0.7563],
         [0.9454, 0.9450, 0.9449,  ..., 0.7563, 0.7561, 0.7557]],

        ...,

        [[0.9453, 0.9444, 0.9438,  ..., 0.7554, 0.7403, 0.7400],
         [0.9352, 0.9346, 0.9310,  ..., 0.7480, 0.7337, 0.7185],
         [0.9340, 0.9242, 0.9231,  ..., 0.7372, 0.7096, 0.7073],
         ...,
         [0.9456, 0.9456, 0.9456,  ..., 0.7567, 0.7567, 0.7565],
         [0.9454, 0.9454, 0.9453,  ..., 0.7560, 0.7559, 0.7557],
         [0.9454, 0.9449, 0.9448,  ..., 0.7554, 0.7550, 0.7545]],

        [[0.9438, 0.9436, 0.9435,  ..., 0.7479, 0.7347, 0.7337],
         [0.9342, 0.9310, 0.9303,  ..., 0.7439, 0.7268, 0.7128],
         [0.9231, 0.9225, 0.9222,  ..., 0.7356, 0.7044, 0.7007],
         ...,
         [0.9456, 0.9455, 0.9454,  ..., 0.7562, 0.7538, 0.7538],
         [0.9454, 0.9454, 0.9452,  ..., 0.7554, 0.7536, 0.7532],
         [0.9454, 0.9448, 0.9445,  ..., 0.7545, 0.7540, 0.7539]],

        [[0.9436, 0.9424, 0.9419,  ..., 0.7429, 0.7293, 0.7221],
         [0.9312, 0.9303, 0.9279,  ..., 0.7372, 0.7231, 0.7007],
         [0.9225, 0.9203, 0.9194,  ..., 0.7290, 0.7173, 0.6926],
         ...,
         [0.9454, 0.9453, 0.9452,  ..., 0.7542, 0.7517, 0.7513],
         [0.9452, 0.9452, 0.9446,  ..., 0.7542, 0.7520, 0.7517],
         [0.9452, 0.9445, 0.9436,  ..., 0.7537, 0.7532, 0.7532]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[2.3952e-06, 2.6487e-06, 6.0901e-06,  ..., 1.1119e-05,
          1.8513e-05, 5.3276e-06],
         [8.4671e-07, 1.6646e-07, 6.0901e-06,  ..., 6.2834e-07,
          4.9123e-05, 4.9016e-05],
         [4.5402e-09, 6.3606e-08, 2.1672e-08,  ..., 1.3500e-06,
          4.4491e-06, 1.2817e-06],
         ...,
         [2.5000e-07, 2.5000e-07, 2.5000e-07,  ..., 8.9988e-08,
          2.2500e-06, 3.5881e-07],
         [8.4111e-09, 2.5000e-07, 8.4111e-09,  ..., 1.3636e-06,
          5.7758e-07, 1.7271e-07],
         [8.4111e-09, 8.4110e-09, 8.4111e-09,  ..., 3.9169e-07,
          2.8339e-06, 4.8360e-06]],

        [[1.4732e-08, 1.4732e-08, 7.7198e-07,  ..., 4.0434e-07,
          1.0876e-06, 1.9006e-06],
         [7.4670e-08, 2.5730e-07, 5.2815e-07,  ..., 1.2570e-06,
          5.5168e-06, 4.2364e-06],
         [1.6612e-09, 5.1767e-07, 9.2015e-07,  ..., 5.1767e-07,
          1.0238e-05, 3.5667e-07],
         ...,
         [2.5000e-07, 2.5000e-07, 2.2500e-06,  ..., 3.5881e-07,
          4.3753e-06, 1.6079e-07],
         [9.8932e-07, 1.6235e-07, 2.8689e-11,  ..., 5.1001e-07,
          1.3878e-06, 3.6008e-06],
         [4.6707e-07, 5.6315e-08, 2.9234e-08,  ..., 3.1307e-07,
          9.4817e-11, 4.4047e-07]],

        [[7.5837e-09, 7.5837e-09, 6.9961e-08,  ..., 9.8151e-07,
          5.7581e-07, 1.2555e-06],
         [1.6065e-06, 5.3875e-07, 7.1544e-08,  ..., 2.3339e-06,
          6.5398e-09, 2.5381e-06],
         [1.4337e-08, 2.0039e-07, 7.7486e-07,  ..., 4.9274e-06,
          3.7305e-08, 1.8421e-07],
         ...,
         [9.9681e-09, 1.2096e-06, 1.9682e-06,  ..., 2.5887e-06,
          7.9001e-08, 1.0183e-06],
         [4.9750e-07, 2.2837e-06, 4.9750e-07,  ..., 2.6227e-06,
          4.7919e-07, 4.1988e-07],
         [1.3766e-08, 4.7408e-07, 1.7199e-06,  ..., 1.6690e-07,
          1.0485e-06, 3.0332e-08]],

        ...,

        [[2.4467e-07, 1.0645e-08, 8.9277e-08,  ..., 8.9277e-08,
          1.1830e-08, 4.6176e-07],
         [1.7014e-06, 2.5562e-07, 9.2649e-08,  ..., 1.7160e-06,
          1.2294e-06, 2.8570e-06],
         [2.4467e-07, 2.5539e-07, 1.3024e-08,  ..., 1.7301e-06,
          2.0193e-06, 1.1376e-04],
         ...,
         [3.8680e-07, 3.2289e-09, 1.1221e-06,  ..., 3.3417e-06,
          3.7702e-06, 2.0111e-06],
         [8.2791e-07, 1.0492e-06, 2.5000e-07,  ..., 5.6185e-08,
          7.1750e-06, 8.8154e-06],
         [1.1169e-06, 1.5426e-07, 7.7537e-08,  ..., 8.8019e-09,
          3.7463e-07, 8.6863e-06]],

        [[8.1355e-07, 1.1470e-06, 7.4093e-08,  ..., 1.9924e-07,
          1.9714e-09, 1.4006e-08],
         [9.5228e-09, 1.3024e-08, 7.5837e-09,  ..., 5.0653e-07,
          1.3342e-05, 1.1352e-04],
         [4.7646e-07, 1.3024e-08, 7.3850e-08,  ..., 1.0240e-07,
          2.0873e-07, 2.1135e-05],
         ...,
         [7.9856e-09, 2.5364e-07, 6.3599e-07,  ..., 1.1764e-06,
          1.4548e-06, 5.7222e-07],
         [1.2466e-07, 4.1852e-07, 5.8212e-07,  ..., 4.2323e-07,
          8.5129e-07, 1.7314e-06],
         [5.9822e-09, 1.1169e-06, 1.1440e-06,  ..., 1.7108e-06,
          1.4887e-06, 1.5118e-06]],

        [[1.0908e-06, 4.1215e-07, 8.9277e-08,  ..., 9.9433e-08,
          1.3238e-07, 1.3980e-05],
         [1.1346e-06, 9.5228e-09, 8.4186e-09,  ..., 2.4376e-07,
          4.3111e-06, 2.6866e-05],
         [6.8648e-05, 2.5899e-05, 5.2138e-06,  ..., 2.3288e-04,
          1.3633e-04, 2.1562e-05],
         ...,
         [4.5699e-09, 2.6994e-09, 4.6878e-08,  ..., 5.9544e-07,
          4.4037e-07, 1.1001e-07],
         [8.4461e-07, 9.0200e-09, 4.6878e-08,  ..., 4.0268e-07,
          4.8971e-08, 2.2483e-07],
         [3.1214e-08, 2.3874e-07, 9.7478e-08,  ..., 2.0219e-06,
          2.7946e-08, 1.6897e-06]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[1.6280e-03, 9.4871e-04, 7.5517e-04,  ..., 2.2634e-03,
          6.2749e-04, 1.0734e-03],
         [2.4910e-03, 2.3575e-03, 1.7831e-03,  ..., 2.5434e-03,
          2.5473e-03, 1.7964e-03],
         [9.8405e-04, 2.5641e-04, 1.1806e-03,  ..., 9.7499e-04,
          9.1728e-04, 1.3661e-03],
         ...,
         [5.9171e-04, 0.0000e+00, 1.3473e-03,  ..., 1.3447e-03,
          1.1706e-03, 5.0000e-04],
         [1.8342e-04, 5.9171e-04, 9.0293e-04,  ..., 6.0903e-04,
          2.9559e-04, 3.2474e-04],
         [1.8342e-04, 8.9497e-04, 6.4740e-04,  ..., 6.4552e-04,
          6.5664e-04, 8.3090e-04]],

        [[8.7069e-04, 4.2471e-04, 1.0693e-03,  ..., 5.5840e-04,
          1.0978e-04, 2.0121e-04],
         [1.1100e-03, 8.7069e-04, 2.3986e-04,  ..., 8.0024e-04,
          3.2024e-04, 7.2131e-04],
         [7.4864e-04, 2.3986e-04, 7.2867e-04,  ..., 4.5924e-04,
          3.2577e-04, 7.9286e-04],
         ...,
         [1.0795e-03, 0.0000e+00, 3.1826e-04,  ..., 1.1353e-03,
          6.1007e-04, 1.4211e-03],
         [3.2116e-04, 1.0795e-03, 1.0580e-03,  ..., 4.0829e-04,
          9.0361e-04, 7.1030e-04],
         [3.2116e-04, 8.9351e-04, 6.4740e-04,  ..., 3.0991e-04,
          5.5571e-04, 1.8329e-04]],

        [[6.6475e-04, 7.4197e-04, 4.2471e-04,  ..., 1.6948e-04,
          8.9783e-05, 1.6520e-03],
         [1.0941e-03, 1.1100e-03, 2.9931e-04,  ..., 6.9705e-04,
          1.0006e-03, 6.1417e-04],
         [3.5862e-04, 7.4864e-04, 7.6504e-05,  ..., 8.2908e-04,
          7.6837e-04, 4.6001e-04],
         ...,
         [1.4435e-03, 9.0478e-04, 3.1826e-04,  ..., 1.0840e-03,
          8.1616e-04, 1.0055e-03],
         [1.1516e-03, 9.0478e-04, 1.1805e-03,  ..., 1.2957e-03,
          5.0635e-04, 1.0535e-03],
         [1.1516e-03, 7.8684e-04, 7.2096e-04,  ..., 1.9741e-04,
          9.0624e-04, 6.7023e-04]],

        ...,

        [[4.4262e-04, 8.0438e-04, 6.2641e-04,  ..., 4.6965e-04,
          6.3233e-04, 8.0446e-04],
         [8.5698e-04, 4.4015e-04, 8.2114e-04,  ..., 8.3755e-04,
          8.5152e-03, 8.6304e-03],
         [6.2385e-04, 6.3780e-04, 9.0923e-04,  ..., 8.5268e-04,
          1.3726e-02, 1.0185e-02],
         ...,
         [7.1872e-04, 2.9368e-04, 1.0366e-03,  ..., 1.2435e-03,
          1.2923e-03, 1.1574e-03],
         [7.9212e-04, 8.8621e-04, 4.2556e-04,  ..., 8.9162e-04,
          8.4191e-04, 1.1196e-03],
         [7.9212e-04, 8.6275e-04, 1.2572e-03,  ..., 1.4252e-03,
          1.1869e-03, 9.5703e-04]],

        [[6.2641e-04, 3.4422e-04, 9.8189e-04,  ..., 8.3814e-04,
          8.6972e-03, 1.5771e-03],
         [1.8657e-04, 8.2114e-04, 1.8476e-04,  ..., 7.4003e-04,
          1.2041e-03, 1.0287e-02],
         [9.0923e-04, 8.4613e-03, 4.2779e-04,  ..., 1.3248e-03,
          7.5111e-03, 3.0856e-03],
         ...,
         [2.9368e-04, 9.9747e-04, 7.2201e-04,  ..., 3.6456e-04,
          1.6795e-04, 6.0034e-04],
         [4.5480e-04, 7.2201e-04, 4.3543e-04,  ..., 9.4594e-04,
          5.8565e-04, 1.0440e-03],
         [4.5480e-04, 1.2572e-03, 1.0079e-03,  ..., 9.5858e-04,
          9.1350e-04, 1.1591e-03]],

        [[3.4422e-04, 4.1503e-04, 7.2776e-04,  ..., 2.9353e-04,
          1.4019e-03, 8.5792e-04],
         [3.6492e-04, 1.8476e-04, 1.5874e-03,  ..., 8.5268e-04,
          4.3380e-03, 3.3537e-03],
         [8.4613e-03, 7.8179e-03, 8.7029e-03,  ..., 9.3801e-03,
          8.7088e-03, 1.0507e-02],
         ...,
         [5.9975e-04, 7.4686e-04, 1.2234e-04,  ..., 1.3683e-03,
          7.5604e-04, 9.7089e-04],
         [1.1041e-03, 1.2234e-04, 9.0441e-04,  ..., 1.1954e-03,
          7.3905e-04, 1.1700e-03],
         [1.1041e-03, 1.0079e-03, 1.6291e-03,  ..., 8.3532e-04,
          2.5684e-04, 6.0495e-04]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:2.5939998626708984 loss2:1670.7940673828125


loss.item(): 41772.4453125


Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([59, 98]) torch.Size([59, 98, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 2.7622e-01, -1.5906e-01,  6.0895e-01,  7.7537e-01, -3.1328e-01,
          1.6738e-01,  8.3809e-02,  8.8004e+00, -7.5816e+00,  3.6760e+00],
        [ 2.2068e+00,  1.1488e+01,  1.1945e+01,  1.5342e+01,  1.5799e+01,
         -1.2252e+01,  3.3552e+01, -1.4139e+01,  1.4843e+01, -7.2787e+01],
        [ 7.1660e+00, -2.7447e+01,  2.1476e+01, -2.5725e+01,  3.8524e+01,
          5.3885e+01,  1.2963e+01,  1.7742e+02,  6.4822e+01,  1.3972e+01],
        [ 6.1752e+01, -5.5755e+01, -1.0664e+02, -4.4097e+01,  1.7180e+02,
          2.8126e+02, -3.7619e+02,  2.9955e+02, -7.8609e+02,  5.3224e+02],
        [ 4.4748e+01, -7.1849e+01,  4.5606e+01,  2.4635e+02,  3.7878e+02,
          4.5601e+02,  5.2775e+02,  8.2971e+02,  1.2106e+02, -3.6141e+02],
        [-4.1665e+01, -1.5462e+01,  3.1682e+02,  1.9635e+02,  4.4934e+02,
          6.6312e+02,  5.3339e+02,  1.4594e+03,  6.7427e+02,  4.0452e+02],
        [-1.7104e-01,  1.6994e+02,  3.2558e+02,  4.4095e+02,  1.7775e+03,
         -8.1873e+02,  5.8073e+02,  9.8786e+02, -1.2638e+03,  1.5767e+03],
        [-8.8782e+01,  2.2492e+02,  6.0539e+02,  7.0560e+02,  1.8823e+02,
         -1.0881e+04, -7.3662e+02,  1.1201e+03,  4.6017e+02, -6.1866e+02],
        [-9.4875e+01,  1.6870e+02,  5.9356e+02,  1.0120e+03,  3.2011e+02,
          2.7308e+02, -1.1691e+04,  1.0239e+03, -6.4416e+02, -1.3244e+04]]) 

MatU.grad[0:10,35:45]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-2.3887e+01,  2.2226e+02],
         [-9.5052e+01,  2.3037e+01],
         [ 1.4104e+02, -1.3773e+02],
         [ 1.1624e+02,  2.5661e+01],
         [-3.1138e+02,  9.5338e+00],
         [ 1.1786e+02, -7.6463e+01],
         [ 2.4779e+01,  4.8925e+02],
         [ 1.3453e+01,  2.5265e+01]],

        [[ 9.1227e+02,  5.5799e+02],
         [ 1.2926e+02,  3.2878e+02],
         [-6.2904e+02, -7.2748e+02],
         [-9.4485e+02, -3.8406e+00],
         [ 4.5673e+02,  3.3337e+02],
         [ 3.8104e+02, -2.2774e+02],
         [-5.4242e+02, -4.6878e+02],
         [ 7.8412e+02, -1.9295e+02],
         [-9.4386e+02, -5.1535e+02],
         [ 2.8183e+02,  1.0574e+03]],

        [[ 4.4716e+02,  7.7447e+02],
         [ 2.7014e+02,  5.8203e+02],
         [-2.7909e+01, -1.5509e+03],
         [-1.3122e+03, -3.8227e+02],
         [ 1.2039e+02,  6.8672e+02],
         [ 2.4440e+02, -4.1052e+02],
         [-7.8566e+02, -5.9416e+01],
         [ 8.4567e+02, -4.5438e+02],
         [ 8.2020e+02,  6.7936e+01],
         [-1.4838e+03, -4.8389e+02]],

        [[ 1.4249e+03, -2.7195e+03],
         [-4.6911e+03, -1.6098e+03],
         [ 7.3643e+03,  1.0304e+02],
         [-5.8810e+02, -7.5100e+02],
         [-1.4227e+03, -4.2532e+02],
         [ 4.8932e+02,  1.8268e+03],
         [-1.2437e+03, -8.0352e+02],
         [ 2.2439e+03,  9.4515e+01],
         [-9.2665e+02,  3.6853e+03],
         [-2.9684e+03, -5.0065e+03]],

        [[ 3.5892e+03, -2.2156e+03],
         [-3.1536e+03,  3.0611e+02],
         [-7.0164e+02,  5.9849e+03],
         [ 6.2101e+02, -1.7743e+03],
         [ 1.1801e+03, -1.2746e+02],
         [ 2.3352e+01,  1.0445e+03],
         [-3.2497e+02,  3.4921e+02],
         [ 5.0125e+02, -2.7806e+01],
         [-1.2379e+03, -3.5458e+02],
         [ 2.8839e+02,  2.3007e+03]],

        [[-2.6996e+03,  3.6470e+03],
         [ 1.1678e+03, -1.3817e+03],
         [-8.1903e+03, -8.2732e+02],
         [ 1.8353e+03,  1.1785e+03],
         [ 9.9549e+02, -1.0686e+01],
         [-3.9205e+02, -5.5635e+02],
         [-3.2918e+01,  9.4231e+02],
         [ 2.6304e+02,  5.7056e+00],
         [ 4.3820e+02, -2.5658e+02],
         [-3.4060e+02,  1.5388e+03]],

        [[ 4.6394e+03,  4.3783e+03],
         [-1.0220e+04, -3.9578e+02],
         [-1.9661e+03,  1.5143e+03],
         [-2.7081e+02,  1.5258e+03],
         [-1.6958e+02,  2.2294e+02],
         [ 9.7310e+02, -8.4411e+01],
         [-5.8308e+02, -2.7436e+02],
         [ 3.5666e+02,  9.6942e-02],
         [ 7.6235e+02,  1.1940e+02],
         [-1.2248e+03, -1.4805e+03]]]) 

MatD.grad: 
tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000, -0.9693,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-6.2810e+00, -1.1226e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-9.1539e+01, -9.3990e+01],
         [-8.2127e+01, -1.0235e+02],
         [-1.2983e+02, -1.9734e+01]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.3814e+02, -3.5063e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-5.9560e+01,  9.1660e+01],
         [ 4.2928e+01,  5.7625e+02],
         [ 0.0000e+00,  0.0000e+00],
         [-1.8372e+03,  2.5937e+02],
         [ 1.2612e+03,  2.0386e+03],
         [ 1.8885e+03,  5.8444e+02],
         [ 5.6035e+02,  1.0744e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.2647e+02,  2.9550e+01],
         [ 4.6493e+01, -8.2031e+02],
         [-1.3326e+03, -7.9570e+02],
         [ 4.2080e+03, -1.1428e+03],
         [-5.0808e+03, -4.8846e+03],
         [-2.7213e+03, -6.7752e+03],
         [ 5.2853e+03, -1.4295e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 5.0030e+02,  4.1011e+02],
         [-4.2579e+02,  4.2798e+02],
         [ 1.1565e+02, -2.8406e+03],
         [ 9.3007e+03, -4.9198e+02],
         [ 2.4959e+03,  3.1278e+03],
         [ 6.3642e+03,  4.2900e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-6.1821e+02,  6.9824e+02],
         [-1.6667e+03,  1.0302e+02],
         [-8.7663e+03, -2.7678e+03],
         [ 6.0041e+03,  9.9550e+03],
         [ 4.6973e+03, -5.7007e+03],
         [-6.2470e+03,  7.3891e+03]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[  -454.9642,   5103.5488],
         [ -8836.0693,   -556.5172],
         [  1862.6422,  -1571.2567],
         [ -4109.8345,   4660.1675],
         [ -8928.1680,  -5578.4268],
         [  2732.6177,   3865.3020],
         [  8531.2344,   1259.6055],
         [ -9434.9971,  -4522.8799],
         [ -5449.1655,   8465.8418],
         [  1302.3983,   4690.6982]],

        [[ -4360.4653,  -5284.3550],
         [  7901.9014,  -1954.1401],
         [  5438.1997,   6553.7808],
         [  6387.6030,   3632.0789],
         [ -3871.4106,  -7249.9746],
         [  -667.6426,   1316.0338],
         [  1758.0344,  10939.0664],
         [  8489.8525,  -5668.7383],
         [  7818.4761,  -6969.9219],
         [ -4696.1128,   1158.0204]],

        [[  -255.1844, -10081.7363],
         [  -142.7310, -11835.0049],
         [  -903.3338,  -4009.0825],
         [ -6056.1367,   5165.7871],
         [  6930.2300,  -7049.9707],
         [ -8231.4756,  -5587.9351],
         [  1895.2568,    -52.6609],
         [  7740.3569,   5782.4907],
         [   454.4817,  -8206.8193],
         [ -6407.4209,   4498.3286]],

        [[ -4403.8218,  10032.6270],
         [ 11259.2705,   1172.7732],
         [ -7047.0874,  -2040.2869],
         [   228.5804,  -5785.6729],
         [  6707.6011,  -5682.4399],
         [ -3046.5500,   6418.1528],
         [ -7051.8408,  -5994.6729],
         [ -7144.8774,   -806.5728],
         [ -6707.5659,  -7008.2515],
         [  4432.3667,    572.9549]],

        [[-11114.7861,    865.0712],
         [  8349.3066,   8176.9707],
         [  4248.0918,   2287.7986],
         [  1092.9205,  -6440.5532],
         [ -1834.0082,   8639.6318],
         [  3648.1606,   3195.3318],
         [ -1942.5231,  -6952.2715],
         [  6873.1069,   5399.8457],
         [   835.9366,   6335.9678],
         [ -4470.7026,   7375.1201]],

        [[  -970.3528,  -9591.3496],
         [  3334.9988,   4035.7659],
         [ -5301.2983,   4305.6865],
         [  -529.6953,   5862.9375],
         [  7748.4497,  -1544.0841],
         [ -5761.0972,   7021.5371],
         [ -7990.0327,  -6723.2251],
         [  7360.7021,   6080.3706],
         [  1840.2057,   7503.1958],
         [  6035.8057,  -9121.5986]],

        [[  8491.2266,   6877.6880],
         [ -1252.3071, -11545.7461],
         [ -3375.5833,  -5579.4282],
         [  5056.1387,   1589.0363],
         [   165.0289,  -8913.3701],
         [   955.9272,  -6355.1997],
         [  5881.8281,  -8098.2192],
         [  6233.3247,   6598.9453],
         [  6597.3208,  -4297.9702],
         [ -8956.2764,  -7756.6221]],

        [[-11312.9053,   -690.1390],
         [  4163.7949,   9712.6875],
         [  6211.9277,   3004.3457],
         [ -4869.7861,   -103.8206],
         [ -8996.5537,   4248.7417],
         [  8801.0957,   6842.5654],
         [   856.4338,   6095.8574],
         [  -808.5697,  -1683.8131],
         [ -5437.1201,  -3829.2866],
         [ -2317.5464,   6959.5840]],

        [[ -2383.9614,  -9768.0322],
         [  1580.9159,    271.9923],
         [  -215.8597,   3577.5605],
         [   697.8772, -11190.9775],
         [ -3658.8333,  -5587.5024],
         [ -4869.3486,  -2785.8430],
         [ -1105.8854,  -5685.8027],
         [ -1496.6824,  -1283.6150],
         [  7456.5020,  -4968.8657],
         [ -2783.5076,   6519.3169]],

        [[  9837.5371,   6348.7432],
         [ -5097.1919,   -598.5807],
         [ -7874.1128,  -5369.5010],
         [  2930.9290,   7679.3276],
         [  1812.4515,   9155.7158],
         [ -1968.7089,  -9112.9434],
         [  3824.5701,   -490.3436],
         [  -495.1673,   8861.8379],
         [ -3174.9180,  -1723.2021],
         [ -3562.8047,   2712.6753]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[ 3.9451e+02,  4.4104e+03],
         [ 8.5374e+02,  6.1951e+03],
         [ 9.5092e+03,  5.8453e+03],
         [ 2.3184e+03,  7.5567e+03],
         [-5.6870e+03, -4.6560e+02],
         [ 1.1076e+04, -5.4191e+03],
         [-3.3095e+02, -5.9681e+03],
         [-6.2161e+03, -3.8526e+03],
         [ 1.1990e+03,  5.3875e+03],
         [ 1.9749e+03, -1.3629e+03]],

        [[ 2.9969e+02, -2.3982e+02],
         [ 9.7333e+02, -3.7198e+03],
         [-7.5030e+03, -7.6997e+03],
         [-1.5422e+03, -6.4564e+03],
         [ 5.9966e+03, -6.4227e+03],
         [ 3.8299e+03, -6.8788e+03],
         [ 4.0476e+02, -1.8877e+03],
         [ 4.1333e+03,  6.8978e+03],
         [ 6.1886e+03, -3.2163e+03],
         [-1.8034e+03, -5.3764e+03]],

        [[ 5.7691e+03, -2.9586e+03],
         [-3.9190e+03,  4.3281e+03],
         [-7.3220e+03, -6.1870e+03],
         [-1.8443e+03, -6.9978e+03],
         [ 4.2923e+03,  6.6272e+03],
         [-7.4666e+03, -5.1188e+03],
         [ 8.5890e+03,  3.9584e+03],
         [-7.7978e+02, -1.1407e+03],
         [ 6.7157e+02,  7.1130e+02],
         [ 7.6229e+02, -1.5217e+01]],

        [[ 3.1958e+02,  3.3241e+03],
         [ 4.1485e+02, -6.4377e+03],
         [-7.7267e+03, -2.5640e+03],
         [-6.5839e+03,  4.3961e+03],
         [-6.6051e+03,  7.6896e+02],
         [ 4.9698e+03, -7.3133e+02],
         [ 4.2126e+01, -3.0346e+03],
         [-1.1294e+02, -1.5742e+03],
         [ 8.8406e+00, -1.3456e+03],
         [-1.3360e+02,  7.5128e+02]],

        [[ 2.2004e+03,  4.8605e+03],
         [ 2.4092e+03, -3.0836e+03],
         [-1.2237e+03,  4.7980e+03],
         [ 8.6249e+03, -4.1120e+03],
         [ 7.4731e+03,  6.6666e+03],
         [-1.0716e+04, -1.6219e+02],
         [ 6.5475e+02,  2.5050e+03],
         [-3.5615e+02,  1.9210e+02],
         [ 6.8032e+02,  7.1007e+02],
         [-6.9642e+02, -4.9947e+02]],

        [[ 5.5186e+03, -3.9937e+03],
         [-7.0932e+03,  1.4491e+02],
         [ 3.7930e+03, -1.0095e+04],
         [ 1.2071e+03,  9.4939e+03],
         [-5.2357e+03,  4.5225e+03],
         [ 5.4526e+02, -3.6265e+03],
         [-1.9010e+03,  2.0331e+02],
         [ 1.1395e+03, -4.4882e+01],
         [-4.8463e+02, -6.4073e+02],
         [-5.5770e+02,  1.1596e+02]],

        [[-2.7359e+03, -2.8690e+02],
         [ 3.0445e+01, -3.9085e+02],
         [ 6.8018e+03,  3.9241e+03],
         [-6.0804e+03,  5.3195e+03],
         [ 1.7987e+03, -2.1716e+03],
         [-2.8734e+03, -3.7629e+03],
         [ 1.7225e+02, -1.9026e+03],
         [-3.6133e+01, -7.8058e+02],
         [ 2.6233e+02, -7.5902e+02],
         [-1.5338e+02, -4.2576e+02]],

        [[-1.9743e+01,  3.0862e+03],
         [ 1.5889e+03,  3.9984e+02],
         [ 5.4061e+03,  6.5141e+03],
         [ 5.9727e+03, -7.2181e+03],
         [-1.2936e+02,  2.4367e+03],
         [-9.7736e+03, -9.8982e+02],
         [ 5.3889e+02,  2.1925e+03],
         [-4.8814e+02,  3.7674e+02],
         [ 1.8908e+03,  1.1109e+03],
         [-1.7533e+03, -2.0621e+01]],

        [[ 8.5582e+03,  9.1275e+02],
         [-5.6438e+03, -2.6181e+03],
         [ 4.1529e+03, -4.8641e+03],
         [-2.5443e+03, -2.7384e+03],
         [ 6.1128e+03, -1.5674e+03],
         [ 4.0335e+03,  3.1252e+03],
         [-7.9828e+03,  3.1246e+03],
         [ 5.0068e+03,  8.9647e+03],
         [-1.0722e+03,  6.9735e+03],
         [-1.8108e+03,  1.1308e+03]],

        [[ 3.1350e+03,  9.9905e+03],
         [ 1.8895e+03,  6.7756e+03],
         [-7.6659e+02,  9.5590e+03],
         [ 5.3048e+02, -7.8798e+03],
         [-2.6778e+01, -7.3465e+03],
         [ 4.4028e+03, -8.6553e+03],
         [ 3.0743e+03, -9.4930e+03],
         [ 4.6922e+02, -6.4242e+03],
         [-2.6864e+03, -1.0418e+04],
         [ 2.1379e+03, -9.1012e+03]]]) 

Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0148,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]],
       grad_fn=<SelectBackward>)

Epoch 1 finished. Total time: 755.7424545288086;  Epoch time: 434.2406749725342 












test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.4231, 0.4091, 0.4040,  ..., 0.2648, 0.2625, 0.2579],
         [0.4241, 0.4091, 0.4045,  ..., 0.2629, 0.2585, 0.2542],
         [0.4244, 0.4094, 0.4051,  ..., 0.2641, 0.2630, 0.2582],
         ...,
         [0.9455, 0.9455, 0.9454,  ..., 0.7561, 0.7559, 0.7555],
         [0.9455, 0.9455, 0.9454,  ..., 0.7561, 0.7552, 0.7550],
         [0.9455, 0.9451, 0.9443,  ..., 0.7549, 0.7543, 0.7537]],

        [[0.9443, 0.9433, 0.9431,  ..., 0.6042, 0.6037, 0.5710],
         [0.9443, 0.9441, 0.9440,  ..., 0.5718, 0.5711, 0.5711],
         [0.9446, 0.9443, 0.9440,  ..., 0.6039, 0.6036, 0.5721],
         ...,
         [0.9456, 0.9456, 0.9455,  ..., 0.7564, 0.7561, 0.7561],
         [0.9456, 0.9456, 0.9456,  ..., 0.7563, 0.7561, 0.7559],
         [0.9456, 0.9452, 0.9451,  ..., 0.7556, 0.7556, 0.7552]],

        [[0.9445, 0.9435, 0.9431,  ..., 0.6387, 0.6379, 0.6365],
         [0.9445, 0.9444, 0.9442,  ..., 0.6389, 0.6387, 0.6051],
         [0.9447, 0.9447, 0.9446,  ..., 0.6399, 0.6398, 0.6391],
         ...,
         [0.9457, 0.9456, 0.9455,  ..., 0.7568, 0.7568, 0.7565],
         [0.9457, 0.9456, 0.9455,  ..., 0.7566, 0.7564, 0.7559],
         [0.9455, 0.9454, 0.9452,  ..., 0.7563, 0.7558, 0.7552]],

        ...,

        [[0.9452, 0.9431, 0.9429,  ..., 0.7543, 0.7357, 0.7356],
         [0.9328, 0.9325, 0.9281,  ..., 0.7462, 0.7280, 0.7112],
         [0.9315, 0.9199, 0.9183,  ..., 0.7317, 0.7009, 0.6978],
         ...,
         [0.9456, 0.9455, 0.9455,  ..., 0.7566, 0.7564, 0.7564],
         [0.9453, 0.9453, 0.9452,  ..., 0.7560, 0.7547, 0.7546],
         [0.9453, 0.9448, 0.9447,  ..., 0.7542, 0.7540, 0.7527]],

        [[0.9429, 0.9418, 0.9418,  ..., 0.7456, 0.7292, 0.7281],
         [0.9311, 0.9281, 0.9270,  ..., 0.7410, 0.7201, 0.7046],
         [0.9183, 0.9178, 0.9174,  ..., 0.7298, 0.6952, 0.6905],
         ...,
         [0.9455, 0.9455, 0.9454,  ..., 0.7556, 0.7527, 0.7523],
         [0.9453, 0.9451, 0.9451,  ..., 0.7541, 0.7524, 0.7521],
         [0.9451, 0.9447, 0.9442,  ..., 0.7529, 0.7527, 0.7523]],

        [[0.9418, 0.9401, 0.9391,  ..., 0.7379, 0.7225, 0.7132],
         [0.9270, 0.9270, 0.9237,  ..., 0.7317, 0.7151, 0.6894],
         [0.9178, 0.9149, 0.9134,  ..., 0.7225, 0.7081, 0.6805],
         ...,
         [0.9454, 0.9454, 0.9447,  ..., 0.7521, 0.7489, 0.7478],
         [0.9447, 0.9446, 0.9445,  ..., 0.7520, 0.7499, 0.7487],
         [0.9446, 0.9442, 0.9424,  ..., 0.7511, 0.7511, 0.7509]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[1.1913e-06, 4.5862e-06, 5.7320e-06,  ..., 1.0743e-05,
          6.4068e-06, 1.3456e-06],
         [3.8886e-06, 7.8982e-07, 6.2003e-06,  ..., 3.8201e-06,
          4.6300e-05, 2.4829e-05],
         [3.1473e-07, 1.1305e-06, 9.8320e-08,  ..., 1.1663e-05,
          3.3168e-07, 1.0840e-06],
         ...,
         [2.2655e-09, 3.9565e-07, 6.1369e-09,  ..., 4.0320e-12,
          2.5599e-09, 1.2954e-08],
         [4.4195e-08, 5.9338e-10, 1.1633e-09,  ..., 1.4438e-06,
          1.2742e-08, 1.5768e-10],
         [6.6440e-08, 2.0692e-07, 3.3511e-08,  ..., 5.3207e-07,
          5.2877e-06, 3.8440e-06]],

        [[5.3040e-08, 4.5050e-06, 6.6417e-07,  ..., 6.3900e-06,
          3.4075e-08, 1.3572e-07],
         [3.0774e-07, 1.1295e-07, 1.0819e-10,  ..., 4.2305e-09,
          3.2911e-07, 2.2468e-06],
         [2.9678e-07, 1.3100e-07, 1.1481e-08,  ..., 8.1190e-07,
          3.9110e-06, 6.8487e-08],
         ...,
         [5.1071e-08, 3.1369e-07, 3.4721e-07,  ..., 1.1914e-07,
          1.9793e-07, 4.8892e-08],
         [2.6115e-08, 2.3117e-07, 1.5923e-07,  ..., 6.3462e-08,
          1.9616e-06, 1.0923e-06],
         [3.1668e-07, 2.0351e-07, 2.5063e-09,  ..., 1.3878e-07,
          4.8780e-08, 1.0751e-06]],

        [[1.2330e-08, 6.8816e-08, 6.7664e-07,  ..., 1.5116e-08,
          3.6160e-06, 9.9961e-07],
         [2.3773e-07, 7.8223e-08, 5.9289e-07,  ..., 1.1108e-07,
          6.8862e-08, 1.0274e-08],
         [2.3186e-07, 8.6990e-10, 2.4567e-07,  ..., 4.9711e-07,
          7.4132e-10, 4.5440e-07],
         ...,
         [8.6304e-08, 3.0727e-07, 4.2161e-08,  ..., 9.9930e-07,
          8.3064e-07, 2.4005e-07],
         [9.6553e-08, 2.3362e-09, 1.7547e-07,  ..., 1.1879e-07,
          4.6200e-08, 9.7653e-09],
         [3.3218e-08, 5.1200e-08, 1.0547e-08,  ..., 1.3490e-08,
          2.1848e-09, 1.5191e-07]],

        ...,

        [[1.9112e-08, 9.2823e-08, 1.0278e-07,  ..., 2.4900e-07,
          5.3615e-09, 3.5681e-07],
         [1.3798e-06, 4.2628e-07, 4.5040e-08,  ..., 2.2142e-06,
          3.5657e-07, 1.0194e-06],
         [1.8442e-07, 2.4323e-07, 1.4576e-10,  ..., 1.1390e-06,
          1.9863e-06, 1.3244e-04],
         ...,
         [2.5167e-07, 2.7225e-07, 1.7705e-07,  ..., 2.7753e-07,
          1.4235e-06, 2.2015e-07],
         [1.4991e-07, 2.3532e-07, 4.8458e-08,  ..., 2.7821e-06,
          5.5913e-07, 3.3061e-06],
         [2.8507e-07, 4.7788e-08, 1.2714e-07,  ..., 2.0636e-08,
          1.5985e-07, 4.9077e-06]],

        [[4.7092e-07, 3.2592e-07, 9.8256e-08,  ..., 7.9810e-07,
          9.7336e-07, 2.8235e-07],
         [1.5851e-07, 2.5558e-07, 7.3520e-08,  ..., 3.5650e-07,
          1.2760e-05, 1.1714e-04],
         [1.4912e-07, 3.6421e-08, 2.0481e-07,  ..., 2.2114e-07,
          2.6324e-07, 3.6106e-05],
         ...,
         [3.1694e-07, 9.0315e-08, 3.9681e-09,  ..., 7.4731e-10,
          6.9856e-08, 6.6357e-08],
         [4.4147e-07, 3.0401e-07, 1.2759e-08,  ..., 1.8956e-07,
          8.7304e-07, 4.8213e-07],
         [1.5469e-07, 1.0429e-10, 7.2762e-07,  ..., 3.2323e-07,
          1.8699e-06, 1.7147e-08]],

        [[1.9544e-08, 9.8673e-08, 6.6449e-08,  ..., 9.0926e-10,
          2.9665e-07, 2.4307e-05],
         [1.5932e-07, 2.3262e-08, 1.5478e-07,  ..., 5.4951e-07,
          1.2544e-06, 2.6543e-05],
         [6.0611e-05, 1.3811e-05, 3.2135e-06,  ..., 2.1763e-04,
          8.4353e-05, 4.6713e-06],
         ...,
         [9.3460e-07, 4.7617e-10, 3.6798e-09,  ..., 3.9605e-09,
          1.2477e-07, 9.3825e-08],
         [8.3626e-08, 9.0939e-09, 7.7938e-08,  ..., 5.0674e-07,
          9.5266e-07, 2.0169e-08],
         [1.8397e-08, 9.2611e-07, 2.1090e-07,  ..., 1.9241e-08,
          4.4938e-06, 1.7624e-06]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[1.2311e-03, 8.6943e-04, 5.4271e-04,  ..., 1.4400e-03,
          4.7729e-04, 5.1121e-04],
         [1.2027e-03, 1.3622e-03, 8.2186e-04,  ..., 1.3740e-03,
          1.3414e-03, 8.9662e-04],
         [4.3977e-04, 6.2913e-05, 3.9427e-04,  ..., 8.1719e-04,
          8.3207e-04, 5.2790e-04],
         ...,
         [4.3301e-04, 6.5733e-05, 6.7387e-04,  ..., 1.4066e-03,
          5.5172e-04, 9.0492e-05],
         [6.3689e-04, 4.3301e-04, 4.6134e-04,  ..., 7.0168e-04,
          3.8931e-04, 3.1548e-04],
         [6.3689e-04, 6.7710e-04, 2.1117e-04,  ..., 3.0494e-04,
          8.5242e-04, 9.6473e-04]],

        [[3.8325e-04, 7.2105e-04, 5.8359e-04,  ..., 8.4534e-04,
          5.9067e-04, 1.0142e-04],
         [3.8325e-04, 3.8610e-04, 1.6693e-04,  ..., 2.2043e-04,
          3.1830e-04, 2.8147e-04],
         [2.4220e-04, 4.9519e-04, 1.6693e-04,  ..., 1.7414e-04,
          2.2516e-04, 4.5362e-04],
         ...,
         [7.0643e-04, 1.1230e-04, 6.5733e-05,  ..., 2.4319e-04,
          6.6969e-04, 5.4447e-04],
         [7.0643e-04, 3.3822e-04, 4.0979e-04,  ..., 6.7097e-04,
          5.6103e-04, 7.0066e-04],
         [3.3822e-04, 3.5116e-04, 6.7710e-04,  ..., 4.6652e-04,
          3.3628e-04, 6.0293e-04]],

        [[6.3585e-04, 4.6650e-04, 5.9344e-04,  ..., 5.8941e-04,
          3.9604e-04, 1.1476e-03],
         [6.3585e-04, 3.1903e-04, 2.4019e-04,  ..., 2.2088e-04,
          1.9770e-04, 8.7380e-04],
         [2.8727e-04, 4.9630e-04, 2.4220e-04,  ..., 1.4322e-04,
          8.9088e-05, 4.2812e-04],
         ...,
         [7.4890e-04, 1.1230e-04, 9.7689e-04,  ..., 6.9860e-04,
          6.3580e-04, 6.8533e-04],
         [1.1681e-04, 4.0979e-04, 3.7098e-04,  ..., 5.0736e-04,
          3.7003e-04, 3.8152e-04],
         [7.0056e-04, 4.6928e-04, 3.5116e-04,  ..., 4.2427e-04,
          6.1252e-04, 2.4132e-04]],

        ...,

        [[1.8639e-04, 4.3166e-04, 6.0012e-04,  ..., 7.3057e-04,
          8.9236e-04, 5.4489e-04],
         [6.3323e-04, 1.1299e-04, 3.9709e-04,  ..., 4.7210e-04,
          8.1115e-03, 8.3901e-03],
         [4.3016e-04, 3.8657e-04, 4.4491e-04,  ..., 8.2832e-04,
          1.3063e-02, 9.5788e-03],
         ...,
         [2.6208e-04, 8.3305e-05, 3.9623e-04,  ..., 7.5800e-04,
          2.8210e-04, 5.8060e-04],
         [3.6491e-04, 2.2822e-04, 1.6626e-04,  ..., 4.6583e-04,
          6.4129e-04, 3.2513e-04],
         [3.6491e-04, 5.8796e-04, 3.6681e-04,  ..., 2.8957e-04,
          4.5467e-04, 3.3779e-04]],

        [[6.0012e-04, 2.9333e-04, 5.8575e-04,  ..., 3.5491e-04,
          8.1484e-03, 1.0556e-03],
         [4.1440e-04, 3.9709e-04, 1.7883e-04,  ..., 8.4825e-04,
          7.2244e-04, 1.0051e-02],
         [4.4491e-04, 8.1206e-03, 3.0538e-04,  ..., 1.0405e-03,
          6.9255e-03, 2.5141e-03],
         ...,
         [8.3305e-05, 5.1111e-04, 4.5105e-05,  ..., 4.0903e-04,
          3.4902e-04, 4.2614e-04],
         [4.7069e-04, 1.5951e-04, 3.1348e-04,  ..., 7.9798e-04,
          3.2436e-04, 5.6990e-04],
         [1.5951e-04, 3.6681e-04, 1.9851e-04,  ..., 3.1129e-04,
          1.9448e-04, 1.0212e-04]],

        [[5.8575e-04, 6.3387e-04, 7.4219e-04,  ..., 4.8931e-04,
          1.3631e-03, 1.1707e-03],
         [1.7883e-04, 7.6334e-04, 6.7424e-04,  ..., 8.2832e-04,
          3.1840e-03, 2.2184e-03],
         [8.1206e-03, 7.6942e-03, 7.7237e-03,  ..., 8.4476e-03,
          7.9394e-03, 9.3324e-03],
         ...,
         [2.7866e-04, 4.5105e-05, 2.6879e-04,  ..., 7.8674e-04,
          4.1634e-04, 2.4886e-04],
         [2.6879e-04, 6.3471e-04, 7.4901e-04,  ..., 6.4422e-04,
          7.7524e-04, 3.0839e-04],
         [6.3471e-04, 1.9851e-04, 3.4010e-04,  ..., 4.4420e-04,
          9.9872e-04, 6.4726e-04]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:3.3210511207580566 loss2:1392.9169921875


loss.item(): 34826.24609375


Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([59, 98]) torch.Size([59, 98, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-7.4721e-01, -7.3486e-02,  8.2746e-01,  1.0682e+00, -9.8860e-01,
          2.2324e-01,  4.9163e-01,  8.8960e+00, -8.4548e+00,  4.3031e+00],
        [ 2.5866e+00,  1.0599e+01,  1.0369e+01,  1.4072e+01,  1.6141e+01,
         -1.9388e+01,  3.3836e+01, -2.4496e+01,  1.6546e+01, -7.9269e+01],
        [ 7.8510e+00, -3.1190e+01,  1.8591e+01, -4.0589e+01,  3.6108e+01,
          5.5340e+01,  1.8688e+01,  1.6544e+02,  7.1686e+01,  2.2478e+01],
        [ 5.4993e+01, -5.7468e+01, -1.0986e+02, -6.2627e+01,  1.5580e+02,
          2.7800e+02, -3.6084e+02,  2.9497e+02, -7.9137e+02,  5.1344e+02],
        [ 4.7138e+01, -8.2226e+01,  5.3415e+01,  2.5840e+02,  3.6578e+02,
          4.3734e+02,  5.2211e+02,  8.3881e+02,  1.0828e+02, -3.8720e+02],
        [-5.1648e+01, -1.9931e+01,  3.0879e+02,  1.9760e+02,  4.7248e+02,
          6.3542e+02,  5.1437e+02,  1.4015e+03,  6.9220e+02,  4.0726e+02],
        [-1.3393e+01,  1.5975e+02,  3.2921e+02,  4.3995e+02,  1.6988e+03,
         -8.7197e+02,  5.5287e+02,  9.4681e+02, -1.3218e+03,  1.5155e+03],
        [-1.1748e+02,  2.1871e+02,  5.7046e+02,  6.8412e+02,  1.9801e+02,
         -1.0246e+04, -8.1957e+02,  1.0945e+03,  4.7404e+02, -6.8570e+02],
        [-1.3053e+02,  1.6966e+02,  5.8888e+02,  9.9054e+02,  3.1916e+02,
          2.7849e+02, -1.1086e+04,  1.0076e+03, -7.3976e+02, -1.2482e+04]]) 

MatU.grad[0:10,35:45]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 3.4502e+01,  2.1936e+02],
         [-5.3768e+01, -7.8605e+01],
         [ 1.1012e+02, -1.5520e+02],
         [ 9.8330e+01,  3.9149e+01],
         [-2.8998e+02,  3.3925e+00],
         [ 1.1591e+02, -5.3876e+01],
         [-5.5636e+01,  4.7052e+02],
         [-6.4329e+01,  5.4685e+01]],

        [[ 9.7306e+02,  3.4464e+02],
         [-1.8227e+02, -1.6610e+02],
         [-6.8624e+02, -6.2852e+02],
         [-9.2954e+02, -1.4768e+02],
         [ 4.6632e+02,  2.9100e+02],
         [ 3.7000e+02, -1.7695e+02],
         [-5.4294e+02, -4.3616e+02],
         [ 7.9101e+02, -1.5681e+02],
         [-9.3637e+02, -4.8534e+02],
         [ 1.8652e+02,  1.0613e+03]],

        [[-5.3672e+02, -9.1606e+02],
         [-8.0469e+01, -9.8531e+02],
         [-1.3333e+03, -1.0388e+03],
         [-1.2364e+03, -2.0156e+02],
         [ 4.6293e+02,  5.8526e+02],
         [ 1.8863e+02, -3.7878e+02],
         [-7.8397e+02, -1.8324e+01],
         [ 8.4677e+02, -2.6595e+02],
         [ 7.8981e+02,  2.2632e+01],
         [-1.4802e+03, -3.9685e+02]],

        [[ 2.6374e+03,  2.6663e+03],
         [-3.2816e+03, -3.3141e+03],
         [ 7.1427e+03, -1.8946e+03],
         [-3.5028e+02,  3.2035e+02],
         [-1.3685e+03, -1.6005e+02],
         [ 2.9795e+02,  1.8698e+03],
         [-1.2189e+03, -7.8117e+02],
         [ 2.1630e+03, -1.9715e+02],
         [-4.0647e+02,  3.6226e+03],
         [-2.8123e+03, -4.9712e+03]],

        [[-8.4045e+02, -2.8249e+03],
         [ 9.0543e+02,  5.1351e+03],
         [-4.5497e+03,  1.9026e+03],
         [ 2.2741e+02, -1.7794e+03],
         [ 1.1527e+03, -6.6773e+01],
         [ 2.6978e+01,  1.0184e+03],
         [-1.4560e+02,  2.5581e+02],
         [ 4.7900e+02, -1.1838e+01],
         [-1.2026e+03, -3.2150e+02],
         [ 1.8337e+02,  2.2578e+03]],

        [[-5.4792e+02,  2.5595e+03],
         [ 4.4895e+03, -4.1493e+03],
         [-6.6424e+03,  4.8420e+03],
         [ 1.7787e+03,  7.0671e+02],
         [ 9.5854e+02,  1.9965e+00],
         [-3.7494e+02, -5.3397e+02],
         [-7.6254e+01,  9.1482e+02],
         [ 2.4634e+02, -2.4781e+01],
         [ 4.4570e+02, -1.8910e+02],
         [-2.7933e+02,  1.4755e+03]],

        [[-1.2237e+03,  5.5034e+03],
         [-9.1385e+03,  4.7735e+03],
         [-5.0755e+03, -5.4017e+03],
         [ 1.4358e+03,  7.5466e+02],
         [-4.8453e+02,  6.9347e+02],
         [ 9.3903e+02, -8.2174e+01],
         [-5.5596e+02, -2.5732e+02],
         [ 3.3296e+02,  1.8635e+01],
         [ 7.2510e+02,  1.0628e+02],
         [-1.1867e+03, -1.4347e+03]]]) 

MatD.grad: 
tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000, -0.9712,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.1007e+02,  3.3611e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-8.9959e+01, -9.1359e+01],
         [ 1.2287e+02, -3.7124e+01],
         [ 2.7415e+01,  1.2568e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-2.0009e+02, -3.8876e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-9.3361e+01,  5.6517e+01],
         [-2.1984e+02,  5.7182e+02],
         [ 0.0000e+00,  0.0000e+00],
         [-1.4098e+03, -1.0126e+03],
         [ 8.7826e+02,  1.9964e+03],
         [ 9.4013e+02, -1.5033e+03],
         [-8.6435e+02, -1.0490e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.5545e+01, -1.8188e+02],
         [ 1.5131e+01, -5.0798e+02],
         [-1.0910e+03, -1.2521e+03],
         [ 3.2546e+03,  4.2165e+03],
         [-4.4093e+02, -6.3279e+02],
         [-3.1834e+03, -3.4950e+03],
         [ 7.4510e+03, -5.5833e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-2.9668e+02, -7.0008e+02],
         [ 9.7113e+02, -1.4243e+02],
         [ 6.2000e+03, -5.1184e+03],
         [ 9.6264e+02,  7.0924e+03],
         [-3.7213e+03,  2.4531e+03],
         [ 8.8208e+03,  5.8758e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-9.7675e+02, -3.1956e+02],
         [-1.2142e+03, -2.1416e+03],
         [-4.9704e+03, -8.3732e+02],
         [ 4.0520e+03,  1.0619e+04],
         [-4.2378e+03, -5.0385e+03],
         [ 2.6003e+03, -1.2989e+03]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[ -8077.8213,  -1008.0313],
         [ -4789.3203,   6874.8755],
         [  4390.5967,   9530.8359],
         [  8835.5664,   3303.9026],
         [ -4918.1812,  -7388.5371],
         [ -5930.0488,  -8926.0068],
         [  4406.6357,   6064.8257],
         [ -6381.4404,  -3681.6848],
         [ -8098.0117,   3758.0083],
         [  7607.6211,   6670.3140]],

        [[  3566.3357,  -5698.1743],
         [  1951.8147,   5128.8369],
         [ -1556.8136,    694.1498],
         [  -714.5867,  -8920.7275],
         [ -6134.8379,   2018.8732],
         [  9764.9463,   6531.5459],
         [ -5240.6011,   8475.8857],
         [  5442.0703,  -1631.1747],
         [  3385.5164,  -1381.9884],
         [ -6249.7954,   8372.0625]],

        [[  1631.7542,  -9954.1445],
         [ -1408.6439, -11643.3623],
         [ -6772.1851,  -2637.5715],
         [  5377.4902,   1133.3403],
         [  3043.9683,   1051.6118],
         [  -525.8647,   1982.0081],
         [ -5478.6934, -10307.2949],
         [  5049.9629,   6615.5703],
         [  8530.5146,  -4581.4893],
         [ -1416.8928,  -6694.2144]],

        [[ -3329.7297,  10428.0684],
         [ 11308.7129,    211.5515],
         [ -4687.0151,  -5420.7051],
         [  8829.3223,   -869.7355],
         [  2698.0447,  -1223.0503],
         [ -5464.3633,  -5312.9795],
         [ -1881.9435,  -2978.6650],
         [  -536.9648, -10620.4932],
         [ -5350.3252,  -2098.2966],
         [  2300.6553,   8965.9697]],

        [[-11276.8320,   -722.1909],
         [  8282.4971,   8091.2144],
         [ -1373.0692,   6617.0132],
         [  6746.0166,  -3767.3503],
         [-10165.1777,   4852.3462],
         [  5807.7314,   5872.1377],
         [ -9515.5898,  -2464.2966],
         [  1855.7809,   9287.2617],
         [ 10455.7412,   4170.2476],
         [ -6327.4541,   6108.3608]],

        [[   -74.3791,  -9534.1953],
         [  3449.6895,   1052.1530],
         [ -4143.0415,   3422.7363],
         [  6429.6255,   2328.4263],
         [  1293.4442, -10275.2490],
         [ -4995.7578,   4127.6870],
         [ -3646.3350,  -5036.2158],
         [  1735.7621,   4803.2725],
         [  9611.5811,   -620.5095],
         [  1395.9410,  -7414.2163]],

        [[  8381.9502,   6824.7241],
         [  -153.5467, -11533.6260],
         [ -4718.2280,  -1521.4825],
         [  3333.6799,   5960.4131],
         [  6344.9912,  -5716.9302],
         [ -8923.2607,   2999.6313],
         [   625.1730,  -6573.9175],
         [   334.7488,     82.3416],
         [  4679.9834,  -6210.9600],
         [ -4680.6821,  -8413.4375]],

        [[-11320.9697,  -1781.9269],
         [  3510.0034,   9917.3047],
         [   911.1000,   -375.1929],
         [ -1163.3430,  -6880.5728],
         [ -7489.6450,    704.8044],
         [  8439.0898,   4810.7896],
         [  8584.0742,   -724.6707],
         [ -5407.5195,   7430.6343],
         [  7329.8394,   7226.7651],
         [ -8975.1396,    858.9815]],

        [[ -2435.4297,  -9734.4111],
         [  4798.3433,  -1387.4684],
         [ -3437.1299,   2502.2744],
         [  1379.2190, -11322.5742],
         [ -1974.7827,  -3083.9490],
         [ -1595.4529,  -1321.6890],
         [  4974.5464,  -4866.8628],
         [ -4956.0273,  -5582.8730],
         [  2088.4722,   5718.1987],
         [ -5054.9707,   1324.6753]],

        [[  9650.5127,   6359.2788],
         [ -1382.7147,   5726.9814],
         [ -8258.2842,  -4087.2627],
         [   798.5012,   7708.9219],
         [   142.4969,   9261.6484],
         [ -1446.9294,  -9112.7217],
         [   753.3240,   2404.5781],
         [   470.2234,   8641.5537],
         [  2853.4685,  -3768.8042],
         [ -1963.1713,   -998.3030]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[-8.1212e+03, -4.9335e+01],
         [ 8.6534e+03,  2.9512e+03],
         [ 3.7681e+03,  3.5081e+03],
         [-4.5848e+03,  2.5775e+03],
         [ 4.6314e+03,  7.6172e+03],
         [ 1.1108e+04, -4.4394e+03],
         [ 8.5956e+03,  2.3885e+03],
         [ 2.6821e+03,  3.8054e+03],
         [-4.9646e+03, -1.4694e+02],
         [-7.6514e+02, -5.5227e+03]],

        [[-4.1423e+03,  6.6713e+03],
         [ 6.2085e+03, -6.6116e+03],
         [-2.3632e+03, -4.1768e+03],
         [-1.0956e+04, -3.7309e+03],
         [ 5.3856e+03, -6.4673e+03],
         [-5.3850e+03, -4.2319e+03],
         [ 6.0489e+03,  5.0177e+03],
         [ 3.7497e+02,  6.0404e+02],
         [-1.3711e+03, -4.0926e+03],
         [ 3.5815e+03, -1.7725e+03]],

        [[ 7.7546e+01, -4.1718e+03],
         [ 4.9548e+03,  3.9700e+03],
         [-4.6374e+03, -2.6902e+03],
         [-1.0184e+04, -8.5066e+02],
         [ 6.6092e+03,  3.4277e+03],
         [-2.0645e+03, -6.0853e+03],
         [ 6.6578e+03,  8.7792e+02],
         [ 7.9966e+02, -7.5049e+02],
         [ 1.8388e+01, -6.4679e+01],
         [ 3.4228e+02, -1.4304e+03]],

        [[-5.8354e+03,  2.1411e+03],
         [ 6.9028e+03, -9.3597e+02],
         [-4.4719e+03, -9.3276e+03],
         [-4.6489e+03,  7.9942e+03],
         [-8.6998e+02,  6.4203e+03],
         [ 4.9330e+03, -7.7771e+03],
         [-1.7283e+02, -2.9827e+03],
         [-1.1893e+01, -1.5391e+03],
         [-6.3128e+01, -1.3045e+03],
         [-1.1195e+02,  7.1328e+02]],

        [[-4.1143e+03,  4.4452e+02],
         [ 5.2758e+03, -7.0709e+03],
         [ 6.7424e+03,  1.1617e+03],
         [ 9.8680e+02, -7.5808e+03],
         [ 1.1910e+03, -1.1390e+03],
         [-1.0626e+04,  4.4507e+02],
         [ 5.2896e+02,  2.4754e+03],
         [-2.9659e+02, -1.0632e+02],
         [ 6.5401e+02,  6.8157e+02],
         [-6.6893e+02, -4.8040e+02]],

        [[-9.8345e+02, -4.5912e+03],
         [ 3.7663e+03,  6.1253e+03],
         [ 5.4938e+03, -5.6782e+03],
         [-8.2251e+03,  2.8296e+03],
         [ 5.6421e+03,  7.9181e+02],
         [-4.3761e+03, -6.1340e+02],
         [-1.8260e+03,  8.3958e+01],
         [ 1.0973e+03, -3.7176e+01],
         [-4.6448e+02, -6.1444e+02],
         [-5.8407e+02,  6.7788e+01]],

        [[-4.0005e+02,  4.8725e+03],
         [ 7.0522e+03,  6.8485e+03],
         [-8.3978e+02,  6.6879e+03],
         [-4.5092e+03,  6.6502e+03],
         [ 6.7113e+03,  6.6105e+03],
         [ 5.2900e+02,  1.4065e+03],
         [ 2.4004e+02, -1.8280e+03],
         [-3.0602e+01, -7.6032e+02],
         [ 1.3647e+02, -7.4294e+02],
         [-6.0563e+01, -3.7112e+02]],

        [[-2.9419e+03, -2.2692e+03],
         [ 4.7111e+03, -6.0065e+03],
         [ 2.5083e+03, -4.7718e+02],
         [ 9.8030e+02, -2.9870e+03],
         [-2.0023e+03, -5.0702e+03],
         [-9.7857e+03, -6.1510e+02],
         [ 4.3773e+02,  2.1720e+03],
         [ 1.3651e+02,  1.6357e+02],
         [ 1.8395e+03,  1.0840e+03],
         [-1.6678e+03,  1.6207e+02]],

        [[ 6.4859e+03,  1.4312e+03],
         [-1.3126e+03,  1.6870e+03],
         [ 4.1399e+03, -4.1064e+03],
         [-2.7243e+03, -7.8913e+02],
         [ 5.2841e+03, -3.5455e+03],
         [ 1.4503e+03, -3.1748e+03],
         [-7.8772e+03,  2.6348e+03],
         [ 4.7489e+03,  8.9907e+03],
         [-2.1119e+02,  6.9055e+03],
         [-1.3066e+03,  7.1374e+02]],

        [[ 2.3060e+03,  1.0045e+04],
         [ 1.8132e+03,  6.5557e+03],
         [-4.9081e+00,  9.4354e+03],
         [-1.2313e+03, -6.9341e+03],
         [-7.7037e+02, -6.9064e+03],
         [ 4.1105e+03, -8.6295e+03],
         [ 2.6531e+03, -9.3092e+03],
         [-8.5548e+02, -6.3747e+03],
         [-2.2002e+03, -1.0501e+04],
         [ 1.4260e+03, -8.7695e+03]]]) 

Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0152,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]],
       grad_fn=<SelectBackward>)

Epoch 2 finished. Total time: 1435.831274986267;  Epoch time: 680.0858287811279 












test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.4144, 0.4008, 0.3960,  ..., 0.2629, 0.2601, 0.2529],
         [0.4156, 0.4011, 0.3966,  ..., 0.2586, 0.2533, 0.2493],
         [0.4162, 0.4015, 0.3975,  ..., 0.2609, 0.2589, 0.2533],
         ...,
         [0.9457, 0.9454, 0.9454,  ..., 0.7555, 0.7555, 0.7553],
         [0.9455, 0.9454, 0.9453,  ..., 0.7555, 0.7553, 0.7547],
         [0.9453, 0.9452, 0.9435,  ..., 0.7549, 0.7545, 0.7536]],

        [[0.9445, 0.9431, 0.9424,  ..., 0.6035, 0.6033, 0.5706],
         [0.9445, 0.9439, 0.9433,  ..., 0.5710, 0.5701, 0.5700],
         [0.9442, 0.9441, 0.9439,  ..., 0.6034, 0.6029, 0.5713],
         ...,
         [0.9458, 0.9457, 0.9456,  ..., 0.7562, 0.7558, 0.7557],
         [0.9457, 0.9456, 0.9455,  ..., 0.7560, 0.7556, 0.7555],
         [0.9455, 0.9455, 0.9452,  ..., 0.7554, 0.7551, 0.7551]],

        [[0.9448, 0.9436, 0.9425,  ..., 0.6382, 0.6365, 0.6346],
         [0.9448, 0.9447, 0.9434,  ..., 0.6382, 0.6377, 0.6046],
         [0.9450, 0.9447, 0.9441,  ..., 0.6396, 0.6392, 0.6386],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.7569, 0.7569, 0.7566],
         [0.9457, 0.9457, 0.9457,  ..., 0.7567, 0.7559, 0.7556],
         [0.9457, 0.9456, 0.9455,  ..., 0.7560, 0.7555, 0.7551]],

        ...,

        [[0.9452, 0.9420, 0.9419,  ..., 0.7534, 0.7305, 0.7301],
         [0.9302, 0.9296, 0.9243,  ..., 0.7434, 0.7208, 0.7028],
         [0.9282, 0.9150, 0.9122,  ..., 0.7251, 0.6910, 0.6869],
         ...,
         [0.9456, 0.9456, 0.9456,  ..., 0.7567, 0.7567, 0.7564],
         [0.9454, 0.9453, 0.9453,  ..., 0.7559, 0.7536, 0.7534],
         [0.9453, 0.9449, 0.9448,  ..., 0.7529, 0.7525, 0.7507]],

        [[0.9419, 0.9401, 0.9400,  ..., 0.7427, 0.7230, 0.7217],
         [0.9275, 0.9243, 0.9228,  ..., 0.7372, 0.7123, 0.6954],
         [0.9122, 0.9120, 0.9116,  ..., 0.7230, 0.6849, 0.6791],
         ...,
         [0.9456, 0.9456, 0.9456,  ..., 0.7554, 0.7514, 0.7505],
         [0.9454, 0.9453, 0.9451,  ..., 0.7529, 0.7511, 0.7510],
         [0.9451, 0.9449, 0.9446,  ..., 0.7511, 0.7507, 0.7504]],

        [[0.9400, 0.9376, 0.9361,  ..., 0.7318, 0.7146, 0.7031],
         [0.9228, 0.9221, 0.9183,  ..., 0.7251, 0.7056, 0.6767],
         [0.9120, 0.9083, 0.9063,  ..., 0.7148, 0.6977, 0.6672],
         ...,
         [0.9456, 0.9456, 0.9449,  ..., 0.7500, 0.7461, 0.7437],
         [0.9449, 0.9449, 0.9445,  ..., 0.7499, 0.7480, 0.7456],
         [0.9446, 0.9445, 0.9415,  ..., 0.7491, 0.7487, 0.7486]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[1.5297e-06, 5.6194e-06, 5.2129e-06,  ..., 7.6305e-06,
          1.4421e-06, 1.3474e-06],
         [1.0104e-05, 6.4474e-06, 9.3958e-06,  ..., 5.3259e-06,
          3.7897e-05, 8.7853e-06],
         [2.1804e-06, 3.5890e-06, 1.4359e-06,  ..., 1.6211e-06,
          1.3164e-05, 1.7317e-06],
         ...,
         [5.1569e-11, 1.2618e-07, 2.4091e-07,  ..., 6.0494e-07,
          7.0905e-07, 9.5235e-08],
         [2.1171e-09, 1.5086e-07, 1.1592e-08,  ..., 4.1384e-08,
          9.4863e-10, 3.9348e-07],
         [2.2106e-08, 1.5452e-07, 1.4460e-08,  ..., 1.5490e-06,
          2.6794e-06, 8.1163e-07]],

        [[1.2225e-07, 3.3507e-06, 8.2465e-07,  ..., 1.0072e-07,
          3.8840e-07, 6.4160e-09],
         [8.5707e-08, 2.1173e-07, 2.7012e-11,  ..., 8.8225e-07,
          9.0832e-07, 3.0738e-10],
         [4.0436e-08, 2.5487e-07, 1.1603e-07,  ..., 2.8771e-06,
          3.4825e-08, 5.8154e-08],
         ...,
         [4.0323e-08, 2.6926e-09, 1.7996e-07,  ..., 8.5476e-07,
          1.2325e-07, 3.3520e-07],
         [1.1885e-07, 2.4901e-08, 7.4935e-08,  ..., 4.4589e-07,
          9.5589e-08, 1.2067e-06],
         [4.8099e-08, 1.0299e-09, 1.3620e-08,  ..., 3.7043e-08,
          1.9660e-07, 1.1660e-08]],

        [[2.7741e-08, 9.7275e-08, 3.0036e-07,  ..., 1.8548e-07,
          1.2672e-06, 8.9692e-07],
         [1.7963e-09, 3.8231e-10, 9.0311e-09,  ..., 6.5412e-08,
          5.0295e-08, 8.2015e-07],
         [1.5243e-07, 4.9370e-08, 1.4293e-08,  ..., 2.0206e-07,
          2.1897e-08, 3.2612e-07],
         ...,
         [1.5671e-08, 2.3035e-08, 2.5199e-09,  ..., 4.5885e-09,
          2.2113e-08, 9.9730e-10],
         [4.7568e-08, 4.9531e-07, 6.7334e-08,  ..., 6.6004e-08,
          6.9481e-07, 2.1233e-07],
         [1.0475e-07, 2.7593e-09, 9.6567e-09,  ..., 1.0890e-06,
          9.6945e-07, 3.2841e-09]],

        ...,

        [[8.2848e-08, 3.0820e-08, 7.4769e-08,  ..., 1.2289e-07,
          1.4547e-06, 6.4172e-07],
         [5.7545e-07, 6.6079e-07, 1.0517e-08,  ..., 6.0175e-07,
          2.3305e-08, 2.3280e-08],
         [2.3796e-06, 2.1804e-07, 7.4618e-08,  ..., 1.0198e-07,
          2.2099e-06, 1.4702e-04],
         ...,
         [5.2908e-07, 2.7523e-08, 4.0061e-12,  ..., 9.5817e-11,
          1.0091e-06, 1.6535e-07],
         [5.3211e-08, 2.7713e-08, 4.4828e-07,  ..., 2.0214e-07,
          5.9272e-07, 3.5569e-07],
         [1.4805e-08, 9.8950e-08, 1.0376e-07,  ..., 5.4209e-07,
          1.7989e-06, 2.7486e-06]],

        [[1.7773e-07, 9.7198e-07, 1.0649e-08,  ..., 2.8801e-06,
          3.4074e-06, 1.4492e-06],
         [1.2805e-06, 4.0402e-07, 5.9848e-08,  ..., 6.4421e-06,
          1.7832e-05, 1.2537e-04],
         [3.8117e-08, 1.4894e-07, 5.7807e-07,  ..., 1.3603e-06,
          8.6508e-07, 5.0023e-05],
         ...,
         [1.8252e-07, 5.9178e-08, 5.4004e-08,  ..., 4.2287e-07,
          5.4422e-07, 1.4364e-06],
         [1.5626e-08, 2.6451e-07, 4.1927e-08,  ..., 1.4392e-07,
          1.0721e-08, 1.4748e-08],
         [3.7930e-07, 3.7599e-07, 4.8433e-09,  ..., 4.3641e-08,
          1.8973e-06, 1.0549e-06]],

        [[7.1190e-08, 2.3178e-07, 1.3030e-06,  ..., 7.9839e-07,
          1.8677e-07, 2.3604e-05],
         [1.0329e-07, 1.7473e-06, 9.8968e-08,  ..., 7.1659e-08,
          9.2716e-07, 3.1053e-05],
         [5.3075e-05, 5.2574e-06, 1.7636e-06,  ..., 2.0223e-04,
          4.5129e-05, 7.2771e-08],
         ...,
         [1.0424e-07, 1.3504e-06, 6.7142e-11,  ..., 3.1331e-07,
          1.5844e-07, 8.0864e-07],
         [2.0387e-07, 1.0523e-08, 3.4637e-07,  ..., 1.6280e-06,
          9.6011e-07, 3.5671e-07],
         [2.1930e-07, 2.6027e-08, 3.6996e-08,  ..., 6.1310e-06,
          1.2646e-06, 4.9830e-07]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[7.9202e-04, 9.9676e-04, 6.9200e-04,  ..., 5.1884e-04,
          4.1265e-04, 2.3866e-05],
         [3.0820e-04, 3.0002e-04, 2.9257e-04,  ..., 5.3432e-04,
          5.2055e-04, 5.0915e-05],
         [6.3741e-04, 2.0974e-04, 8.2897e-04,  ..., 4.4771e-04,
          6.2149e-04, 5.1968e-04],
         ...,
         [8.6341e-05, 4.6666e-05, 9.0037e-05,  ..., 1.9100e-04,
          7.1893e-04, 5.4040e-04],
         [3.5433e-04, 4.6666e-05, 4.9355e-04,  ..., 3.6495e-04,
          8.2031e-04, 7.7614e-05],
         [4.9355e-04, 2.7872e-04, 6.8585e-04,  ..., 6.5342e-04,
          9.8484e-04, 6.2440e-04]],

        [[4.2705e-04, 3.7603e-04, 4.9045e-04,  ..., 5.9356e-04,
          5.1350e-04, 2.3374e-04],
         [4.2705e-04, 2.5421e-04, 5.9851e-04,  ..., 4.9273e-04,
          6.3035e-04, 5.3540e-04],
         [4.9156e-04, 4.2891e-04, 2.5421e-04,  ..., 1.9310e-04,
          2.3179e-04, 2.5455e-04],
         ...,
         [2.5522e-04, 8.6341e-05, 3.1704e-04,  ..., 2.5378e-04,
          3.4561e-04, 3.2429e-04],
         [7.9593e-04, 3.1704e-04, 5.3667e-04,  ..., 1.1764e-04,
          2.9718e-04, 3.9588e-04],
         [1.2105e-04, 5.3667e-04, 2.7872e-04,  ..., 1.5905e-04,
          7.0170e-04, 9.3657e-05]],

        [[5.7656e-04, 3.1676e-04, 1.2668e-04,  ..., 3.2586e-04,
          4.0269e-04, 4.7734e-04],
         [5.7656e-04, 2.4318e-04, 1.7124e-04,  ..., 5.1135e-04,
          4.6360e-04, 6.6195e-04],
         [4.9100e-04, 2.4318e-04, 1.7081e-04,  ..., 4.3230e-04,
          3.9316e-04, 2.5740e-04],
         ...,
         [5.3965e-04, 2.5522e-04, 3.5318e-04,  ..., 3.4301e-04,
          1.3430e-04, 9.9708e-05],
         [9.2356e-04, 6.3173e-04, 7.9593e-04,  ..., 2.8408e-04,
          5.0799e-04, 3.8895e-04],
         [2.6496e-04, 3.7029e-04, 1.2105e-04,  ..., 1.8166e-04,
          4.5643e-04, 4.8089e-04]],

        ...,

        [[4.5493e-04, 2.1579e-04, 5.8382e-04,  ..., 6.2595e-04,
          5.3371e-04, 7.3764e-04],
         [1.1069e-04, 2.4141e-04, 6.8706e-04,  ..., 5.7032e-05,
          7.8673e-03, 8.2587e-03],
         [3.8322e-04, 3.0157e-04, 2.9980e-04,  ..., 5.3459e-04,
          1.2229e-02, 9.0902e-03],
         ...,
         [6.5948e-04, 2.2264e-04, 4.7484e-04,  ..., 6.9283e-04,
          6.8670e-04, 9.9828e-04],
         [5.4260e-04, 3.3784e-04, 4.2101e-04,  ..., 4.4157e-04,
          7.5122e-04, 7.5267e-04],
         [3.3784e-04, 8.1439e-04, 5.6723e-04,  ..., 3.0920e-04,
          6.5733e-04, 4.7670e-04]],

        [[5.8382e-04, 3.8528e-04, 7.3610e-04,  ..., 3.3381e-04,
          7.5362e-03, 5.6425e-04],
         [3.0757e-04, 6.8706e-04, 1.3987e-04,  ..., 8.4661e-04,
          3.8276e-04, 9.4989e-03],
         [2.9980e-04, 7.7082e-03, 4.5703e-04,  ..., 7.1104e-04,
          6.1483e-03, 1.8948e-03],
         ...,
         [4.6086e-04, 2.2264e-04, 3.4948e-04,  ..., 7.7547e-05,
          7.2604e-05, 5.6910e-04],
         [3.9092e-04, 4.2101e-04, 4.2799e-04,  ..., 1.9726e-04,
          3.9823e-04, 4.7986e-04],
         [4.2799e-04, 8.1439e-04, 8.2844e-04,  ..., 5.7208e-04,
          5.8986e-04, 1.0540e-03]],

        [[7.3610e-04, 6.5494e-04, 5.4966e-04,  ..., 6.8628e-04,
          8.1320e-04, 8.9186e-04],
         [1.3987e-04, 8.6563e-04, 2.7237e-04,  ..., 5.3459e-04,
          2.4070e-03, 1.4419e-03],
         [7.7082e-03, 7.4958e-03, 7.1889e-03,  ..., 7.5173e-03,
          7.2202e-03, 8.2338e-03],
         ...,
         [4.6086e-04, 5.4107e-04, 2.3121e-04,  ..., 1.4803e-04,
          9.2739e-04, 6.7789e-04],
         [1.1246e-04, 2.3121e-04, 5.1545e-04,  ..., 7.5491e-04,
          2.7226e-04, 6.6594e-04],
         [8.2844e-04, 5.1545e-04, 6.7530e-04,  ..., 1.1142e-03,
          7.0229e-04, 7.7258e-04]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:3.7985000610351562 loss2:1201.162841796875


loss.item(): 30032.869140625


Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([59, 98]) torch.Size([59, 98, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-8.6976e-01, -9.1162e-02,  9.4271e-01, -6.6558e-01, -1.3971e+00,
          6.2366e-02,  1.0495e+00,  8.5660e+00, -8.8476e+00,  4.6829e+00],
        [ 2.5228e+00,  9.9064e+00,  8.8031e+00,  1.2583e+01,  1.5897e+01,
         -2.5187e+01,  3.3424e+01, -3.3487e+01,  1.9239e+01, -8.3165e+01],
        [ 7.7019e+00, -3.3825e+01,  1.5906e+01, -5.2876e+01,  3.3649e+01,
          5.4975e+01,  1.9303e+01,  1.5457e+02,  7.9030e+01,  2.4650e+01],
        [ 4.6328e+01, -5.8314e+01, -1.1285e+02, -7.9999e+01,  1.4196e+02,
          2.7391e+02, -3.7710e+02,  2.8550e+02, -7.8439e+02,  4.9272e+02],
        [ 4.5177e+01, -9.3690e+01,  5.8616e+01,  2.5878e+02,  3.5233e+02,
          4.2047e+02,  5.1455e+02,  8.0339e+02,  1.3730e+02, -3.9698e+02],
        [-6.2211e+01, -3.1562e+01,  3.0205e+02,  2.0231e+02,  4.8641e+02,
          6.1170e+02,  4.9470e+02,  1.3394e+03,  7.0144e+02,  4.4126e+02],
        [-3.5826e+01,  2.2155e+02,  3.3532e+02,  4.3111e+02,  1.6615e+03,
         -9.1410e+02,  5.2676e+02,  9.1394e+02, -1.3537e+03,  1.4543e+03],
        [-1.3396e+02,  2.0540e+02,  6.2085e+02,  6.7111e+02,  2.0360e+02,
         -9.6915e+03, -8.8123e+02,  1.1044e+03,  5.1849e+02, -7.4130e+02],
        [-1.5788e+02,  1.0908e+02,  5.7350e+02,  9.7873e+02,  3.2644e+02,
          2.8504e+02, -1.0495e+04,  9.8799e+02, -8.3437e+02, -1.1868e+04]]) 

MatU.grad[0:10,35:45]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 6.7691e+01,  2.0946e+02],
         [-3.4356e+01, -8.5918e+01],
         [ 2.1915e+01, -1.5287e+02],
         [ 6.1424e+01,  5.8641e+01],
         [-2.6523e+02, -2.0000e-01],
         [ 1.0611e+02, -4.3646e+01],
         [-9.6602e+01,  4.4539e+02],
         [-1.5349e+02,  5.8834e+01]],

        [[ 9.0408e+02, -1.4772e+02],
         [-7.6094e+02, -3.9173e+02],
         [-7.9076e+02, -4.3962e+02],
         [-9.0183e+02, -1.3411e+02],
         [ 5.0210e+02,  2.1539e+02],
         [ 3.5754e+02, -1.2958e+02],
         [-5.4190e+02, -4.0287e+02],
         [ 7.8095e+02, -1.0087e+02],
         [-9.2720e+02, -4.5391e+02],
         [ 1.0464e+02,  1.0510e+03]],

        [[-1.1928e+03, -1.3990e+03],
         [-3.3636e+02, -8.3324e+02],
         [-1.5317e+03,  5.0574e+02],
         [-8.4884e+02,  6.5328e+02],
         [ 6.6824e+02,  4.0305e+02],
         [-7.6898e+01, -2.4594e+02],
         [-7.7970e+02,  1.9171e+01],
         [ 8.3902e+02, -1.1422e+02],
         [ 7.3672e+02, -3.8883e+01],
         [-1.4714e+03, -3.3484e+02]],

        [[-1.9974e+03,  5.1029e+03],
         [ 1.7523e+03, -2.9094e+03],
         [ 6.0567e+03, -3.1442e+03],
         [ 3.7660e+02,  8.9254e+02],
         [-1.2017e+03,  8.5700e+01],
         [ 2.9848e+01,  1.8535e+03],
         [-1.1834e+03, -7.6148e+02],
         [ 2.0734e+03, -3.4423e+02],
         [ 2.4336e+02,  3.5757e+03],
         [-2.6190e+03, -4.9110e+03]],

        [[-7.6776e+03,  1.0057e+03],
         [ 6.8705e+03,  3.3648e+03],
         [-5.5287e+03, -4.1706e+03],
         [-1.2659e+03, -1.4275e+03],
         [ 1.1194e+03,  2.3210e+00],
         [ 8.2517e+00,  9.8353e+02],
         [ 1.0965e+02,  2.1103e+02],
         [ 4.5547e+02,  1.5081e+00],
         [-1.1660e+03, -2.8907e+02],
         [ 8.6316e+01,  2.2040e+03]],

        [[ 4.8556e+03,  3.4657e+02],
         [ 1.6624e+03, -3.4264e+02],
         [-1.3538e+03,  7.6324e+03],
         [ 5.2578e+02, -1.0424e+03],
         [ 9.2394e+02, -1.6149e+01],
         [-3.5853e+02, -5.1176e+02],
         [-8.1563e+01,  8.9002e+02],
         [ 2.3356e+02, -2.7472e+01],
         [ 4.6554e+02, -8.5217e+01],
         [-2.3749e+02,  1.4181e+03]],

        [[-8.3525e+03,  3.3577e+02],
         [-4.0144e+03,  5.1314e+03],
         [-1.2087e+03, -6.1248e+03],
         [ 1.3001e+03, -9.7581e+02],
         [-2.8326e+02,  7.5204e+02],
         [ 9.0311e+02, -4.8568e+01],
         [-5.2884e+02, -2.4057e+02],
         [ 3.1412e+02, -4.0566e+00],
         [ 6.8740e+02,  9.1212e+01],
         [-1.1504e+03, -1.3877e+03]]]) 

MatD.grad: 
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 1.0406,  ..., 0.0000, 0.0000, 0.0000],
        ...,
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.0271e+02,  3.2502e+01],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-8.7997e+01, -8.8903e+01],
         [ 7.5563e+01,  1.0008e+02],
         [ 7.3821e+01,  1.0191e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 2.8084e+02,  3.3476e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.0857e+02,  8.9705e+00],
         [ 4.0619e+01,  3.3866e+02],
         [ 0.0000e+00,  0.0000e+00],
         [-3.0256e+02, -1.5633e+03],
         [-1.6609e+02,  1.6329e+03],
         [-3.9426e+02, -2.0663e+03],
         [-1.5356e+03, -1.8322e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.0399e+02, -1.5572e+02],
         [ 8.1126e+02,  3.6243e+01],
         [ 2.3921e+02, -5.9873e+02],
         [-3.1071e+03,  4.0991e+03],
         [ 5.5047e+03,  5.9045e+03],
         [ 2.1886e+03,  4.5294e+03],
         [ 2.4229e+03, -7.7448e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-6.6547e+02, -6.5941e+02],
         [ 1.2570e+03,  8.7882e+02],
         [ 5.9166e+03, -2.6551e+03],
         [-7.0928e+03,  4.2694e+03],
         [-7.2737e+03, -3.1135e+03],
         [ 4.4896e+03,  8.6349e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-5.3395e+02, -9.0835e+02],
         [ 6.9966e+02, -2.2847e+03],
         [ 7.0008e+03,  2.1920e+03],
         [-5.7058e+03, -7.8386e+02],
         [-1.0467e+04,  1.8478e+03],
         [ 7.8568e+03, -6.5194e+03]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[ -7186.5054,  -4905.5200],
         [  6081.5659,   7087.9165],
         [   -22.0310,   9240.1260],
         [  6791.3369,  -2992.1555],
         [  3854.2959,    908.9702],
         [ -6304.3135,  -9760.5273],
         [ -5634.2910,   4251.1763],
         [  7462.0903,   3618.7576],
         [ -2526.6755,  -7520.8223],
         [  8320.7158,   1565.8367]],

        [[  3719.9702,  -2757.9050],
         [ -5769.8237,   7057.2402],
         [ -4243.7207,  -5111.3213],
         [ -4808.5210,  -8293.5566],
         [   745.2395,   4176.4326],
         [  8967.5693,   5465.2012],
         [ -8142.9570,  -4145.0142],
         [ -4218.9941,   4685.0649],
         [ -5823.9907,   5976.6074],
         [ -2240.4548,   8429.3232]],

        [[  1992.3999,  -9714.7207],
         [ -1572.3855, -11509.0928],
         [ -5682.8418,    370.1887],
         [  8084.6460,  -3886.0010],
         [ -5851.1143,   4411.8003],
         [  7633.8052,   1707.6914],
         [ -7061.8013,  -7665.7812],
         [ -3108.0002,  -2140.6172],
         [  9922.7529,   3250.2273],
         [  2340.6528, -10355.5820]],

        [[ -1713.9292,  10691.0332],
         [ 11248.4980,   -861.6247],
         [  1387.0229,  -2014.8870],
         [  7043.0898,   4264.3706],
         [ -4893.3779,   7405.9951],
         [   916.2260, -10329.0117],
         [  5251.2407,   5570.7114],
         [  4752.8604,  -8806.4922],
         [  4223.1108,   3716.3228],
         [   280.0376,   6899.7974]],

        [[-11137.9443,  -1701.7581],
         [  8221.9033,   7950.6641],
         [ -2874.1060,   3677.3037],
         [  5535.3604,   5035.6211],
         [ -9016.9336,  -4210.2158],
         [  1271.0725,   2815.0613],
         [ -7715.0762,   5044.6167],
         [ -3874.1160,   2987.0745],
         [ 10434.8828,  -2426.0432],
         [ -3005.8450,  -2437.3730]],

        [[   994.5815,  -9378.6709],
         [ -1579.9921,  -3736.4966],
         [  1904.2834,  -1475.0562],
         [  7675.6748,  -4085.9043],
         [ -6491.0474,  -7529.9717],
         [  -625.2903,  -6094.5288],
         [  6203.6860,   4690.7017],
         [ -6529.0044,  -5669.7812],
         [  8124.1475,  -5428.5664],
         [ -7075.3335,   4042.1099]],

        [[  8189.0371,   6809.9502],
         [  1091.9806, -11422.4424],
         [   376.2392,   7638.8594],
         [ -4258.4009,   2638.4172],
         [  5754.4678,   3987.7336],
         [ -6264.1294,   8049.4287],
         [ -4841.7637,   4133.5356],
         [ -3143.4019,  -7000.0664],
         [ -1024.7711,  -6176.7886],
         [  6103.9619,   1753.4547]],

        [[-11409.4141,  -1392.1185],
         [  2334.6951,  10211.1738],
         [ -6062.4810,  -3859.8633],
         [  5475.5093,  -3947.7754],
         [  3180.5134,  -5889.9399],
         [ -1211.4904,  -6595.9946],
         [  5902.9849,  -5241.9097],
         [ -4581.6333,   6548.8735],
         [  8547.0996,   6802.2236],
         [ -5243.4263,  -7168.7617]],

        [[ -1626.0586,  -9840.0225],
         [  3290.4155,  -2174.6926],
         [ -2820.8723,  -2802.2209],
         [   946.8848, -11270.8799],
         [  2921.1021,   4775.3477],
         [  1872.3330,    297.9674],
         [  6246.5186,   -157.7054],
         [  -559.7130,  -2271.2297],
         [ -3490.0415,   7286.8833],
         [  -970.0410,  -3775.1975]],

        [[  9517.9941,   6295.7891],
         [  4471.4517,   4446.8262],
         [ -8130.8179,   -936.6596],
         [ -3327.1394,   5732.5107],
         [ -1388.2520,   8938.8525],
         [  1008.5573,  -8965.6416],
         [ -2151.8162,   1751.5858],
         [  1237.9479,   8427.8457],
         [  2422.1633,   -440.1587],
         [ -1034.0526,    634.9424]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[ -7168.3970,  -2507.6934],
         [  5798.4849,  -6217.4565],
         [ -4730.4336,  -5963.3745],
         [ -8956.4414,  -6664.9990],
         [ 11179.9082,   4591.3818],
         [  1554.4669,   5605.7314],
         [  5206.3013,   8897.8613],
         [ 10277.8213,   4145.5591],
         [ -6346.5288,  -3571.9832],
         [  1380.6930,  -3206.7075]],

        [[ -4866.5171,   5792.6694],
         [  5986.2598,  -2392.2673],
         [  5775.9609,   6815.9292],
         [ -8526.6084,   4890.6973],
         [  2513.9336,    583.1766],
         [ -7665.2402,   4997.7324],
         [  3299.6641,   3397.4670],
         [ -1005.5516,  -8855.9785],
         [ -4612.5972,    679.1730],
         [  3158.8201,   3865.7244]],

        [[ -6716.9121,  -1018.8895],
         [  8787.8408,  -2035.5441],
         [  3811.9954,   7302.7793],
         [ -8180.8813,   3230.1543],
         [  2241.8330,  -5700.0273],
         [  7976.9395,    -60.1313],
         [ -1213.1694,  -3504.7136],
         [  1562.4614,    517.5567],
         [   176.1787,   -925.1324],
         [  -355.0293,   -993.3832]],

        [[ -2651.8884,   -211.7330],
         [  4837.1821,   2852.8657],
         [  2614.3088,  -8216.7568],
         [   830.3769,   1249.9043],
         [  5746.4790,   4910.1099],
         [  2041.2942,  -7255.4277],
         [  -211.5888,  -2929.1335],
         [   108.0324,  -1493.7809],
         [   -80.4904,  -1261.6332],
         [   -76.5097,    711.6456]],

        [[ -3810.9373,  -4309.4858],
         [  1564.6478,  -5469.9028],
         [  6465.0591,  -4176.7910],
         [ -5791.6143,  -2649.4275],
         [ -6303.0620,  -6786.4868],
         [-10616.0039,    708.6245],
         [   387.1308,   2438.4016],
         [    74.3193,   -301.3738],
         [   626.0958,    654.2955],
         [  -641.5028,   -461.0634]],

        [[ -3676.3213,   -225.4521],
         [  8072.0537,   4035.9573],
         [  -203.1134,   6017.0215],
         [ -6001.0171,  -4850.4468],
         [  9056.3027,  -3601.4006],
         [ -3384.0283,   3268.4124],
         [ -1767.1930,   -115.1944],
         [  1054.4559,    -30.3298],
         [  -444.2228,   -587.9436],
         [  -544.6918,     20.8429]],

        [[  2055.4995,   3571.5112],
         [  6276.1948,   4545.7231],
         [ -2643.1907,   1548.6636],
         [  5100.9824,    335.8382],
         [  3535.2832,   8230.6055],
         [  3421.6643,   2588.5393],
         [   234.1368,  -1780.9712],
         [    19.3682,   -726.4198],
         [    19.6158,   -713.2848],
         [    24.7636,   -287.4984]],

        [[ -1530.9991,  -1186.6049],
         [  3680.9248,  -7696.6567],
         [  -554.1327,  -6969.9302],
         [ -4241.2959,   6055.9976],
         [  -246.6901,  -6581.4370],
         [ -9720.6387,    123.3642],
         [   308.4472,   2142.3083],
         [   706.3626,   -214.8124],
         [  1785.8729,   1053.6616],
         [ -1603.0740,    211.8911]],

        [[  2503.3201,     27.4435],
         [  6876.3872,   3282.8967],
         [  1266.0031,    832.8593],
         [    23.8741,    265.2612],
         [  1940.8281,  -2922.6809],
         [ -1176.6564,  -3880.9971],
         [ -7653.0435,   1826.0404],
         [  4458.2944,   8991.3115],
         [   214.0655,   6613.1406],
         [  -620.3406,    295.7226]],

        [[   606.3939,   9943.2500],
         [   918.8101,   6244.6460],
         [  1383.4330,   8931.3574],
         [ -1737.0607,  -4526.5239],
         [  -696.1185,  -6500.5664],
         [  3668.4131,  -8581.1338],
         [  2078.9993,  -9136.1621],
         [  -860.1213,  -6225.7202],
         [ -1531.6460, -10590.7412],
         [   428.4964,  -8285.2178]]]) 

Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0153,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]],
       grad_fn=<SelectBackward>)

Epoch 3 finished. Total time: 2237.661435365677;  Epoch time: 801.8222126960754 












test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.4055, 0.3921, 0.3878,  ..., 0.2615, 0.2581, 0.2479],
         [0.4069, 0.3925, 0.3886,  ..., 0.2534, 0.2484, 0.2445],
         [0.4077, 0.3932, 0.3897,  ..., 0.2594, 0.2539, 0.2485],
         ...,
         [0.9457, 0.9454, 0.9453,  ..., 0.7548, 0.7546, 0.7545],
         [0.9455, 0.9453, 0.9450,  ..., 0.7548, 0.7547, 0.7540],
         [0.9450, 0.9450, 0.9426,  ..., 0.7538, 0.7538, 0.7528]],

        [[0.9446, 0.9427, 0.9417,  ..., 0.6028, 0.6019, 0.5698],
         [0.9446, 0.9436, 0.9424,  ..., 0.5698, 0.5693, 0.5689],
         [0.9437, 0.9436, 0.9431,  ..., 0.6022, 0.6021, 0.5702],
         ...,
         [0.9457, 0.9457, 0.9456,  ..., 0.7563, 0.7550, 0.7549],
         [0.9456, 0.9456, 0.9455,  ..., 0.7553, 0.7549, 0.7546],
         [0.9456, 0.9456, 0.9450,  ..., 0.7546, 0.7544, 0.7543]],

        [[0.9449, 0.9433, 0.9418,  ..., 0.6375, 0.6349, 0.6324],
         [0.9449, 0.9449, 0.9427,  ..., 0.6375, 0.6365, 0.6044],
         [0.9449, 0.9449, 0.9433,  ..., 0.6395, 0.6384, 0.6378],
         ...,
         [0.9458, 0.9457, 0.9457,  ..., 0.7571, 0.7567, 0.7565],
         [0.9457, 0.9457, 0.9456,  ..., 0.7566, 0.7551, 0.7550],
         [0.9457, 0.9457, 0.9456,  ..., 0.7553, 0.7547, 0.7546]],

        ...,

        [[0.9449, 0.9411, 0.9405,  ..., 0.7524, 0.7243, 0.7235],
         [0.9272, 0.9261, 0.9196,  ..., 0.7402, 0.7124, 0.6930],
         [0.9242, 0.9094, 0.9050,  ..., 0.7173, 0.6795, 0.6747],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.7568, 0.7566, 0.7563],
         [0.9457, 0.9457, 0.9457,  ..., 0.7559, 0.7523, 0.7523],
         [0.9454, 0.9454, 0.9451,  ..., 0.7511, 0.7506, 0.7489]],

        [[0.9405, 0.9382, 0.9376,  ..., 0.7393, 0.7156, 0.7141],
         [0.9235, 0.9196, 0.9179,  ..., 0.7322, 0.7032, 0.6849],
         [0.9054, 0.9051, 0.9050,  ..., 0.7151, 0.6734, 0.6666],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.7551, 0.7497, 0.7483],
         [0.9457, 0.9456, 0.9455,  ..., 0.7514, 0.7499, 0.7492],
         [0.9454, 0.9452, 0.9451,  ..., 0.7491, 0.7487, 0.7481]],

        [[0.9376, 0.9346, 0.9325,  ..., 0.7244, 0.7057, 0.6913],
         [0.9179, 0.9165, 0.9122,  ..., 0.7173, 0.6948, 0.6625],
         [0.9054, 0.9009, 0.8983,  ..., 0.7047, 0.6862, 0.6525],
         ...,
         [0.9458, 0.9456, 0.9451,  ..., 0.7476, 0.7424, 0.7386],
         [0.9455, 0.9451, 0.9446,  ..., 0.7474, 0.7454, 0.7415],
         [0.9451, 0.9446, 0.9403,  ..., 0.7465, 0.7464, 0.7458]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[2.5684e-06, 5.6499e-06, 5.2507e-06,  ..., 4.8279e-06,
          7.2515e-07, 2.9312e-06],
         [1.7386e-05, 1.7373e-05, 1.3480e-05,  ..., 1.7363e-05,
          2.7216e-05, 1.2032e-06],
         [4.8850e-06, 5.9166e-06, 3.6515e-06,  ..., 7.5678e-06,
          9.6304e-06, 3.1540e-06],
         ...,
         [4.0648e-07, 4.8715e-07, 2.5957e-07,  ..., 1.7221e-06,
          8.8793e-07, 2.8918e-07],
         [9.7602e-09, 2.4395e-07, 3.3249e-13,  ..., 1.1951e-06,
          3.2972e-07, 6.7571e-07],
         [3.4812e-09, 2.6531e-08, 3.7769e-08,  ..., 3.9783e-07,
          1.2254e-06, 1.5157e-08]],

        [[1.5574e-07, 1.1416e-06, 2.7289e-07,  ..., 1.5586e-06,
          5.5547e-07, 1.1689e-07],
         [4.9071e-09, 1.8460e-07, 1.7679e-08,  ..., 5.3624e-07,
          1.4852e-06, 8.1910e-07],
         [1.6090e-07, 1.0498e-07, 3.2038e-08,  ..., 7.3748e-07,
          4.5486e-08, 5.5305e-08],
         ...,
         [3.1880e-07, 4.1111e-07, 1.2323e-07,  ..., 1.2664e-06,
          1.0224e-06, 2.2121e-07],
         [1.3225e-08, 1.5594e-07, 7.9569e-08,  ..., 2.6834e-08,
          2.8248e-07, 1.0654e-06],
         [1.1239e-07, 6.9238e-08, 5.3660e-10,  ..., 3.0888e-10,
          1.7215e-07, 2.0271e-07]],

        [[2.2118e-09, 1.8143e-07, 1.1290e-08,  ..., 7.5305e-08,
          7.9475e-08, 1.0595e-06],
         [1.3909e-07, 5.1490e-08, 2.5930e-07,  ..., 7.5798e-07,
          1.4684e-07, 1.4556e-07],
         [1.0269e-07, 3.7384e-08, 4.2166e-08,  ..., 1.3701e-07,
          2.2745e-07, 3.6963e-09],
         ...,
         [2.9094e-08, 3.5255e-07, 1.0048e-08,  ..., 1.2119e-06,
          4.5405e-07, 3.3436e-08],
         [2.4076e-07, 3.2008e-07, 1.1745e-06,  ..., 3.0067e-06,
          1.1687e-06, 9.1394e-07],
         [2.1588e-07, 2.6777e-09, 9.5785e-10,  ..., 2.2731e-06,
          1.8884e-06, 8.1303e-10]],

        ...,

        [[3.7988e-07, 6.7088e-09, 7.2874e-08,  ..., 7.0613e-10,
          4.2535e-06, 2.8205e-06],
         [2.0506e-07, 9.9279e-07, 2.6452e-07,  ..., 1.6216e-07,
          3.0122e-08, 1.5782e-07],
         [7.1630e-06, 6.0086e-07, 2.8859e-07,  ..., 9.4851e-08,
          2.0465e-06, 1.6155e-04],
         ...,
         [1.7591e-07, 8.2321e-08, 3.4723e-08,  ..., 2.1575e-06,
          1.7834e-07, 2.0813e-06],
         [1.0246e-07, 3.0985e-08, 1.8425e-07,  ..., 6.6050e-08,
          3.6424e-08, 7.2160e-07],
         [2.1978e-07, 7.6880e-09, 3.7931e-07,  ..., 9.6145e-07,
          4.5704e-06, 1.0512e-06]],

        [[6.5469e-08, 1.0423e-06, 1.2814e-08,  ..., 4.0627e-06,
          5.3583e-06, 3.1164e-06],
         [3.1679e-06, 7.7324e-07, 5.5933e-09,  ..., 7.2765e-06,
          2.8031e-05, 1.4250e-04],
         [7.1394e-08, 6.8602e-07, 1.0208e-07,  ..., 9.8653e-07,
          1.3886e-06, 6.0124e-05],
         ...,
         [7.2080e-08, 2.4910e-07, 2.8837e-08,  ..., 9.2159e-07,
          9.1112e-07, 1.3552e-06],
         [2.5443e-08, 6.5534e-08, 3.1108e-11,  ..., 1.1670e-07,
          1.7901e-07, 1.6773e-07],
         [1.9540e-07, 3.2891e-07, 7.4896e-08,  ..., 8.5969e-08,
          1.2488e-06, 1.4393e-06]],

        [[3.0692e-08, 1.1315e-12, 3.3554e-06,  ..., 2.8123e-06,
          2.3079e-06, 2.1832e-05],
         [1.5637e-08, 3.6777e-06, 1.3663e-08,  ..., 1.4015e-06,
          1.6475e-06, 4.3532e-05],
         [4.6039e-05, 7.1769e-07, 8.4457e-07,  ..., 5.2917e-05,
          1.8538e-05, 6.7158e-06],
         ...,
         [1.6065e-07, 6.3299e-07, 3.7695e-08,  ..., 4.5932e-07,
          5.7736e-08, 5.2564e-07],
         [9.5639e-08, 9.1470e-08, 3.3472e-07,  ..., 8.5877e-07,
          1.1531e-07, 1.3746e-06],
         [8.1544e-10, 2.3769e-09, 7.9810e-08,  ..., 2.5574e-06,
          3.6417e-06, 2.3313e-08]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[5.5304e-04, 7.0744e-04, 7.4325e-04,  ..., 6.4095e-04,
          2.4486e-04, 3.6227e-04],
         [7.2255e-04, 5.4357e-04, 1.5317e-04,  ..., 1.9107e-04,
          8.0481e-04, 4.2801e-04],
         [7.5866e-04, 2.4611e-04, 9.2966e-04,  ..., 1.5726e-04,
          1.1283e-04, 1.0647e-03],
         ...,
         [2.0472e-05, 4.5755e-04, 4.2050e-04,  ..., 1.4660e-04,
          7.0566e-04, 1.2221e-04],
         [5.0809e-04, 4.2050e-04, 1.9162e-04,  ..., 3.5709e-04,
          3.5142e-04, 8.0074e-05],
         [1.9162e-04, 4.2530e-04, 8.0181e-04,  ..., 9.7088e-04,
          7.1453e-04, 3.1811e-04]],

        [[5.7051e-04, 7.4957e-04, 2.8906e-04,  ..., 4.8742e-04,
          5.1630e-04, 7.0961e-05],
         [5.7051e-04, 1.7898e-04, 8.4579e-04,  ..., 6.2254e-04,
          8.7892e-04, 8.1992e-04],
         [5.1277e-04, 1.7898e-04, 4.5734e-04,  ..., 3.3197e-04,
          2.0541e-04, 6.2926e-04],
         ...,
         [9.2298e-05, 2.0472e-05, 4.6606e-04,  ..., 6.0934e-04,
          5.7073e-04, 9.4934e-05],
         [8.1785e-04, 2.6133e-04, 5.0809e-04,  ..., 4.7178e-04,
          1.8415e-04, 5.3462e-04],
         [3.0458e-04, 2.6133e-04, 4.2530e-04,  ..., 4.2350e-04,
          2.6769e-04, 3.3889e-04]],

        [[5.6430e-04, 1.9393e-04, 4.7980e-04,  ..., 1.2013e-04,
          1.0052e-04, 5.0983e-04],
         [5.6430e-04, 2.5326e-04, 3.4388e-04,  ..., 5.8548e-04,
          3.9853e-04, 2.5408e-04],
         [6.5797e-05, 2.5326e-04, 2.3153e-04,  ..., 4.2608e-04,
          4.9417e-04, 1.7376e-04],
         ...,
         [8.2302e-04, 9.2298e-05, 4.0379e-04,  ..., 5.5486e-04,
          3.8743e-04, 5.7510e-04],
         [9.8500e-04, 7.5536e-04, 7.1946e-04,  ..., 6.9391e-04,
          6.7618e-04, 5.1276e-04],
         [4.4243e-04, 7.5536e-04, 3.0458e-04,  ..., 4.2023e-04,
          7.3154e-04, 7.9924e-04]],

        ...,

        [[5.0193e-04, 5.3697e-04, 3.3334e-04,  ..., 4.7411e-04,
          4.0993e-04, 4.1442e-04],
         [4.6298e-04, 1.4439e-04, 8.1913e-04,  ..., 6.2900e-05,
          7.3286e-03, 7.8282e-03],
         [4.1552e-04, 4.8735e-04, 5.0869e-04,  ..., 4.8292e-04,
          1.1450e-02, 8.6388e-03],
         ...,
         [6.3848e-04, 2.9647e-04, 5.1795e-04,  ..., 9.8896e-04,
          8.2187e-04, 1.2676e-03],
         [2.8751e-04, 1.1835e-04, 6.9346e-04,  ..., 3.3266e-04,
          9.0102e-04, 6.5863e-04],
         [5.1554e-04, 1.0757e-03, 6.2175e-04,  ..., 1.0123e-03,
          8.2821e-04, 5.6641e-04]],

        [[3.3334e-04, 5.6039e-04, 4.8237e-04,  ..., 4.1740e-04,
          6.9369e-03, 2.2864e-04],
         [1.0092e-04, 8.1913e-04, 5.4218e-05,  ..., 6.4111e-04,
          1.9998e-04, 8.7704e-03],
         [7.0579e-03, 1.5920e-04, 5.0869e-04,  ..., 2.8178e-04,
          5.4915e-03, 1.3257e-03],
         ...,
         [2.9647e-04, 5.7117e-04, 6.2665e-04,  ..., 3.7005e-04,
          3.1725e-04, 5.8543e-04],
         [2.8751e-04, 5.0596e-04, 6.3541e-04,  ..., 7.4553e-04,
          6.6412e-04, 3.3400e-04],
         [1.0757e-03, 6.7921e-04, 7.8551e-04,  ..., 5.3102e-04,
          6.1532e-04, 1.2145e-03]],

        [[4.8237e-04, 4.6664e-04, 5.4257e-04,  ..., 5.3504e-04,
          1.7325e-04, 4.7683e-04],
         [5.4218e-05, 5.7236e-04, 3.2782e-04,  ..., 7.0958e-03,
          1.9406e-03, 1.1447e-03],
         [7.0579e-03, 7.0779e-03, 6.8537e-03,  ..., 4.6942e-03,
          6.4731e-03, 7.2344e-03],
         ...,
         [5.7117e-04, 7.2740e-04, 1.4162e-04,  ..., 6.7163e-04,
          9.8426e-04, 8.1279e-04],
         [6.3541e-04, 1.4162e-04, 6.5204e-04,  ..., 9.4287e-04,
          2.9825e-04, 1.0918e-03],
         [7.8551e-04, 6.5204e-04, 7.8162e-04,  ..., 5.1815e-04,
          9.2867e-04, 6.2043e-04]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:4.510725021362305 loss2:1110.5504150390625


loss.item(): 27768.26953125


Finish constructing loss, calculating backward() ... 
