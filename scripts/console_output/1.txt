debug:
MatD.shape: torch.Size([55, 122]) 
 MatD: tensor([[0.0130, 0.0115, 0.0108,  ..., 0.0044, 0.0048, 0.0060],
        [0.0105, 0.0122, 0.0102,  ..., 0.0049, 0.0053, 0.0064],
        [0.0106, 0.0101, 0.0106,  ..., 0.0042, 0.0042, 0.0047],
        ...,
        [0.0200, 0.0200, 0.0196,  ..., 0.0278, 0.0250, 0.0227],
        [0.0192, 0.0196, 0.0196,  ..., 0.0227, 0.0238, 0.0222],
        [0.0196, 0.0192, 0.0200,  ..., 0.0217, 0.0250, 0.0233]])
MatU.shape: torch.Size([55, 122, 2]) 
 MatUx: tensor([[-1.4928e-03, -7.4156e-04, -1.1439e-04,  ...,  4.0241e-04,
          1.2164e-03,  1.2164e-03],
        [ 1.6688e-03, -1.9910e-03,  3.2223e-04,  ...,  4.1719e-04,
          1.0911e-03,  1.0911e-03],
        [-5.3729e-04,  5.3729e-04,  1.0000e-10,  ...,  1.0000e-10,
          5.1074e-04,  5.1074e-04],
        ...,
        [ 1.0000e-10, -3.9216e-04,  8.0032e-04,  ..., -2.7778e-03,
         -2.2727e-03, -2.2727e-03],
        [ 3.7707e-04,  1.0000e-10,  3.9216e-04,  ...,  1.0823e-03,
         -1.5873e-03, -1.5873e-03],
        [-3.7707e-04,  7.6923e-04, -3.9216e-04,  ...,  3.2609e-03,
         -1.7442e-03, -1.7442e-03]])   




test_counter in loss_omega_mat(): 671
test_counter in loss_omega_mat(): 1342
test_counter in loss_omega_mat(): 2013
test_counter in loss_omega_mat(): 2684
test_counter in loss_omega_mat(): 3355
test_counter in loss_omega_mat(): 4026
test_counter in loss_omega_mat(): 4697
mat_omega_topk: tensor([[[0.9458, 0.9458, 0.9457,  ..., 0.8945, 0.8006, 0.8006],
         [0.9458, 0.9458, 0.9457,  ..., 0.8945, 0.8006, 0.8006],
         [0.9458, 0.9458, 0.9457,  ..., 0.8943, 0.8006, 0.8006],
         ...,
         [0.9458, 0.9458, 0.9458,  ..., 0.8946, 0.8004, 0.8004],
         [0.9458, 0.9458, 0.9458,  ..., 0.8945, 0.8005, 0.8004],
         [0.9458, 0.9457, 0.9457,  ..., 0.8942, 0.8005, 0.8004]],

        [[0.9459, 0.9458, 0.9458,  ..., 0.8946, 0.8006, 0.8006],
         [0.9458, 0.9458, 0.9458,  ..., 0.8946, 0.8006, 0.8005],
         [0.9458, 0.9458, 0.9458,  ..., 0.8946, 0.8006, 0.8006],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.8943, 0.8005, 0.8005],
         [0.9458, 0.9457, 0.9457,  ..., 0.8944, 0.8005, 0.8003],
         [0.9456, 0.9454, 0.9453,  ..., 0.8941, 0.8004, 0.8004]],

        [[0.9459, 0.9459, 0.9459,  ..., 0.8947, 0.8007, 0.8006],
         [0.9459, 0.9459, 0.9459,  ..., 0.8946, 0.8007, 0.8006],
         [0.9459, 0.9459, 0.9458,  ..., 0.8946, 0.8006, 0.8006],
         ...,
         [0.9457, 0.9455, 0.9453,  ..., 0.8938, 0.8004, 0.8003],
         [0.9457, 0.9453, 0.9452,  ..., 0.8937, 0.8002, 0.8002],
         [0.9453, 0.9450, 0.9449,  ..., 0.8935, 0.8002, 0.8001]],

        ...,

        [[0.9424, 0.9413, 0.9411,  ..., 0.8885, 0.7965, 0.7952],
         [0.9428, 0.9420, 0.9413,  ..., 0.8886, 0.7975, 0.7958],
         [0.9449, 0.9447, 0.9447,  ..., 0.8897, 0.7995, 0.7991],
         ...,
         [0.9439, 0.9438, 0.9434,  ..., 0.8909, 0.7989, 0.7981],
         [0.9433, 0.9432, 0.9431,  ..., 0.8894, 0.7984, 0.7979],
         [0.9431, 0.9408, 0.9406,  ..., 0.8857, 0.7989, 0.7953]],

        [[0.9451, 0.9436, 0.9431,  ..., 0.8886, 0.7979, 0.7971],
         [0.9432, 0.9431, 0.9428,  ..., 0.8877, 0.7969, 0.7967],
         [0.9447, 0.9432, 0.9431,  ..., 0.8871, 0.7980, 0.7978],
         ...,
         [0.9443, 0.9437, 0.9434,  ..., 0.8905, 0.7989, 0.7986],
         [0.9449, 0.9437, 0.9430,  ..., 0.8890, 0.7999, 0.7981],
         [0.9452, 0.9437, 0.9412,  ..., 0.8860, 0.7998, 0.7989]],

        [[0.9455, 0.9451, 0.9436,  ..., 0.8877, 0.8000, 0.7981],
         [0.9443, 0.9434, 0.9432,  ..., 0.8871, 0.7979, 0.7973],
         [0.9434, 0.9431, 0.9424,  ..., 0.8879, 0.7975, 0.7952],
         ...,
         [0.9453, 0.9450, 0.9449,  ..., 0.8919, 0.8002, 0.7999],
         [0.9451, 0.9450, 0.9450,  ..., 0.8929, 0.8002, 0.7997],
         [0.9452, 0.9451, 0.9451,  ..., 0.8898, 0.8000, 0.7995]]],
       grad_fn=<SliceBackward>) 

mat_duij: tensor([[[3.0525e-06, 4.7106e-08, 4.7106e-08,  ..., 5.0769e-07,
          6.6843e-07, 3.2458e-06],
         [2.4690e-08, 5.1244e-08, 5.1244e-08,  ..., 4.7106e-08,
          1.4783e-06, 8.7114e-11],
         [1.1037e-08, 6.9618e-07, 6.9618e-07,  ..., 2.4843e-07,
          1.5074e-06, 3.5238e-07],
         ...,
         [2.3097e-09, 2.3097e-09, 3.2487e-07,  ..., 1.1499e-06,
          3.0394e-08, 3.8315e-07],
         [3.5542e-07, 4.5480e-07, 1.0861e-06,  ..., 2.1235e-06,
          1.3726e-06, 3.1989e-07],
         [8.3317e-07, 7.0615e-07, 7.9573e-07,  ..., 8.0410e-09,
          3.5209e-07, 3.6244e-06]],

        [[1.3660e-08, 3.2447e-07, 1.3660e-08,  ..., 4.6458e-07,
          8.3333e-07, 3.3007e-07],
         [1.3085e-08, 1.3085e-08, 5.1244e-08,  ..., 1.3418e-06,
          4.0000e-20, 1.3085e-08],
         [4.6066e-08, 1.0825e-07, 1.2540e-08,  ..., 4.3302e-07,
          5.9293e-07, 1.2540e-08],
         ...,
         [2.1168e-07, 5.9369e-07, 2.1168e-07,  ..., 1.0758e-08,
          8.5191e-07, 4.4271e-08],
         [1.2700e-07, 7.8153e-08, 8.2659e-10,  ..., 3.9397e-07,
          2.8820e-08, 1.0761e-07],
         [9.6376e-07, 3.5871e-07, 9.6917e-07,  ..., 3.5213e-06,
          7.5730e-07, 3.7198e-07]],

        [[1.3660e-08, 1.3660e-08, 1.3660e-08,  ..., 1.1291e-07,
          4.0000e-20, 3.1392e-07],
         [4.8024e-08, 1.1532e-08, 1.1532e-08,  ..., 3.0587e-07,
          4.5164e-07, 1.7695e-06],
         [4.3619e-07, 1.8089e-07, 1.4581e-08,  ..., 2.0447e-07,
          3.9799e-08, 9.8876e-07],
         ...,
         [3.1788e-07, 1.8160e-06, 3.8949e-08,  ..., 3.0044e-06,
          2.0679e-06, 2.7617e-06],
         [4.3089e-07, 3.5870e-08, 1.4879e-07,  ..., 1.9809e-06,
          3.6929e-06, 1.0091e-06],
         [7.7969e-06, 2.5696e-06, 1.4837e-06,  ..., 3.2126e-06,
          3.1157e-05, 2.2501e-07]],

        ...,

        [[1.3949e-05, 1.3949e-05, 1.9052e-05,  ..., 3.4135e-05,
          6.2947e-06, 2.1598e-05],
         [1.6207e-05, 1.6207e-05, 1.0023e-05,  ..., 6.0227e-05,
          9.0513e-06, 4.4506e-05],
         [1.2820e-06, 1.2820e-06, 1.0000e-20,  ..., 2.6605e-05,
          5.1279e-06, 1.8716e-07],
         ...,
         [3.5295e-05, 1.5031e-05, 2.0336e-06,  ..., 5.1731e-06,
          6.0073e-06, 4.7484e-05],
         [2.9278e-06, 1.3693e-05, 2.5682e-06,  ..., 9.3046e-07,
          4.4012e-06, 1.2144e-05],
         [3.0475e-06, 1.0821e-05, 8.2047e-07,  ..., 4.9467e-05,
          3.2819e-06, 6.9445e-07]],

        [[2.2746e-10, 2.1948e-06, 2.1948e-06,  ..., 2.7210e-05,
          9.3391e-07, 6.6090e-06],
         [1.5863e-05, 4.7465e-06, 3.0681e-05,  ..., 2.9859e-05,
          8.3573e-06, 1.0040e-04],
         [3.3558e-06, 8.3724e-06, 4.8948e-07,  ..., 2.1926e-05,
          5.7785e-08, 6.4085e-06],
         ...,
         [4.1854e-06, 6.0963e-06, 7.1981e-07,  ..., 1.8050e-08,
          1.4550e-06, 3.9190e-06],
         [3.0246e-06, 3.0246e-06, 1.3140e-06,  ..., 1.1167e-05,
          1.1656e-05, 7.3759e-06],
         [6.9445e-07, 1.8041e-05, 6.9445e-07,  ..., 5.2508e-09,
          8.2047e-07, 3.1467e-05]],

        [[1.5379e-07, 6.9445e-07, 6.1514e-07,  ..., 3.5105e-06,
          6.1514e-07, 1.5379e-07],
         [1.9141e-05, 1.9141e-05, 6.1514e-07,  ..., 6.9854e-05,
          6.9854e-05, 4.0393e-06],
         [6.3452e-05, 1.5863e-05, 1.5863e-05,  ..., 2.1926e-05,
          4.0314e-05, 1.5229e-04],
         ...,
         [2.5237e-07, 6.9445e-07, 6.9445e-07,  ..., 6.6992e-06,
          6.5188e-06, 1.7683e-06],
         [6.9445e-07, 4.4518e-06, 6.9445e-07,  ..., 1.9464e-07,
          1.5379e-07, 1.5123e-05],
         [3.0246e-06, 6.9445e-07, 6.9445e-07,  ..., 5.4210e-20,
          6.9445e-07, 2.7778e-06]]], grad_fn=<CopySlices>) 

mat_uij: tensor([[[1.6839e-03, 5.3579e-04, 6.0414e-04,  ..., 1.2454e-03,
          1.4993e-03, 2.6920e-04],
         [5.3579e-04, 9.9618e-04, 5.5359e-04,  ..., 1.0969e-03,
          1.1929e-03, 1.0216e-03],
         [9.9618e-04, 8.4637e-04, 1.4245e-03,  ..., 9.4588e-04,
          5.2475e-04, 1.4993e-03],
         ...,
         [7.2667e-04, 7.8632e-04, 8.2759e-04,  ..., 1.1969e-03,
          1.0438e-03, 7.3090e-04],
         [3.1729e-04, 7.2667e-04, 4.8135e-04,  ..., 9.0089e-04,
          1.2325e-03, 7.3874e-04],
         [3.1729e-04, 8.4192e-04, 1.1941e-03,  ..., 2.2067e-03,
          1.0167e-03, 1.0438e-03]],

        [[4.8543e-04, 5.6815e-04, 4.8367e-04,  ..., 1.1784e-03,
          3.2014e-04, 7.0936e-04],
         [3.4834e-04, 4.7028e-04, 4.8367e-04,  ..., 1.0861e-03,
          1.1198e-04, 9.7631e-04],
         [3.4834e-04, 5.8443e-04, 8.4637e-04,  ..., 8.0234e-04,
          7.0936e-04, 7.6516e-04],
         ...,
         [3.4364e-04, 7.8632e-04, 7.9062e-04,  ..., 9.9582e-04,
          1.3095e-03, 2.0815e-04],
         [3.4364e-04, 4.4192e-04, 1.0533e-03,  ..., 2.2641e-03,
          5.5815e-04, 1.5299e-03],
         [8.9714e-05, 7.3662e-04, 2.1640e-03,  ..., 1.2837e-03,
          1.0215e-03, 2.1926e-03]],

        [[2.6135e-04, 4.6854e-04, 4.1383e-04,  ..., 7.4329e-04,
          1.1945e-04, 2.3549e-04],
         [4.6854e-04, 6.0097e-04, 6.6648e-04,  ..., 5.6847e-04,
          7.2044e-04, 1.0216e-03],
         [6.0097e-04, 3.1819e-04, 5.8443e-04,  ..., 2.3647e-04,
          5.2475e-04, 2.3549e-04],
         ...,
         [7.9062e-04, 1.8896e-03, 1.1504e-03,  ..., 1.4112e-03,
          9.5217e-04, 4.9821e-04],
         [1.0533e-03, 2.8321e-03, 1.7444e-03,  ..., 2.4937e-03,
          2.1810e-03, 1.0865e-03],
         [2.1640e-03, 4.3940e-03, 3.1527e-03,  ..., 1.7610e-03,
          2.2380e-03, 6.1072e-04]],

        ...,

        [[2.8790e-03, 1.0310e-03, 1.6523e-03,  ..., 1.7823e-03,
          1.9089e-03, 3.2170e-03],
         [2.1706e-03, 2.0482e-03, 1.0310e-03,  ..., 2.2721e-03,
          4.0425e-03, 2.6081e-03],
         [6.9963e-04, 1.3310e-03, 1.1510e-03,  ..., 2.8938e-03,
          3.1725e-04, 1.6236e-03],
         ...,
         [5.0895e-03, 6.3275e-03, 3.6810e-03,  ..., 5.5320e-03,
          3.4019e-03, 6.0182e-03],
         [2.3515e-03, 5.7702e-03, 2.6554e-03,  ..., 5.9291e-03,
          1.1774e-03, 2.6603e-03],
         [2.6554e-03, 3.7062e-03, 2.7957e-03,  ..., 5.4876e-03,
          3.4019e-03, 7.2462e-05]],

        [[1.9014e-03, 7.9989e-04, 1.9342e-03,  ..., 2.2721e-03,
          2.8128e-03, 1.1578e-03],
         [2.4494e-03, 1.9342e-03, 2.1706e-03,  ..., 2.7283e-03,
          3.3106e-03, 3.1403e-03],
         [1.3310e-03, 2.4494e-03, 1.3537e-03,  ..., 3.3066e-03,
          2.0812e-03, 4.9259e-04],
         ...,
         [2.2956e-03, 4.4749e-04, 3.6810e-03,  ..., 3.0795e-03,
          3.4487e-03, 1.2822e-03],
         [2.5092e-03, 4.2365e-03, 3.0224e-03,  ..., 2.5121e-03,
          3.2048e-03, 3.4697e-03],
         [2.7273e-03, 4.2365e-03, 1.1428e-03,  ..., 5.0828e-03,
          1.9609e-03, 3.4487e-03]],

        [[3.9216e-04, 6.2540e-04, 7.9989e-04,  ..., 2.7283e-03,
          5.5459e-04, 1.6645e-03],
         [3.6120e-03, 5.3625e-03, 3.6120e-03,  ..., 3.3066e-03,
          3.6120e-03, 3.1499e-03],
         [5.3625e-03, 1.6633e-03, 4.0021e-03,  ..., 3.3152e-03,
          3.1517e-03, 4.0021e-03],
         ...,
         [1.0019e-03, 1.8054e-03, 1.5542e-03,  ..., 2.3070e-03,
          3.9216e-04, 2.7021e-03],
         [0.0000e+00, 1.8054e-03, 2.0588e-03,  ..., 9.1657e-04,
          1.2259e-03, 2.4151e-03],
         [2.7273e-03, 8.3333e-04, 0.0000e+00,  ..., 7.2462e-05,
          9.0869e-04, 0.0000e+00]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:361.84942626953125
t:0, Finish constructing loss
require grad ? True True False
MatD grad and MatUx grad: torch.Size([55, 122]) torch.Size([55, 122, 2]) 

MatD.grad: tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0011,  ...,  0.0034,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0159,  ..., -0.0032,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: tensor([[[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   8.2434,  -26.7819],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -14.4226,  -27.7909],
         [ -21.2554,  -60.6669],
         [  11.1104,  -76.2221],
         [ -41.0924,  -72.6599],
         [  32.4272,  -37.0012],
         [ -70.0381,   10.6973],
         [  84.6332,   27.9567]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -87.7286,  -27.6336],
         [ 277.0150,  335.8332],
         [ 157.8942,  279.6469],
         [-392.2069,  109.7473],
         [ 311.4900,  364.8397],
         [-318.5057, -209.7336],
         [ -77.2894,  393.3138]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -19.8137,  -19.8137],
         [-107.9814,  -42.0147],
         [ 235.8825,  182.7157],
         [ 107.5662,  -76.5289],
         [ 230.3810, -420.2605],
         [-393.3457, -281.4543],
         [ 524.0185,    0.8830],
         [-339.9969, -487.0916]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,   28.0243],
         [  68.3608,   -2.4610],
         [  -9.8875,  -71.7535],
         [-378.5028, -361.5365],
         [  72.6425,  451.9904],
         [-180.7674, -174.9291],
         [-147.5743,  433.1414],
         [-120.0312,    8.9251]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  82.6888,   25.9437],
         [-176.9458,  250.9576],
         [ 185.6121, -400.8556],
         [-385.7838,  397.4768],
         [ 452.1461,   -7.7220],
         [-376.8358, -525.0232],
         [  81.7267,  374.1667]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  88.2326,  -19.6274],
         [-426.4770, -165.2494],
         [ 594.0566, -109.5521],
         [-427.7379, -274.0957],
         [-109.1827,   95.9592],
         [ 344.9978, -264.0450],
         [-329.7517,   30.1288]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  67.7615,  -53.6071],
         [-335.7918,   61.1103],
         [ 346.0919, -152.4985],
         [ -67.0492, -289.7582],
         [-395.5011,  165.8901],
         [ 249.9027,  322.0029],
         [ 489.6053, -154.7839]]]) 

MatU.grad[10:20,10:20]: tensor([[[-3.7440e+02,  2.5908e+02],
         [ 3.4074e+02, -1.3784e+02],
         [-2.2742e+02,  2.2922e+02],
         [-6.8401e+00,  6.0329e+01],
         [ 4.7142e+01,  1.2640e+02],
         [ 3.9576e+02, -1.8658e+02],
         [-4.3826e+02,  3.3584e+01],
         [ 1.3730e+02,  9.3278e+01],
         [-3.2476e+02, -6.8903e+01],
         [ 2.1310e+02,  4.6270e+02]],

        [[-5.1841e+02, -3.3399e+02],
         [ 4.3165e+02,  3.5467e+02],
         [-3.3520e+02, -8.8316e+01],
         [ 3.0984e+01,  4.4861e+02],
         [-2.2620e+02, -1.5972e+02],
         [ 3.7829e+02,  2.3400e+01],
         [-1.9864e+02, -5.3211e+02],
         [-2.3271e+01,  1.5573e+02],
         [ 2.2665e+02,  3.2701e+02],
         [-3.0853e+01, -6.0795e+02]],

        [[-5.9929e+01,  1.7633e+02],
         [-1.5192e+02,  1.5119e+01],
         [ 3.4532e+02,  1.9459e+02],
         [-5.5278e+02, -2.4240e+02],
         [-6.9256e+01,  5.2162e+02],
         [-1.1253e+02,  3.5844e+02],
         [ 2.4573e+02,  5.0124e+02],
         [ 1.4946e+02, -4.7035e+02],
         [-5.8738e+02, -1.6340e+02],
         [ 2.6235e+02,  5.0156e+02]],

        [[-2.4036e+02, -4.7936e+02],
         [ 3.3736e+02, -2.7166e+02],
         [-3.6500e+02, -1.3554e+02],
         [ 3.0701e+02,  1.5916e+02],
         [-2.3112e+02, -3.9747e+01],
         [ 1.4757e+02,  1.1768e+02],
         [-5.3134e+02, -7.8741e+01],
         [ 3.7052e+02, -1.0048e+01],
         [ 4.9650e+01, -2.8617e+02],
         [-1.7852e+02,  1.8325e+01]],

        [[-1.0644e+02,  4.1471e+02],
         [ 4.8269e+02,  3.8753e+02],
         [-6.5338e+01, -1.9021e+02],
         [ 2.1225e+02, -6.3617e+01],
         [-2.4778e+01, -8.2463e+01],
         [-2.3327e+02, -3.8335e+02],
         [-4.1318e+02, -5.5250e+01],
         [ 1.8136e+02,  4.3373e+02],
         [ 3.0121e+02,  2.8827e+02],
         [-4.5155e+02, -1.3942e+02]],

        [[-2.0459e+01, -1.3351e+02],
         [-8.7867e+01, -1.1561e+02],
         [ 5.9724e+01, -3.6280e+01],
         [ 2.5901e+02,  1.0965e+01],
         [-3.2047e+02, -4.5259e+02],
         [-7.1805e+01,  1.6795e+02],
         [-1.5352e+02,  1.8662e+02],
         [ 1.8567e+01,  2.8970e+02],
         [-3.2133e+02,  3.7860e+02],
         [ 4.4202e+02, -1.8914e+02]],

        [[ 1.9439e+01, -8.5865e+00],
         [ 2.7646e+01, -3.7826e-01],
         [ 1.4828e+02,  1.9438e+01],
         [-5.0243e+02,  5.0976e+01],
         [ 3.5474e+02, -4.4678e+01],
         [ 1.2581e+02,  2.2664e+02],
         [ 3.4759e+02, -4.4908e+02],
         [ 8.0378e+01, -3.3508e+02],
         [-4.9663e+02, -3.2152e+02],
         [ 3.8096e+02,  1.2303e+02]],

        [[ 1.9439e+01,  1.9439e+01],
         [ 1.9439e+01,  1.9439e+01],
         [ 2.1092e+02,  1.9438e+01],
         [-5.8850e+02, -9.4655e+00],
         [ 5.5324e+02,  2.2618e+02],
         [-5.8766e+02, -2.8873e+02],
         [ 3.8248e+02,  3.8455e+02],
         [-2.4023e+02,  7.1779e+01],
         [-1.9023e+02,  4.6702e+02],
         [-6.0557e+01,  2.9722e+02]],

        [[ 1.9439e+01,  8.2077e+01],
         [ 2.6036e+01,  1.2842e+01],
         [ 2.1092e+02,  1.9438e+01],
         [-2.8539e+02,  4.4348e+01],
         [-8.8692e+01, -3.5921e+01],
         [-2.3043e+01,  2.9904e+02],
         [ 8.9450e+01,  2.4210e+00],
         [ 5.8766e+02,  1.4705e+02],
         [-3.8893e+02, -3.5272e+02],
         [ 3.6152e+02, -1.7654e+02]],

        [[-5.3690e+01,  1.1332e+02],
         [ 2.6036e+01,  4.0867e+01],
         [ 2.6680e+02,  4.1167e+01],
         [-3.9450e+02,  3.3949e+01],
         [ 2.7561e+02, -1.4135e+02],
         [-3.3336e+02, -6.3711e+00],
         [ 4.0969e+02, -6.7020e+01],
         [ 7.6795e+01, -4.6176e+02],
         [-2.5173e+02, -3.4113e+02],
         [ 3.9456e+02, -1.4605e+01]]]) 

MatU.grad[20:30,20:30]:  tensor([[[  71.8929,  411.3469],
         [-431.1114,  281.0072],
         [ -82.8471,  549.9717],
         [ 367.5332,  452.3549],
         [  33.3231,  191.1270],
         [-388.0816,  240.2012],
         [ 572.2632,   66.4062],
         [-197.5195, -412.2442],
         [-403.9071, -233.2500],
         [ 450.3151,  200.8209]],

        [[ 118.0487,   -2.3944],
         [ 405.8083, -336.6762],
         [ -59.7689, -599.9377],
         [-102.1749, -439.4637],
         [  -1.5453, -378.6924],
         [-409.4293, -358.8900],
         [ 315.7964,  189.5188],
         [  26.2328, -413.0199],
         [ 131.4319, -130.0295],
         [ -21.4118,  433.9216]],

        [[-305.0222, -215.5539],
         [-462.8045,   73.1550],
         [ 131.9863,  304.6233],
         [ 140.4590,   -8.6726],
         [  78.2878,  610.9185],
         [ 106.5162,  253.8360],
         [-324.1706,  -93.2016],
         [  43.7138,  529.8177],
         [ 392.5799,  435.5991],
         [-298.2386, -401.3481]],

        [[ 107.6413,  481.0048],
         [-241.4999,  355.4357],
         [-260.0898, -199.6254],
         [ 598.6940,  190.5568],
         [-362.2026, -512.0146],
         [-334.2593, -217.3222],
         [ 596.8870,   81.4544],
         [ 196.0536, -471.4843],
         [-421.0904, -433.1926],
         [-229.1611, -160.4564]],

        [[ -95.0603, -389.2314],
         [-360.6286, -485.6750],
         [ 245.5186,   89.0885],
         [-236.6392,  216.8079],
         [ 178.4537,  267.9821],
         [  60.7584,  207.4030],
         [  31.1875, -342.4353],
         [ -22.9647,   27.8988],
         [-185.1917,  420.6018],
         [  66.0407,  443.0984]],

        [[-384.5996,  -45.9775],
         [ 344.7473,    8.0973],
         [ 354.5758,   68.5572],
         [-270.5384, -397.4230],
         [ 143.1140, -557.8541],
         [-399.0326, -233.3461],
         [ 183.9003,  611.3515],
         [ 416.4691,  275.4779],
         [ -90.4153, -576.8116],
         [-246.3996, -226.5774]],

        [[-386.5713,  188.1760],
         [ 205.1535,  549.4082],
         [ -80.8638,  -74.1499],
         [-537.7294,  -51.7637],
         [ 256.5131,  541.5721],
         [ 547.9148,  163.0336],
         [-127.8227, -120.5219],
         [-505.2110, -224.0644],
         [ 465.9404,  145.0826],
         [-179.7950, -209.0981]],

        [[  97.8294,  -51.8656],
         [-529.2202, -230.6852],
         [ -23.3930,  446.9818],
         [ 247.7133,  136.7450],
         [ -19.5842, -238.4968],
         [ 291.2466, -216.2304],
         [-219.7025, -555.0639],
         [-159.7151,  224.9505],
         [  86.0160,  229.4617],
         [ 169.1188,  567.2178]],

        [[-294.8120, -422.6062],
         [ 306.2419,   90.1564],
         [-401.1770, -265.5277],
         [-134.1267,   30.4085],
         [  -8.8138,   13.3597],
         [-364.7153,  430.4828],
         [ 399.7776,  523.7211],
         [  11.2810, -310.3284],
         [ 310.2840, -368.6057],
         [-205.1370,  255.5353]],

        [[ 326.1305,   68.4658],
         [ -96.1839, -367.0756],
         [-274.2612,  -45.8917],
         [-278.0540,  251.5905],
         [ 420.1895,  389.4992],
         [  97.6465, -366.5350],
         [-497.5321, -261.5197],
         [ -78.4911,   65.7641],
         [ 605.9914,  149.6310],
         [-382.1125, -428.2687]]]) 

t:0, loss.item(): 3618.494140625
Optimized result :
 MatD: tensor([[0.0130, 0.0115, 0.0108,  ..., 0.0044, 0.0048, 0.0060],
        [0.0105, 0.0122, 0.0102,  ..., 0.0049, 0.0053, 0.0064],
        [0.0106, 0.0101, 0.0096,  ..., 0.0032, 0.0042, 0.0047],
        ...,
        [0.0200, 0.0200, 0.0186,  ..., 0.0288, 0.0250, 0.0227],
        [0.0192, 0.0196, 0.0196,  ..., 0.0227, 0.0238, 0.0222],
        [0.0196, 0.0192, 0.0200,  ..., 0.0217, 0.0250, 0.0233]],
       requires_grad=True) 
MatUx: tensor([[-1.4928e-03, -7.4156e-04, -1.1439e-04,  ...,  4.0241e-04,
          1.2164e-03,  1.2164e-03],
        [ 1.6688e-03, -1.9910e-03,  3.2223e-04,  ...,  4.1719e-04,
          1.0911e-03,  1.0911e-03],
        [-5.3729e-04,  5.3729e-04,  1.0000e-10,  ...,  1.0000e-10,
          5.1074e-04,  5.1074e-04],
        ...,
        [ 1.0000e-10, -3.9216e-04,  8.0032e-04,  ..., -2.7778e-03,
         -2.2727e-03, -2.2727e-03],
        [ 3.7707e-04,  1.0000e-10,  3.9216e-04,  ...,  1.0823e-03,
         -1.5873e-03, -1.5873e-03],
        [-3.7707e-04,  7.6923e-04, -3.9216e-04,  ...,  3.2609e-03,
         -1.7442e-03, -1.7442e-03]], grad_fn=<SelectBackward>)  




 
test_counter in loss_omega_mat(): 671
test_counter in loss_omega_mat(): 1342
test_counter in loss_omega_mat(): 2013
test_counter in loss_omega_mat(): 2684
test_counter in loss_omega_mat(): 3355
test_counter in loss_omega_mat(): 4026
test_counter in loss_omega_mat(): 4697
mat_omega_topk: tensor([[[0.9452, 0.9452, 0.9448,  ..., 0.8927, 0.8003, 0.8000],
         [0.9454, 0.9452, 0.9441,  ..., 0.8921, 0.8000, 0.7998],
         [0.9454, 0.9454, 0.9442,  ..., 0.8925, 0.8001, 0.8000],
         ...,
         [0.9449, 0.9442, 0.9442,  ..., 0.8932, 0.7994, 0.7994],
         [0.9450, 0.9449, 0.9445,  ..., 0.8931, 0.7995, 0.7994],
         [0.9452, 0.9450, 0.9450,  ..., 0.8933, 0.8004, 0.7999]],

        [[0.9449, 0.9447, 0.9447,  ..., 0.8931, 0.7997, 0.7995],
         [0.9453, 0.9446, 0.9442,  ..., 0.8931, 0.7999, 0.7997],
         [0.9453, 0.9448, 0.9442,  ..., 0.8929, 0.8000, 0.7999],
         ...,
         [0.9449, 0.9448, 0.9446,  ..., 0.8931, 0.7995, 0.7991],
         [0.9449, 0.9449, 0.9449,  ..., 0.8930, 0.7997, 0.7992],
         [0.9450, 0.9450, 0.9450,  ..., 0.8930, 0.8000, 0.7991]],

        [[0.9447, 0.9446, 0.9444,  ..., 0.8930, 0.7998, 0.7992],
         [0.9448, 0.9446, 0.9442,  ..., 0.8931, 0.7999, 0.7998],
         [0.9449, 0.9446, 0.9443,  ..., 0.8932, 0.8000, 0.8000],
         ...,
         [0.9449, 0.9449, 0.9448,  ..., 0.8930, 0.7997, 0.7996],
         [0.9452, 0.9450, 0.9449,  ..., 0.8934, 0.8000, 0.7999],
         [0.9453, 0.9452, 0.9450,  ..., 0.8936, 0.7999, 0.7996]],

        ...,

        [[0.9443, 0.9438, 0.9426,  ..., 0.8894, 0.7978, 0.7976],
         [0.9444, 0.9439, 0.9432,  ..., 0.8905, 0.7984, 0.7978],
         [0.9446, 0.9445, 0.9444,  ..., 0.8910, 0.8000, 0.7997],
         ...,
         [0.9454, 0.9451, 0.9436,  ..., 0.8915, 0.7996, 0.7988],
         [0.9454, 0.9444, 0.9443,  ..., 0.8912, 0.7996, 0.7981],
         [0.9443, 0.9418, 0.9404,  ..., 0.8828, 0.7988, 0.7964]],

        [[0.9448, 0.9445, 0.9443,  ..., 0.8905, 0.7978, 0.7975],
         [0.9444, 0.9442, 0.9438,  ..., 0.8907, 0.7984, 0.7977],
         [0.9445, 0.9437, 0.9434,  ..., 0.8895, 0.7987, 0.7984],
         ...,
         [0.9455, 0.9452, 0.9450,  ..., 0.8920, 0.7999, 0.7998],
         [0.9455, 0.9454, 0.9453,  ..., 0.8924, 0.8001, 0.8001],
         [0.9453, 0.9453, 0.9418,  ..., 0.8833, 0.7999, 0.7998]],

        [[0.9454, 0.9453, 0.9445,  ..., 0.8907, 0.7998, 0.7981],
         [0.9447, 0.9444, 0.9442,  ..., 0.8895, 0.7985, 0.7974],
         [0.9441, 0.9435, 0.9426,  ..., 0.8902, 0.7982, 0.7972],
         ...,
         [0.9453, 0.9452, 0.9450,  ..., 0.8935, 0.7998, 0.7998],
         [0.9455, 0.9454, 0.9454,  ..., 0.8937, 0.8000, 0.7997],
         [0.9454, 0.9454, 0.9453,  ..., 0.8883, 0.7998, 0.7995]]],
       grad_fn=<SliceBackward>) 

mat_duij: tensor([[[1.5697e-06, 6.1303e-07, 1.5342e-06,  ..., 1.6576e-06,
          4.8329e-06, 2.7454e-06],
         [5.9850e-07, 1.3389e-06, 5.9850e-07,  ..., 3.1790e-06,
          7.8533e-07, 8.7105e-11],
         [2.7431e-08, 1.2212e-06, 4.6899e-06,  ..., 5.4807e-07,
          3.7390e-06, 5.9637e-07],
         ...,
         [9.0619e-07, 4.7035e-06, 9.0619e-07,  ..., 4.0873e-09,
          3.2271e-06, 3.0395e-08],
         [1.6308e-07, 1.6308e-07, 3.8332e-06,  ..., 6.4929e-06,
          7.8151e-07, 6.6101e-07],
         [2.5496e-08, 4.4435e-06, 4.3565e-06,  ..., 1.2276e-06,
          1.2177e-06, 4.8981e-06]],

        [[5.9067e-06, 7.7991e-07, 2.5319e-06,  ..., 1.1782e-07,
          1.0266e-05, 3.3007e-07],
         [1.2419e-06, 7.6930e-06, 1.2419e-06,  ..., 7.0839e-07,
          5.4905e-06, 1.5154e-05],
         [6.1681e-07, 4.5021e-07, 7.1341e-06,  ..., 1.8009e-06,
          3.5555e-06, 3.5646e-06],
         ...,
         [4.9706e-06, 2.9151e-07, 6.4512e-06,  ..., 1.2193e-05,
          3.2026e-06, 1.1611e-05],
         [9.4333e-07, 1.6373e-06, 8.8283e-06,  ..., 1.2328e-05,
          4.7079e-06, 1.0102e-06],
         [2.4139e-10, 4.0624e-06, 4.0735e-06,  ..., 4.5092e-06,
          4.3610e-06, 7.5730e-07]],

        [[6.4510e-06, 7.7991e-07, 8.3124e-06,  ..., 4.4812e-06,
          3.1392e-07, 2.3247e-06],
         [1.2263e-06, 7.9676e-07, 3.0979e-07,  ..., 8.9652e-06,
          2.4690e-08, 7.1277e-06],
         [3.3027e-07, 5.4735e-06, 3.3027e-07,  ..., 1.2587e-05,
          7.3951e-07, 4.8378e-06],
         ...,
         [1.2082e-07, 1.2082e-07, 1.9026e-07,  ..., 4.8063e-06,
          3.2832e-09, 1.2287e-06],
         [1.4147e-06, 6.5708e-07, 3.7733e-07,  ..., 4.6684e-06,
          4.3193e-06, 4.3213e-06],
         [3.6359e-07, 3.1753e-06, 3.2123e-06,  ..., 3.4510e-07,
          2.5022e-06, 3.0983e-06]],

        ...,

        [[7.4793e-06, 9.3650e-08, 2.2419e-05,  ..., 5.6297e-07,
          4.0062e-05, 2.0330e-05],
         [9.1553e-06, 1.0520e-09, 1.0522e-06,  ..., 3.3184e-05,
          1.0172e-06, 7.1357e-06],
         [1.0000e-06, 1.7489e-08, 1.7489e-08,  ..., 9.9730e-06,
          6.9956e-08, 1.2726e-05],
         ...,
         [1.8150e-07, 7.6914e-07, 5.8856e-06,  ..., 2.6693e-05,
          8.3571e-06, 2.0338e-07],
         [4.9066e-07, 3.6308e-07, 3.6308e-07,  ..., 8.7889e-07,
          9.5854e-09, 2.2048e-06],
         [5.5610e-07, 8.8743e-09, 8.3795e-08,  ..., 9.2006e-06,
          3.5497e-08, 6.9445e-07]],

        [[1.0304e-06, 2.3182e-07, 1.6997e-06,  ..., 2.7210e-05,
          3.2582e-07, 9.2028e-06],
         [2.0603e-05, 8.8974e-06, 1.0104e-05,  ..., 2.9859e-05,
          3.6238e-05, 2.3921e-05],
         [1.3645e-06, 9.0223e-08, 1.5159e-05,  ..., 2.1926e-05,
          5.0193e-06, 2.1565e-06],
         ...,
         [1.0938e-06, 9.1045e-07, 2.8189e-07,  ..., 1.8050e-08,
          1.4550e-06, 9.2242e-07],
         [2.1405e-08, 5.4632e-07, 5.4631e-07,  ..., 7.7467e-07,
          1.6490e-06, 1.1656e-05],
         [2.7778e-08, 1.5562e-06, 6.5868e-07,  ..., 3.7154e-06,
          2.5906e-06, 1.1973e-06]],

        [[1.9381e-06, 3.3611e-06, 3.1838e-06,  ..., 1.5005e-05,
          7.7524e-06, 1.3017e-05],
         [1.1391e-05, 3.1838e-06, 1.6583e-05,  ..., 6.9854e-05,
          1.6079e-05, 4.0422e-05],
         [2.4658e-05, 2.4829e-05, 8.8974e-06,  ..., 2.1926e-05,
          4.0314e-05, 6.9567e-05],
         ...,
         [2.7778e-08, 2.9870e-09, 2.2571e-06,  ..., 3.4608e-07,
          4.4919e-07, 1.5216e-07],
         [4.6944e-06, 2.7777e-08, 5.3255e-08,  ..., 4.0000e-06,
          1.2345e-08, 5.7224e-06],
         [2.7777e-08, 4.6944e-06, 5.4631e-07,  ..., 4.0000e-06,
          1.1167e-06, 1.0028e-05]]], grad_fn=<CopySlices>) 

mat_uij: tensor([[[1.3793e-03, 5.3579e-04, 1.1684e-03,  ..., 9.8216e-04,
          1.7445e-03, 8.0903e-04],
         [1.1111e-03, 5.3579e-04, 1.5915e-03,  ..., 1.7462e-03,
          1.7111e-03, 1.8122e-03],
         [1.0575e-03, 1.1111e-03, 2.0156e-03,  ..., 2.2385e-03,
          8.6026e-04, 1.4896e-03],
         ...,
         [1.3147e-03, 1.6116e-03, 7.2667e-04,  ..., 1.5339e-03,
          9.2227e-04, 9.6602e-04],
         [1.6835e-03, 1.7114e-03, 2.3924e-03,  ..., 1.4170e-03,
          1.8037e-03, 1.6341e-03],
         [1.1608e-03, 8.9714e-05, 1.6835e-03,  ..., 1.1678e-03,
          6.6271e-04, 2.0645e-03]],

        [[2.2669e-03, 2.3430e-03, 6.0414e-04,  ..., 1.8745e-03,
          1.6201e-03, 1.3469e-03],
         [3.4834e-04, 1.6914e-03, 1.7044e-03,  ..., 1.3818e-03,
          4.0074e-04, 7.4253e-04],
         [3.4834e-04, 1.0905e-03, 1.4688e-03,  ..., 1.2466e-03,
          1.3522e-03, 2.0636e-03],
         ...,
         [1.3147e-03, 7.9062e-04, 3.4364e-04,  ..., 1.4170e-03,
          1.8918e-03, 1.8070e-03],
         [2.1189e-03, 1.7114e-03, 1.3138e-03,  ..., 9.8677e-04,
          2.4188e-03, 1.2531e-03],
         [1.9813e-03, 6.6916e-04, 8.9714e-05,  ..., 7.2553e-04,
          1.0714e-03, 1.8070e-03]],

        [[2.3430e-03, 1.7903e-03, 1.7701e-03,  ..., 2.6613e-03,
          2.7482e-03, 1.3697e-03],
         [1.4940e-03, 2.2822e-03, 1.7044e-03,  ..., 1.8745e-03,
          5.1629e-04, 1.8122e-03],
         [1.6820e-03, 2.2822e-03, 2.5459e-03,  ..., 1.7854e-03,
          1.9782e-03, 1.4896e-03],
         ...,
         [2.1356e-03, 3.3116e-04, 7.9062e-04,  ..., 9.8677e-04,
          1.1666e-03, 7.0460e-04],
         [1.0125e-03, 7.4865e-04, 3.3116e-04,  ..., 1.0106e-03,
          7.1258e-04, 6.7515e-04],
         [1.7274e-03, 1.0125e-03, 1.9813e-03,  ..., 1.3207e-03,
          2.0645e-03, 7.0460e-04]],

        ...,

        [[1.6505e-03, 5.2406e-03, 1.2742e-03,  ..., 3.2390e-03,
          2.1462e-03, 1.9089e-03],
         [1.5770e-03, 1.1358e-03, 1.6352e-03,  ..., 3.8578e-04,
          2.0982e-03, 6.5528e-04],
         [8.9211e-04, 1.5633e-03, 1.3004e-03,  ..., 2.1514e-03,
          1.8090e-03, 1.6267e-03],
         ...,
         [3.3144e-03, 3.6080e-03, 2.4439e-03,  ..., 3.2408e-03,
          3.1950e-03, 2.6548e-03],
         [3.3144e-03, 3.1423e-04, 6.6706e-04,  ..., 2.4352e-03,
          1.1774e-03, 6.8627e-04],
         [6.6706e-04, 1.1119e-03, 3.7062e-03,  ..., 5.2310e-03,
          2.6548e-03, 7.2462e-05]],

        [[9.5299e-04, 1.3606e-03, 1.6505e-03,  ..., 3.8578e-04,
          9.9152e-04, 7.9107e-04],
         [1.5770e-03, 1.2933e-03, 1.9342e-03,  ..., 1.1992e-03,
          1.8621e-03, 1.9557e-03],
         [1.5633e-03, 1.0941e-03, 2.4494e-03,  ..., 3.3066e-03,
          1.0696e-03, 1.5074e-03],
         ...,
         [1.2622e-03, 9.0647e-04, 4.4749e-04,  ..., 1.1700e-03,
          1.5039e-03, 4.5042e-04],
         [1.2622e-03, 5.1239e-04, 1.5028e-03,  ..., 3.1599e-03,
          1.6746e-03, 2.5084e-03],
         [1.0715e-03, 1.5028e-03, 1.1119e-03,  ..., 5.0828e-03,
          1.5039e-03, 2.0547e-03]],

        [[3.9216e-04, 1.6180e-03, 1.3606e-03,  ..., 1.1992e-03,
          5.5459e-04, 2.2808e-03],
         [1.6383e-03, 1.6383e-03, 1.2933e-03,  ..., 3.3066e-03,
          2.2626e-03, 1.6383e-03],
         [2.5420e-03, 1.6633e-03, 2.0213e-03,  ..., 1.3629e-03,
          8.0323e-04, 2.0213e-03],
         ...,
         [1.4673e-03, 9.0647e-04, 1.0019e-03,  ..., 5.4134e-04,
          7.9959e-04, 1.4673e-03],
         [2.0009e-03, 0.0000e+00, 5.1239e-04,  ..., 2.3154e-03,
          9.7139e-04, 2.1140e-03],
         [0.0000e+00, 2.3154e-03, 1.0715e-03,  ..., 1.6369e-03,
          1.4673e-03, 1.0966e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:nan loss2:nan
t:1, Finish constructing loss
require grad ? True True False
MatD grad and MatUx grad: torch.Size([55, 122]) torch.Size([55, 122, 2]) 

MatD.grad: tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0015,  ...,  0.0199,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0204,  ..., -0.0442,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: tensor([[[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   1.2715,   27.9809],
         [  27.7981,    3.3690],
         [ -26.6505,   -8.5953],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  25.5852,   18.0209],
         [  89.9957,   16.9040],
         [ -20.9204,   62.1042],
         [  70.4148,   82.1354],
         [-102.3097,   58.6856],
         [ -39.1744,  -76.1690],
         [  31.5311,  -25.0414]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  21.4945,   17.9421],
         [  24.7238,   59.3333],
         [   3.8911, -112.5825],
         [-240.6542, -222.9505],
         [ 334.1509, -314.1658],
         [-161.6529,  -84.0441],
         [-120.1700,  302.1079],
         [ 343.1111,  142.9078]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  13.3517,   46.3873],
         [-184.2298, -394.1252],
         [-287.6729,  429.8947],
         [-315.7118,  225.1226],
         [ 195.3457,  223.5794],
         [-262.6690, -496.3334],
         [ -49.5271,  210.3917]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -53.8617,   58.2622],
         [ 369.8326,  246.3777],
         [ 329.8123,  210.6219],
         [-378.7843, -418.9216],
         [ 335.0342,  408.8795],
         [ 385.6494, -256.6156],
         [ 311.9859, -468.8525]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -67.3006,  -53.4709],
         [ 295.6504, -331.9109],
         [-452.1422,  -76.5941],
         [  80.3043, -443.8084],
         [-401.7036,  428.2960],
         [ 161.8722,  236.7137],
         [-472.9602, -196.2174]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  24.7283,  -13.0814],
         [ -87.2675,   76.5976],
         [-125.0780,   73.3124],
         [  24.5488,  293.7755],
         [ 263.9330,   71.4896],
         [ 257.8588, -562.4377],
         [-273.0593,  206.7891],
         [ 153.6493, -440.4681]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -63.9432,   -8.7642],
         [ -51.1739, -466.3015],
         [-108.8406,  205.8273],
         [ 352.2124,  248.0264],
         [ -22.4614, -470.1113],
         [-142.3553,   80.4504],
         [ 485.8782,  250.0783]]]) 

MatU.grad[10:20,10:20]: tensor([[[  61.0042, -258.8149],
         [-375.7506,  469.9823],
         [ 381.9644,  -56.5503],
         [ 434.8083, -347.9768],
         [-441.4035, -285.0942],
         [-107.9828,  517.7831],
         [ 149.5788, -516.6630],
         [-487.0611, -330.8251],
         [ 266.2201,  513.3055],
         [-440.2788,  -91.2178]],

        [[-363.0297,   83.2255],
         [-176.3504, -102.5376],
         [  98.4244,  416.1018],
         [-501.8825,  236.2328],
         [ 232.0786,  408.5444],
         [-161.3860, -362.8690],
         [ 414.8170,  104.3422],
         [ 383.6007, -359.1881],
         [-325.8884, -325.2605],
         [ 317.8291,  151.7455]],

        [[ 481.7979, -367.9083],
         [ 245.2587, -457.4661],
         [-121.9460, -309.5933],
         [-353.7520,  115.5624],
         [ 470.3895,  233.7706],
         [ 247.1441,  -67.5387],
         [-126.7879,  281.5527],
         [-269.6929,  -93.3320],
         [ 120.0452,  267.1458],
         [-300.6228, -140.5766]],

        [[ 285.3025,  345.3903],
         [-348.6246,  318.2288],
         [ 271.3907,  252.9877],
         [-155.0166, -455.7300],
         [  19.8170,  365.4363],
         [-450.8034, -276.3647],
         [-438.6125,  258.9196],
         [ 162.4618,  445.9530],
         [-293.9472,  279.4200],
         [ 172.6061, -437.3611]],

        [[ 227.6544, -453.0566],
         [-365.6533, -423.3494],
         [ 528.5698,  211.8042],
         [-382.3222,  197.4199],
         [ 391.6523,  262.1939],
         [  15.8007,  -32.1245],
         [-130.1432,  374.2497],
         [-175.6431, -135.8848],
         [ -97.7082, -260.3643],
         [ 244.4506,  376.8645]],

        [[ 438.1465,  245.5148],
         [ 311.5573,  192.6180],
         [-292.5244,  417.9638],
         [-311.9573, -428.7636],
         [ 246.2841,   73.1602],
         [ 403.9312, -423.4544],
         [ 374.9538, -273.1075],
         [-437.8759, -250.5234],
         [ 376.9632,  -95.9043],
         [-252.2221,  370.6668]],

        [[-170.8546,  364.0804],
         [-167.7854,  281.8583],
         [-177.9911, -340.4140],
         [ 355.5885, -288.9825],
         [-333.1891,  458.9930],
         [-425.0467, -350.6367],
         [-114.0672,  250.6519],
         [-345.2251,  507.7925],
         [-203.6748,   20.4092],
         [-287.8409, -387.5249]],

        [[-115.5451, -372.8313],
         [-379.3492, -385.2978],
         [  71.3392, -182.6786],
         [ 148.2190,  494.4539],
         [-247.5648, -247.2380],
         [ 210.7463,  259.9467],
         [-115.1252,  -37.7850],
         [ 341.8672, -454.9249],
         [ 347.0439,  -18.4671],
         [ 330.4319, -242.9443]],

        [[-192.8817, -303.8209],
         [ -98.7334,  -16.6452],
         [-221.0066,  274.1191],
         [ 275.6049, -315.4818],
         [ 358.9438,  411.0613],
         [ 461.0135, -278.1984],
         [-454.1846, -372.1739],
         [ -53.7388, -258.9526],
         [ 172.3821,  279.7969],
         [-425.4675,  136.5365]],

        [[ 342.4871,  -31.3221],
         [-104.9604,  -42.2462],
         [-274.2032, -208.7666],
         [ 283.7683, -313.0537],
         [-439.7474,  226.1000],
         [ 299.1446,  263.1827],
         [-141.2736,  419.7274],
         [-390.1574,  211.4101],
         [ 383.6548,  244.0083],
         [-320.3277,  269.7789]]]) 

MatU.grad[20:30,20:30]:  tensor([[[-320.5019, -383.7257],
         [ 209.0705, -405.8267],
         [ 466.0013, -133.1605],
         [-209.4503, -124.4537],
         [-459.9638, -413.3894],
         [ 289.5439, -400.3384],
         [ -90.3572, -418.4242],
         [ 468.6562,  172.3884],
         [ 292.7998,  266.3564],
         [-309.1867, -375.5880]],

        [[-436.6790,  346.8361],
         [-308.9960,  267.9646],
         [ 310.1428,   -2.7426],
         [ 453.5455,  141.0245],
         [ 490.5954,  201.0488],
         [  89.1786,  235.2845],
         [-300.4325, -354.5238],
         [-327.4687,  231.0131],
         [-357.0774,  404.6776],
         [ 326.4388, -328.3829]],

        [[ 338.3193,  363.1264],
         [ 185.5424, -496.3759],
         [-473.0898, -270.1195],
         [-426.0233,  404.2800],
         [-359.0726,  -91.1025],
         [-390.6064, -324.2384],
         [ 482.3302,  323.5244],
         [-275.0590, -139.2625],
         [-206.4160, -328.7278],
         [ 252.7150,  276.3081]],

        [[-417.2814, -124.7256],
         [ 328.9546, -238.7076],
         [ 277.6277,  503.1973],
         [ -10.3915, -228.6247],
         [ 311.4717,  247.2616],
         [ 317.4188,  276.9437],
         [  92.2309, -372.9500],
         [-198.7543,  236.7691],
         [ 138.9370,  166.3270],
         [ 245.1825,  426.1550]],

        [[ 285.2656,  214.7861],
         [ 120.5390,  140.1015],
         [-381.8709, -250.7279],
         [ 414.6879, -302.6651],
         [-323.6777, -419.9047],
         [-383.1962, -279.1802],
         [-332.5533,  388.6929],
         [ 455.6598, -346.6386],
         [ 290.9175, -267.2882],
         [-537.6502, -285.0564]],

        [[ 139.6335,  440.0498],
         [-317.2367, -453.4126],
         [-276.2693, -209.2081],
         [ 301.6404,  152.7891],
         [-333.9018,  349.9437],
         [ 433.4128,  280.1862],
         [-269.0059,  -29.4661],
         [-306.3367, -303.3911],
         [ 221.5018,   57.5447],
         [  91.0047,  356.8672]],

        [[ 226.7693, -404.6951],
         [-346.6480,   -8.3730],
         [ 426.3071,  439.7932],
         [  53.5997,  361.5359],
         [-277.3570, -305.1116],
         [ -82.0596, -449.6159],
         [ 453.5149,  427.5801],
         [  13.2107,  335.1641],
         [-246.5186, -345.9078],
         [ 216.7211,  468.2698]],

        [[-228.3091,  397.3739],
         [  35.5573,  261.7142],
         [ 289.8996, -295.5618],
         [-473.9974, -339.9438],
         [ 340.7873,  467.5269],
         [-309.5712,  367.1985],
         [ 275.1856,   82.6071],
         [ 427.7758, -309.6912],
         [-418.4944, -353.5453],
         [-459.4506,  -86.9090]],

        [[ 422.1219,  127.0080],
         [-318.5251, -420.4581],
         [ -53.9959,  256.3367],
         [ 194.1065, -353.8026],
         [ 493.0489, -233.6723],
         [ 229.8239, -277.2947],
         [-315.3819, -289.2617],
         [-417.8540,  363.2601],
         [-191.1305,  438.8997],
         [ 308.6441, -263.7549]],

        [[-292.5325, -455.4431],
         [ 406.2532,  209.3587],
         [ 324.3724,  339.1266],
         [ 144.0858, -264.3768],
         [-357.0197, -213.6185],
         [-299.0819,  472.4508],
         [ 393.0744,  309.5198],
         [ 450.2423, -231.3459],
         [-113.9286, -231.0841],
         [ 195.1229,  198.9259]]]) 

t:1, loss.item(): nan
Optimized result :
 MatD: tensor([[0.0130, 0.0115, 0.0108,  ..., 0.0044, 0.0048, 0.0060],
        [0.0105, 0.0122, 0.0102,  ..., 0.0049, 0.0053, 0.0064],
        [0.0106, 0.0101, 0.0086,  ..., 0.0023, 0.0042, 0.0047],
        ...,
        [0.0200, 0.0200, 0.0176,  ..., 0.0296, 0.0250, 0.0227],
        [0.0192, 0.0196, 0.0196,  ..., 0.0227, 0.0238, 0.0222],
        [0.0196, 0.0192, 0.0200,  ..., 0.0217, 0.0250, 0.0233]],
       requires_grad=True) 
MatUx: tensor([[-1.4928e-03, -7.4156e-04, -1.1439e-04,  ...,  4.0241e-04,
          1.2164e-03,  1.2164e-03],
        [ 1.6688e-03, -1.9910e-03,  3.2223e-04,  ...,  4.1719e-04,
          1.0911e-03,  1.0911e-03],
        [-5.3729e-04,  5.3729e-04,  1.0000e-10,  ...,  1.0000e-10,
          5.1074e-04,  5.1074e-04],
        ...,
        [ 1.0000e-10, -3.9216e-04,  8.0032e-04,  ..., -2.7778e-03,
         -2.2727e-03, -2.2727e-03],
        [ 3.7707e-04,  1.0000e-10,  3.9216e-04,  ...,  1.0823e-03,
         -1.5873e-03, -1.5873e-03],
        [-3.7707e-04,  7.6923e-04, -3.9216e-04,  ...,  3.2609e-03,
         -1.7442e-03, -1.7442e-03]], grad_fn=<SelectBackward>)  




 
test_counter in loss_omega_mat(): 671
test_counter in loss_omega_mat(): 1342
test_counter in loss_omega_mat(): 2013
test_counter in loss_omega_mat(): 2684
test_counter in loss_omega_mat(): 3355
test_counter in loss_omega_mat(): 4026
test_counter in loss_omega_mat(): 4697
mat_omega_topk: tensor([[[0.9453, 0.9452, 0.9451,  ..., 0.8934, 0.8002, 0.7997],
         [0.9458, 0.9453, 0.9450,  ..., 0.8926, 0.8004, 0.8002],
         [0.9458, 0.9457, 0.9452,  ..., 0.8929, 0.8004, 0.8003],
         ...,
         [0.9453, 0.9442, 0.9440,  ..., 0.8936, 0.7997, 0.7996],
         [0.9454, 0.9450, 0.9442,  ..., 0.8934, 0.8000, 0.7992],
         [0.9455, 0.9450, 0.9448,  ..., 0.8921, 0.7999, 0.7996]],

        [[0.9451, 0.9451, 0.9449,  ..., 0.8933, 0.7999, 0.7996],
         [0.9457, 0.9450, 0.9449,  ..., 0.8937, 0.8001, 0.8001],
         [0.9457, 0.9455, 0.9452,  ..., 0.8939, 0.8003, 0.8002],
         ...,
         [0.9453, 0.9453, 0.9451,  ..., 0.8936, 0.7999, 0.7998],
         [0.9454, 0.9454, 0.9453,  ..., 0.8939, 0.8001, 0.7999],
         [0.9455, 0.9453, 0.9452,  ..., 0.8926, 0.7999, 0.7997]],

        [[0.9451, 0.9451, 0.9449,  ..., 0.8930, 0.8001, 0.7998],
         [0.9454, 0.9451, 0.9449,  ..., 0.8939, 0.8004, 0.8002],
         [0.9455, 0.9454, 0.9453,  ..., 0.8940, 0.8005, 0.8004],
         ...,
         [0.9455, 0.9453, 0.9453,  ..., 0.8938, 0.8003, 0.8001],
         [0.9456, 0.9454, 0.9453,  ..., 0.8941, 0.8004, 0.8003],
         [0.9453, 0.9453, 0.9452,  ..., 0.8930, 0.8001, 0.7999]],

        ...,

        [[0.9450, 0.9444, 0.9443,  ..., 0.8900, 0.7992, 0.7987],
         [0.9453, 0.9449, 0.9448,  ..., 0.8922, 0.7994, 0.7994],
         [0.9453, 0.9452, 0.9451,  ..., 0.8933, 0.8003, 0.8002],
         ...,
         [0.9456, 0.9453, 0.9439,  ..., 0.8914, 0.8001, 0.7998],
         [0.9453, 0.9445, 0.9443,  ..., 0.8917, 0.8000, 0.7974],
         [0.9445, 0.9430, 0.9425,  ..., 0.8826, 0.7998, 0.7971]],

        [[0.9451, 0.9450, 0.9449,  ..., 0.8916, 0.7989, 0.7984],
         [0.9453, 0.9452, 0.9449,  ..., 0.8928, 0.7997, 0.7989],
         [0.9453, 0.9452, 0.9449,  ..., 0.8925, 0.8000, 0.7998],
         ...,
         [0.9456, 0.9454, 0.9450,  ..., 0.8918, 0.8001, 0.8001],
         [0.9454, 0.9449, 0.9447,  ..., 0.8923, 0.8002, 0.7996],
         [0.9449, 0.9447, 0.9430,  ..., 0.8820, 0.8001, 0.7990]],

        [[0.9452, 0.9451, 0.9451,  ..., 0.8917, 0.7989, 0.7985],
         [0.9452, 0.9452, 0.9451,  ..., 0.8917, 0.7994, 0.7992],
         [0.9452, 0.9451, 0.9444,  ..., 0.8919, 0.7996, 0.7990],
         ...,
         [0.9455, 0.9454, 0.9450,  ..., 0.8936, 0.7998, 0.7996],
         [0.9454, 0.9454, 0.9449,  ..., 0.8932, 0.7997, 0.7990],
         [0.9449, 0.9449, 0.9449,  ..., 0.8869, 0.7998, 0.7984]]],
       grad_fn=<SliceBackward>) 

mat_duij: tensor([[[6.8950e-07, 4.6937e-06, 1.4325e-06,  ..., 1.7283e-06,
          1.3525e-06, 4.3841e-07],
         [1.3536e-07, 7.4940e-07, 4.8539e-07,  ..., 9.0469e-07,
          7.9451e-07, 1.8164e-07],
         [2.4925e-08, 9.8221e-08, 2.1693e-06,  ..., 3.0099e-07,
          1.7977e-07, 5.2202e-07],
         ...,
         [1.3512e-06, 2.7692e-07, 7.0028e-06,  ..., 5.7409e-07,
          5.7801e-07, 9.9338e-06],
         [2.6086e-07, 4.6508e-07, 6.4737e-08,  ..., 5.3109e-08,
          1.0579e-09, 6.9112e-06],
         [7.0091e-07, 2.9106e-06, 1.8597e-07,  ..., 1.9082e-07,
          1.3969e-06, 1.3137e-06]],

        [[5.9479e-07, 9.2233e-07, 6.8760e-07,  ..., 4.6788e-07,
          5.7397e-07, 9.2018e-07],
         [3.3226e-07, 3.2823e-07, 2.1823e-06,  ..., 5.0180e-07,
          1.2785e-06, 3.9958e-06],
         [1.2138e-06, 1.1655e-06, 1.4018e-07,  ..., 2.3499e-06,
          1.6780e-06, 1.2276e-06],
         ...,
         [3.9577e-06, 1.8051e-07, 1.7472e-06,  ..., 4.1116e-06,
          1.6549e-06, 3.2632e-06],
         [2.8330e-07, 2.3141e-06, 4.9348e-11,  ..., 1.3987e-07,
          4.0751e-07, 5.4865e-07],
         [1.7850e-06, 5.5382e-07, 7.1154e-07,  ..., 2.9224e-06,
          1.9701e-06, 2.8115e-08]],

        [[3.1393e-06, 5.3277e-07, 4.3378e-08,  ..., 3.9524e-06,
          1.9365e-07, 7.2808e-08],
         [6.3992e-08, 1.4447e-07, 3.6438e-07,  ..., 7.7894e-06,
          4.0765e-08, 6.9053e-06],
         [8.6648e-07, 3.5699e-06, 1.2808e-07,  ..., 4.9969e-06,
          1.4574e-08, 3.4235e-09],
         ...,
         [4.5268e-07, 5.5763e-08, 1.1486e-07,  ..., 2.6410e-07,
          1.6487e-06, 4.0916e-06],
         [3.4064e-07, 3.3140e-06, 8.1373e-07,  ..., 7.5281e-07,
          8.0800e-08, 5.7070e-06],
         [5.8348e-07, 5.7639e-10, 2.9980e-08,  ..., 2.1427e-07,
          3.3397e-08, 7.0356e-07]],

        ...,

        [[3.4077e-06, 3.1396e-07, 7.9869e-06,  ..., 2.5582e-06,
          1.3694e-05, 1.7478e-05],
         [2.9670e-06, 9.7859e-08, 9.3208e-08,  ..., 5.6660e-06,
          1.1281e-05, 2.3154e-06],
         [1.3343e-08, 2.0478e-06, 1.6392e-06,  ..., 3.6769e-06,
          7.6780e-06, 3.6943e-06],
         ...,
         [2.6297e-07, 2.2636e-07, 6.8275e-06,  ..., 6.1947e-06,
          8.1699e-07, 2.2139e-06],
         [2.9321e-07, 3.6023e-06, 8.3328e-08,  ..., 3.6891e-06,
          8.9115e-09, 1.6304e-10],
         [4.7091e-07, 3.3177e-07, 1.6051e-07,  ..., 1.3516e-06,
          1.1385e-06, 2.3937e-06]],

        [[1.5012e-06, 1.7995e-06, 2.6356e-06,  ..., 7.5205e-07,
          4.0880e-05, 1.9522e-06],
         [4.3986e-06, 4.0439e-06, 8.7273e-06,  ..., 1.5026e-05,
          4.6948e-06, 1.5171e-05],
         [2.1070e-07, 2.2227e-06, 1.2280e-05,  ..., 2.3661e-05,
          2.2827e-07, 1.7089e-05],
         ...,
         [1.1618e-06, 2.4575e-07, 9.5084e-07,  ..., 3.6784e-06,
          1.1494e-07, 2.1874e-06],
         [9.9451e-08, 1.7179e-08, 2.7088e-06,  ..., 1.2942e-06,
          2.3604e-09, 2.9378e-06],
         [1.1275e-07, 1.9320e-06, 3.5293e-09,  ..., 5.2395e-06,
          2.1009e-06, 3.0317e-06]],

        [[4.6237e-06, 3.6670e-06, 3.3956e-06,  ..., 1.5286e-05,
          2.4698e-05, 6.2768e-06],
         [9.5695e-06, 1.2132e-05, 5.4910e-06,  ..., 1.7607e-05,
          3.9354e-05, 2.4225e-05],
         [1.2902e-05, 8.6356e-06, 4.6995e-06,  ..., 2.5330e-05,
          2.2764e-05, 6.5932e-06],
         ...,
         [1.3516e-07, 1.3121e-07, 1.7425e-06,  ..., 5.0150e-07,
          1.1501e-07, 1.3615e-06],
         [1.9409e-06, 1.8496e-06, 8.4419e-09,  ..., 8.8744e-07,
          4.2291e-06, 3.3256e-07],
         [1.2612e-07, 1.9451e-06, 1.0365e-06,  ..., 4.8233e-07,
          3.1466e-06, 3.4721e-06]]], grad_fn=<CopySlices>) 

mat_uij: tensor([[[0.0006, 0.0021, 0.0004,  ..., 0.0014, 0.0014, 0.0016],
         [0.0009, 0.0006, 0.0010,  ..., 0.0014, 0.0002, 0.0018],
         [0.0009, 0.0011, 0.0017,  ..., 0.0014, 0.0008, 0.0010],
         ...,
         [0.0010, 0.0005, 0.0020,  ..., 0.0015, 0.0007, 0.0007],
         [0.0011, 0.0012, 0.0005,  ..., 0.0009, 0.0018, 0.0020],
         [0.0005, 0.0012, 0.0006,  ..., 0.0017, 0.0002, 0.0010]],

        [[0.0012, 0.0004, 0.0007,  ..., 0.0007, 0.0012, 0.0011],
         [0.0005, 0.0010, 0.0007,  ..., 0.0011, 0.0010, 0.0007],
         [0.0005, 0.0012, 0.0017,  ..., 0.0015, 0.0011, 0.0024],
         ...,
         [0.0010, 0.0003, 0.0002,  ..., 0.0012, 0.0012, 0.0010],
         [0.0011, 0.0010, 0.0012,  ..., 0.0009, 0.0005, 0.0014],
         [0.0005, 0.0012, 0.0007,  ..., 0.0009, 0.0009, 0.0014]],

        [[0.0012, 0.0010, 0.0006,  ..., 0.0016, 0.0015, 0.0005],
         [0.0020, 0.0011, 0.0006,  ..., 0.0018, 0.0014, 0.0018],
         [0.0016, 0.0020, 0.0016,  ..., 0.0012, 0.0010, 0.0021],
         ...,
         [0.0014, 0.0003, 0.0013,  ..., 0.0016, 0.0012, 0.0010],
         [0.0011, 0.0010, 0.0013,  ..., 0.0013, 0.0017, 0.0016],
         [0.0007, 0.0007, 0.0007,  ..., 0.0003, 0.0010, 0.0002]],

        ...,

        [[0.0008, 0.0032, 0.0009,  ..., 0.0022, 0.0010, 0.0015],
         [0.0008, 0.0002, 0.0010,  ..., 0.0034, 0.0019, 0.0004],
         [0.0015, 0.0005, 0.0005,  ..., 0.0010, 0.0012, 0.0011],
         ...,
         [0.0013, 0.0013, 0.0016,  ..., 0.0014, 0.0007, 0.0017],
         [0.0013, 0.0012, 0.0002,  ..., 0.0007, 0.0001, 0.0011],
         [0.0012, 0.0010, 0.0023,  ..., 0.0047, 0.0017, 0.0001]],

        [[0.0008, 0.0008, 0.0012,  ..., 0.0016, 0.0005, 0.0041],
         [0.0008, 0.0012, 0.0009,  ..., 0.0004, 0.0013, 0.0003],
         [0.0015, 0.0010, 0.0009,  ..., 0.0017, 0.0010, 0.0013],
         ...,
         [0.0006, 0.0008, 0.0009,  ..., 0.0009, 0.0008, 0.0016],
         [0.0008, 0.0010, 0.0006,  ..., 0.0012, 0.0008, 0.0008],
         [0.0010, 0.0006, 0.0010,  ..., 0.0049, 0.0008, 0.0016]],

        [[0.0018, 0.0008, 0.0008,  ..., 0.0010, 0.0006, 0.0007],
         [0.0012, 0.0009, 0.0008,  ..., 0.0001, 0.0019, 0.0020],
         [0.0009, 0.0008, 0.0009,  ..., 0.0013, 0.0015, 0.0016],
         ...,
         [0.0003, 0.0011, 0.0016,  ..., 0.0002, 0.0011, 0.0012],
         [0.0011, 0.0012, 0.0010,  ..., 0.0014, 0.0013, 0.0016],
         [0.0001, 0.0015, 0.0010,  ..., 0.0003, 0.0011, 0.0008]]],
       grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:nan loss2:nan
t:2, Finish constructing loss
require grad ? True True False
MatD grad and MatUx grad: torch.Size([55, 122]) torch.Size([55, 122, 2]) 

MatD.grad: tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0185,  ...,  0.0381,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0159,  ..., -0.0285,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: tensor([[[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  23.6590,   20.4632],
         [  47.0011,   42.8805],
         [  -7.2148,   86.9417],
         [  21.0045,   87.3648],
         [ -57.0118,   56.9172],
         [  -1.1652,   45.9048],
         [ -24.2972,    6.8140]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  50.9015,   39.3288],
         [-310.6470, -247.7543],
         [  16.4208, -331.7621],
         [ 298.6004, -230.5545],
         [-377.0155, -343.5384],
         [ 409.5560,   67.1565],
         [  99.0002, -422.9370]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [  85.3745,   42.2873],
         [-213.0503, -130.1170],
         [-168.1495,  175.1119],
         [-302.8562,  441.1856],
         [ 173.1737,  381.8127],
         [-456.2120, -104.0274],
         [ 477.3192,  351.7433]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -62.2000,   48.4005],
         [ 134.2237,   40.5141],
         [ 422.8898,  350.8586],
         [-306.5931, -512.9096],
         [ 205.2555,  227.6469],
         [ 217.7585, -442.2379],
         [ 179.4621,  -51.2911]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -80.6451,  -38.8422],
         [  94.9190, -394.1140],
         [-261.3500,  448.5027],
         [ 448.3474, -439.7620],
         [-504.6703,   68.3559],
         [ 390.5781,  428.0414],
         [-137.2101, -421.4103]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -85.2709,   14.6827],
         [ 349.2537,  173.9777],
         [-470.1013, -167.2809],
         [ 321.8746,  386.4151],
         [ -38.2324, -426.7878],
         [-304.0237,  211.3529],
         [ 406.8579, -262.9525]],

        [[   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [   0.0000,    0.0000],
         [ -88.3135,   31.9995],
         [ 356.5876, -266.5717],
         [-373.3661, -146.1609],
         [  10.3473,  247.4619],
         [ 443.6788, -259.8455],
         [-130.0041, -350.4392],
         [ 164.9644,  355.2877]]]) 

MatU.grad[10:20,10:20]: tensor([[[ 403.2981, -229.4841],
         [-502.4654,  302.7368],
         [ 146.1031, -370.4462],
         [ 143.9670,    0.7850],
         [ -53.4853, -154.0089],
         [-448.2068,  212.2057],
         [ 386.7259, -315.2582],
         [-193.3279,  -31.3716],
         [ 330.7404,  218.0903],
         [-159.2750, -492.5058]],

        [[ 281.4724,  469.3837],
         [-359.3926, -329.9956],
         [ 240.7263,  157.6563],
         [-268.8420, -149.3472],
         [ 270.2930,  393.0665],
         [-422.5891,   73.8014],
         [ 326.4659,  311.3812],
         [  93.7294, -371.8636],
         [-377.4082, -235.8933],
         [ -53.0863,  578.4888]],

        [[ 252.0976, -435.9020],
         [ 218.8312, -253.1414],
         [-448.2693,  -52.4197],
         [ -37.9981,  560.6730],
         [ 114.8661, -111.5241],
         [ 119.8884, -254.9857],
         [-205.4830, -257.6716],
         [-160.3676,  458.8991],
         [ 442.0696,  205.6270],
         [-335.0000, -396.0709]],

        [[ 338.9095,  390.9245],
         [-360.9560,  327.1181],
         [ 470.0660,  147.0758],
         [-476.5683, -352.4512],
         [ 511.2031, -117.9994],
         [-496.7030,   79.6565],
         [  87.1743,  185.1922],
         [-500.1991,  153.3996],
         [  46.8289,  246.4305],
         [ 363.9682, -225.0238]],

        [[ 263.1436, -379.5532],
         [-393.0532, -415.1711],
         [ 273.3868,  375.8660],
         [-359.6843,  146.8536],
         [ 157.7382,   -8.7512],
         [ 341.1436,  501.7947],
         [ 280.9106,  156.7960],
         [-336.2234, -246.0701],
         [-425.4683,  -85.1648],
         [ 441.7396,  209.2562]],

        [[ 240.6266,  320.3516],
         [ 430.7993,  274.9100],
         [-119.3437,  121.4816],
         [-300.2042, -289.7501],
         [ 185.6053,  434.0632],
         [ 214.8822, -444.8241],
         [ 228.6391, -287.5702],
         [ -17.5117, -144.0475],
         [ 299.4128, -312.4160],
         [-358.9890,  275.2888]],

        [[  -7.7205,  192.0411],
         [ -92.7500,  120.6625],
         [-288.6353, -241.4706],
         [ 391.4970, -231.8224],
         [-387.7602,  266.5010],
         [-142.9402, -269.2269],
         [-481.5240,  337.3921],
         [ -78.3137,  368.8146],
         [ 178.2220,  411.4795],
         [-434.1857,  -62.3000]],

        [[-182.0366,   26.3950],
         [ 231.3155,   48.4799],
         [-633.1779,   53.0832],
         [ 450.4876,  227.8001],
         [-407.9409, -275.8610],
         [ 396.4937,  454.3818],
         [-325.0398, -456.8572],
         [ 307.3739, -175.7671],
         [ 262.4491, -434.1734],
         [ -76.9589, -216.4195]],

        [[-120.5575,   21.1755],
         [  13.7998, -104.4486],
         [-214.2780, -555.1329],
         [ 300.0877,  -64.2883],
         [  21.2637,  234.1909],
         [ 193.2656, -365.0744],
         [-176.6438,  -76.0186],
         [-411.0732, -158.4929],
         [ 505.4233,  176.5465],
         [-388.7253,  312.5145]],

        [[ 273.3365, -454.2295],
         [ -34.0006, -214.0413],
         [-289.1309,  218.7862],
         [ 386.1561, -207.0465],
         [-298.5678,  444.6610],
         [ 407.6990,  172.3727],
         [-509.4941,  202.9942],
         [ -88.0298,  466.1624],
         [ 285.0401,  170.2656],
         [-444.5639,  -77.0638]]]) 

MatU.grad[20:30,20:30]:  tensor([[[-203.1441, -352.7200],
         [ 399.2794, -317.9899],
         [ 231.7210, -310.0040],
         [-264.6624, -347.2004],
         [-143.6045, -363.5551],
         [ 304.8184, -379.1046],
         [-425.6938,  -83.6252],
         [ 166.5121,  316.8165],
         [ 394.1821,  241.6840],
         [-533.3466, -193.5500]],

        [[-227.7700,  -38.3748],
         [-484.8327,  355.0102],
         [  80.2150,  432.1219],
         [ 335.8383,  302.1861],
         [ -21.7120,  360.1227],
         [ 450.4646,  324.8265],
         [-335.9761, -308.9913],
         [ -58.9888,  389.4371],
         [-223.8090,  155.1205],
         [ 112.2201, -447.7760]],

        [[ 390.1927,  215.4463],
         [ 446.6798, -140.6502],
         [-210.9442, -372.2751],
         [-348.0905,  121.0739],
         [ -87.8613, -619.6567],
         [-225.4754, -257.6351],
         [ 380.0590,   75.2821],
         [ 148.7690, -503.8123],
         [-425.8210, -255.6044],
         [ 200.5748,  374.8070]],

        [[-153.8887, -440.5843],
         [ 225.4138, -415.4859],
         [ 245.4235,  221.3529],
         [-555.8467, -175.3708],
         [ 334.8661,  451.8163],
         [ 462.6310,  221.3045],
         [-580.4268,  -51.9004],
         [-349.2966,  377.2997],
         [ 380.0009,  348.1381],
         [ 215.1475,  140.0564]],

        [[  80.3986,  411.0317],
         [ 314.6068,  407.5562],
         [-157.3867, -125.4781],
         [ 311.9448, -364.6312],
         [-274.9518, -170.9772],
         [ 128.1649, -291.9258],
         [-130.3773,  348.4084],
         [ 198.4128,  -83.1807],
         [ 316.3756, -423.6760],
         [-295.8859, -427.6806]],

        [[ 437.4658,   89.7920],
         [-431.0920,   53.5708],
         [-463.1971, -167.0562],
         [ 320.4688,  507.2873],
         [-311.8705,  394.1691],
         [ 389.9835,  274.0632],
         [-111.6153, -553.0493],
         [-370.5642, -283.2745],
         [ -23.0173,  564.8959],
         [ 516.4249,  288.0115]],

        [[ 345.0000, -262.7816],
         [-274.3748, -446.0895],
         [  47.7894,  230.6550],
         [ 601.6830,  141.1581],
         [-269.4348, -565.6984],
         [-450.7092, -135.9274],
         [ 169.6450,  101.8819],
         [ 532.2637,  161.9886],
         [-536.5482,  -10.5428],
         [ 191.5130,  237.3767]],

        [[-214.6755,  167.1987],
         [ 412.4166,  227.7307],
         [  68.9625, -393.0757],
         [-505.2510, -208.6122],
         [ 192.3074,  399.1870],
         [-311.0602,  304.5519],
         [ 196.2189,  468.9901],
         [ 317.6945, -279.8923],
         [-199.9647, -226.4086],
         [-332.0337, -471.3190]],

        [[ 309.2104,  371.8439],
         [-358.6113, -315.6039],
         [ 544.0004,  282.4331],
         [ 197.9433,  -84.3607],
         [  74.3793,   24.4050],
         [ 377.4541, -403.3363],
         [-388.3793, -355.7787],
         [-113.6736,  317.7165],
         [-339.9392,  362.1440],
         [ 230.4079, -305.7211]],

        [[-373.2923, -179.0830],
         [  -4.8702,  306.8082],
         [ 293.4178,   27.1725],
         [ 402.0818, -372.9440],
         [-463.0042, -371.8983],
         [-212.8175,  348.6411],
         [ 379.1655,  277.4442],
         [ 351.1199,  -65.2269],
         [-470.2367, -139.4960],
         [ 345.2581,  382.5113]]]) 

t:2, loss.item(): nan
Optimized result :
 MatD: tensor([[0.0130, 0.0115, 0.0108,  ..., 0.0044, 0.0048, 0.0060],
        [0.0105, 0.0122, 0.0102,  ..., 0.0049, 0.0053, 0.0064],
        [0.0106, 0.0101, 0.0079,  ..., 0.0015, 0.0042, 0.0047],
        ...,
        [0.0200, 0.0200, 0.0166,  ..., 0.0304, 0.0250, 0.0227],
        [0.0192, 0.0196, 0.0196,  ..., 0.0227, 0.0238, 0.0222],
        [0.0196, 0.0192, 0.0200,  ..., 0.0217, 0.0250, 0.0233]],
       requires_grad=True) 
MatUx: tensor([[-1.4928e-03, -7.4156e-04, -1.1439e-04,  ...,  4.0241e-04,
          1.2164e-03,  1.2164e-03],
        [ 1.6688e-03, -1.9910e-03,  3.2223e-04,  ...,  4.1719e-04,
          1.0911e-03,  1.0911e-03],
        [-5.3729e-04,  5.3729e-04,  1.0000e-10,  ...,  1.0000e-10,
          5.1074e-04,  5.1074e-04],
        ...,
        [ 1.0000e-10, -3.9216e-04,  8.0032e-04,  ..., -2.7778e-03,
         -2.2727e-03, -2.2727e-03],
        [ 3.7707e-04,  1.0000e-10,  3.9216e-04,  ...,  1.0823e-03,
         -1.5873e-03, -1.5873e-03],
        [-3.7707e-04,  7.6923e-04, -3.9216e-04,  ...,  3.2609e-03,
         -1.7442e-03, -1.7442e-03]], grad_fn=<SelectBackward>)  




 
test_counter in loss_omega_mat(): 671
test_counter in loss_omega_mat(): 1342
test_counter in loss_omega_mat(): 2013
test_counter in loss_omega_mat(): 2684
test_counter in loss_omega_mat(): 3355
test_counter in loss_omega_mat(): 4026
test_counter in loss_omega_mat(): 4697
