DIR_NAME: g:\Workspaces\Anaconda_ws\Semantic_Denoising_MVS\scripts 

DEVICE: cuda? True

Graph params:
(pLambda,pAlpha,pCigma_int,pCigma_spa,pB,pK,pQ): 
(20,15,0.07,3,9,20,3)

MatI: 
tensor([[ 63.,  62.,  64.,  ..., 114., 122., 115.],
        [ 65.,  63.,  67.,  ..., 115., 125., 119.],
        [ 62.,  73.,  67.,  ..., 116., 119., 116.],
        ...,
        [ 83.,  66.,  77.,  ...,  85.,  80.,  81.],
        [ 87.,  55.,  82.,  ...,  73.,  78.,  74.],
        [ 71.,  69.,  73.,  ...,  72.,  85.,  88.]])
MatC: 
tensor([[0.9529, 0.9686, 0.9804,  ..., 0.9882, 0.9961, 0.9961],
        [0.9137, 0.9451, 0.9490,  ..., 0.9882, 0.9961, 0.9961],
        [0.8510, 0.8549, 0.9098,  ..., 0.9922, 0.9922, 0.9922],
        ...,
        [0.9490, 0.8941, 0.9098,  ..., 0.9804, 0.9804, 0.9843],
        [0.9490, 0.9176, 0.9216,  ..., 0.9804, 0.9804, 0.9804],
        [0.9373, 0.9216, 0.9333,  ..., 0.9725, 0.9804, 0.9843]])
debug:
MatD.shape: torch.Size([59, 98]) 
has nan? False 
MatD: 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0149,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]]) 

MatU.shape: torch.Size([59, 98, 2]) 
has nan? False 
MatUx: 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]]) 

Optimize & Adam params:
(n_iter,lr,betas,eps):
(20,0.0005,(0.9, 0.999),1e-08)










test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
test_counter in loss_omega_mat(): 4046
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9456, 0.9453, 0.9450,  ..., 0.6405, 0.6065, 0.6065],
         [0.4517, 0.4407, 0.4255,  ..., 0.2921, 0.2921, 0.2918],
         [0.4407, 0.4254, 0.4209,  ..., 0.2917, 0.2887, 0.2750],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7571],
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7570, 0.7568],
         [0.9459, 0.9459, 0.9457,  ..., 0.7569, 0.7568, 0.7564]],

        [[0.9456, 0.9455, 0.9454,  ..., 0.6408, 0.6408, 0.6407],
         [0.9455, 0.9453, 0.9452,  ..., 0.6400, 0.6065, 0.6065],
         [0.9453, 0.9452, 0.9452,  ..., 0.6399, 0.6065, 0.6065],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7571, 0.7571],
         [0.9459, 0.9459, 0.9457,  ..., 0.7572, 0.7571, 0.7569]],

        [[0.9455, 0.9455, 0.9454,  ..., 0.7569, 0.7569, 0.6408],
         [0.9455, 0.9453, 0.9453,  ..., 0.7562, 0.6407, 0.6407],
         [0.9453, 0.9453, 0.9452,  ..., 0.6408, 0.6407, 0.6406],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7572, 0.7571],
         [0.9459, 0.9459, 0.9457,  ..., 0.7572, 0.7571, 0.7571]],

        ...,

        [[0.9458, 0.9458, 0.9458,  ..., 0.7571, 0.7569, 0.7565],
         [0.9459, 0.9458, 0.9458,  ..., 0.7573, 0.7564, 0.7490],
         [0.9459, 0.9458, 0.9452,  ..., 0.7571, 0.7449, 0.7447],
         ...,
         [0.9459, 0.9459, 0.9453,  ..., 0.7567, 0.7565, 0.7564],
         [0.9459, 0.9459, 0.9452,  ..., 0.7566, 0.7564, 0.7563],
         [0.9459, 0.9457, 0.9451,  ..., 0.7564, 0.7564, 0.7562]],

        [[0.9458, 0.9458, 0.9458,  ..., 0.7569, 0.7565, 0.7560],
         [0.9458, 0.9458, 0.9458,  ..., 0.7543, 0.7515, 0.7455],
         [0.9454, 0.9452, 0.9452,  ..., 0.7506, 0.7455, 0.7405],
         ...,
         [0.9458, 0.9455, 0.9454,  ..., 0.7565, 0.7564, 0.7563],
         [0.9455, 0.9455, 0.9453,  ..., 0.7565, 0.7564, 0.7564],
         [0.9455, 0.9454, 0.9454,  ..., 0.7564, 0.7563, 0.7562]],

        [[0.9458, 0.9458, 0.9458,  ..., 0.7569, 0.7565, 0.7539],
         [0.9458, 0.9458, 0.9458,  ..., 0.7520, 0.7500, 0.7431],
         [0.9452, 0.9449, 0.9444,  ..., 0.7475, 0.7442, 0.7371],
         ...,
         [0.9457, 0.9455, 0.9454,  ..., 0.7566, 0.7566, 0.7558],
         [0.9455, 0.9454, 0.9453,  ..., 0.7567, 0.7565, 0.7562],
         [0.9454, 0.9454, 0.9452,  ..., 0.7566, 0.7565, 0.7563]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[1.5306e-06, 4.0484e-08, 3.8611e-07,  ..., 1.6194e-07,
          2.7048e-06, 1.0837e-06],
         [6.7664e-07, 5.9629e-07, 1.1162e-06,  ..., 2.2855e-06,
          1.0239e-06, 3.6436e-07],
         [4.1929e-06, 1.8933e-07, 1.6268e-06,  ..., 1.7672e-05,
          1.1506e-05, 1.2208e-05],
         ...,
         [1.6670e-07, 9.5653e-08, 9.8029e-09,  ..., 4.4213e-08,
          6.6680e-07, 5.8263e-08],
         [1.9661e-07, 9.5653e-08, 1.9661e-07,  ..., 4.6043e-07,
          3.0338e-07, 1.7094e-07],
         [1.6773e-06, 2.6592e-07, 2.6592e-07,  ..., 2.6592e-07,
          7.5769e-06, 1.2975e-06]],

        [[2.8325e-07, 1.7654e-07, 1.7654e-07,  ..., 2.0375e-06,
          2.1904e-06, 2.9109e-06],
         [1.7654e-07, 4.1929e-06, 4.1929e-06,  ..., 9.3287e-06,
          2.3838e-05, 1.5889e-06],
         [1.7654e-07, 1.3507e-05, 1.7654e-07,  ..., 1.7102e-05,
          1.9209e-05, 4.6486e-05],
         ...,
         [1.6670e-07, 2.5735e-07, 1.0000e-20,  ..., 6.6680e-07,
          8.3830e-07, 6.6680e-07],
         [1.6670e-07, 1.6670e-07, 1.6670e-07,  ..., 7.2539e-07,
          6.6680e-07, 9.6858e-08],
         [4.0742e-07, 1.3124e-06, 9.0385e-07,  ..., 1.0699e-06,
          2.9083e-07, 5.5747e-10]],

        [[1.9859e-07, 1.0000e-20, 1.0000e-20,  ..., 1.7654e-07,
          4.1929e-06, 2.3963e-06],
         [3.8611e-07, 3.8611e-07, 1.7654e-07,  ..., 2.1381e-06,
          4.2425e-06, 2.7653e-06],
         [1.5049e-06, 3.3422e-06, 1.0146e-06,  ..., 3.3566e-06,
          8.2579e-06, 2.4823e-06],
         ...,
         [1.6670e-07, 9.4222e-09, 2.5538e-07,  ..., 1.0103e-06,
          3.6291e-07, 3.7277e-07],
         [6.6680e-07, 5.4362e-07, 1.0825e-07,  ..., 2.4146e-06,
          6.9943e-07, 7.1822e-06],
         [9.0016e-07, 1.3535e-06, 9.0016e-07,  ..., 6.8514e-06,
          2.4383e-06, 4.3517e-06]],

        ...,

        [[1.5747e-07, 4.0484e-08, 4.0485e-08,  ..., 9.7911e-07,
          4.0485e-08, 1.6194e-07],
         [3.5764e-07, 3.2603e-07, 3.2603e-07,  ..., 3.0471e-06,
          1.9090e-06, 2.3852e-06],
         [1.4890e-07, 1.6194e-07, 3.4467e-07,  ..., 6.2140e-07,
          8.3810e-05, 9.9396e-06],
         ...,
         [2.1588e-08, 2.1588e-08, 1.5951e-06,  ..., 6.6560e-07,
          5.8572e-07, 1.0033e-06],
         [3.3333e-07, 1.8526e-07, 2.4237e-06,  ..., 7.8320e-08,
          3.9491e-06, 6.0170e-07],
         [2.2668e-08, 8.8498e-08, 3.7071e-06,  ..., 4.9573e-06,
          2.5146e-06, 4.4657e-06]],

        [[1.4091e-07, 1.3674e-07, 1.4091e-07,  ..., 1.8350e-06,
          2.5155e-10, 1.8782e-06],
         [4.0485e-08, 2.3852e-06, 1.3041e-06,  ..., 1.2908e-06,
          3.4103e-08, 1.5350e-06],
         [3.1941e-07, 1.6667e-07, 1.6194e-07,  ..., 1.4457e-06,
          6.6375e-06, 1.3566e-05],
         ...,
         [3.5399e-07, 3.3753e-07, 3.3753e-07,  ..., 2.4492e-06,
          5.1727e-06, 3.8973e-06],
         [2.8112e-06, 6.5969e-07, 6.5969e-07,  ..., 3.6938e-06,
          2.0413e-06, 2.4941e-06],
         [2.0518e-06, 1.6852e-07, 1.6852e-07,  ..., 1.1838e-05,
          8.9742e-09, 3.4217e-06]],

        [[4.0484e-08, 1.5307e-07, 4.0485e-08,  ..., 6.7664e-07,
          4.0022e-07, 1.4854e-07],
         [4.2865e-08, 2.6486e-08, 3.1247e-11,  ..., 1.0357e-06,
          3.4010e-11, 3.1382e-06],
         [3.8686e-06, 1.6667e-07, 4.7259e-06,  ..., 1.1962e-04,
          5.8869e-07, 1.7361e-05],
         ...,
         [1.6539e-07, 3.0779e-08, 2.6495e-07,  ..., 6.0406e-06,
          2.3641e-07, 2.2810e-06],
         [2.1612e-06, 1.0115e-06, 9.3442e-06,  ..., 2.5958e-05,
          1.3193e-05, 1.4419e-05],
         [9.9629e-06, 2.4096e-06, 6.2709e-07,  ..., 1.2029e-06,
          9.2564e-08, 2.1429e-07]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[1.4447e-03, 1.0451e-03, 9.4000e-04,  ..., 1.3741e-03,
          2.2025e-04, 2.8949e-04],
         [6.2341e-04, 1.0789e-03, 2.8710e-03,  ..., 2.8455e-04,
          4.0957e-04, 1.6510e-03],
         [2.9354e-03, 1.7905e-03, 3.0949e-03,  ..., 1.3044e-03,
          3.1642e-04, 2.1427e-03],
         ...,
         [1.4002e-04, 3.2474e-04, 3.0928e-04,  ..., 8.6235e-04,
          5.7877e-04, 1.0050e-03],
         [1.1545e-03, 1.6672e-04, 8.5170e-04,  ..., 1.0256e-03,
          9.5909e-04, 1.3004e-03],
         [1.1545e-03, 5.4969e-04, 1.6475e-03,  ..., 1.4687e-03,
          1.3399e-03, 1.8780e-03]],

        [[1.6916e-03, 1.6275e-03, 4.2017e-04,  ..., 1.5583e-03,
          9.6858e-04, 1.4184e-03],
         [1.6275e-03, 1.9322e-03, 3.6392e-03,  ..., 2.7127e-03,
          5.4322e-04, 6.7511e-04],
         [3.3638e-03, 3.6392e-03, 2.0000e-03,  ..., 3.0134e-03,
          5.7905e-04, 7.1304e-04],
         ...,
         [9.7068e-05, 1.4002e-04, 4.0829e-04,  ..., 5.8048e-04,
          3.2474e-04, 5.8928e-04],
         [8.1658e-04, 8.9497e-04, 8.5170e-04,  ..., 1.0329e-03,
          6.8010e-04, 1.2181e-03],
         [3.1803e-04, 8.9497e-04, 1.6475e-03,  ..., 4.7689e-04,
          1.0415e-03, 9.5993e-04]],

        [[1.3390e-03, 6.2138e-04, 7.5010e-04,  ..., 1.0409e-03,
          2.6156e-03, 2.0440e-03],
         [6.2138e-04, 9.0859e-04, 1.9322e-03,  ..., 9.6626e-04,
          8.1964e-04, 1.4872e-03],
         [1.1100e-03, 3.3638e-03, 4.4393e-04,  ..., 1.6498e-03,
          1.4442e-03, 1.0255e-03],
         ...,
         [9.7068e-05, 4.1967e-04, 3.2116e-04,  ..., 5.2944e-04,
          8.8985e-04, 1.9192e-03],
         [3.2116e-04, 4.7709e-04, 8.4281e-04,  ..., 8.2922e-04,
          1.1643e-03, 1.2898e-03],
         [1.6177e-04, 4.7709e-04, 8.4218e-04,  ..., 2.7444e-04,
          1.3063e-03, 1.2212e-03]],

        ...,

        [[5.9803e-04, 6.0541e-04, 5.7102e-04,  ..., 1.2877e-03,
          5.6933e-04, 4.5514e-04],
         [1.2345e-03, 9.9077e-04, 1.6588e-03,  ..., 9.9859e-04,
          2.4975e-03, 9.9547e-03],
         [2.7692e-04, 9.9077e-04, 1.8476e-04,  ..., 7.0254e-04,
          1.0741e-02, 1.9116e-03],
         ...,
         [4.5480e-04, 3.3018e-04, 1.4175e-03,  ..., 1.9264e-03,
          5.5091e-04, 1.4518e-04],
         [4.5480e-04, 5.9926e-04, 1.9996e-03,  ..., 1.6342e-03,
          4.4536e-04, 4.8397e-04],
         [5.9926e-04, 9.5845e-04, 1.6480e-03,  ..., 4.2364e-04,
          4.6592e-04, 2.1037e-04]],

        [[9.6886e-04, 5.7102e-04, 1.5466e-03,  ..., 5.4730e-04,
          1.4170e-03, 2.7519e-03],
         [5.1885e-04, 1.6588e-03, 1.5466e-03,  ..., 1.7099e-03,
          7.9408e-04, 9.3702e-04],
         [1.0392e-03, 2.3841e-03, 1.8476e-04,  ..., 9.5891e-03,
          5.1530e-03, 4.1035e-03],
         ...,
         [8.7857e-04, 1.3957e-03, 1.2949e-03,  ..., 1.1574e-03,
          1.2609e-03, 1.1344e-03],
         [1.3957e-03, 2.4663e-03, 3.0406e-03,  ..., 2.2475e-03,
          5.8121e-04, 6.0875e-04],
         [2.4663e-03, 2.6075e-03, 1.2366e-03,  ..., 2.4182e-03,
          8.6151e-04, 2.3963e-03]],

        [[6.2921e-04, 9.6886e-04, 2.8892e-04,  ..., 9.0827e-04,
          1.8388e-03, 2.1358e-03],
         [4.8241e-04, 5.1885e-04, 2.8892e-04,  ..., 5.2875e-03,
          9.0808e-03, 4.6511e-03],
         [2.3841e-03, 1.7771e-03, 4.0825e-04,  ..., 1.2952e-02,
          2.1800e-03, 3.9513e-03],
         ...,
         [4.6683e-04, 2.9728e-03, 1.2949e-03,  ..., 3.3386e-05,
          1.6342e-03, 1.2801e-03],
         [2.9728e-03, 3.1963e-03, 3.0406e-03,  ..., 1.9264e-03,
          1.7187e-03, 6.6912e-04],
         [3.1963e-03, 2.6075e-03, 1.4376e-03,  ..., 4.9722e-04,
          3.4729e-03, 2.4031e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:2117.10205078125


loss.item(): 42342.0390625


Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([59, 98]) torch.Size([59, 98, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 1.4040e+00,  4.5969e+00,  4.3504e+00,  3.1596e+00,  2.7795e+00,
          4.9879e-01,  7.4626e+00,  1.0229e+01,  5.2164e-01, -1.2337e+01],
        [-3.2908e+00, -2.6996e+00, -6.3937e+00,  2.4041e-01,  5.2687e+00,
          9.9426e+00,  9.1528e+00,  9.5734e+01,  2.0685e+01,  3.4522e+01],
        [ 5.8253e-01, -1.4882e+01, -2.7403e+01, -1.5991e+01,  9.0514e+01,
          1.9204e+01, -2.3588e+02,  1.9759e+02, -4.7065e+02,  2.7512e+02],
        [-2.0419e+01,  1.3843e+01, -1.4480e+00,  2.0883e+01,  7.2091e+01,
          6.1661e+02, -1.8561e+01,  5.3194e+02, -8.7543e+01, -5.7065e+02],
        [ 1.1780e+01, -8.4057e+00, -2.1878e+00,  5.5826e+02,  5.5497e+02,
          7.5882e+02,  9.4559e+02,  1.3442e+03, -7.7504e+01,  1.9060e+02],
        [-1.0509e+01,  1.9119e+01,  1.6656e+02,  5.7628e+02,  1.0117e+03,
         -6.6558e+02,  8.3293e+02,  1.6504e+03, -1.2158e+02,  1.4467e+03],
        [ 3.4112e+00,  4.3035e+00,  5.6407e+02,  8.0100e+02,  3.9340e+02,
         -1.2316e+04, -7.0243e+02,  1.1666e+03,  1.2916e+02, -1.0972e+03],
        [-2.7309e+00,  2.8706e+01,  8.9510e+01,  9.6643e+02,  6.4344e+02,
          1.1207e+02, -8.1050e+03,  6.9380e+02, -5.1177e+02, -1.1008e+04]]) 

MatU.grad[0:10,35:45]: 
tensor([[[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[  488.4095,  -366.9297],
         [ -669.2017,    71.2159],
         [  374.6219,   776.2484],
         [ -294.1638,   -17.2294],
         [  242.5247,  -696.9795],
         [  -58.0138,   -66.6124],
         [ -206.9245,   697.6710],
         [ -242.5362,   238.1314],
         [   74.8285,   885.1346],
         [ -127.0456,  -283.4349]],

        [[ 1543.2496,  1009.1642],
         [ 1303.6619,  -195.6516],
         [-1234.1196, -1467.2837],
         [-1981.4292,   196.3708],
         [ 1497.5709,   862.4662],
         [ 1155.4810,  -344.4296],
         [-2115.4038, -1212.0667],
         [ 2136.0027,  -559.6055],
         [-1850.0460, -1186.3042],
         [  354.0812,  1858.8131]],

        [[ 2210.4277,  3900.4443],
         [-1040.9576,  -238.3721],
         [ 2341.8484, -4946.6191],
         [-4916.2031,   934.8397],
         [  584.3933,  4231.1382],
         [ 2090.0999, -2345.0974],
         [-5333.9932, -1161.3107],
         [ 3911.3882, -1608.4668],
         [ 2946.4058,  2135.0596],
         [-5831.1982, -1651.4641]],

        [[-1047.1002, -3216.2261],
         [-5094.0908,  3077.8049],
         [ 7401.8989,  2344.9060],
         [  319.4274, -3756.7744],
         [-5282.9761,   669.3934],
         [  913.4145,  7076.0864],
         [-3815.3616, -3258.1069],
         [ 5318.5713,   660.4656],
         [-1944.1621,  3884.6665],
         [-3881.5125, -5592.5576]],

        [[ 3899.8762,  1878.6672],
         [-4770.8535, -1421.1271],
         [ 2603.7683,  1133.1582],
         [ 4018.7930, -6705.9194],
         [ 1804.8011,  -512.4644],
         [   23.8800,  1647.2366],
         [ -810.5209,  1781.8887],
         [ 6497.7886, -1626.0352],
         [-6848.3433, -1927.0774],
         [  463.5302,  7740.4448]],

        [[  681.0952, -1762.7388],
         [-3412.1528,  3873.1560],
         [-7057.1074, -3950.8953],
         [ 5743.1079,  3485.8254],
         [ 1817.3337,  -445.9574],
         [ -639.0045,  -790.1432],
         [  -13.4299,  1321.2570],
         [ 1678.1443,  -643.6706],
         [  344.3640,   -67.2569],
         [ -571.5283,  1584.8524]],

        [[ 5256.4580, -1593.1147],
         [-8533.4941, -3132.3455],
         [ 3120.1636,  5073.2856],
         [-3467.6357, -1094.8490],
         [ 1360.9430,  -766.7207],
         [ 1224.7362,    40.6601],
         [ -779.5754,  -494.8970],
         [ 1275.6321,  -185.7186],
         [ 1423.8760,   435.4611],
         [-1305.7228, -1457.9144]]]) 

MatD.grad: 
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0230,  ..., 0.0000, 0.0000, 0.0000],
        ...,
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.5104e+01, -1.8133e+02],
         [-1.3760e+02, -2.9040e+01],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.3836e+02,  1.3342e+02],
         [ 1.8736e+02,  2.5753e+02],
         [ 1.8013e+02,  2.9845e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 2.8946e+00,  1.0722e+02],
         [-9.5453e+01,  4.8873e+01],
         [ 1.8673e+02,  1.2909e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 3.1812e+02, -1.7186e+02],
         [-1.1609e+01, -7.6113e+02],
         [ 5.1946e+02, -2.5518e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 6.2298e+02, -1.2433e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.1863e+02, -1.3795e+02],
         [-1.4484e+02, -1.1576e+01],
         [ 1.0767e+03, -4.2871e+02],
         [-2.8417e+03, -1.7979e+03],
         [-9.9443e+02,  3.0312e+02],
         [ 1.3085e+03, -1.3710e+03],
         [-1.6516e+03, -9.2774e+02],
         [ 5.7884e+03,  1.1888e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-3.4918e+02,  3.0296e+02],
         [ 7.6466e+02,  1.2234e+03],
         [ 6.8378e+02,  3.5358e+03],
         [-7.0781e+03,  2.0812e+03],
         [ 4.7783e+03,  6.7455e+03],
         [-1.4222e+03,  5.1447e+03],
         [ 3.9792e+03,  6.0347e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 7.2209e+02,  4.4691e+02],
         [-1.2811e+02, -1.9317e+03],
         [ 1.2139e+03, -5.7005e+02],
         [-3.2343e+02, -4.8450e+03],
         [ 4.1284e+02, -8.1121e+03],
         [ 1.5664e+03, -1.1885e+03],
         [-5.3298e+03,  5.1230e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-8.2667e+02, -1.6158e+02],
         [ 1.9927e+03,  5.6075e+02],
         [-3.8258e+03, -3.4232e+03],
         [-4.6609e+03,  2.0153e+03],
         [ 7.9053e+03, -4.3701e+03],
         [ 5.9146e+03, -3.8692e+03],
         [-5.0497e+03, -6.3263e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-3.9239e+02, -4.7547e+01],
         [ 6.1872e+02,  1.9062e+03],
         [ 9.6613e+02,  3.8988e+03],
         [-8.5532e+03,  1.2323e+03],
         [ 5.5161e+03,  8.0422e+03],
         [ 6.5670e+03,  3.1895e+03],
         [ 1.0083e+02, -1.2246e+03]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[ 6085.4058, -1763.1036],
         [  203.7075, -4734.4751],
         [-3847.5552, -5839.2334],
         [-6450.4604, -3040.9045],
         [  995.2974,  2863.1287],
         [ 6322.7964,  6715.0708],
         [ -958.0494, -8297.8535],
         [  877.7407,  1107.7173],
         [ 5808.3491,  -618.4980],
         [-6293.2593, -4769.2236]],

        [[   54.3560,  3745.9407],
         [  -62.3601, -5888.5176],
         [-1287.7329, -1711.9138],
         [-1403.0248,  8377.7900],
         [ 4555.1958,   365.5328],
         [-5105.9614, -7077.4644],
         [ 7877.7563,  -901.4976],
         [-2028.6824,   575.0313],
         [ -824.5791,   160.2484],
         [ 4320.7627, -7119.3110]],

        [[-1951.2461, -8142.5654],
         [ 1203.6946, -9368.2324],
         [ 6441.2979,  1544.6545],
         [-7389.3472, -2452.2588],
         [-3240.8149,   858.7062],
         [  902.5228,   206.4946],
         [ 7628.4116,  3330.3630],
         [-2073.6057, -4026.4282],
         [-8197.6357,  1677.1085],
         [ 2418.2466,  8620.7852]],

        [[-4138.9038,  7771.9517],
         [ 8964.0811,  1545.1847],
         [ 2477.5459,  3369.7168],
         [-5044.4629,  1082.8652],
         [-3266.7092,   869.7668],
         [ 3263.2764,  8742.7256],
         [ 1670.2302,  1286.0901],
         [ 1471.5192,  5965.5742],
         [ 3586.7734,  1113.7111],
         [-2683.6223, -6118.0498]],

        [[-8588.2656,  1759.5277],
         [ 6743.4424,  6602.4478],
         [ -259.7581, -3656.4402],
         [-4762.1094,  1577.0031],
         [ 7270.9258, -2602.3076],
         [-3863.3193, -7997.8950],
         [ 6641.6226,  1555.2334],
         [-1334.2639, -4564.5029],
         [-6590.4097, -3130.9817],
         [ 7070.0264, -3633.4846]],

        [[-1456.8306, -7698.8882],
         [ -702.8896,  4201.1196],
         [ 2615.5559, -1564.2905],
         [-6591.6440, -1386.6331],
         [ -868.4171,  5680.4214],
         [ 5722.3203, -1668.1257],
         [ 2012.6616,  1941.0997],
         [-1254.0675, -2723.2053],
         [-5991.8511, -1487.7727],
         [ -179.8689,  2627.5122]],

        [[ 6724.5654,  5677.4380],
         [-2037.8027, -9212.4668],
         [ 2323.6797, -5871.7642],
         [-1541.4298, -1992.0266],
         [-5805.6758,    89.5079],
         [ 5138.3252, -7257.3027],
         [ -851.9716,  2153.3025],
         [ -806.7203, -1618.9185],
         [-1863.5905,  8287.6602],
         [   10.0203,  2408.1331]],

        [[-8878.1338,  1076.2074],
         [ 3545.9990,  7717.0312],
         [ 5190.4565,  3968.4841],
         [  277.1488,  3827.5591],
         [-8622.4482,  -373.6039],
         [ 6884.6616,  5842.8018],
         [-4187.4053, -1215.6926],
         [ 6261.4175, -4831.9282],
         [-6977.7114, -6191.7095],
         [ 5998.9731,  -407.8510]],

        [[  155.6281, -7685.4443],
         [-2360.6582,  3654.2246],
         [ 2616.7632,  -560.1222],
         [-1573.1027, -8747.9961],
         [  663.5370, -5622.1577],
         [  910.5487,   985.3317],
         [-4559.8999,  1733.7256],
         [ 3996.3665,  3546.7061],
         [ -885.3112, -7349.2622],
         [ 3841.5264, -1895.9860]],

        [[ 7817.4429,  5227.0288],
         [-3852.1631, -1895.3389],
         [-6431.2744, -4645.8281],
         [ 2515.7058,  6245.9565],
         [ 1913.0165,  7214.5547],
         [  339.1231, -7651.1733],
         [ -965.1330, -2780.6414],
         [-1289.5088,  7325.0713],
         [  950.5784,  5548.2544],
         [ 3757.2861,  -477.3417]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[ 6175.8022,  -478.3866],
         [-7587.3594,  -849.9658],
         [-1062.6890, -1106.5459],
         [ 8111.2983,  -611.9603],
         [-8166.3281, -4216.0811],
         [ 9644.0195,    94.1108],
         [-3329.2380, -6963.0508],
         [-6270.5396, -4398.2007],
         [ 6414.3174,  -765.9182],
         [-1460.4795,  2757.1946]],

        [[ 4001.0361, -3597.8718],
         [-6991.4263,  3887.0598],
         [   74.5539,   238.6547],
         [ 4999.9771,   654.5964],
         [-5746.9326,  1992.6533],
         [ 6087.3271,  1373.0909],
         [-1951.2338, -4020.6106],
         [-1213.0176,  8396.9668],
         [ 7182.1558,  3118.8313],
         [-2276.9080, -5228.7754]],

        [[ 5827.6069,  2809.4814],
         [-7673.0840, -2610.2444],
         [ 1054.5518,   503.6792],
         [ 5993.4487,   431.2729],
         [-4096.5068, -2285.0620],
         [  437.7522,  2566.6753],
         [ 7065.5601,  -314.3143],
         [-4373.3726, -5185.5591],
         [-1738.9078,   154.7133],
         [ 1133.4078,  3706.0791]],

        [[ 1726.8865, -2483.0337],
         [-5332.3008,   146.5570],
         [ 1183.8829,  5141.6191],
         [ 2259.2073, -6672.4746],
         [  380.1559, -6981.9839],
         [-1995.4907,  4761.2974],
         [  918.1640, -8706.4824],
         [  759.8815, -6585.2930],
         [  276.6362, -2593.3291],
         [ -362.5107,  1652.9321]],

        [[ 3444.7244,  -402.6013],
         [-2885.8369,  5037.9253],
         [-6255.0186, -1942.5427],
         [ -835.6013,  4249.8711],
         [ 6430.3965,  6461.0454],
         [-9376.3486,  -449.9320],
         [ 2396.2175,  7748.7368],
         [-1222.2690,   509.9801],
         [  843.5114,   889.4020],
         [ -908.7913,  -676.3972]],

        [[ 6056.3574,  2456.6631],
         [-7754.5176, -3302.7424],
         [-1693.0842,   633.6743],
         [ 8100.0752,  -231.0705],
         [-5946.2397, -1101.9531],
         [ 4362.9551,  1932.9824],
         [-5767.2808,   641.2990],
         [ 1938.3011,   -94.4991],
         [ -712.3793,  -858.3538],
         [-1039.7881,   193.5287]],

        [[ 2544.0137, -2974.4690],
         [-3472.3926, -2925.5862],
         [ -326.0244, -4101.4277],
         [ 5411.4878, -4365.6821],
         [-2055.0315, -6270.6104],
         [ 1874.3362,   620.5644],
         [  978.1645, -8012.8657],
         [  -23.5433, -1212.3604],
         [  542.3800, -1012.1290],
         [  -63.4033,  -213.7529]],

        [[ 3691.5034,  -570.8141],
         [-2160.5957,  4456.8008],
         [-1775.7124,  -327.4467],
         [  -90.9438,   -96.0389],
         [ 4430.0176,  5354.4531],
         [-8985.3721,  -334.0840],
         [ 1873.2202,  7512.6787],
         [ -837.8962,  -987.8543],
         [ 5936.8770,  3843.8989],
         [-5646.6812,  -277.8085]],

        [[ 7438.2222, -1082.0770],
         [-4901.9199, -3678.2180],
         [-1331.5200,  1705.8821],
         [ 4098.8047,  1170.3033],
         [-1434.9890,  1792.7404],
         [ 4176.8882,  2396.8904],
         [-6986.5752,  2920.5493],
         [ 4236.5977,  7723.0200],
         [  325.3952,  5745.5483],
         [ -486.7090,  1167.1925]],

        [[ 3282.2446,  7952.1367],
         [ -557.4296,  5654.8042],
         [  559.1349,  7784.6836],
         [ 1992.1462, -6539.8511],
         [ 1208.8906, -6433.9912],
         [ 3651.1384, -7444.0371],
         [ 2630.5547, -8847.3145],
         [  147.1337, -6056.2104],
         [-2458.5891, -9182.9678],
         [ 2343.1309, -8496.1992]]]) 

Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0144,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]],
       grad_fn=<SelectBackward>)

Epoch 0 finished. Total time: 319.28816628456116;  Epoch time: 319.28816628456116 












test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
test_counter in loss_omega_mat(): 4046
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9455, 0.9454, 0.9451,  ..., 0.6405, 0.6063, 0.6063],
         [0.4518, 0.4330, 0.4180,  ..., 0.2870, 0.2869, 0.2866],
         [0.4329, 0.4180, 0.4135,  ..., 0.2866, 0.2835, 0.2703],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.7572, 0.7571, 0.7571],
         [0.9458, 0.9458, 0.9458,  ..., 0.7572, 0.7571, 0.7569],
         [0.9459, 0.9459, 0.9458,  ..., 0.7570, 0.7569, 0.7566]],

        [[0.9458, 0.9457, 0.9456,  ..., 0.6410, 0.6408, 0.6406],
         [0.9458, 0.9456, 0.9454,  ..., 0.6404, 0.6063, 0.6061],
         [0.9458, 0.9455, 0.9454,  ..., 0.6402, 0.6063, 0.6062],
         ...,
         [0.9458, 0.9457, 0.9457,  ..., 0.7572, 0.7572, 0.7572],
         [0.9459, 0.9458, 0.9458,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7572, 0.7571, 0.7570]],

        [[0.9458, 0.9458, 0.9457,  ..., 0.7569, 0.7569, 0.6410],
         [0.9458, 0.9457, 0.9457,  ..., 0.7569, 0.6410, 0.6409],
         [0.9458, 0.9457, 0.9455,  ..., 0.6410, 0.6409, 0.6408],
         ...,
         [0.9458, 0.9457, 0.9457,  ..., 0.7572, 0.7572, 0.7572],
         [0.9459, 0.9458, 0.9458,  ..., 0.7573, 0.7572, 0.7572],
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7572, 0.7571]],

        ...,

        [[0.9458, 0.9458, 0.9458,  ..., 0.7572, 0.7572, 0.7569],
         [0.9459, 0.9458, 0.9458,  ..., 0.7573, 0.7564, 0.7471],
         [0.9458, 0.9458, 0.9452,  ..., 0.7572, 0.7419, 0.7414],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7571, 0.7571, 0.7568],
         [0.9459, 0.9458, 0.9458,  ..., 0.7571, 0.7568, 0.7567],
         [0.9458, 0.9456, 0.9456,  ..., 0.7568, 0.7567, 0.7563]],

        [[0.9458, 0.9458, 0.9457,  ..., 0.7572, 0.7569, 0.7566],
         [0.9458, 0.9458, 0.9458,  ..., 0.7535, 0.7499, 0.7430],
         [0.9454, 0.9452, 0.9452,  ..., 0.7490, 0.7417, 0.7363],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.7569, 0.7569, 0.7567],
         [0.9458, 0.9457, 0.9456,  ..., 0.7569, 0.7568, 0.7565],
         [0.9457, 0.9457, 0.9456,  ..., 0.7566, 0.7565, 0.7563]],

        [[0.9458, 0.9457, 0.9457,  ..., 0.7568, 0.7566, 0.7536],
         [0.9458, 0.9458, 0.9454,  ..., 0.7500, 0.7478, 0.7397],
         [0.9452, 0.9450, 0.9434,  ..., 0.7445, 0.7399, 0.7314],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.7568, 0.7564, 0.7559],
         [0.9458, 0.9456, 0.9455,  ..., 0.7568, 0.7563, 0.7563],
         [0.9457, 0.9456, 0.9455,  ..., 0.7566, 0.7563, 0.7563]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[6.9084e-08, 4.9169e-07, 1.4732e-08,  ..., 1.9668e-06,
          2.0920e-08, 1.3259e-07],
         [1.0406e-07, 7.4093e-08, 3.1915e-09,  ..., 1.3856e-10,
          2.3827e-07, 3.5962e-06],
         [2.9993e-07, 2.0596e-06, 7.5875e-08,  ..., 7.3108e-06,
          7.9565e-07, 6.2201e-06],
         ...,
         [8.4111e-09, 3.5881e-07, 1.4178e-06,  ..., 1.7238e-07,
          4.6707e-07, 1.5841e-06],
         [3.2024e-09, 8.9002e-07, 1.3386e-07,  ..., 6.7478e-07,
          1.1042e-06, 7.4912e-09],
         [2.4577e-10, 7.8082e-08, 2.4577e-10,  ..., 4.1370e-08,
          2.4577e-10, 1.3027e-07]],

        [[6.3732e-09, 1.0655e-06, 8.4671e-07,  ..., 3.2785e-07,
          2.7041e-07, 4.9863e-07],
         [2.3952e-06, 8.4671e-07, 2.9993e-07,  ..., 9.3287e-06,
          1.9206e-05, 5.7358e-08],
         [6.3732e-09, 6.3732e-09, 4.7312e-06,  ..., 9.8313e-06,
          2.8282e-05, 8.3105e-06],
         ...,
         [5.3261e-11, 8.4111e-09, 2.5000e-07,  ..., 1.7334e-06,
          4.6707e-07, 1.3636e-06],
         [8.4111e-09, 8.4111e-09, 1.1918e-06,  ..., 4.6707e-07,
          3.5638e-08, 3.9169e-07],
         [2.0314e-07, 7.4253e-07, 1.9126e-08,  ..., 1.2955e-07,
          2.2695e-07, 1.4931e-06]],

        [[2.5000e-07, 6.3732e-09, 8.9422e-07,  ..., 6.3732e-09,
          3.7855e-06, 3.0029e-07],
         [6.3732e-09, 1.4732e-08, 1.4732e-08,  ..., 1.7492e-06,
          4.3946e-07, 8.8408e-07],
         [1.7640e-06, 7.4670e-08, 2.5730e-07,  ..., 1.5963e-08,
          2.4823e-06, 6.9241e-07],
         ...,
         [9.8932e-07, 8.4111e-09, 1.6235e-07,  ..., 1.2222e-08,
          4.6442e-07, 1.3878e-06],
         [2.9234e-08, 5.6315e-08, 5.8170e-07,  ..., 2.9035e-09,
          1.9402e-07, 3.2383e-08],
         [3.0386e-07, 1.5108e-08, 4.4009e-07,  ..., 2.0581e-06,
          1.3810e-08, 3.7836e-09]],

        ...,

        [[1.0645e-08, 2.5587e-07, 8.9277e-08,  ..., 1.6869e-06,
          2.2816e-06, 9.5229e-09],
         [8.1355e-07, 5.0400e-09, 5.0400e-09,  ..., 7.5653e-07,
          1.4006e-08, 1.9714e-09],
         [9.5228e-09, 1.3024e-08, 7.5837e-09,  ..., 5.0653e-07,
          1.1352e-04, 7.0369e-06],
         ...,
         [4.1852e-07, 1.2466e-07, 5.8212e-07,  ..., 3.6966e-06,
          2.2549e-06, 1.7314e-06],
         [5.9822e-09, 1.1169e-06, 4.8420e-09,  ..., 5.1788e-06,
          4.9290e-06, 1.5118e-06],
         [4.2323e-07, 4.1012e-08, 1.8095e-07,  ..., 8.3588e-07,
          3.7604e-07, 2.9808e-06]],

        [[1.3116e-06, 1.5531e-08, 1.6956e-08,  ..., 1.5063e-09,
          1.6777e-08, 2.3439e-07],
         [1.2817e-07, 1.9715e-09, 8.9277e-08,  ..., 4.0469e-07,
          4.6877e-07, 3.0240e-06],
         [4.2459e-09, 9.5228e-09, 8.4186e-09,  ..., 8.8583e-08,
          4.3111e-06, 2.6866e-05],
         ...,
         [1.1990e-06, 6.5566e-09, 1.1685e-06,  ..., 5.9962e-07,
          2.1732e-06, 4.8971e-08],
         [3.1214e-08, 1.7219e-06, 2.3874e-07,  ..., 4.3234e-06,
          1.6897e-06, 2.7946e-08],
         [4.5699e-09, 8.0086e-09, 8.3676e-09,  ..., 1.2234e-07,
          5.0140e-07, 1.6424e-07]],

        [[8.9277e-08, 4.9893e-07, 1.2294e-06,  ..., 4.9169e-07,
          1.2828e-06, 1.3132e-08],
         [2.4444e-07, 4.3923e-07, 4.9991e-07,  ..., 2.3261e-07,
          2.4420e-07, 5.1597e-06],
         [2.1517e-06, 1.1919e-06, 2.8020e-06,  ..., 1.0893e-04,
          5.1405e-06, 2.1778e-05],
         ...,
         [8.7083e-09, 4.5622e-07, 9.7076e-07,  ..., 1.4800e-09,
          9.1731e-07, 1.0207e-06],
         [8.9340e-10, 2.5578e-07, 2.4237e-06,  ..., 1.2923e-05,
          1.0872e-05, 7.0789e-06],
         [2.7348e-09, 2.7437e-06, 8.5201e-08,  ..., 2.5497e-06,
          7.2449e-06, 1.4298e-06]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[4.5880e-04, 4.1091e-04, 4.4929e-04,  ..., 1.5000e-04,
          2.2025e-04, 0.0000e+00],
         [3.8196e-04, 1.0789e-03, 2.2013e-03,  ..., 8.2374e-04,
          5.9267e-04, 6.7075e-04],
         [1.9521e-03, 4.9516e-04, 1.8406e-03,  ..., 7.2430e-04,
          3.1642e-04, 1.2891e-03],
         ...,
         [9.0641e-04, 6.9072e-04, 1.1353e-03,  ..., 6.7586e-04,
          1.1353e-03, 4.5979e-04],
         [1.4830e-04, 2.6579e-04, 3.3711e-04,  ..., 8.9923e-04,
          4.0913e-05, 1.3004e-03],
         [7.3224e-04, 6.2999e-04, 7.9380e-04,  ..., 1.9018e-04,
          5.9180e-04, 9.2632e-04]],

        [[5.7983e-04, 1.6916e-03, 6.2749e-04,  ..., 1.2274e-03,
          4.8226e-04, 4.4053e-04],
         [1.6280e-03, 6.2749e-04, 2.7809e-03,  ..., 1.5820e-03,
          5.4322e-04, 6.7511e-04],
         [2.4910e-03, 1.4694e-03, 2.7809e-03,  ..., 1.6593e-03,
          7.1304e-04, 5.7905e-04],
         ...,
         [9.0641e-04, 9.0293e-04, 5.9171e-04,  ..., 5.8012e-04,
          8.6893e-04, 6.0903e-04],
         [6.4740e-04, 1.4830e-04, 8.9497e-04,  ..., 6.5664e-04,
          5.0635e-04, 4.0829e-04],
         [7.3224e-04, 1.1386e-03, 6.8252e-04,  ..., 8.0694e-04,
          9.5993e-04, 9.9213e-04]],

        [[5.6559e-04, 5.7983e-04, 1.3790e-03,  ..., 5.8178e-04,
          3.4657e-04, 1.4430e-03],
         [1.6280e-03, 4.2471e-04, 1.1773e-03,  ..., 3.3317e-04,
          1.1124e-03, 1.9448e-04],
         [2.4910e-03, 1.1100e-03, 8.7069e-04,  ..., 4.8048e-04,
          6.0827e-04, 9.4389e-04],
         ...,
         [3.2116e-04, 9.0293e-04, 1.0795e-03,  ..., 1.2867e-03,
          5.9172e-04, 9.0361e-04],
         [6.4740e-04, 4.7709e-04, 5.8688e-04,  ..., 6.4240e-04,
          3.0991e-04, 6.0863e-04],
         [9.0096e-04, 1.1386e-03, 4.7709e-04,  ..., 3.6835e-04,
          2.7444e-04, 6.0456e-04]],

        ...,

        [[4.0197e-04, 8.7342e-04, 9.8189e-04,  ..., 8.4498e-04,
          1.3694e-03, 9.9410e-04],
         [6.2641e-04, 1.8657e-04, 3.4422e-04,  ..., 6.8915e-04,
          1.5771e-03, 8.6972e-03],
         [1.8657e-04, 8.2114e-04, 1.8476e-04,  ..., 7.4003e-04,
          1.0287e-02, 1.2041e-03],
         ...,
         [7.2201e-04, 4.5480e-04, 4.3543e-04,  ..., 5.8565e-04,
          1.4518e-04, 1.0440e-03],
         [4.5480e-04, 1.2572e-03, 1.0321e-03,  ..., 5.5573e-04,
          9.1350e-04, 1.1591e-03],
         [1.0321e-03, 9.5845e-04, 9.7310e-04,  ..., 6.7125e-04,
          8.6625e-04, 1.1211e-03]],

        [[5.1962e-04, 4.1503e-04, 4.2904e-04,  ..., 7.9528e-04,
          1.7558e-03, 1.0355e-03],
         [4.1503e-04, 3.4422e-04, 5.1885e-04,  ..., 1.4019e-03,
          2.9353e-04, 8.5792e-04],
         [3.6492e-04, 1.8476e-04, 1.5874e-03,  ..., 9.4179e-03,
          4.3380e-03, 3.3537e-03],
         ...,
         [8.7857e-04, 1.6592e-04, 3.2428e-04,  ..., 2.6661e-04,
          4.6044e-04, 3.7572e-04],
         [1.6592e-04, 1.2448e-03, 1.0079e-03,  ..., 6.0875e-04,
          6.0495e-04, 2.5684e-04],
         [1.2448e-03, 1.3516e-03, 1.0442e-03,  ..., 1.4127e-03,
          1.7827e-03, 8.6151e-04]],

        [[2.8892e-04, 4.4958e-04, 4.6965e-04,  ..., 6.3233e-04,
          1.8388e-03, 1.9879e-03],
         [2.8892e-04, 5.1885e-04, 9.1121e-04,  ..., 5.2875e-03,
          9.0808e-03, 4.6511e-03],
         [1.5874e-03, 1.9379e-03, 4.0825e-04,  ..., 1.2038e-02,
          2.1800e-03, 2.5421e-03],
         ...,
         [4.6683e-04, 1.6109e-03, 3.2428e-04,  ..., 1.6795e-04,
          3.3386e-05, 2.2629e-04],
         [1.6109e-03, 1.7849e-03, 1.6291e-03,  ..., 1.0440e-03,
          3.6323e-04, 1.6444e-03],
         [1.3516e-03, 1.7849e-03, 9.5589e-04,  ..., 4.9722e-04,
          1.0673e-03, 2.2481e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:2.501488447189331 loss2:1938.388427734375


loss.item(): 38770.26953125


Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([59, 98]) torch.Size([59, 98, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 6.6214e-01,  3.0332e+00,  3.6919e+00,  1.6645e+00,  1.7213e+00,
          9.8116e-01,  6.2068e+00,  1.0342e+01,  1.1640e+00, -1.2399e+01],
        [-6.3746e-01,  3.5833e+00, -1.0809e+01, -4.0952e+00,  8.0122e+00,
          1.4219e+01,  6.7786e+00,  1.0087e+02,  2.5786e+01,  4.1839e+01],
        [-1.0319e+01, -1.0755e+00, -1.3907e+01, -2.7299e+01,  6.4916e+01,
          2.7496e+01, -2.3858e+02,  2.0984e+02, -4.7640e+02,  2.7175e+02],
        [-1.0500e+01, -2.7389e+01,  1.9439e+01,  2.8686e+01,  7.2315e+01,
          6.1498e+02,  4.8726e+01,  5.2968e+02, -1.3702e+02, -6.0030e+02],
        [-8.8334e+00,  3.6099e+01, -2.1547e+01,  5.6055e+02,  5.9071e+02,
          7.6033e+02,  9.5367e+02,  1.2155e+03,  1.4186e+00,  2.6089e+02],
        [-1.4059e+00,  5.2221e+00,  1.2804e+02,  5.8126e+02,  1.0211e+03,
         -7.3734e+02,  8.3563e+02,  1.6057e+03, -1.7466e+02,  1.4340e+03],
        [-1.4010e+01, -1.1047e+01,  5.2868e+02,  7.6462e+02,  4.0587e+02,
         -1.2000e+04, -7.8456e+02,  1.1643e+03,  1.8653e+02, -1.1609e+03],
        [ 3.1750e+01,  3.5119e+01,  5.5955e+01,  9.4687e+02,  6.3195e+02,
          1.2407e+02, -7.8218e+03,  7.0567e+02, -6.3079e+02, -1.0673e+04]]) 

MatU.grad[0:10,35:45]: 
tensor([[[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[  502.1714,  -422.8353],
         [ -670.6212,  -110.1379],
         [  204.7312,   649.8967],
         [ -448.9680,   363.9077],
         [   62.7123,  -613.5891],
         [  235.9033,   206.1061],
         [ -296.6860,   837.5475],
         [  -50.7466,   -43.9171],
         [  -11.5729,   890.4867],
         [ -119.2084,  -291.3135]],

        [[ 1650.3406,   847.4702],
         [  949.2021,   284.5634],
         [-1227.5682, -1491.2446],
         [-1998.8510,   -19.0005],
         [ 1564.8007,   821.5146],
         [ 1155.2327,  -137.0320],
         [-2140.7712, -1232.4426],
         [ 2180.1252,  -452.0599],
         [-1846.0626, -1171.2954],
         [  304.9560,  1865.6595]],

        [[ 2058.8369,  3249.4436],
         [  807.8985,  2799.4448],
         [  669.5303, -4737.2622],
         [-4627.3003,  -695.9363],
         [  243.2330,  4031.1184],
         [ 1948.4132, -1877.8900],
         [-5405.3110,  -725.7023],
         [ 3965.4043, -1057.2804],
         [ 2833.3687,  1099.7131],
         [-5820.9126, -1581.7365]],

        [[ 1717.2458, -2358.0798],
         [-5131.4795,  -702.8219],
         [ 7955.1411,  1230.1407],
         [-1686.8900, -2759.5647],
         [-5203.5649,  -598.0046],
         [  740.5969,  7284.9434],
         [-3996.6396, -3279.2097],
         [ 5559.9326,  -198.4523],
         [-1525.1129,  3409.2654],
         [-3832.2864, -5715.6553]],

        [[ 3434.5828, -1485.3325],
         [-3753.9360,  1725.8416],
         [  327.2792, -3927.3396],
         [ 3949.2002, -7077.4087],
         [ 1798.9866,  -387.2467],
         [  -99.5998,  1675.0349],
         [ -685.6630,  1735.4421],
         [ 6822.9102, -1367.5415],
         [-6791.8330, -1893.9301],
         [  184.3267,  7725.6196]],

        [[-2188.4255,  3036.9272],
         [  622.6465, -1170.5272],
         [-7564.0659, -1193.0325],
         [ 5996.5591,  3041.9600],
         [ 1689.6600,  -235.7962],
         [ -620.3548,  -770.6666],
         [  109.4946,  1261.9703],
         [ 1688.4155,  -464.4205],
         [  310.7879,   -17.0528],
         [ -543.0714,  1517.5906]],

        [[ 3984.2729,  2773.1208],
         [-9072.7207, -1169.4359],
         [-1220.8046,    75.8605],
         [ -693.9324,  4512.7964],
         [  686.0208,   473.8548],
         [ 1303.3025,  -145.3085],
         [ -754.0054,  -478.8780],
         [ 1172.1382,   263.8142],
         [ 1382.4938,   413.0026],
         [-1280.4552, -1427.4214]]]) 

MatD.grad: 
tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000, -0.8935,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.5099e+01, -1.8127e+02],
         [-8.1696e+01,  1.3729e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.8954e+02, -3.1552e+01],
         [ 1.3577e+02,  2.8651e+02],
         [-4.0290e+02, -2.5011e+01],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.6374e+00,  1.0536e+02],
         [-1.0359e+02,  1.9137e+01],
         [ 2.0156e+02,  1.0450e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 4.0734e+02,  2.4046e+01],
         [ 1.8313e+02, -7.1995e+02],
         [-9.3017e+01,  6.9317e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.0315e+02, -3.1615e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.8022e+02,  4.8083e+02],
         [ 8.0105e+02, -2.1216e+01],
         [ 4.0203e+02,  5.7969e+02],
         [-1.4358e+01, -1.0542e+03],
         [ 1.2929e+03, -1.2465e+03],
         [-9.0936e+02, -2.3603e+02],
         [ 4.1047e+03, -3.7250e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 2.3595e+02, -3.2499e+02],
         [ 6.0436e+02,  1.2876e+03],
         [-4.2406e+03, -1.1263e+03],
         [-7.3574e+03, -7.6574e+02],
         [ 4.5595e+03,  6.9090e+03],
         [ 6.1354e+03,  1.6397e+03],
         [ 1.3199e+03,  3.5775e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 5.6449e+02, -5.4931e+02],
         [ 5.8189e+02, -1.7533e+03],
         [-3.0195e+03,  5.0651e+03],
         [ 4.7318e+03, -2.4952e+03],
         [-4.1348e+03, -6.5669e+03],
         [-3.3571e+03,  5.3365e+03],
         [ 3.3297e+03, -2.3538e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-6.5186e+02,  2.5802e+02],
         [ 1.3462e+03, -2.7899e+02],
         [ 3.8290e+02,  5.2023e+02],
         [ 5.7385e+02, -4.6560e+03],
         [ 8.1787e+03, -1.7902e+03],
         [ 9.9854e+02,  1.3411e+03],
         [ 4.4504e+03, -4.5559e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-5.2787e+01,  2.9205e+02],
         [-1.1590e+03,  8.6686e+02],
         [-5.4253e+03, -1.4081e+03],
         [-7.5566e+03, -3.6997e+03],
         [ 5.4644e+03,  7.9818e+03],
         [ 3.4653e+03, -4.9647e+03],
         [-5.0297e+03,  4.9487e+03]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[ -173.9851,  4104.4595],
         [-7086.1484,  -440.6879],
         [ 1486.7357, -1257.3766],
         [-3297.0112,  3735.8386],
         [-7149.1416, -4468.6934],
         [ 2185.2092,  3092.3347],
         [ 6826.5713,  1007.9274],
         [-7549.7769, -3619.0835],
         [-4360.4380,  6774.6211],
         [ 1041.9332,  3753.9453]],

        [[-3510.7371, -4259.5703],
         [ 6367.8306, -1578.7041],
         [ 4383.2710,  5280.9434],
         [ 5138.7632,  2926.1599],
         [-3096.0095, -5809.2183],
         [ -533.7686,  1050.0439],
         [ 1406.8109,  8753.5645],
         [ 6794.0107, -3968.7126],
         [ 6256.9688, -6145.4717],
         [-3758.0452,   926.6733]],

        [[ -203.8138, -8111.3140],
         [ -114.0540, -9526.5645],
         [ -724.2145, -3220.9941],
         [-4870.8325,  4165.5547],
         [ 6219.7544, -5539.9219],
         [-6586.8003, -4480.1963],
         [ 1516.5282,   -42.0490],
         [ 6193.9414,  5587.9668],
         [  363.6000, -6567.4307],
         [-5127.7290,  3599.8025]],

        [[-3544.4895,  8074.1616],
         [ 9063.3828,   948.3840],
         [-5668.5317, -1645.2014],
         [  191.6002, -4675.5186],
         [ 4730.1836, -4660.3667],
         [-2435.9893,  5112.4346],
         [-5982.7065, -4457.6460],
         [-5717.8765,  -645.5234],
         [-5367.9326, -5608.6753],
         [ 3547.2336,   458.6045]],

        [[-8956.4863,   697.0665],
         [ 6727.8672,  6591.6714],
         [ 3431.3401,  1852.9011],
         [  887.2587, -5207.8901],
         [-1462.3164,  6892.8579],
         [ 2920.4656,  2536.1160],
         [-1546.9805, -5560.3433],
         [ 5504.0229,  3358.7810],
         [  677.3314,  5064.7720],
         [-3578.0422,  5902.4326]],

        [[ -782.2335, -7768.8931],
         [ 2697.3926,  3275.0164],
         [-4295.0884,  3498.2854],
         [ -420.1396,  4747.8188],
         [ 6212.3276, -1256.0316],
         [-4599.9932,  5601.2217],
         [-6052.6211, -5718.5151],
         [ 5895.8301,  4866.4609],
         [ 1479.9357,  6000.2456],
         [ 4829.3286, -7301.7119]],

        [[ 6850.3843,  5547.8076],
         [-1013.0203, -9316.9414],
         [-2728.9434, -4495.0039],
         [ 4079.9216,  1286.8955],
         [  145.2305, -7168.8423],
         [  778.5603, -5105.0293],
         [ 4718.1958, -6494.0420],
         [ 4997.2563,  5289.4131],
         [ 5282.9165, -3449.3477],
         [-7168.6948, -6215.2549]],

        [[-9118.0176,  -553.9852],
         [ 3356.9358,  7837.6450],
         [ 5025.9351,  2441.1470],
         [-3935.6011,   -80.5202],
         [-7251.6060,  3427.4568],
         [ 7092.5898,  5500.5215],
         [  695.0542,  4870.7271],
         [ -652.0011, -1380.8824],
         [-4360.6519, -3101.9595],
         [-2668.6218,  7057.7144]],

        [[-1928.3276, -7879.4580],
         [ 1288.2004,   225.7991],
         [ -186.6148,  2900.1465],
         [  565.8224, -9056.9111],
         [-2959.8989, -4520.7417],
         [-3959.9417, -2295.2493],
         [ -894.4341, -4638.2651],
         [-1202.0367, -1078.5873],
         [ 6035.8696, -4030.5139],
         [-2743.1562,  3756.8921]],

        [[ 7938.9082,  5121.8887],
         [-4127.7856,  -480.3649],
         [-6372.2461, -4344.9751],
         [ 2371.6550,  6232.9360],
         [ 1453.6244,  7421.5381],
         [-1595.6331, -7450.6997],
         [ 3138.4541,  -423.2359],
         [ -402.6564,  7252.7300],
         [-2607.3931, -1437.9260],
         [ -391.3521,  3035.3342]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[ 3.6270e+02,  3.6684e+03],
         [ 7.3838e+02,  5.0574e+03],
         [ 6.5782e+03,  4.9436e+03],
         [ 1.7630e+03,  5.8955e+03],
         [-4.4277e+03, -2.5389e+02],
         [ 8.4809e+03, -4.2089e+03],
         [-7.1910e+01, -3.9103e+03],
         [-4.9143e+03, -2.8532e+03],
         [ 2.2633e+03,  4.7326e+03],
         [ 3.6162e+03, -1.3906e+03]],

        [[ 5.7793e+02,  9.9469e+01],
         [ 7.8351e+02, -3.0856e+03],
         [-5.4797e+03, -5.6302e+03],
         [-1.3489e+03, -5.5696e+03],
         [ 4.7220e+03, -4.8963e+03],
         [ 2.8848e+03, -4.3454e+03],
         [ 1.6077e+02,  5.0319e+02],
         [ 3.6390e+03,  6.6541e+03],
         [ 6.2671e+03, -1.2870e+03],
         [-5.2472e+02, -4.6911e+03]],

        [[ 4.8175e+03, -2.5014e+03],
         [-3.2679e+03,  3.5594e+03],
         [-6.5362e+03, -5.4278e+03],
         [-1.0979e+03, -5.0980e+03],
         [ 3.0645e+03,  5.2304e+03],
         [-5.3076e+03, -2.2539e+03],
         [ 6.4011e+03,  4.3850e+03],
         [-3.5365e+03, -4.8070e+03],
         [ 2.7475e+03, -4.6837e+03],
         [-2.6335e+03,  1.3196e+02]],

        [[-1.6112e+02,  2.4702e+03],
         [ 2.5639e+02, -5.3529e+03],
         [-6.0612e+03, -1.9162e+03],
         [-4.9767e+03,  3.4144e+03],
         [-4.3548e+03,  6.5882e+02],
         [ 4.1094e+03,  5.4177e+02],
         [ 7.2432e+02, -8.7468e+03],
         [-8.7947e+01, -6.6283e+03],
         [ 8.7801e+01, -2.5919e+03],
         [-3.1864e+02,  1.5879e+03]],

        [[ 1.8949e+03,  4.1409e+03],
         [ 2.0116e+03, -2.6052e+03],
         [-1.1142e+03,  3.6658e+03],
         [ 6.6656e+03, -3.5548e+03],
         [ 6.4448e+03,  5.1322e+03],
         [-9.3959e+03,  3.2613e+02],
         [ 2.1142e+03,  7.8240e+03],
         [-9.7556e+02,  8.6751e+01],
         [ 8.2339e+02,  8.0668e+02],
         [-8.7853e+02, -6.5669e+02]],

        [[ 4.6486e+03, -3.3668e+03],
         [-5.9268e+03,  1.0504e+02],
         [ 3.0708e+03, -8.3137e+03],
         [ 8.3227e+02,  7.0275e+03],
         [-3.8548e+03,  3.1248e+03],
         [ 1.5575e+03, -2.5474e+03],
         [-5.6728e+03, -3.8105e+02],
         [ 1.8994e+03, -8.1577e+01],
         [-6.9118e+02, -8.3204e+02],
         [-9.7809e+02,  6.7642e+01]],

        [[-2.3062e+03, -2.5537e+02],
         [-1.6386e+02, -1.0322e+03],
         [ 5.5144e+03,  1.9324e+03],
         [-5.1880e+03,  3.4299e+03],
         [ 1.7166e+03, -2.6125e+03],
         [-1.1887e+03, -3.3463e+03],
         [ 1.7566e+02, -8.0721e+03],
         [ 3.1894e+02, -1.1450e+03],
         [ 3.7661e+02, -1.0251e+03],
         [ 8.2869e+01, -1.6476e+02]],

        [[ 1.6876e+00,  2.5529e+03],
         [ 1.1310e+03, -4.5774e+02],
         [ 3.4778e+03,  4.6155e+03],
         [ 5.2473e+03,  6.2276e+03],
         [-7.1853e+01,  9.4721e+02],
         [-8.9563e+03,  5.5156e+02],
         [ 1.6677e+03,  7.5684e+03],
         [-5.3083e+02,  1.4677e+02],
         [ 5.9930e+03,  4.0263e+03],
         [-5.6558e+03,  7.7871e+01]],

        [[ 7.0556e+03,  7.8165e+02],
         [-4.6822e+03, -2.5560e+03],
         [ 3.7042e+03, -5.0019e+03],
         [-1.8477e+03, -3.2691e+03],
         [ 4.3098e+03, -2.1929e+03],
         [ 3.0332e+03,  1.7447e+03],
         [-6.8044e+03,  2.7004e+03],
         [ 4.1147e+03,  7.7684e+03],
         [-1.1729e+03,  6.0641e+03],
         [ 3.3160e+02,  8.1375e+02]],

        [[ 2.5746e+03,  8.1532e+03],
         [ 1.5575e+03,  5.5697e+03],
         [-6.6930e+02,  7.6583e+03],
         [ 4.0946e+02, -6.4110e+03],
         [ 6.8278e+01, -6.2828e+03],
         [ 3.5067e+03, -7.4644e+03],
         [ 2.3625e+03, -8.8162e+03],
         [-2.9001e+02, -6.0101e+03],
         [-2.0703e+03, -9.3261e+03],
         [ 1.9444e+03, -8.3821e+03]]]) 

Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0148,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]],
       grad_fn=<SelectBackward>)

Epoch 1 finished. Total time: 822.1221630573273;  Epoch time: 502.83299827575684 












test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
test_counter in loss_omega_mat(): 4046
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9453, 0.9453, 0.9446,  ..., 0.6404, 0.6061, 0.6061],
         [0.4517, 0.4264, 0.4113,  ..., 0.2825, 0.2820, 0.2818],
         [0.4262, 0.4113, 0.4094,  ..., 0.2818, 0.2800, 0.2691],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7572, 0.7571],
         [0.9459, 0.9459, 0.9459,  ..., 0.7572, 0.7572, 0.7569],
         [0.9459, 0.9459, 0.9459,  ..., 0.7571, 0.7569, 0.7569]],

        [[0.9458, 0.9457, 0.9456,  ..., 0.6408, 0.6407, 0.6406],
         [0.9457, 0.9456, 0.9455,  ..., 0.6404, 0.6060, 0.6059],
         [0.9457, 0.9455, 0.9455,  ..., 0.6401, 0.6061, 0.6059],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7572, 0.7571, 0.7570]],

        [[0.9458, 0.9458, 0.9458,  ..., 0.7570, 0.7570, 0.6409],
         [0.9458, 0.9458, 0.9457,  ..., 0.7568, 0.6410, 0.6409],
         [0.9458, 0.9458, 0.9457,  ..., 0.6409, 0.6407, 0.6407],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7571]],

        ...,

        [[0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7571, 0.7569],
         [0.9459, 0.9459, 0.9458,  ..., 0.7571, 0.7564, 0.7448],
         [0.9458, 0.9457, 0.9452,  ..., 0.7569, 0.7383, 0.7376],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7570, 0.7570],
         [0.9459, 0.9458, 0.9458,  ..., 0.7571, 0.7571, 0.7568],
         [0.9458, 0.9457, 0.9457,  ..., 0.7569, 0.7567, 0.7562]],

        [[0.9459, 0.9458, 0.9458,  ..., 0.7570, 0.7569, 0.7568],
         [0.9459, 0.9459, 0.9457,  ..., 0.7525, 0.7481, 0.7397],
         [0.9453, 0.9452, 0.9452,  ..., 0.7472, 0.7373, 0.7309],
         ...,
         [0.9459, 0.9459, 0.9457,  ..., 0.7570, 0.7570, 0.7569],
         [0.9459, 0.9458, 0.9458,  ..., 0.7571, 0.7570, 0.7566],
         [0.9458, 0.9457, 0.9457,  ..., 0.7566, 0.7563, 0.7561]],

        [[0.9459, 0.9458, 0.9457,  ..., 0.7566, 0.7566, 0.7532],
         [0.9459, 0.9457, 0.9455,  ..., 0.7476, 0.7454, 0.7358],
         [0.9452, 0.9449, 0.9425,  ..., 0.7413, 0.7351, 0.7248],
         ...,
         [0.9459, 0.9459, 0.9457,  ..., 0.7570, 0.7563, 0.7553],
         [0.9459, 0.9457, 0.9457,  ..., 0.7570, 0.7566, 0.7560],
         [0.9456, 0.9456, 0.9456,  ..., 0.7565, 0.7565, 0.7561]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[1.0134e-06, 1.0653e-07, 4.7561e-08,  ..., 3.5554e-06,
          2.8450e-08, 1.5610e-07],
         [1.8817e-07, 2.6771e-07, 1.3783e-08,  ..., 4.3274e-07,
          3.0669e-07, 2.0700e-06],
         [6.3887e-07, 2.1007e-06, 3.3170e-07,  ..., 3.5642e-06,
          2.0901e-06, 4.9577e-06],
         ...,
         [2.5074e-07, 1.3401e-07, 1.3846e-08,  ..., 3.4388e-07,
          9.4297e-07, 1.1585e-09],
         [2.3900e-08, 1.4358e-07, 3.0897e-08,  ..., 5.2739e-08,
          1.1642e-06, 8.9641e-08],
         [1.3180e-07, 1.3103e-08, 1.9070e-07,  ..., 3.2592e-07,
          3.5654e-08, 1.4925e-08]],

        [[4.9584e-08, 2.7105e-07, 8.3558e-07,  ..., 1.3034e-06,
          1.2739e-07, 2.8278e-07],
         [1.3503e-06, 8.7322e-07, 3.9939e-07,  ..., 1.0410e-05,
          9.6290e-06, 1.1656e-11],
         [5.9421e-08, 6.4714e-08, 4.6391e-07,  ..., 4.3357e-06,
          1.3999e-05, 1.9149e-06],
         ...,
         [3.4056e-08, 1.0707e-08, 1.9269e-07,  ..., 1.9602e-06,
          2.6436e-08, 1.6261e-06],
         [9.4684e-08, 5.5728e-07, 5.2831e-08,  ..., 3.2677e-07,
          3.9385e-07, 2.1459e-07],
         [1.5669e-09, 4.7369e-07, 8.8422e-08,  ..., 1.1825e-08,
          5.7909e-12, 1.0569e-07]],

        [[2.5976e-07, 1.6635e-08, 1.8002e-07,  ..., 4.7908e-07,
          1.0823e-06, 8.9753e-08],
         [2.4577e-07, 3.6414e-07, 1.7177e-08,  ..., 6.9016e-07,
          3.6095e-06, 1.5411e-06],
         [1.3905e-07, 3.4876e-07, 5.2227e-08,  ..., 2.2502e-07,
          9.4710e-07, 2.7321e-09],
         ...,
         [1.3190e-07, 1.1029e-07, 4.6670e-08,  ..., 1.6958e-06,
          1.0348e-06, 8.4591e-08],
         [1.0525e-07, 1.8221e-07, 6.1900e-08,  ..., 8.0708e-07,
          4.0882e-07, 4.3017e-08],
         [6.1715e-08, 2.4561e-07, 7.6340e-09,  ..., 2.6371e-07,
          4.8776e-07, 1.8045e-08]],

        ...,

        [[1.7703e-08, 8.2352e-08, 1.0396e-07,  ..., 5.4801e-07,
          1.0566e-06, 6.2047e-07],
         [2.3421e-07, 1.9925e-07, 6.6916e-08,  ..., 1.2188e-06,
          3.3483e-07, 1.2215e-06],
         [5.1763e-07, 2.9348e-07, 4.4955e-08,  ..., 7.6188e-08,
          1.1864e-04, 3.3839e-06],
         ...,
         [6.6474e-07, 6.8629e-07, 5.0943e-10,  ..., 5.7772e-06,
          6.2033e-07, 1.9691e-07],
         [2.4346e-07, 2.6274e-07, 2.6424e-10,  ..., 4.7177e-06,
          2.8608e-07, 1.1104e-06],
         [6.1676e-07, 4.2113e-07, 9.2191e-09,  ..., 5.5880e-07,
          1.2057e-06, 2.8382e-06]],

        [[2.3970e-08, 2.6426e-10, 4.1567e-08,  ..., 1.0491e-06,
          5.5424e-07, 4.1694e-07],
         [4.4249e-07, 7.4379e-08, 5.1103e-07,  ..., 1.5765e-08,
          8.3570e-07, 5.3904e-06],
         [1.0261e-06, 1.4524e-07, 1.2670e-07,  ..., 1.7151e-08,
          1.3768e-06, 2.7057e-05],
         ...,
         [1.1568e-08, 1.9946e-08, 9.1605e-08,  ..., 3.2142e-07,
          9.5885e-09, 8.8454e-08],
         [4.1138e-09, 2.8627e-07, 1.2416e-06,  ..., 7.7937e-08,
          1.2560e-06, 1.4334e-06],
         [8.3264e-08, 3.6196e-07, 3.4214e-07,  ..., 1.3957e-07,
          7.7472e-09, 1.0857e-07]],

        [[1.2091e-06, 9.9853e-08, 2.3757e-07,  ..., 4.0759e-08,
          1.4839e-06, 9.0357e-09],
         [1.5947e-09, 6.3364e-09, 7.2949e-07,  ..., 1.0566e-08,
          1.4477e-06, 1.0179e-06],
         [9.2316e-07, 1.8684e-06, 1.4372e-06,  ..., 1.2028e-04,
          1.8158e-05, 3.8348e-05],
         ...,
         [7.6896e-07, 1.8091e-07, 6.3714e-07,  ..., 5.3500e-08,
          5.8853e-09, 3.7751e-06],
         [4.3211e-07, 4.1081e-07, 1.3216e-06,  ..., 3.4621e-06,
          1.3416e-06, 8.1175e-06],
         [2.6947e-08, 5.0744e-07, 4.0395e-10,  ..., 1.3451e-06,
          3.1442e-06, 1.5012e-06]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[3.3237e-04, 6.6629e-04, 7.0311e-04,  ..., 8.9113e-04,
          7.2625e-05, 2.1591e-04],
         [3.3705e-04, 9.2598e-04, 1.1391e-03,  ..., 4.5502e-04,
          2.4731e-04, 2.7263e-04],
         [1.0039e-03, 4.9140e-04, 9.1582e-04,  ..., 3.7948e-04,
          2.6959e-04, 2.1551e-04],
         ...,
         [3.8500e-04, 4.7752e-04, 3.4028e-04,  ..., 2.8175e-04,
          4.2281e-05, 7.8320e-04],
         [3.8500e-04, 6.9133e-04, 5.2085e-04,  ..., 7.1585e-04,
          6.1802e-04, 5.2506e-04],
         [4.1343e-04, 5.2085e-04, 3.4212e-04,  ..., 6.0606e-04,
          1.5756e-04, 7.9219e-04]],

        [[4.6335e-04, 1.1132e-03, 4.4157e-04,  ..., 8.0935e-04,
          7.2594e-04, 4.3040e-04],
         [9.9077e-04, 4.4157e-04, 1.8166e-03,  ..., 8.6264e-04,
          5.4321e-04, 3.3501e-04],
         [1.2045e-03, 1.3560e-03, 1.8166e-03,  ..., 6.8600e-04,
          7.0774e-04, 5.7904e-04],
         ...,
         [5.9268e-04, 4.6521e-04, 4.7752e-04,  ..., 9.8578e-04,
          5.2565e-04, 9.2716e-04],
         [6.9133e-04, 1.2874e-04, 5.9268e-04,  ..., 5.4410e-04,
          1.8304e-04, 2.2479e-04],
         [4.9256e-04, 1.2874e-04, 3.4212e-04,  ..., 1.4367e-04,
          5.0254e-04, 6.0642e-04]],

        [[4.9171e-04, 4.6335e-04, 4.6704e-04,  ..., 3.3203e-05,
          1.2642e-03, 7.2284e-04],
         [5.0339e-04, 4.6704e-04, 3.7198e-04,  ..., 6.2759e-05,
          3.2928e-04, 6.5201e-04],
         [2.4314e-04, 4.5595e-04, 3.7198e-04,  ..., 3.5684e-04,
          1.7502e-04, 3.1412e-04],
         ...,
         [4.1431e-04, 2.8935e-04, 4.6589e-04,  ..., 3.1342e-04,
          6.1312e-04, 2.3822e-04],
         [1.2169e-04, 2.8935e-04, 3.8771e-04,  ..., 7.0374e-04,
          2.7817e-04, 4.3082e-04],
         [1.2169e-04, 4.1905e-04, 1.3791e-04,  ..., 3.4678e-04,
          3.1606e-04, 7.6390e-04]],

        ...,

        [[5.7179e-04, 4.9517e-04, 5.3699e-04,  ..., 4.2110e-04,
          3.2598e-04, 7.7769e-04],
         [5.9644e-04, 6.1543e-04, 2.7892e-04,  ..., 3.0442e-04,
          1.1230e-03, 8.2017e-03],
         [3.7478e-04, 4.0634e-04, 2.0984e-04,  ..., 2.1294e-04,
          9.9810e-03, 8.4089e-04],
         ...,
         [3.2223e-04, 4.9202e-04, 4.7195e-04,  ..., 4.9182e-04,
          7.8089e-04, 6.9949e-04],
         [3.2223e-04, 3.5539e-04, 4.4122e-04,  ..., 7.5262e-05,
          5.2717e-04, 7.3912e-05],
         [3.5539e-04, 6.8863e-04, 4.7921e-05,  ..., 7.4983e-04,
          5.1958e-04, 6.9246e-04]],

        [[3.0585e-04, 5.8771e-04, 5.3699e-04,  ..., 9.0189e-04,
          2.1294e-04, 9.5703e-04],
         [6.1543e-04, 5.2439e-04, 7.0046e-04,  ..., 1.6092e-03,
          6.7778e-04, 1.3290e-03],
         [8.2550e-04, 2.0984e-04, 7.3906e-04,  ..., 8.5176e-03,
          3.2118e-03, 2.2117e-03],
         ...,
         [6.1931e-04, 2.4329e-04, 5.0928e-04,  ..., 5.9573e-04,
          9.0653e-05, 6.5571e-04],
         [6.1931e-04, 4.0584e-04, 1.7430e-04,  ..., 6.1265e-04,
          4.6890e-04, 4.3851e-04],
         [4.0584e-04, 6.8863e-04, 3.3847e-05,  ..., 8.7093e-04,
          4.3825e-04, 9.2572e-04]],

        [[3.3384e-04, 5.8771e-04, 4.3171e-04,  ..., 6.7831e-04,
          6.7188e-04, 1.4659e-03],
         [5.2439e-04, 4.3171e-04, 4.7678e-04,  ..., 4.3718e-03,
          8.1374e-03, 3.5411e-03],
         [7.3906e-04, 1.0857e-03, 8.2621e-05,  ..., 1.0912e-02,
          2.2759e-03, 1.6181e-03],
         ...,
         [5.4118e-04, 1.5866e-04, 5.0928e-04,  ..., 2.5737e-04,
          5.2195e-04, 6.0167e-04],
         [5.4118e-04, 3.7701e-04, 8.9315e-04,  ..., 6.9949e-04,
          9.3136e-04, 4.9528e-04],
         [4.2653e-04, 4.5501e-04, 6.3846e-04,  ..., 4.6914e-04,
          4.9294e-04, 1.2132e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:2.8862335681915283 loss2:1638.254150390625


loss.item(): 32767.96875


Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([59, 98]) torch.Size([59, 98, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 3.1443e-01,  2.3889e+00,  2.9929e+00,  1.2321e+00,  1.5479e+00,
          1.4506e+00,  5.7172e+00,  1.0864e+01,  1.7901e+00, -1.3088e+01],
        [-2.4968e+00,  3.2238e+00, -9.1782e+00, -6.5037e+00,  5.4677e+00,
          1.2381e+01,  6.9974e+00,  9.9180e+01,  2.9265e+01,  4.7746e+01],
        [-2.1265e+01,  1.6008e+01,  1.0599e+01, -2.1340e+01,  4.4727e+01,
          2.0588e+01, -2.3855e+02,  2.0391e+02, -4.7785e+02,  2.6609e+02],
        [ 1.3791e+01, -1.1442e+01,  1.0806e+01,  3.4823e+01,  6.1905e+01,
          4.7421e+02,  2.0059e+02,  5.1137e+02, -1.9521e+02, -6.0979e+02],
        [-1.0260e+01,  3.6504e+01, -3.9368e+00,  5.4852e+02,  6.1375e+02,
          7.3993e+02,  9.6164e+02,  1.1958e+03, -3.6420e+01,  3.2446e+02],
        [ 2.0216e+01, -1.5013e+01,  1.1288e+02,  5.6723e+02,  1.0290e+03,
         -8.0448e+02,  8.2696e+02,  1.5749e+03, -2.1663e+02,  1.4118e+03],
        [ 1.9797e-01,  2.1398e+01,  4.8679e+02,  7.3261e+02,  4.1947e+02,
         -1.1691e+04, -8.6855e+02,  1.1556e+03,  2.4123e+02, -1.2230e+03],
        [ 2.4140e+01,  1.4186e+01,  4.0498e+01,  9.3161e+02,  6.2416e+02,
          1.4296e+02, -7.5491e+03,  7.1210e+02, -7.2862e+02, -1.0350e+04]]) 

MatU.grad[0:10,35:45]: 
tensor([[[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[  674.6730,   113.6541],
         [ -683.5476,   -77.3189],
         [  134.1483,   669.8868],
         [ -197.1534,   284.8375],
         [ -153.4341,  -639.7893],
         [  265.5946,   182.9533],
         [ -218.7156,   841.2772],
         [  307.4071,  -321.3269],
         [  -71.5698,   875.5639],
         [ -121.9400,  -284.2276]],

        [[ 1803.5623,   580.9443],
         [  206.4090,   592.8896],
         [-1261.8392, -1353.9287],
         [-1997.1471,  -299.4727],
         [ 1653.0756,   724.9945],
         [ 1154.0966,    36.4628],
         [-2159.6611, -1179.6249],
         [ 2204.1772,  -335.4425],
         [-1844.3330, -1147.1189],
         [  235.1666,  1865.6299]],

        [[ -753.2303, -1360.0331],
         [ 2530.3613,  -932.7845],
         [-2650.7310, -1627.3296],
         [-3878.5835, -1528.7908],
         [ -851.7043,  3782.8721],
         [ 1836.9073, -1197.1986],
         [-5434.2456,  -321.6567],
         [ 3838.3560,   145.6378],
         [ 2314.7515,  -175.4481],
         [-5827.6396, -1436.5531]],

        [[ 1917.2278,  3589.5581],
         [-2847.2266, -4270.8662],
         [ 8245.0430, -1514.3976],
         [ -122.3554,  1460.6365],
         [-5054.5801, -1241.3533],
         [  367.7867,  7326.7642],
         [-4069.1479, -3130.7800],
         [ 5531.0859,  -806.7954],
         [ -904.0477,  3332.6826],
         [-3791.2004, -5792.7798]],

        [[  135.9941, -2038.8840],
         [  978.4794,  1202.3003],
         [-5115.1973, -1333.2833],
         [ 2598.4727, -7262.1729],
         [ 1780.7656,  -243.1518],
         [  -30.3667,  1637.0021],
         [ -526.7717,  1669.6472],
         [ 7050.4131, -1020.3959],
         [-6771.1592, -1780.4260],
         [  -56.7940,  7680.1680]],

        [[ -404.4421,  2320.2981],
         [ 4226.2305, -3101.5947],
         [-5907.2393,  3828.3972],
         [ 6096.3892,  2047.4506],
         [ 1681.7970,  -141.1511],
         [ -602.0250,  -751.1217],
         [   16.6922,  1266.5486],
         [ 1696.5787,  -301.0959],
         [  294.3823,    74.9430],
         [ -495.6098,  1454.2418]],

        [[-1490.6600,  3729.9287],
         [-7747.0781,  4425.4189],
         [-5656.6128, -3762.9827],
         [ 3922.9819,  3649.4263],
         [ -878.4637,  1150.1565],
         [ 1275.4938,  -198.8290],
         [ -729.4520,  -462.4324],
         [ 1207.3961,   214.2826],
         [ 1325.8906,   379.5476],
         [-1248.6926, -1401.3937]]]) 

MatD.grad: 
tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000, -0.9196,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.7022e+02,  6.3904e+01],
         [-2.1726e+01,  8.1758e+01],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.4357e+02, -1.2768e+02],
         [ 3.2976e+01,  3.1365e+02],
         [-2.8371e+02, -3.1721e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 6.4724e-01,  1.0343e+02],
         [-6.1067e+01, -8.3450e+01],
         [ 2.2691e+02,  4.1703e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-3.1985e+02,  1.8822e+02],
         [-3.8564e+02, -5.4949e+02],
         [-7.5657e+02,  3.7148e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.4230e+02,  1.3299e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-2.4905e+02,  4.7260e+01],
         [-3.4909e+02,  7.0301e+02],
         [ 2.8183e+03,  1.0203e+03],
         [ 1.1285e+03, -6.6848e+02],
         [ 8.7320e+02, -1.1097e+02],
         [ 8.0314e+02,  1.0833e+03],
         [-1.3088e+03, -1.1859e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-3.1475e+02, -5.0163e+00],
         [-2.4061e+02,  1.4514e+03],
         [-6.7846e+02, -5.0688e+03],
         [-6.3726e+03, -3.4456e+03],
         [ 4.1122e+03,  7.2118e+03],
         [ 3.8192e+03, -6.0904e+03],
         [-3.2878e+03, -4.9963e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-7.7051e+02, -1.2834e+02],
         [-9.2935e+02, -8.6420e+02],
         [-3.7701e+03,  2.0143e+03],
         [ 6.9860e+02,  3.7893e+03],
         [-9.0534e+02, -3.0517e+03],
         [ 3.6879e+02,  1.6490e+03],
         [ 7.4624e+03, -3.8678e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-2.2280e+02,  9.0193e+01],
         [-1.0248e+02, -7.6067e+02],
         [ 3.4753e+03,  3.6533e+03],
         [ 6.4061e+03, -3.8147e+03],
         [ 2.4305e+03,  6.4469e+03],
         [-4.0607e+03,  4.2092e+03],
         [ 7.2605e+03,  4.8981e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 3.7017e+02, -3.0195e+02],
         [-1.5362e+03, -6.8645e+02],
         [-3.0162e+03, -6.1244e+03],
         [-3.1896e+03, -1.6016e+03],
         [ 4.6656e+03,  8.3260e+03],
         [-2.8924e+03, -4.3763e+03],
         [ 8.7552e+02, -1.8438e+03]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[-6461.6958,  -824.5796],
         [-3821.2080,  5453.8555],
         [ 3529.4465,  7635.6250],
         [ 6995.6836,  2711.6255],
         [-3946.0645, -5915.7720],
         [-4755.8813, -7121.6895],
         [ 3381.1011,  4853.2290],
         [-5120.5718, -2924.9514],
         [-6481.2842,  3036.8933],
         [ 5983.1621,  5326.2407]],

        [[ 2872.3391, -4608.7085],
         [ 1618.4415,  4161.6406],
         [-1271.1497,   588.6511],
         [ -570.6121, -7190.9917],
         [-4906.7842,  1604.7374],
         [ 7842.0039,  5338.5693],
         [-4199.0493,  6816.5430],
         [ 4303.8682, -1372.7380],
         [ 2715.6846, -1074.1129],
         [-4989.2461,  6737.4546]],

        [[ 1322.1283, -8030.6040],
         [-1136.8994, -9399.9141],
         [-5465.5229, -2122.9148],
         [ 4344.3984,   911.6633],
         [ 1960.0100,   579.6655],
         [ -483.7471,  1639.1536],
         [-4392.8823, -8238.0762],
         [ 4013.2549,  4655.7783],
         [ 6836.7544, -3632.9761],
         [-1153.5255, -5334.4707]],

        [[-2689.0259,  8420.2344],
         [ 9132.2607,   177.0704],
         [-3779.0864, -4366.0615],
         [ 7158.7017,  -719.5482],
         [ 2727.1731,  -681.9460],
         [-4376.4297, -4267.5425],
         [-1076.5981, -2742.3938],
         [ -430.4930, -8495.8184],
         [-4269.1782, -1649.5193],
         [ 1714.0281,  6965.7515]],

        [[-9124.7227,  -583.6531],
         [ 6701.5605,  6550.7480],
         [-1137.7826,  5363.4985],
         [ 5471.7349, -3059.4751],
         [-8181.5693,  3874.4077],
         [ 4600.7021,  4685.8423],
         [-7595.4390, -1990.9895],
         [ 1755.9110,  8084.2266],
         [ 8341.6602,  3326.3206],
         [-5035.9062,  4823.0591]],

        [[  -52.2687, -7771.0918],
         [ 2807.9297,   871.5684],
         [-3375.1064,  2795.5579],
         [ 5211.0718,  1911.6412],
         [  989.8724, -8275.8682],
         [-3975.7898,  3192.5181],
         [-3244.3096, -3757.6587],
         [ 1412.3588,  3827.5916],
         [ 7653.6802,  -552.0891],
         [ 1102.9983, -5961.7749]],

        [[ 6794.7480,  5539.4453],
         [ -127.8525, -9357.2295],
         [-3829.8228, -1222.6184],
         [ 2699.5586,  4824.4907],
         [ 5119.2876, -4634.9058],
         [-7153.8442,  2335.7314],
         [  500.7937, -5329.1597],
         [  295.5182,     9.7600],
         [ 3692.6890, -5062.5015],
         [-3856.8210, -6763.6562]],

        [[-9180.0508, -1431.7458],
         [ 2845.1814,  8049.1558],
         [  754.7875,  -310.9548],
         [ -944.2863, -5585.3345],
         [-6035.6733,   532.5652],
         [ 6836.4829,  3831.6152],
         [ 6921.3770,  -641.9043],
         [-4522.7598,  5982.6787],
         [ 5917.8555,  5749.3188],
         [-5708.3892,   556.7382]],

        [[-1960.8921, -7914.1567],
         [ 3892.3750, -1115.1896],
         [-2787.2505,  2056.5598],
         [ 1123.6696, -9225.2949],
         [-1604.9314, -2515.5703],
         [-1268.4978, -1056.3784],
         [ 4052.1289, -3989.9717],
         [-3847.5466, -4461.8384],
         [ 1833.3807,  4298.1079],
         [-3155.2456,  1802.5687]],

        [[ 7853.8716,  5158.9546],
         [-1147.4574,  4670.6816],
         [-6740.7148, -3334.6421],
         [  637.3924,  6299.9106],
         [   89.6935,  7552.2900],
         [-1192.6890, -7501.6802],
         [  605.0978,  1971.3656],
         [  397.8575,  7114.1802],
         [ 2084.7212, -3302.0469],
         [-4948.1958,  -962.7904]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[-6.7014e+03, -1.9476e+02],
         [ 6.9051e+03,  2.2088e+03],
         [ 3.2393e+03,  2.7869e+03],
         [-3.4635e+03,  1.9105e+03],
         [ 3.6643e+03,  5.4323e+03],
         [ 8.6498e+03, -3.2406e+03],
         [ 5.6655e+03,  3.0199e+03],
         [ 2.7498e+03,  4.1843e+03],
         [-3.8732e+03, -1.6269e+02],
         [ 2.3290e+02, -3.5375e+03]],

        [[-3.8308e+03,  5.1527e+03],
         [ 4.9612e+03, -5.4941e+03],
         [-1.9415e+03, -2.9947e+03],
         [-7.5543e+03, -2.2321e+03],
         [ 4.2665e+03, -4.9746e+03],
         [-4.3584e+03, -2.8128e+03],
         [ 4.9658e+03,  2.1719e+03],
         [ 1.6185e+03,  2.9456e+03],
         [-3.6311e+02, -5.4819e+03],
         [ 3.4972e+03, -6.1608e+01]],

        [[-1.5004e+02, -3.5642e+03],
         [ 4.0900e+03,  3.2300e+03],
         [-3.7473e+03, -2.3478e+03],
         [-8.7169e+03, -6.2480e+02],
         [ 6.1801e+03,  3.9084e+03],
         [-1.9322e+03, -5.3305e+03],
         [ 4.3497e+03,  8.9270e+02],
         [ 1.7899e+03, -9.8464e+02],
         [ 1.6571e+03, -3.5111e+03],
         [-1.9821e+03, -3.2944e+03]],

        [[-4.3055e+03,  2.4867e+03],
         [ 5.7769e+03, -8.3880e+02],
         [-2.8966e+03, -7.7401e+03],
         [-3.8549e+03,  6.1649e+03],
         [ 2.5520e+02,  5.4199e+03],
         [ 2.7707e+03, -5.5334e+03],
         [-6.7172e+02, -8.7391e+03],
         [-4.8399e+02, -6.5625e+03],
         [-1.0131e+02, -2.5714e+03],
         [-2.5719e+02,  1.5191e+03]],

        [[-3.7112e+03,  4.8254e+01],
         [ 4.3688e+03, -5.9593e+03],
         [ 5.2530e+03,  1.3099e+03],
         [ 7.5956e+02, -5.6059e+03],
         [ 1.4018e+03, -2.4483e+02],
         [-9.3403e+03,  4.4323e+02],
         [ 1.7834e+03,  7.8889e+03],
         [-5.0805e+02, -2.5465e+02],
         [ 7.9856e+02,  7.8169e+02],
         [-8.4218e+02, -6.6003e+02]],

        [[-8.1878e+02, -4.0605e+03],
         [ 3.2619e+03,  4.9371e+03],
         [ 2.3519e+03, -5.2282e+03],
         [-6.0554e+03,  1.7789e+03],
         [ 5.2317e+03,  3.5296e+01],
         [-2.3814e+03, -1.2342e+03],
         [-5.5342e+03, -5.1362e+02],
         [ 1.8600e+03, -6.9049e+01],
         [-6.6914e+02, -8.0693e+02],
         [-9.1907e+02, -8.0930e+00]],

        [[-2.2187e+02,  4.0091e+03],
         [ 5.7218e+03,  6.1137e+03],
         [-9.9443e+02,  5.5041e+03],
         [-3.6008e+03,  5.0996e+03],
         [ 5.2584e+03,  4.7929e+03],
         [-4.1575e+02,  8.1525e+01],
         [ 5.7669e+02, -8.0653e+03],
         [ 2.3022e+02, -1.1273e+03],
         [ 2.1927e+02, -9.7740e+02],
         [ 6.1301e+01, -5.0777e+01]],

        [[-2.4662e+03, -2.1451e+03],
         [ 4.3652e+03, -5.0525e+03],
         [ 3.6971e+03, -1.2442e+03],
         [ 7.6711e+02,  1.5049e+03],
         [-9.9911e+02, -3.8857e+03],
         [-8.9524e+03,  4.5897e+02],
         [ 1.3370e+03,  7.6928e+03],
         [ 9.4823e+02,  1.1917e+03],
         [ 5.9688e+03,  4.0501e+03],
         [-5.5983e+03,  2.6629e+02]],

        [[ 5.3990e+03,  8.5082e+02],
         [-1.2708e+03,  1.0885e+03],
         [ 2.9719e+03, -3.8440e+03],
         [-2.3631e+03, -9.6501e+02],
         [ 4.1700e+03, -2.0541e+03],
         [ 1.1666e+03, -2.4422e+03],
         [-6.7464e+03,  2.2889e+03],
         [ 3.9416e+03,  7.8329e+03],
         [-8.2718e+02,  5.9901e+03],
         [ 3.1601e+02,  6.5924e+02]],

        [[ 1.8899e+03,  8.2626e+03],
         [ 1.4703e+03,  5.4350e+03],
         [-9.9676e+00,  7.5945e+03],
         [-1.0250e+03, -5.8075e+03],
         [-6.6010e+02, -5.9770e+03],
         [ 3.2715e+03, -7.4915e+03],
         [ 1.9081e+03, -8.8037e+03],
         [ 6.2276e+01, -5.8921e+03],
         [-1.6811e+03, -9.4582e+03],
         [ 1.3176e+03, -8.1825e+03]]]) 

Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0152,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]],
       grad_fn=<SelectBackward>)

Epoch 2 finished. Total time: 1538.2762730121613;  Epoch time: 716.1521506309509 












test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
test_counter in loss_omega_mat(): 4046
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9451, 0.9450, 0.9439,  ..., 0.6403, 0.6060, 0.6058],
         [0.4515, 0.4221, 0.4080,  ..., 0.2791, 0.2786, 0.2781],
         [0.4219, 0.4075, 0.4072,  ..., 0.2785, 0.2780, 0.2678],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7571, 0.7571],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7570],
         [0.9459, 0.9459, 0.9459,  ..., 0.7572, 0.7571, 0.7570]],

        [[0.9457, 0.9456, 0.9454,  ..., 0.6407, 0.6407, 0.6406],
         [0.9455, 0.9454, 0.9453,  ..., 0.6403, 0.6060, 0.6058],
         [0.9454, 0.9454, 0.9453,  ..., 0.6401, 0.6060, 0.6059],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7571, 0.7571]],

        [[0.9457, 0.9457, 0.9456,  ..., 0.7570, 0.7570, 0.6408],
         [0.9458, 0.9456, 0.9456,  ..., 0.7567, 0.6410, 0.6410],
         [0.9458, 0.9457, 0.9456,  ..., 0.6409, 0.6405, 0.6404],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7571]],

        ...,

        [[0.9459, 0.9459, 0.9459,  ..., 0.7572, 0.7569, 0.7567],
         [0.9459, 0.9459, 0.9456,  ..., 0.7568, 0.7563, 0.7420],
         [0.9457, 0.9456, 0.9452,  ..., 0.7566, 0.7343, 0.7334],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7571, 0.7571],
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7571, 0.7571],
         [0.9459, 0.9458, 0.9458,  ..., 0.7569, 0.7565, 0.7560]],

        [[0.9459, 0.9459, 0.9459,  ..., 0.7570, 0.7569, 0.7566],
         [0.9459, 0.9459, 0.9456,  ..., 0.7513, 0.7461, 0.7358],
         [0.9453, 0.9452, 0.9451,  ..., 0.7454, 0.7323, 0.7249],
         ...,
         [0.9459, 0.9458, 0.9458,  ..., 0.7571, 0.7571, 0.7571],
         [0.9458, 0.9458, 0.9458,  ..., 0.7572, 0.7571, 0.7570],
         [0.9458, 0.9458, 0.9458,  ..., 0.7569, 0.7566, 0.7560]],

        [[0.9459, 0.9459, 0.9459,  ..., 0.7565, 0.7564, 0.7530],
         [0.9459, 0.9455, 0.9454,  ..., 0.7450, 0.7426, 0.7317],
         [0.9453, 0.9447, 0.9414,  ..., 0.7377, 0.7297, 0.7175],
         ...,
         [0.9459, 0.9458, 0.9458,  ..., 0.7570, 0.7561, 0.7544],
         [0.9458, 0.9458, 0.9457,  ..., 0.7569, 0.7568, 0.7554],
         [0.9458, 0.9457, 0.9457,  ..., 0.7564, 0.7564, 0.7564]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[8.5233e-07, 1.5982e-09, 4.4112e-09,  ..., 1.9344e-07,
          9.4634e-09, 7.3477e-08],
         [2.2949e-07, 1.3973e-06, 1.6317e-07,  ..., 5.5223e-11,
          3.4527e-08, 1.6566e-07],
         [3.3438e-06, 1.0839e-06, 1.6439e-06,  ..., 9.3455e-06,
          1.3265e-05, 1.2488e-06],
         ...,
         [6.2533e-08, 1.1709e-07, 2.2270e-07,  ..., 2.1709e-07,
          4.0840e-07, 8.8256e-07],
         [2.7270e-07, 1.0071e-07, 1.5201e-09,  ..., 2.5161e-08,
          9.7067e-07, 1.9231e-07],
         [3.0135e-07, 3.9448e-07, 4.8141e-08,  ..., 2.4129e-07,
          1.1594e-07, 3.9494e-08]],

        [[1.0430e-08, 6.3951e-09, 1.3367e-06,  ..., 2.7439e-07,
          4.9441e-07, 5.3913e-07],
         [1.5333e-06, 1.4491e-06, 1.9844e-06,  ..., 6.7430e-06,
          3.7300e-06, 2.0449e-06],
         [1.2387e-09, 2.9857e-07, 6.2023e-07,  ..., 5.0052e-07,
          3.2699e-06, 1.1802e-08],
         ...,
         [1.9536e-09, 1.7624e-07, 1.7852e-09,  ..., 2.2352e-08,
          5.1142e-07, 2.1058e-08],
         [1.2719e-09, 5.4598e-08, 4.5812e-08,  ..., 6.6814e-07,
          1.7537e-09, 3.9715e-07],
         [2.3012e-07, 3.9321e-07, 9.1182e-09,  ..., 1.5831e-07,
          5.7779e-07, 5.2172e-07]],

        [[1.8783e-08, 2.8674e-07, 2.4745e-09,  ..., 9.5435e-07,
          2.3281e-09, 5.8578e-08],
         [2.0807e-07, 1.9443e-08, 4.2933e-07,  ..., 3.2569e-08,
          1.6731e-06, 2.8511e-06],
         [2.7505e-08, 4.2849e-09, 1.4835e-08,  ..., 5.5663e-08,
          2.3093e-07, 1.2119e-07],
         ...,
         [3.8577e-08, 7.4405e-08, 1.9458e-07,  ..., 3.5063e-07,
          1.2498e-07, 1.2028e-08],
         [9.6442e-08, 2.0129e-07, 3.6928e-08,  ..., 1.3904e-10,
          2.1402e-07, 1.2294e-07],
         [3.3498e-07, 1.1459e-09, 1.6852e-07,  ..., 1.5481e-07,
          9.8565e-07, 2.2742e-11]],

        ...,

        [[1.0864e-09, 3.5336e-08, 5.5036e-08,  ..., 6.9370e-08,
          4.5540e-08, 1.7251e-06],
         [7.0966e-08, 8.8537e-09, 3.3012e-07,  ..., 3.7748e-06,
          1.4839e-06, 3.9951e-06],
         [1.4262e-06, 1.6928e-06, 5.9403e-08,  ..., 2.6356e-06,
          1.2429e-04, 2.1814e-06],
         ...,
         [1.5057e-07, 2.7273e-07, 5.5914e-07,  ..., 2.5944e-06,
          3.9960e-08, 1.0984e-07],
         [5.9520e-07, 6.5387e-07, 1.1964e-07,  ..., 4.2224e-06,
          3.6417e-07, 2.8830e-08],
         [2.0763e-07, 6.3634e-08, 1.3604e-06,  ..., 8.7593e-07,
          3.3121e-08, 1.3390e-06]],

        [[3.4956e-07, 4.8678e-08, 4.4213e-07,  ..., 1.5372e-06,
          1.6951e-06, 5.5920e-07],
         [1.3499e-08, 2.1929e-07, 5.6462e-08,  ..., 2.7705e-07,
          1.8660e-06, 3.4843e-06],
         [8.2344e-08, 1.5170e-07, 2.7047e-06,  ..., 8.1343e-07,
          8.2541e-07, 3.0595e-05],
         ...,
         [8.1838e-08, 1.8759e-07, 1.8005e-08,  ..., 9.2490e-08,
          1.0215e-07, 4.6490e-09],
         [1.4846e-07, 1.0346e-08, 4.4254e-07,  ..., 2.5617e-07,
          3.0507e-07, 1.1099e-06],
         [8.9053e-07, 3.7922e-07, 6.0273e-08,  ..., 4.4436e-07,
          6.7929e-07, 1.7657e-06]],

        [[2.8771e-07, 2.3805e-07, 8.5030e-09,  ..., 1.5918e-07,
          7.6313e-08, 1.0797e-06],
         [2.7106e-07, 1.0925e-07, 3.8821e-07,  ..., 1.2840e-07,
          3.0105e-06, 3.3080e-08],
         [2.0611e-07, 1.7502e-06, 5.6573e-07,  ..., 1.3844e-04,
          4.0392e-05, 6.3673e-05],
         ...,
         [1.8284e-07, 1.8609e-07, 3.8602e-07,  ..., 1.7994e-07,
          4.9449e-07, 5.5146e-06],
         [3.9349e-09, 1.0365e-06, 2.2212e-08,  ..., 1.6690e-06,
          2.2780e-07, 4.7888e-06],
         [6.5147e-07, 7.0719e-07, 3.0120e-08,  ..., 8.0749e-07,
          6.1392e-08, 2.5844e-08]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[5.5901e-04, 3.9434e-04, 5.7794e-04,  ..., 3.3773e-04,
          4.2091e-05, 3.8637e-04],
         [1.2052e-04, 5.0713e-04, 4.4129e-04,  ..., 4.4229e-04,
          1.0478e-04, 6.1713e-04],
         [4.2530e-04, 6.4240e-04, 8.9625e-04,  ..., 2.0224e-04,
          4.1474e-04, 8.8793e-04],
         ...,
         [2.4700e-04, 4.0752e-04, 1.1944e-04,  ..., 7.5840e-05,
          4.9629e-04, 4.0358e-04],
         [1.9713e-04, 5.3873e-04, 4.0752e-04,  ..., 6.7135e-04,
          5.5486e-04, 4.2387e-04],
         [7.1418e-04, 1.9713e-04, 7.4056e-04,  ..., 8.0242e-04,
          4.9050e-04, 7.4003e-04]],

        [[6.2011e-04, 7.2801e-05, 2.3824e-04,  ..., 8.8995e-04,
          9.3608e-05, 5.7893e-04],
         [5.3717e-04, 2.3824e-04, 6.7397e-04,  ..., 2.4086e-04,
          5.6099e-04, 7.8667e-05],
         [2.6762e-04, 8.2412e-04, 6.7397e-04,  ..., 2.0539e-04,
          5.2053e-04, 5.7830e-04],
         ...,
         [3.4267e-04, 2.4700e-04, 4.3028e-04,  ..., 5.9790e-04,
          2.7626e-04, 3.7942e-04],
         [6.7974e-04, 2.5525e-04, 5.3873e-04,  ..., 4.3150e-04,
          5.0169e-04, 4.9826e-04],
         [6.7974e-04, 7.1418e-04, 8.2933e-04,  ..., 7.7221e-04,
          4.2893e-04, 5.8029e-04]],

        [[4.6163e-04, 4.2283e-04, 7.2801e-05,  ..., 6.2023e-04,
          2.9271e-04, 2.0435e-04],
         [4.9334e-04, 5.4061e-04, 6.9118e-04,  ..., 3.1371e-04,
          4.2000e-04, 8.0837e-04],
         [6.0369e-04, 5.5157e-04, 5.4061e-04,  ..., 5.6934e-04,
          5.5534e-04, 6.1883e-04],
         ...,
         [3.4267e-04, 7.8616e-04, 4.8479e-04,  ..., 2.4463e-04,
          1.9675e-04, 4.9077e-04],
         [3.1071e-04, 1.1755e-04, 4.8479e-04,  ..., 3.2705e-04,
          2.5088e-04, 2.0077e-04],
         [3.1071e-04, 4.4937e-04, 1.7449e-04,  ..., 7.2832e-05,
          5.0804e-04, 8.9448e-04]],

        ...,

        [[2.8734e-04, 3.3981e-04, 1.4746e-04,  ..., 4.8533e-04,
          3.8776e-04, 4.9788e-04],
         [7.3025e-04, 5.1758e-04, 3.9616e-04,  ..., 2.9415e-04,
          6.0954e-04, 7.6306e-03],
         [6.7707e-04, 3.1427e-04, 1.9228e-04,  ..., 4.0447e-04,
          9.4282e-03, 4.7240e-04],
         ...,
         [5.2000e-04, 2.6748e-04, 3.9894e-04,  ..., 7.5010e-04,
          2.3174e-04, 1.9360e-04],
         [2.6748e-04, 6.2287e-04, 7.6124e-04,  ..., 9.6481e-04,
          3.7910e-04, 9.3340e-04],
         [6.2287e-04, 7.2471e-04, 2.4293e-04,  ..., 6.3281e-04,
          2.0503e-04, 5.2439e-04]],

        [[8.9246e-05, 2.8734e-04, 4.6564e-04,  ..., 8.9614e-04,
          4.9190e-04, 4.0447e-04],
         [9.4416e-04, 7.3025e-04, 6.0895e-04,  ..., 1.3426e-03,
          7.4818e-04, 1.1884e-03],
         [1.8749e-04, 1.9228e-04, 9.5639e-04,  ..., 7.6702e-03,
          2.3970e-03, 1.3291e-03],
         ...,
         [6.2477e-04, 2.8915e-04, 5.8238e-04,  ..., 7.1750e-04,
          2.4005e-04, 4.7415e-04],
         [2.8915e-04, 5.8482e-04, 7.6124e-04,  ..., 5.0269e-04,
          4.0514e-04, 1.1757e-04],
         [2.4293e-04, 5.7624e-04, 4.3611e-04,  ..., 6.7026e-04,
          2.1590e-04, 5.4268e-04]],

        [[8.9246e-05, 4.5071e-04, 4.0744e-04,  ..., 6.0259e-04,
          5.0500e-04, 9.9498e-04],
         [9.4416e-04, 5.8835e-04, 6.4993e-04,  ..., 3.5156e-03,
          7.1983e-03, 2.4057e-03],
         [1.8749e-04, 1.8417e-04, 4.4790e-04,  ..., 9.7307e-03,
          2.2328e-03, 1.2323e-03],
         ...,
         [4.3012e-04, 5.8238e-04, 5.0937e-04,  ..., 2.1938e-04,
          2.0286e-04, 7.4512e-04],
         [5.8482e-04, 5.0937e-04, 7.2066e-04,  ..., 8.1713e-04,
          6.0705e-04, 5.2982e-04],
         [5.7624e-04, 7.2066e-04, 5.9928e-04,  ..., 6.2507e-04,
          3.3738e-04, 1.2544e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:3.0394105911254883 loss2:1432.360595703125


loss.item(): 28650.25


Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([59, 98]) torch.Size([59, 98, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-1.5531e-02,  1.8227e+00,  1.9574e+00,  8.2804e-01,  1.6337e+00,
          1.5532e+00,  5.2427e+00,  1.0921e+01,  3.1465e+00, -1.3393e+01],
        [-2.7117e+00,  1.1461e+00, -5.2276e+00, -2.0112e+00,  4.7761e+00,
          1.0990e+01,  8.1175e+00,  9.5767e+01,  3.2304e+01,  5.2010e+01],
        [-1.6021e+01,  2.2481e+01,  2.3787e+01, -1.4678e+01,  3.3655e+01,
          2.4376e+01, -2.3860e+02,  1.9796e+02, -4.7739e+02,  2.5990e+02],
        [ 2.6077e+01,  1.7210e+01, -4.7956e+00,  2.5894e+01,  5.4112e+01,
          4.6016e+02,  2.2746e+02,  4.9030e+02, -2.4034e+02, -6.0959e+02],
        [ 7.1371e+00,  1.3620e+01,  2.5289e+01,  5.2676e+02,  6.0935e+02,
          7.1741e+02,  9.6032e+02,  1.1638e+03, -8.5429e+01,  3.8094e+02],
        [ 2.7592e+01, -6.9593e-01,  1.0512e+02,  5.3925e+02,  1.0300e+03,
         -8.6826e+02,  8.1361e+02,  1.5400e+03, -2.3623e+02,  1.3869e+03],
        [ 1.1296e+01,  2.0193e+01,  4.6340e+02,  7.1587e+02,  4.2758e+02,
         -1.1390e+04, -9.4262e+02,  1.1432e+03,  2.7594e+02, -1.2819e+03],
        [ 7.0420e+00, -3.9815e+00,  3.2715e+01,  9.1651e+02,  6.2746e+02,
          1.5921e+02, -7.2737e+03,  7.1797e+02, -8.1366e+02, -1.0064e+04]]) 

MatU.grad[0:10,35:45]: 
tensor([[[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[  294.3893,   605.2171],
         [ -632.4818,    37.9075],
         [   16.7288,   683.9823],
         [  446.1118,  -313.2089],
         [ -326.9979,  -533.5267],
         [  328.0347,   132.5360],
         [ -136.2338,   822.0296],
         [  404.4646,  -182.3123],
         [  -77.4686,   861.3050],
         [ -125.3977,  -275.5650]],

        [[ 1821.6086,   -65.9012],
         [-1129.3265,  -490.3233],
         [-1109.3761,  -774.9214],
         [-1986.0516,  -332.0311],
         [ 1763.9628,   538.5029],
         [ 1139.8372,   145.6580],
         [-2179.3379, -1117.9033],
         [ 2209.0862,  -231.7871],
         [-1840.8984, -1121.6072],
         [  133.5302,  1852.0626]],

        [[-2415.4778, -3887.1782],
         [  -43.4043, -2870.7275],
         [-3400.7910,  2573.9067],
         [  -93.6198, -1065.8954],
         [-1740.5039,  2363.6313],
         [  748.4165,   490.0511],
         [-5449.8638,   103.6368],
         [ 3522.9553,   550.7997],
         [ 2509.2051, -1482.8140],
         [-5830.8853, -1266.6329]],

        [[-1390.0699,  4307.3120],
         [ 2645.6416, -3034.9143],
         [ 6790.7271, -4649.8760],
         [ 2816.0002,  2749.1594],
         [-5018.8110, -1193.7850],
         [  -94.3635,  7307.2573],
         [-4095.6997, -2765.6589],
         [ 5485.7202,  -888.5275],
         [ -155.1837,  3213.5286],
         [-3889.5640, -6071.7812]],

        [[-5558.0630,   350.3342],
         [ 6187.3223, -2232.9915],
         [-4939.5591,  2644.5398],
         [-3072.6968, -5327.8423],
         [ 1776.1760,   -42.8439],
         [   42.2279,  1619.5927],
         [ -331.7242,  1611.0673],
         [ 7066.5024,  -719.4542],
         [-6744.3091, -1659.7200],
         [ -188.9760,  7616.2603]],

        [[ 4672.7598,   793.4001],
         [ 2977.9224,  -683.3323],
         [   82.1730,  7728.2378],
         [  707.9382, -3728.3379],
         [ 1677.9565,   -96.4736],
         [ -584.0931,  -731.5417],
         [  -91.2144,  1248.1344],
         [ 1691.8505,  -185.7892],
         [  202.4432,   -87.4719],
         [ -436.8717,  1392.2095]],

        [[-6223.0542,   472.5693],
         [-2197.5869,  6564.6406],
         [-4320.2798, -3896.8030],
         [ 4126.4033,  -399.9900],
         [-1655.4784,   525.9315],
         [ 1249.6655,  -194.2062],
         [ -704.9949,  -446.4629],
         [ 1246.3411,    39.4727],
         [ 1263.1565,   336.4106],
         [-1224.6180, -1369.2592]]]) 

MatD.grad: 
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.8866,  ..., 0.0000, 0.0000, 0.0000],
        ...,
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.4446e+00,  1.8173e+02],
         [ 5.5637e+01, -6.2172e+01],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-3.8219e+01, -1.8826e+02],
         [-1.1015e+02,  2.9303e+02],
         [-3.4686e+01, -4.1623e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 2.2033e-01,  1.0149e+02],
         [ 4.4181e+01, -9.1357e+01],
         [ 6.2180e+01, -2.1811e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-4.0057e+02,  7.8925e+01],
         [-7.2131e+02, -8.1607e+01],
         [-9.5214e+02, -3.8464e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-8.9600e+01,  1.2150e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.6961e+02, -6.3328e+02],
         [-1.1677e+03,  9.5189e+01],
         [ 2.0835e+03,  1.5048e+03],
         [ 8.6497e+02,  5.4261e+02],
         [-1.0908e+03,  1.4352e+03],
         [ 1.5035e+03,  1.0373e+03],
         [-5.6843e+03,  2.8026e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-5.8300e+02,  2.5873e+02],
         [-1.4150e+03,  4.4747e+02],
         [ 2.5839e+03, -3.4731e+03],
         [-2.7437e+03, -3.6630e+03],
         [ 1.4423e+03,  6.4988e+03],
         [-5.6328e+02, -7.0023e+03],
         [-4.6975e+03, -5.9137e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-8.4490e+02,  1.0356e+02],
         [-1.0797e+03,  4.4387e+02],
         [ 6.8166e+02, -5.7806e+03],
         [-3.6782e+03,  5.9571e+03],
         [ 6.1411e+03,  5.7399e+03],
         [ 2.5508e+03, -4.6403e+03],
         [ 7.1479e+03, -3.5323e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 3.0515e+02,  3.0702e+02],
         [-1.9983e+03, -4.0774e+02],
         [ 1.5905e+03,  3.0983e+03],
         [ 5.1707e+03,  1.9754e+03],
         [-6.5676e+03,  4.9037e+03],
         [-2.8056e+03,  1.1511e+03],
         [ 3.4216e+03,  7.3693e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 4.4679e+02,  5.1291e+00],
         [-4.1712e+02, -1.9585e+03],
         [ 3.7622e+03, -4.2355e+03],
         [ 7.3465e+03,  3.0577e+03],
         [-4.9882e+03, -2.2255e+03],
         [-8.0370e+03,  9.8999e+02],
         [ 6.0113e+03, -4.8351e+03]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[-5837.8506, -3885.3047],
         [ 4915.5850,  5498.2915],
         [   31.5791,  7378.9683],
         [ 5484.4624, -2317.7952],
         [ 3091.8069,   751.9495],
         [-5082.2192, -7782.0010],
         [-4242.5820,  3438.0532],
         [ 5641.7070,  2725.0986],
         [-2125.3411, -5923.2788],
         [ 6630.7944,  1209.8688]],

        [[ 3114.1406, -2409.4534],
         [-4633.2217,  5676.6787],
         [-3351.9319, -4126.8486],
         [-3872.8445, -6695.8452],
         [  651.8560,  3324.5947],
         [ 7153.8291,  4304.4048],
         [-6581.0679, -3237.7778],
         [-3367.8894,  3874.6506],
         [-4649.0288,  4718.2065],
         [-1840.2720,  6665.2671]],

        [[ 1620.4825, -7863.0063],
         [-1268.9663, -9328.4795],
         [-4571.8594,   394.5990],
         [ 6568.6069, -3173.2310],
         [-5181.3179,  3857.7297],
         [ 6179.6333,  1322.7177],
         [-5633.3462, -6143.2988],
         [-2383.8906, -2309.5337],
         [ 7932.9507,  2536.5034],
         [ 1911.1733, -8262.4346]],

        [[-1382.2910,  8671.2178],
         [ 9122.6416,  -691.7153],
         [ 1126.8737, -1572.9529],
         [ 5712.9663,  3500.6843],
         [-3442.2454,  5553.9292],
         [  728.4919, -8284.0488],
         [ 4045.3567,  4449.2251],
         [ 3814.8384, -7044.8994],
         [ 3379.2644,  2804.7925],
         [  453.4509,  5673.0894]],

        [[-9059.4531, -1379.3654],
         [ 6688.4771,  6472.8999],
         [-2325.7175,  2939.6204],
         [ 4484.1030,  4125.0869],
         [-7268.1978, -3447.7759],
         [ 1074.2329,  2068.9124],
         [-6232.7925,  3750.5369],
         [-3405.1111,  3858.7529],
         [ 8339.4043, -1975.7231],
         [-2445.1968, -1933.1051]],

        [[  854.8064, -7696.9077],
         [-1308.0110, -3061.6702],
         [ 1587.5579, -1235.0167],
         [ 6262.3633, -3415.5764],
         [-5230.1958, -6134.8892],
         [ -543.3680, -4947.3281],
         [ 5059.0098,  3754.7971],
         [-5199.1919, -4680.6235],
         [ 6468.2891, -4383.9214],
         [-5793.6309,  2991.0066]],

        [[ 6692.9297,  5552.8945],
         [  892.3734, -9330.8154],
         [  342.9286,  6274.8262],
         [-3512.8354,  2147.6218],
         [ 4616.1348,  3191.9412],
         [-5063.2632,  6481.3159],
         [-3671.0693,  3206.6003],
         [-2982.8696, -5763.8413],
         [ -981.6870, -5289.4463],
         [ 4929.1006,  1315.6106]],

        [[-9317.3584, -1128.0172],
         [ 1903.2510,  8351.5059],
         [-4963.1890, -3150.7715],
         [ 4496.9912, -3178.8918],
         [ 2609.6128, -4760.1104],
         [ -973.2808, -5419.3032],
         [ 4744.8184, -4267.1245],
         [-3647.1467,  5226.3628],
         [ 6891.5645,  5453.4478],
         [-2444.4868, -5200.5508]],

        [[-1279.2094, -8066.6851],
         [ 2678.1382, -1797.9900],
         [-2254.2795, -2323.8833],
         [  764.2783, -9266.6104],
         [ 2410.1072,  3860.3787],
         [ 1555.9945,   240.4800],
         [ 5129.9014,  -176.4288],
         [-1169.8656, -1772.6180],
         [-2898.1287,  5920.8799],
         [  511.5479, -1950.1707]],

        [[ 7825.3418,  5152.7773],
         [ 3679.6841,  3649.7615],
         [-6708.2905,  -777.0289],
         [-2759.5129,  4716.4521],
         [-1162.5148,  7343.5444],
         [  825.3854, -7445.7095],
         [-1820.9987,  1408.7136],
         [ 1046.5206,  6987.1011],
         [ 1984.9462, -1093.4860],
         [-4242.2720,  -965.0461]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[-5.7378e+03, -2.3159e+03],
         [ 4.6996e+03, -5.0130e+03],
         [-3.7627e+03, -4.9750e+03],
         [-6.9990e+03, -5.1372e+03],
         [ 8.4781e+03,  4.0034e+03],
         [ 8.9227e+02,  4.8763e+03],
         [ 4.0241e+03,  6.4524e+03],
         [ 8.4541e+03,  3.0466e+03],
         [-6.4347e+03, -3.4947e+03],
         [-1.0815e+03, -2.1949e+03]],

        [[-4.3620e+03,  4.6018e+03],
         [ 4.9632e+03, -2.0344e+03],
         [ 4.5890e+03,  5.8674e+03],
         [-6.5916e+03,  4.5006e+03],
         [ 3.5126e+03,  8.8759e+02],
         [-5.4837e+03,  1.8432e+03],
         [ 1.5605e+03,  1.7199e+03],
         [-1.3258e+03, -5.2901e+03],
         [-3.5725e+03, -3.0510e+03],
         [ 2.7224e+03,  3.7707e+03]],

        [[-5.6692e+03, -1.0296e+03],
         [ 7.3133e+03, -1.8252e+03],
         [ 2.8410e+03,  5.4405e+03],
         [-7.1545e+03,  3.7298e+03],
         [ 2.3198e+03, -4.2958e+03],
         [ 5.1854e+03, -3.0960e+03],
         [-2.7017e+02, -3.5471e+03],
         [ 5.8849e+03,  2.3512e+03],
         [-4.8833e+02,  1.9146e+03],
         [ 2.6700e+03, -3.4706e+03]],

        [[-1.5879e+03, -1.4295e+01],
         [ 4.1389e+03,  2.4999e+03],
         [ 3.1760e+03, -6.4692e+03],
         [-4.2490e+02,  2.0090e+03],
         [ 3.5977e+03,  4.7717e+03],
         [ 3.8208e+01, -5.3417e+03],
         [-1.3369e+02, -8.7074e+03],
         [-1.8760e+02, -6.5426e+03],
         [-2.7253e+02, -2.5408e+03],
         [-1.7473e+02,  1.4557e+03]],

        [[-3.2238e+03, -3.5876e+03],
         [ 1.0320e+03, -4.9492e+03],
         [ 5.5804e+03, -3.1550e+03],
         [-4.0272e+03, -1.5076e+03],
         [-3.8718e+03, -4.6979e+03],
         [-9.2904e+03,  1.2989e+02],
         [ 1.3926e+03,  7.9115e+03],
         [ 8.4746e+01, -4.2519e+02],
         [ 7.7423e+02,  7.5686e+02],
         [-7.9423e+02, -6.5033e+02]],

        [[-3.1562e+03, -7.0280e+02],
         [ 6.7939e+03,  3.1797e+03],
         [-1.5316e+03,  4.5196e+03],
         [-4.3101e+03, -3.4490e+03],
         [ 6.6756e+03, -2.2007e+03],
         [-2.7168e+03,  1.8259e+03],
         [-5.3358e+03, -2.4196e+02],
         [ 1.8225e+03, -6.1256e+01],
         [-6.7696e+02, -7.9607e+02],
         [-9.0345e+02, -2.6840e+01]],

        [[ 1.9279e+03,  2.7173e+03],
         [ 5.2467e+03,  4.4924e+03],
         [-2.8839e+03,  2.3979e+03],
         [ 3.9916e+03,  9.7879e+02],
         [ 3.5007e+03,  6.7426e+03],
         [ 1.0848e+03,  3.7594e+03],
         [-5.5084e+02, -8.0335e+03],
         [-2.3614e+00, -1.0862e+03],
         [-8.7187e+01, -9.7162e+02],
         [-1.6859e+01,  1.2731e+02]],

        [[-1.4331e+03, -1.5082e+03],
         [ 3.5918e+03, -5.2620e+03],
         [ 6.5581e+02, -5.4599e+03],
         [-6.4981e+02, -4.8310e+03],
         [-2.3567e+02, -4.7632e+03],
         [-8.9493e+03,  4.9976e+01],
         [ 9.2868e+02,  7.8682e+03],
         [ 1.6971e+03,  2.9868e+02],
         [ 5.9367e+03,  4.0792e+03],
         [-5.4701e+03,  2.6928e+02]],

        [[ 2.2008e+03, -1.7203e+02],
         [ 5.6097e+03,  2.9257e+03],
         [ 6.7760e+02,  1.5287e+03],
         [-6.2460e+02,  1.4923e+03],
         [ 1.9650e+03, -2.9237e+02],
         [-8.9652e+02, -3.0603e+03],
         [-6.6869e+03,  1.7270e+03],
         [ 3.7547e+03,  7.8924e+03],
         [-4.8889e+01,  5.7916e+03],
         [-1.7072e+02,  3.3427e+02]],

        [[ 4.4904e+02,  8.2235e+03],
         [ 7.1598e+02,  5.2388e+03],
         [ 1.2295e+03,  7.4335e+03],
         [-1.5393e+03, -3.8513e+03],
         [-7.4992e+02, -5.7070e+03],
         [ 2.9530e+03, -7.4677e+03],
         [ 1.3985e+03, -8.7323e+03],
         [ 3.5343e+02, -5.8516e+03],
         [-1.1401e+03, -9.6095e+03],
         [ 4.2371e+02, -7.8773e+03]]]) 

Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0153,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]],
       grad_fn=<SelectBackward>)

Epoch 3 finished. Total time: 2415.244804382324;  Epoch time: 876.9216570854187 












test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
test_counter in loss_omega_mat(): 4046
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9446, 0.9445, 0.9428,  ..., 0.6399, 0.6058, 0.6054],
         [0.4511, 0.4191, 0.4063,  ..., 0.2773, 0.2773, 0.2740],
         [0.4188, 0.4057, 0.4039,  ..., 0.2772, 0.2733, 0.2649],
         ...,
         [0.9459, 0.9458, 0.9458,  ..., 0.7572, 0.7572, 0.7571],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7571],
         [0.9459, 0.9459, 0.9459,  ..., 0.7572, 0.7571, 0.7571]],

        [[0.9457, 0.9453, 0.9451,  ..., 0.6408, 0.6407, 0.6405],
         [0.9451, 0.9451, 0.9450,  ..., 0.6401, 0.6059, 0.6058],
         [0.9451, 0.9450, 0.9450,  ..., 0.6398, 0.6060, 0.6058],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7571]],

        [[0.9457, 0.9456, 0.9453,  ..., 0.7568, 0.7567, 0.6408],
         [0.9456, 0.9453, 0.9453,  ..., 0.7565, 0.6409, 0.6409],
         [0.9456, 0.9454, 0.9453,  ..., 0.6409, 0.6405, 0.6400],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7571]],

        ...,

        [[0.9459, 0.9459, 0.9459,  ..., 0.7571, 0.7567, 0.7565],
         [0.9458, 0.9458, 0.9455,  ..., 0.7567, 0.7562, 0.7391],
         [0.9457, 0.9453, 0.9451,  ..., 0.7563, 0.7300, 0.7291],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7572, 0.7570],
         [0.9459, 0.9458, 0.9458,  ..., 0.7570, 0.7564, 0.7559]],

        [[0.9459, 0.9459, 0.9458,  ..., 0.7569, 0.7567, 0.7563],
         [0.9458, 0.9458, 0.9454,  ..., 0.7501, 0.7441, 0.7318],
         [0.9453, 0.9451, 0.9450,  ..., 0.7436, 0.7269, 0.7186],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7572],
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7572, 0.7571],
         [0.9459, 0.9459, 0.9458,  ..., 0.7571, 0.7569, 0.7560]],

        [[0.9458, 0.9458, 0.9458,  ..., 0.7562, 0.7561, 0.7529],
         [0.9458, 0.9453, 0.9451,  ..., 0.7424, 0.7396, 0.7274],
         [0.9453, 0.9445, 0.9399,  ..., 0.7338, 0.7240, 0.7098],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7570, 0.7559, 0.7535],
         [0.9459, 0.9458, 0.9458,  ..., 0.7569, 0.7569, 0.7546],
         [0.9459, 0.9458, 0.9457,  ..., 0.7566, 0.7564, 0.7563]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[2.1221e-07, 3.2258e-08, 3.5652e-07,  ..., 2.5629e-07,
          2.2410e-07, 1.5967e-06],
         [1.1799e-07, 2.7589e-06, 3.1388e-09,  ..., 6.6469e-09,
          8.2308e-07, 3.0767e-06],
         [5.4409e-06, 6.7681e-07, 1.6629e-06,  ..., 1.2184e-05,
          1.2117e-05, 3.2717e-07],
         ...,
         [1.9697e-08, 3.7298e-07, 2.5456e-07,  ..., 1.9785e-09,
          6.6087e-07, 2.6769e-07],
         [1.0770e-09, 2.3377e-08, 4.0193e-07,  ..., 5.5900e-07,
          3.1618e-08, 4.1209e-09],
         [4.8755e-08, 8.2811e-08, 3.8822e-07,  ..., 3.0356e-07,
          1.8383e-09, 7.0778e-08]],

        [[3.5107e-07, 3.5637e-08, 1.9625e-06,  ..., 1.2209e-06,
          2.7293e-08, 1.8412e-07],
         [2.2524e-06, 1.9536e-06, 3.6262e-06,  ..., 2.0325e-06,
          1.2537e-06, 7.5322e-06],
         [2.1191e-07, 4.3788e-06, 5.2314e-08,  ..., 8.9813e-07,
          7.6133e-08, 2.2413e-06],
         ...,
         [2.5014e-08, 2.2656e-09, 2.6922e-07,  ..., 1.5788e-07,
          1.1535e-06, 1.8465e-06],
         [2.6182e-08, 5.8850e-09, 3.8795e-07,  ..., 2.9186e-08,
          4.7073e-07, 1.3003e-06],
         [2.7575e-07, 2.4095e-07, 8.9708e-09,  ..., 1.3565e-06,
          1.8181e-06, 8.0987e-07]],

        [[3.9194e-07, 4.3048e-08, 7.4221e-10,  ..., 1.5942e-09,
          4.9953e-07, 5.3882e-07],
         [5.0212e-08, 3.7636e-10, 4.8608e-08,  ..., 5.1539e-08,
          8.5370e-07, 2.2522e-07],
         [2.9332e-09, 6.2125e-08, 1.0304e-07,  ..., 1.3116e-07,
          9.1739e-07, 4.1870e-07],
         ...,
         [1.0630e-07, 5.1653e-10, 1.2238e-07,  ..., 2.3798e-07,
          3.4235e-08, 8.1172e-08],
         [1.1825e-08, 9.8438e-10, 8.1345e-08,  ..., 1.8815e-08,
          4.0158e-09, 5.0103e-08],
         [2.4533e-09, 1.5068e-07, 1.3667e-07,  ..., 3.3788e-07,
          4.8556e-07, 1.6597e-09]],

        ...,

        [[3.7080e-08, 4.5995e-08, 3.9664e-08,  ..., 7.0255e-07,
          2.0015e-07, 2.4818e-06],
         [9.7455e-11, 4.2591e-09, 4.0488e-07,  ..., 4.2199e-06,
          3.2018e-06, 6.3719e-06],
         [1.9335e-06, 3.0850e-06, 6.8669e-08,  ..., 6.3044e-06,
          1.3308e-04, 1.5744e-06],
         ...,
         [2.4619e-11, 1.7828e-07, 4.9240e-11,  ..., 3.1901e-09,
          1.0740e-08, 5.0943e-08],
         [5.2443e-07, 6.9719e-09, 1.1274e-07,  ..., 2.6696e-07,
          1.2804e-06, 9.1543e-07],
         [1.0376e-06, 1.1502e-09, 2.0494e-08,  ..., 3.1093e-07,
          8.2447e-07, 1.5330e-07]],

        [[6.4906e-07, 2.3859e-08, 5.5875e-07,  ..., 1.6101e-07,
          2.1278e-06, 8.7768e-07],
         [9.1707e-09, 5.2821e-09, 6.3059e-08,  ..., 1.6341e-06,
          3.3731e-06, 1.0426e-06],
         [1.5912e-08, 1.4334e-07, 3.6005e-06,  ..., 1.9088e-06,
          1.0318e-06, 4.0336e-05],
         ...,
         [5.4274e-09, 4.3228e-07, 9.3322e-09,  ..., 3.9811e-09,
          7.8168e-07, 1.9519e-07],
         [4.5745e-08, 4.9908e-14, 9.3460e-08,  ..., 1.8296e-08,
          5.2727e-08, 3.8801e-08],
         [7.1318e-07, 1.8753e-07, 1.2102e-07,  ..., 1.6799e-06,
          1.4009e-06, 2.7783e-06]],

        [[1.3339e-07, 8.5735e-07, 1.3274e-07,  ..., 9.3256e-07,
          5.7405e-08, 3.7048e-06],
         [5.3493e-07, 2.2674e-07, 3.3477e-08,  ..., 9.6200e-08,
          3.7268e-06, 5.6176e-07],
         [1.2813e-09, 1.8006e-06, 8.8240e-08,  ..., 1.5263e-04,
          6.8728e-05, 9.0941e-05],
         ...,
         [1.1470e-07, 1.9387e-08, 8.8890e-09,  ..., 4.5141e-07,
          6.1180e-07, 4.3485e-06],
         [8.8447e-08, 4.9691e-07, 1.6344e-09,  ..., 2.4663e-06,
          2.3848e-06, 1.0509e-06],
         [2.6208e-07, 8.4913e-07, 8.4487e-08,  ..., 1.7355e-07,
          2.0186e-09, 1.6590e-07]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[3.6350e-04, 2.5811e-04, 2.3848e-04,  ..., 6.6607e-04,
          1.1326e-04, 5.9892e-04],
         [3.7155e-04, 3.8636e-04, 3.4872e-04,  ..., 5.9393e-05,
          2.9348e-04, 1.1314e-03],
         [6.1165e-04, 9.2714e-04, 7.6726e-04,  ..., 4.7355e-04,
          6.0513e-04, 1.2579e-03],
         ...,
         [5.1710e-04, 6.5622e-04, 4.6765e-04,  ..., 1.3481e-04,
          4.9065e-05, 6.6190e-04],
         [1.4162e-04, 4.6008e-04, 8.7774e-05,  ..., 2.0946e-04,
          2.2686e-04, 5.5444e-04],
         [6.7342e-04, 5.6365e-04, 8.7774e-05,  ..., 3.4347e-04,
          6.9529e-04, 3.6543e-04]],

        [[4.8427e-04, 3.5311e-04, 1.9977e-04,  ..., 8.0930e-04,
          5.7891e-04, 5.5310e-04],
         [1.9977e-04, 5.2953e-04, 6.7969e-04,  ..., 3.9153e-04,
          1.6425e-04, 3.7947e-04],
         [1.6959e-04, 6.7969e-04, 8.5070e-04,  ..., 3.7774e-04,
          2.0804e-04, 3.6339e-04],
         ...,
         [5.6175e-04, 5.1710e-04, 4.6123e-04,  ..., 1.9147e-04,
          3.9386e-04, 4.0559e-04],
         [4.3722e-04, 1.4162e-04, 8.5598e-04,  ..., 1.8373e-04,
          5.3754e-04, 6.6163e-04],
         [8.9385e-04, 6.7342e-04, 8.5598e-04,  ..., 5.0725e-04,
          7.8967e-04, 6.3795e-04]],

        [[7.2053e-04, 3.8963e-04, 3.5311e-04,  ..., 4.8813e-04,
          7.9419e-04, 1.3408e-04],
         [2.2430e-04, 5.6522e-04, 7.2391e-04,  ..., 2.5777e-04,
          8.0229e-04, 4.0794e-04],
         [8.2847e-04, 7.5493e-04, 5.6522e-04,  ..., 4.5013e-04,
          6.1614e-04, 6.2660e-04],
         ...,
         [5.6175e-04, 8.0551e-04, 2.4017e-04,  ..., 5.9918e-04,
          7.1763e-05, 2.4191e-04],
         [4.3722e-04, 4.3218e-04, 2.8747e-04,  ..., 5.6912e-04,
          5.3688e-04, 6.2385e-04],
         [8.9385e-04, 4.2729e-04, 4.3218e-04,  ..., 1.7246e-04,
          2.7534e-04, 5.5312e-04]],

        ...,

        [[2.8952e-04, 6.2775e-05, 5.7867e-04,  ..., 7.1191e-04,
          5.7193e-04, 6.9926e-04],
         [3.0220e-04, 4.8666e-04, 6.0429e-04,  ..., 3.9449e-04,
          1.4852e-04, 6.9825e-03],
         [8.3986e-04, 1.5438e-04, 1.1700e-04,  ..., 7.3518e-04,
          8.7586e-03, 2.5048e-04],
         ...,
         [5.0551e-04, 2.5207e-04, 3.7757e-04,  ..., 4.1120e-04,
          5.6044e-04, 6.4566e-04],
         [5.8786e-04, 7.5509e-04, 1.0721e-03,  ..., 3.2461e-04,
          8.1822e-04, 2.5295e-04],
         [7.1312e-04, 6.4248e-04, 8.7512e-04,  ..., 7.0627e-04,
          4.4282e-04, 8.5776e-04]],

        [[4.3891e-04, 6.2775e-05, 3.3524e-04,  ..., 1.9199e-04,
          4.6112e-04, 7.3518e-04],
         [8.5253e-04, 4.8666e-04, 3.2776e-04,  ..., 8.0743e-04,
          5.4673e-04, 7.8700e-04],
         [3.2858e-04, 1.1700e-04, 6.7452e-04,  ..., 7.0475e-03,
          1.8590e-03, 7.6488e-04],
         ...,
         [6.1482e-04, 2.5207e-04, 2.3602e-04,  ..., 2.9732e-04,
          1.5020e-04, 2.8491e-04],
         [7.5509e-04, 7.2767e-04, 1.7927e-04,  ..., 2.6942e-04,
          5.0383e-04, 4.5565e-04],
         [7.1312e-04, 9.8351e-04, 7.7674e-04,  ..., 7.5605e-04,
          5.4515e-04, 6.1154e-04]],

        [[2.6738e-04, 3.3524e-04, 3.1901e-04,  ..., 4.6938e-04,
          4.6242e-04, 6.9035e-04],
         [8.5253e-04, 4.2163e-04, 7.1648e-04,  ..., 2.8798e-03,
          6.4810e-03, 1.5467e-03],
         [3.2858e-04, 5.5672e-04, 4.7172e-04,  ..., 8.5992e-03,
          2.1122e-03, 1.4349e-03],
         ...,
         [4.1960e-04, 2.3602e-04, 9.3001e-04,  ..., 2.1842e-04,
          4.2583e-04, 4.8072e-04],
         [7.2767e-04, 9.3001e-04, 1.0232e-03,  ..., 1.0555e-03,
          7.8853e-04, 2.3363e-04],
         [9.8351e-04, 1.0232e-03, 6.9880e-04,  ..., 8.7191e-04,
          7.3193e-04, 7.4861e-04]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:3.4470741748809814 loss2:1336.6715087890625


loss.item(): 26736.876953125


Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([59, 98]) torch.Size([59, 98, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-1.1436e-01,  1.1997e+00,  1.3487e+00,  8.2836e-01,  1.9598e+00,
          1.3910e+00,  4.9053e+00,  1.0663e+01,  4.1246e+00, -1.3524e+01],
        [ 3.3321e-03, -1.6991e+00, -2.1006e+00,  1.4282e+00,  4.6745e+00,
          1.0166e+01,  1.0123e+01,  9.1734e+01,  3.4641e+01,  5.5010e+01],
        [-8.9519e+00,  2.2153e+01,  2.3889e+01, -1.0878e+01,  3.2429e+01,
          2.6586e+01, -2.3390e+02,  1.9025e+02, -4.6956e+02,  2.5187e+02],
        [ 2.8758e+01,  3.0492e+01, -1.1264e+01,  1.8661e+01,  5.2765e+01,
          4.4732e+02,  2.4563e+02,  4.6607e+02, -2.6787e+02, -6.0687e+02],
        [ 1.8863e+01, -1.1175e+00,  3.2719e+01,  5.0536e+02,  6.1544e+02,
          6.9741e+02,  9.4999e+02,  1.1062e+03, -1.1583e+02,  4.2711e+02],
        [ 3.1719e+01,  1.2327e+01,  9.9895e+01,  5.2068e+02,  1.0253e+03,
         -9.2247e+02,  7.8561e+02,  1.3902e+03, -2.3138e+02,  1.3712e+03],
        [ 1.7989e+01,  1.1724e+01,  4.5008e+02,  7.1484e+02,  4.3188e+02,
         -1.1097e+04, -1.0102e+03,  1.1256e+03,  3.2967e+02, -1.3125e+03],
        [-4.9811e+00, -1.7044e+01,  3.7990e+01,  9.0620e+02,  6.3231e+02,
          1.7454e+02, -7.0133e+03,  7.1963e+02, -8.9910e+02, -9.7845e+03]]) 

MatU.grad[0:10,35:45]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-2.1525e+02,  6.5078e+02],
         [-4.4330e+02,  1.7119e+02],
         [-2.2675e+02,  6.3147e+02],
         [ 2.0592e+02, -7.1270e+02],
         [-4.3211e+02, -3.0814e+02],
         [ 3.2579e+02, -1.8629e+02],
         [-2.8390e+01,  7.8531e+02],
         [ 4.2731e+02, -1.3108e+02],
         [-5.4173e+01,  8.5160e+02],
         [-1.1457e+02, -2.8489e+02]],

        [[ 1.0357e+03, -1.1228e+03],
         [-1.6167e+03, -8.5755e+02],
         [ 2.4643e+02,  1.5288e+01],
         [-1.9522e+03, -1.7951e+02],
         [ 1.8477e+03,  1.8740e+02],
         [ 1.1045e+03,  1.9447e+02],
         [-2.2007e+03, -1.0341e+03],
         [ 2.2056e+03, -1.3557e+02],
         [-1.8337e+03, -1.1001e+03],
         [ 1.7472e+01,  1.8228e+03]],

        [[-3.1859e+03, -4.9128e+03],
         [-3.4151e+03, -2.3997e+03],
         [-1.6078e+03,  4.7000e+03],
         [ 4.3941e+03,  7.0229e+02],
         [-6.9279e+02, -3.3697e+03],
         [-1.2798e+03,  1.8137e+03],
         [-5.4126e+03,  5.0526e+02],
         [ 3.3411e+03,  5.3108e+02],
         [ 2.3229e+03, -1.9710e+03],
         [-5.8246e+03, -1.0965e+03]],

        [[-3.1690e+03,  2.0267e+03],
         [ 6.5265e+03, -9.0375e+01],
         [ 1.7707e+03, -5.1624e+03],
         [ 1.2349e+03,  3.3480e+03],
         [-4.4433e+03,  2.8899e+02],
         [-4.7341e+02,  7.2190e+03],
         [-4.1366e+03, -2.4586e+03],
         [ 5.4325e+03, -6.7342e+02],
         [ 5.4757e+02,  3.0418e+03],
         [-3.7352e+03, -6.1388e+03]],

        [[-6.9633e+03,  2.6882e+03],
         [ 5.4922e+03, -2.2299e+03],
         [-8.0795e+02,  3.3585e+03],
         [-5.9408e+03,  1.0973e+03],
         [ 1.7434e+03,  1.1715e+02],
         [ 3.5895e+01,  1.6231e+03],
         [-1.2997e+02,  1.5680e+03],
         [ 7.0507e+03, -4.6446e+02],
         [-6.7109e+03, -1.5406e+03],
         [-1.9230e+02,  7.5419e+03]],

        [[ 1.0948e+03, -5.3134e+03],
         [-9.7307e+02,  2.2566e+03],
         [ 5.7440e+03,  5.0859e+03],
         [-5.1562e+03, -4.9182e+03],
         [ 1.6703e+03, -6.8985e+01],
         [-5.6625e+02, -7.1230e+02],
         [-1.2894e+02,  1.2164e+03],
         [ 1.6864e+03, -7.3706e+01],
         [ 2.2908e+02,  1.0454e+00],
         [-3.7036e+02,  1.3235e+03]],

        [[-6.4634e+03, -3.4303e+03],
         [ 5.9936e+03,  2.3707e+03],
         [ 1.5667e+03,  1.3450e+03],
         [-5.8289e+01, -5.4637e+03],
         [-1.6068e+03, -1.3511e+02],
         [ 1.2315e+03, -1.5989e+02],
         [-6.8072e+02, -4.3110e+02],
         [ 1.2223e+03, -1.2470e+02],
         [ 1.1962e+03,  2.7865e+02],
         [-1.1949e+03, -1.3421e+03]]]) 

MatD.grad: 
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.8760,  ..., 0.0000, 0.0000, 0.0000],
        ...,
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.0643e+01,  1.8130e+02],
         [ 5.9965e+01, -5.6220e+01],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.9042e+02, -2.4916e+01],
         [-2.1149e+02,  1.7183e+02],
         [ 3.2786e+02, -2.4210e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.6933e-02,  9.9657e+01],
         [ 7.6694e+01, -6.3638e+01],
         [-2.1150e+02, -8.1282e+01]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-4.1893e+02, -3.8699e+00],
         [-3.3044e+02,  4.6970e+02],
         [-1.8545e+02, -9.3566e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-9.3642e+00,  9.6434e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.6226e+02, -5.7709e+02],
         [-1.1788e+03, -4.0093e+02],
         [-1.1907e+03, -4.8492e+02],
         [ 1.0042e+02,  1.1818e+03],
         [-1.3248e+03,  1.3886e+03],
         [ 1.8662e+03,  5.3540e+02],
         [-4.8365e+03,  3.4300e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-5.4054e+01, -4.4384e+02],
         [-1.0018e+03, -1.1406e+03],
         [ 2.9797e+03, -1.7161e+01],
         [ 5.2145e+03,  1.3921e+03],
         [-5.8286e+03, -1.5419e+03],
         [-4.2792e+03, -4.3473e+03],
         [-4.0856e+02, -3.6793e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-8.5421e+02,  2.1159e+02],
         [ 5.3793e+02,  1.6972e+03],
         [ 3.7892e+03, -4.4924e+03],
         [-3.7364e+03,  4.2469e+03],
         [ 4.1918e+03,  7.9840e+03],
         [ 4.0902e+03, -5.3525e+03],
         [ 4.8221e+02,  1.9319e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 4.4185e+02, -7.5175e+02],
         [-2.0474e+03,  1.5026e+02],
         [-1.3389e+03, -1.2880e+03],
         [-1.6755e+01,  5.5615e+03],
         [-8.5968e+03,  1.3901e+03],
         [ 4.2444e+02, -3.5408e+03],
         [-1.1125e+03,  4.7305e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.1043e+02,  1.5467e+02],
         [ 9.0658e+02, -1.6780e+03],
         [ 4.4095e+03,  1.6485e+03],
         [ 8.1545e+03,  2.6650e+03],
         [-6.2325e+03, -7.3456e+03],
         [-5.2361e+03,  5.0145e+03],
         [ 5.9072e+03, -1.2694e+03]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[-1986.1646, -2796.4407],
         [ 6958.7427,   172.0030],
         [-1846.5070,  1420.6212],
         [ 3560.8171, -5023.6509],
         [ 6742.2876,  5382.4956],
         [-4940.6426, -6352.1025],
         [-5826.5098,   594.2918],
         [ 8371.1318,  3420.1292],
         [ 3712.2314, -5943.6167],
         [ 2061.0454, -2981.9915]],

        [[ -734.5182,  2441.9265],
         [-7172.3145,  2448.7573],
         [-2098.1704, -5139.5576],
         [-3734.3452, -6329.3330],
         [ 3029.6863,  3056.0806],
         [ 1249.4706,   161.0942],
         [-3809.7698, -8183.7993],
         [-5015.3345,  3799.5549],
         [-4734.3018,  6182.4346],
         [ 5384.9395,    99.9729]],

        [[ 1095.5973, -7694.7480],
         [ -871.4001, -9341.7148],
         [-1305.3307,  6030.0771],
         [ 6571.6211, -2556.7048],
         [-5299.7378,  2989.3108],
         [ 6168.1606,  2494.8452],
         [-6059.9985, -1541.7732],
         [-5911.0522, -3937.0168],
         [ 2722.7002,  7361.7983],
         [ 4931.3184, -7384.2456]],

        [[  406.5602,  8494.8096],
         [ 9057.7031, -1422.3047],
         [ 4501.4277,  2179.6223],
         [ 1687.0197,  4137.4600],
         [-4368.7671,  3327.5752],
         [ 3395.3926, -8161.2715],
         [ 5525.1494,  4349.2129],
         [ 5814.6343, -2232.8325],
         [ 4804.6602,  5344.3159],
         [-4735.7290,   299.3223]],

        [[-9053.9131, -1536.8793],
         [ 6708.8101,  6346.0151],
         [-2064.6829,  -641.6692],
         [  647.3984,  5128.7437],
         [-2900.6243, -6293.0420],
         [-4120.6978,  -166.9556],
         [  199.5154,  4918.5874],
         [-4525.4580, -4655.7832],
         [ 4017.4592, -5664.8467],
         [ 1536.9604, -6966.0581]],

        [[ 1691.3348, -7427.9150],
         [-1882.1622, -3673.1289],
         [ 3914.2119, -3343.2961],
         [ 2716.9834, -3878.2617],
         [-5944.5884,  -935.0748],
         [ 2717.6106, -5205.0225],
         [ 6956.2764,  4606.8115],
         [-3730.0195, -5230.4873],
         [ 2771.3162, -3673.0957],
         [-3708.0562,  6592.5723]],

        [[ 6692.2275,  5427.9468],
         [ 1751.7195, -9216.7109],
         [ 3064.4866,  5716.8818],
         [-3924.4277, -2999.8796],
         [  692.9595,  5783.9473],
         [-1724.4061,  6698.2959],
         [-4404.7505,  4455.4082],
         [-3808.7502, -2419.6602],
         [-7223.5840,  -837.8270],
         [ 6699.4531,  4451.0713]],

        [[-9399.6562,   -95.7628],
         [  294.8167,  8519.7109],
         [-6328.7295, -3312.1206],
         [ 3550.1919,  -319.0310],
         [ 7498.2798, -3451.5083],
         [-5748.6431, -6891.0762],
         [  293.7218, -4879.6567],
         [-1530.4946,  1977.7407],
         [ 7659.3374,  4215.8013],
         [  933.5025, -7383.1768]],

        [[  921.9070, -7765.6758],
         [-1704.1681, -1614.1752],
         [  558.7549, -3296.8247],
         [  172.2378, -8548.0176],
         [ 3637.1941,  4523.1343],
         [ 4439.7378,   791.1358],
         [ 2146.9407,  2880.0535],
         [ 2014.2771,   -28.2771],
         [-4181.4795,  5280.5518],
         [ 3003.6018, -4036.9507]],

        [[ 7987.3623,  4776.6128],
         [ 6017.8452,   690.0280],
         [-2874.2864,  4222.8389],
         [-4329.5537,  -432.7491],
         [-1852.7288,  7097.5894],
         [ 2246.9419, -5566.4292],
         [-2367.9211,   127.2314],
         [ 1298.3970,  6905.3262],
         [-2193.7029,  -100.5782],
         [  903.9562, -1151.0264]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[-2.7333e+03, -2.8847e+03],
         [ 2.7571e+03, -5.1803e+03],
         [-6.8477e+03, -3.9156e+03],
         [-4.2974e+03, -5.4177e+03],
         [ 8.8760e+03,  5.8527e+02],
         [-5.4735e+03,  4.9587e+03],
         [ 2.2983e+03,  4.5463e+03],
         [ 8.5467e+03,  1.0072e+03],
         [-5.0322e+03, -3.7406e+03],
         [-4.0238e+03,  2.0465e+03]],

        [[-3.6703e+03,  2.5868e+03],
         [ 2.7570e+03,  2.8682e+03],
         [ 5.4804e+03,  5.4834e+03],
         [-1.3117e+03,  4.7941e+03],
         [-7.1188e+02,  6.1671e+03],
         [-4.1048e+03,  4.4597e+03],
         [ 8.4789e+02, -5.0397e+02],
         [-5.2952e+02, -7.3166e+03],
         [-5.5465e+03,  6.6942e+02],
         [-8.1716e+00,  5.5473e+03]],

        [[-5.9379e+03,  1.2583e+03],
         [ 5.4624e+03, -5.1308e+03],
         [ 7.4171e+03,  3.7000e+03],
         [-3.2892e+03,  2.4089e+03],
         [-3.4879e+02, -5.4844e+03],
         [ 6.0353e+03,  1.3211e+03],
         [-3.4021e+03, -3.5982e+03],
         [ 5.9845e+03,  4.7051e+03],
         [-8.4838e+02,  3.6156e+03],
         [ 3.4770e+03, -1.8889e+03]],

        [[ 1.6305e+03, -3.6237e+03],
         [ 3.0028e+02,  4.3715e+03],
         [ 5.5207e+03, -4.2293e+02],
         [ 6.4901e+03, -3.1074e+03],
         [ 2.8538e+03,  3.6326e+02],
         [-1.4243e+03, -2.5681e+03],
         [-2.8158e+02, -8.7751e+03],
         [ 1.3220e+02, -6.5126e+03],
         [-2.5124e+02, -2.4821e+03],
         [-7.8501e+01,  1.4114e+03]],

        [[-2.0553e+03, -4.2418e+03],
         [-1.8533e+03, -8.1297e+02],
         [ 2.1068e+03, -3.3102e+03],
         [-4.0332e+03,  3.1091e+03],
         [-4.5473e+03, -5.1859e+03],
         [-9.2134e+03, -3.2107e+02],
         [ 9.3845e+02,  7.7681e+03],
         [ 5.9986e+02, -3.8981e+02],
         [ 7.3211e+02,  7.7499e+02],
         [-7.6828e+02, -6.3216e+02]],

        [[-4.0345e+03,  2.2814e+03],
         [ 7.8639e+03,  5.3179e+02],
         [-1.7188e+03,  6.9673e+03],
         [-5.4361e+02, -5.7686e+03],
         [ 6.4126e+03, -1.4887e+03],
         [-1.5532e+03,  1.7095e+03],
         [-5.1357e+03,  2.0393e+02],
         [ 1.7829e+03, -4.9815e+01],
         [-6.5542e+02, -7.7131e+02],
         [-8.6167e+02, -6.5953e+01]],

        [[ 3.0706e+03, -3.6966e-01],
         [ 4.9914e+03,  1.9653e+03],
         [-8.3387e+02, -3.5095e+03],
         [ 4.6819e+03, -2.6727e+03],
         [-4.4032e+02,  4.8032e+03],
         [ 2.3099e+03,  2.7004e+03],
         [-6.5976e+02, -7.9566e+03],
         [-9.4492e+01, -9.4021e+02],
         [-2.0322e+02, -9.3719e+02],
         [-3.0287e+02,  3.8841e+02]],

        [[ 2.4892e+03, -4.5826e+02],
         [-7.9907e+02, -1.6191e+03],
         [-2.3710e+03, -3.3633e+03],
         [-1.9504e+03, -5.2399e+03],
         [-6.9514e+02, -4.6351e+03],
         [-8.8994e+03, -4.2667e+02],
         [ 5.2467e+02,  7.8931e+03],
         [ 1.2705e+03, -1.0418e+02],
         [ 6.1981e+03,  4.1990e+03],
         [-5.3120e+03,  1.8040e+02]],

        [[-1.4680e+03, -2.3035e+03],
         [ 6.9696e+03,  2.0117e+03],
         [-1.3122e+03,  2.6807e+03],
         [ 5.0749e+03,  1.8560e+03],
         [-5.0395e+02,  2.1396e+03],
         [-2.5195e+03, -3.1773e+03],
         [-6.5654e+03,  1.0108e+03],
         [ 3.5452e+03,  7.9454e+03],
         [ 5.6431e+02,  5.6656e+03],
         [-2.1341e+02, -1.1003e+01]],

        [[-7.4992e+02,  7.8655e+03],
         [-2.0013e+02,  5.0063e+03],
         [ 1.2133e+03,  7.4470e+03],
         [ 8.9858e+01, -1.7756e+03],
         [ 3.5737e+02, -4.4772e+03],
         [ 2.3717e+03, -7.2198e+03],
         [ 8.7141e+02, -8.6413e+03],
         [ 5.4928e+02, -6.0456e+03],
         [-3.8804e+02, -9.3147e+03],
         [-6.9569e+02, -7.7385e+03]]]) 

Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0153,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]],
       grad_fn=<SelectBackward>)

Epoch 4 finished. Total time: 3360.535786628723;  Epoch time: 945.2839982509613 












test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
test_counter in loss_omega_mat(): 4046
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9441, 0.9439, 0.9414,  ..., 0.6397, 0.6055, 0.6049],
         [0.4508, 0.4168, 0.4036,  ..., 0.2756, 0.2754, 0.2695],
         [0.4164, 0.4029, 0.4015,  ..., 0.2753, 0.2685, 0.2620],
         ...,
         [0.9459, 0.9458, 0.9458,  ..., 0.7573, 0.7572, 0.7571],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7572, 0.7572, 0.7571]],

        [[0.9457, 0.9450, 0.9449,  ..., 0.6407, 0.6405, 0.6402],
         [0.9449, 0.9448, 0.9447,  ..., 0.6400, 0.6058, 0.6058],
         [0.9449, 0.9448, 0.9447,  ..., 0.6393, 0.6059, 0.6058],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7572]],

        [[0.9457, 0.9454, 0.9450,  ..., 0.7565, 0.7564, 0.6407],
         [0.9454, 0.9450, 0.9450,  ..., 0.7563, 0.6408, 0.6408],
         [0.9453, 0.9452, 0.9450,  ..., 0.6409, 0.6405, 0.6397],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7571]],

        ...,

        [[0.9459, 0.9459, 0.9459,  ..., 0.7569, 0.7566, 0.7562],
         [0.9458, 0.9458, 0.9455,  ..., 0.7566, 0.7562, 0.7364],
         [0.9456, 0.9452, 0.9451,  ..., 0.7561, 0.7257, 0.7247],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7571],
         [0.9459, 0.9459, 0.9459,  ..., 0.7572, 0.7572, 0.7569],
         [0.9459, 0.9459, 0.9458,  ..., 0.7569, 0.7561, 0.7556]],

        [[0.9459, 0.9458, 0.9456,  ..., 0.7567, 0.7565, 0.7561],
         [0.9458, 0.9457, 0.9454,  ..., 0.7489, 0.7422, 0.7279],
         [0.9452, 0.9451, 0.9450,  ..., 0.7417, 0.7212, 0.7119],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7571],
         [0.9459, 0.9459, 0.9458,  ..., 0.7571, 0.7571, 0.7570],
         [0.9459, 0.9459, 0.9458,  ..., 0.7570, 0.7569, 0.7559]],

        [[0.9458, 0.9456, 0.9456,  ..., 0.7558, 0.7558, 0.7526],
         [0.9457, 0.9450, 0.9446,  ..., 0.7396, 0.7365, 0.7230],
         [0.9452, 0.9443, 0.9382,  ..., 0.7295, 0.7181, 0.7016],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7570, 0.7557, 0.7528],
         [0.9459, 0.9458, 0.9458,  ..., 0.7568, 0.7567, 0.7540],
         [0.9459, 0.9458, 0.9458,  ..., 0.7565, 0.7562, 0.7561]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[9.7720e-09, 7.1403e-08, 5.7775e-07,  ..., 1.1640e-06,
          3.9765e-07, 2.8083e-06],
         [7.3486e-10, 3.7257e-06, 6.3409e-08,  ..., 7.7134e-07,
          3.2745e-07, 8.2677e-06],
         [5.6350e-06, 5.9108e-08, 1.8595e-06,  ..., 1.0330e-05,
          7.1407e-06, 8.5903e-06],
         ...,
         [4.7274e-08, 4.8668e-08, 8.1166e-08,  ..., 2.9850e-10,
          4.9375e-10, 2.2636e-07],
         [5.5492e-08, 4.4441e-08, 1.4039e-07,  ..., 2.6361e-10,
          1.2274e-07, 2.0686e-07],
         [8.4469e-08, 7.6176e-08, 1.1891e-07,  ..., 1.2340e-09,
          2.8798e-07, 7.0510e-08]],

        [[6.6760e-07, 1.5006e-07, 2.7706e-06,  ..., 1.3298e-06,
          1.2909e-06, 1.0668e-07],
         [3.0030e-06, 5.1056e-06, 2.8164e-06,  ..., 5.1777e-07,
          1.1468e-05, 7.4948e-07],
         [1.3724e-08, 9.1430e-06, 6.9562e-08,  ..., 1.2991e-07,
          3.7393e-06, 3.9095e-06],
         ...,
         [7.2453e-08, 2.0075e-07, 3.2914e-09,  ..., 4.4655e-07,
          8.0298e-07, 2.8564e-06],
         [6.3037e-10, 1.1685e-08, 5.4704e-07,  ..., 2.6591e-07,
          8.0564e-07, 1.0699e-06],
         [1.4897e-07, 3.4049e-08, 1.5000e-08,  ..., 2.5427e-07,
          2.0504e-06, 4.5925e-07]],

        [[1.7851e-07, 5.2083e-08, 2.9363e-07,  ..., 6.4451e-08,
          2.1091e-07, 8.5323e-07],
         [8.6403e-10, 1.4456e-07, 8.2045e-09,  ..., 2.5991e-07,
          1.1562e-08, 8.1854e-08],
         [1.0681e-08, 7.3330e-08, 1.7030e-07,  ..., 4.7775e-07,
          7.5385e-07, 5.1144e-07],
         ...,
         [3.1625e-08, 7.3453e-08, 5.4415e-10,  ..., 2.4672e-07,
          5.3421e-08, 1.4424e-09],
         [8.6789e-09, 7.2438e-08, 3.2500e-08,  ..., 3.5996e-07,
          1.6469e-07, 1.1313e-07],
         [9.2221e-10, 1.0654e-07, 1.2294e-07,  ..., 1.0249e-07,
          5.6468e-08, 3.3322e-08]],

        ...,

        [[2.9753e-08, 5.2826e-11, 6.8586e-08,  ..., 8.9436e-07,
          2.5771e-07, 3.2991e-06],
         [1.1075e-08, 1.1020e-07, 3.0813e-07,  ..., 3.0927e-06,
          4.5368e-06, 7.5406e-06],
         [1.9086e-06, 2.9935e-06, 1.3761e-07,  ..., 6.4548e-06,
          1.5248e-04, 1.2641e-06],
         ...,
         [1.0773e-07, 2.4099e-07, 5.0324e-10,  ..., 2.9440e-07,
          5.3348e-08, 4.0512e-07],
         [4.0541e-08, 1.3311e-08, 2.9151e-07,  ..., 1.0970e-07,
          2.0116e-07, 8.8673e-07],
         [2.2568e-07, 2.3748e-08, 7.8822e-09,  ..., 6.3888e-07,
          1.4150e-06, 4.8577e-08]],

        [[2.8403e-09, 2.5341e-07, 3.3950e-07,  ..., 2.4379e-08,
          3.1549e-06, 1.7421e-06],
         [1.0966e-07, 6.9016e-08, 4.5817e-07,  ..., 4.6701e-06,
          5.3260e-06, 4.1258e-13],
         [1.0930e-09, 1.6556e-07, 3.5954e-06,  ..., 2.4538e-06,
          1.5791e-06, 5.5888e-05],
         ...,
         [1.5118e-07, 9.0520e-09, 2.0137e-08,  ..., 2.7502e-07,
          6.1311e-07, 2.1649e-07],
         [7.3368e-12, 7.4524e-09, 1.5130e-10,  ..., 9.0087e-09,
          5.9166e-08, 5.1422e-08],
         [1.2687e-07, 2.1097e-08, 3.5973e-07,  ..., 1.2371e-06,
          1.0609e-06, 1.7150e-06]],

        [[1.0974e-06, 5.2624e-07, 6.7878e-07,  ..., 7.9280e-08,
          3.0658e-06, 6.6982e-06],
         [3.4202e-07, 2.1050e-07, 1.0846e-07,  ..., 6.7249e-08,
          4.2749e-06, 6.4890e-07],
         [9.5223e-08, 2.6231e-06, 8.8649e-10,  ..., 1.6138e-04,
          9.1101e-05, 1.0876e-04],
         ...,
         [3.2039e-09, 3.1170e-08, 1.5238e-07,  ..., 3.9911e-07,
          3.1185e-07, 2.2301e-06],
         [2.8421e-07, 5.8825e-08, 8.6503e-07,  ..., 8.6501e-08,
          1.7477e-06, 3.4644e-11],
         [4.1738e-08, 3.1484e-07, 1.4082e-07,  ..., 3.1822e-07,
          3.6942e-07, 5.1595e-07]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[1.2759e-04, 4.2695e-04, 3.5162e-04,  ..., 6.8325e-04,
          1.6581e-04, 5.9932e-04],
         [3.6840e-04, 7.5293e-04, 2.2694e-04,  ..., 2.1747e-04,
          4.3665e-05, 1.3186e-03],
         [8.9509e-04, 1.1204e-03, 4.5276e-04,  ..., 6.0006e-04,
          5.6071e-04, 8.0150e-04],
         ...,
         [3.4061e-04, 4.5398e-04, 7.4142e-04,  ..., 2.3181e-04,
          1.7561e-04, 4.5113e-04],
         [2.7056e-04, 3.4720e-04, 1.8293e-04,  ..., 6.9572e-04,
          6.1209e-04, 2.6426e-04],
         [1.8293e-04, 5.1979e-04, 3.4727e-04,  ..., 8.2251e-05,
          3.2844e-04, 2.4268e-04]],

        [[7.3174e-04, 4.7087e-04, 5.2889e-04,  ..., 6.5603e-04,
          7.9253e-04, 5.7471e-04],
         [5.2889e-04, 1.3006e-03, 7.1342e-04,  ..., 6.6852e-04,
          4.4678e-04, 2.7209e-04],
         [5.6494e-04, 1.3006e-03, 1.1190e-03,  ..., 5.5454e-04,
          4.3936e-04, 1.3815e-04],
         ...,
         [4.3718e-04, 5.4263e-04, 1.9433e-04,  ..., 2.6217e-04,
          2.7650e-04, 6.1627e-04],
         [4.5444e-04, 3.4720e-04, 6.0557e-04,  ..., 2.0592e-04,
          3.0931e-04, 4.3090e-04],
         [4.4438e-04, 6.0557e-04, 5.1979e-04,  ..., 4.1176e-04,
          8.3343e-04, 6.0282e-04]],

        [[6.6523e-04, 3.4651e-04, 4.1851e-04,  ..., 2.5929e-04,
          6.9214e-04, 8.1164e-05],
         [2.3191e-04, 4.1851e-04, 5.2644e-04,  ..., 1.6934e-04,
          5.7532e-04, 2.5050e-04],
         [8.0091e-04, 6.0115e-04, 5.2644e-04,  ..., 2.8866e-04,
          4.5351e-04, 6.8325e-04],
         ...,
         [5.9346e-04, 4.3718e-04, 5.8741e-04,  ..., 4.5865e-04,
          4.6135e-05, 2.4942e-04],
         [4.5444e-04, 3.2106e-04, 1.6365e-04,  ..., 3.9755e-04,
          6.4721e-04, 6.5975e-04],
         [3.2106e-04, 2.1650e-04, 5.8781e-04,  ..., 3.6965e-04,
          3.2644e-04, 6.3526e-05]],

        ...,

        [[4.3309e-04, 5.1438e-04, 2.3433e-04,  ..., 6.0060e-04,
          4.4971e-04, 6.8785e-04],
         [1.1280e-04, 6.9390e-05, 4.6318e-04,  ..., 1.8726e-04,
          4.1312e-04, 6.3457e-03],
         [6.1596e-04, 2.8408e-04, 5.2073e-05,  ..., 5.7698e-04,
          8.0197e-03, 3.4034e-04],
         ...,
         [3.1614e-04, 1.8039e-04, 4.0597e-04,  ..., 1.5787e-04,
          2.3741e-04, 1.0023e-03],
         [5.2579e-04, 9.2353e-04, 7.4450e-04,  ..., 8.0180e-04,
          6.4521e-04, 3.9211e-04],
         [9.7127e-04, 3.4807e-04, 7.6179e-04,  ..., 2.8924e-04,
          6.8892e-04, 8.8927e-04]],

        [[2.3433e-04, 3.2728e-04, 4.7001e-04,  ..., 2.5380e-04,
          5.3038e-04, 5.7698e-04],
         [6.9390e-05, 3.7325e-04, 2.8444e-04,  ..., 3.8212e-04,
          1.5584e-04, 2.7261e-04],
         [2.9619e-04, 5.2073e-05, 2.9263e-04,  ..., 6.6030e-03,
          1.4605e-03, 4.0040e-04],
         ...,
         [4.0597e-04, 1.7073e-04, 5.5227e-04,  ..., 1.4687e-04,
          3.6495e-04, 2.8886e-04],
         [5.2579e-04, 6.9341e-04, 4.5756e-04,  ..., 1.5827e-04,
          5.9103e-04, 3.1452e-04],
         [9.7127e-04, 1.0145e-03, 8.0741e-04,  ..., 9.3243e-04,
          6.8143e-04, 9.2602e-04]],

        [[3.9155e-04, 5.4669e-04, 4.7001e-04,  ..., 5.5528e-04,
          3.1123e-04, 4.1789e-04],
         [3.7325e-04, 1.7672e-04, 4.4103e-04,  ..., 2.4372e-03,
          6.0234e-03, 1.0164e-03],
         [2.9619e-04, 7.2636e-04, 2.3720e-04,  ..., 7.7423e-03,
          1.7780e-03, 1.5685e-03],
         ...,
         [1.7073e-04, 1.8304e-04, 9.8285e-04,  ..., 3.1049e-04,
          6.3664e-04, 1.3172e-04],
         [6.9341e-04, 9.8285e-04, 7.7346e-04,  ..., 5.8727e-04,
          5.2318e-04, 1.6377e-04],
         [1.0145e-03, 9.4597e-04, 4.7104e-04,  ..., 3.3191e-04,
          7.6484e-04, 8.2161e-04]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:3.84232497215271 loss2:1217.95849609375


loss.item(): 24363.01171875


Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([59, 98]) torch.Size([59, 98, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-1.0440e-01,  1.1472e+00,  9.4100e-01,  7.6779e-01,  2.0760e+00,
          9.3086e-01,  4.7646e+00,  1.0213e+01,  4.8608e+00, -1.3484e+01],
        [ 5.7469e+00,  1.0523e-01,  1.1185e+00,  3.5847e+00,  4.2102e+00,
          9.5306e+00,  1.2381e+01,  8.7211e+01,  3.6474e+01,  5.7372e+01],
        [ 1.0692e+00,  2.1563e+01,  2.1966e+01, -1.1651e+01,  3.4254e+01,
          3.1262e+01, -2.2587e+02,  1.8064e+02, -4.5162e+02,  2.3986e+02],
        [ 2.8840e+01,  2.9650e+01, -8.4860e+00,  1.4642e+01,  5.5941e+01,
          4.4066e+02,  2.6993e+02,  4.3920e+02, -2.8878e+02, -5.9433e+02],
        [ 2.0953e+01, -7.2201e+00,  2.2937e+01,  4.8963e+02,  6.1567e+02,
          6.8817e+02,  9.3968e+02,  1.0760e+03, -1.3144e+02,  4.6049e+02],
        [ 2.8208e+01,  1.5926e+01,  5.0945e+01,  5.0298e+02,  1.0199e+03,
         -9.3694e+02,  7.6993e+02,  1.3464e+03, -2.3072e+02,  1.3439e+03],
        [ 2.2579e+01,  5.9373e+00,  4.3632e+02,  6.6700e+02,  4.3614e+02,
         -1.0820e+04, -1.0333e+03,  1.0880e+03,  3.7350e+02, -1.3531e+03],
        [-1.1296e+01, -1.8609e+01,  3.2862e+01,  8.9211e+02,  6.3306e+02,
          2.2874e+02, -6.7397e+03,  7.1581e+02, -9.7132e+02, -9.5144e+03]]) 

MatU.grad[0:10,35:45]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[-6.5143e+02,  1.6341e+02],
         [ 8.6126e+01, -1.5127e+02],
         [-4.7586e+02,  4.4367e+02],
         [-1.6836e+01, -3.2974e+02],
         [-1.9508e+02, -9.4231e+01],
         [-6.2406e+01, -3.8351e+02],
         [ 1.1157e+02,  7.0895e+02],
         [ 4.5053e+02, -9.8989e+01],
         [-8.8968e+00,  8.4756e+02],
         [-7.9123e+01, -3.1812e+02]],

        [[-2.0621e+01, -1.7745e+03],
         [-1.5194e+03, -9.7696e+02],
         [ 1.0227e+03,  1.1817e+03],
         [-1.8269e+03,  1.6468e+02],
         [ 1.6610e+03, -6.6332e+02],
         [ 1.0457e+03,  2.0110e+02],
         [-2.2298e+03, -9.1713e+02],
         [ 2.1974e+03, -3.7989e+01],
         [-1.8245e+03, -1.0800e+03],
         [-8.0943e+01,  1.7868e+03]],

        [[-2.1617e+03, -5.0638e+03],
         [-3.5784e+03, -1.1596e+03],
         [ 5.0335e+02,  3.9740e+03],
         [ 4.8689e+03,  1.4304e+03],
         [ 1.3254e+03, -5.8891e+03],
         [-2.6893e+03,  1.7112e+03],
         [-5.3466e+03,  7.7069e+02],
         [ 3.1624e+03,  3.6310e+02],
         [ 2.1011e+03, -2.1743e+03],
         [-5.6308e+03, -9.0569e+02]],

        [[-1.1845e+03, -1.9559e+03],
         [ 6.0146e+03,  1.5849e+03],
         [-6.0810e+03, -5.1764e+02],
         [-1.9658e+03,  3.1212e+02],
         [-6.6054e+02,  1.9894e+03],
         [-6.9747e+02,  7.1245e+03],
         [-4.0971e+03, -1.9420e+03],
         [ 5.4001e+03, -3.5007e+02],
         [ 1.5227e+03,  2.8346e+03],
         [-3.5334e+03, -6.2260e+03]],

        [[-5.1939e+03,  7.2704e+02],
         [ 2.2559e+03,  7.3040e+02],
         [ 3.0479e+03,  1.0959e+03],
         [-5.0117e+03,  4.5710e+03],
         [ 1.6959e+03,  2.4680e+02],
         [-5.0362e+01,  1.6406e+03],
         [ 1.0677e+00,  1.4690e+03],
         [ 7.0129e+03, -1.8788e+02],
         [-6.6763e+03, -1.4015e+03],
         [-1.1297e+02,  7.5306e+03]],

        [[-9.8023e+02, -4.0362e+03],
         [-5.0770e+03,  2.0863e+03],
         [ 7.3894e+03, -1.3785e+03],
         [-6.4391e+03, -3.7338e+03],
         [ 1.6591e+03, -4.6650e+01],
         [-5.4887e+02, -6.9309e+02],
         [-1.2230e+02,  1.1865e+03],
         [ 1.6731e+03,  5.4580e+01],
         [ 1.9385e+02,  2.2457e+01],
         [-2.7078e+02,  1.2377e+03]],

        [[-4.1896e+03, -5.1461e+03],
         [ 9.0140e+03, -1.8098e+03],
         [ 4.5649e+03,  2.6347e+03],
         [-4.1089e+03, -3.9121e+03],
         [-1.2057e+03, -7.3191e+02],
         [ 1.2155e+03, -1.0366e+02],
         [-6.5693e+02, -4.1655e+02],
         [ 1.2067e+03, -1.5943e+02],
         [ 1.1304e+03,  2.0332e+02],
         [-1.1675e+03, -1.3120e+03]]]) 

MatD.grad: 
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.8463,  ..., 0.0000, 0.0000, 0.0000],
        ...,
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-3.7743e+01,  1.7751e+02],
         [ 6.6814e+01, -4.5549e+01],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.8116e+02,  6.3438e+01],
         [-1.5244e+02, -2.6313e+02],
         [ 3.9031e+02,  3.9902e+01],
         [ 0.0000e+00,  0.0000e+00],
         [-1.3473e-01,  9.7941e+01],
         [ 9.1281e+01, -3.5519e+01],
         [-1.9025e+02,  1.2241e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-3.8355e+02, -1.2706e+02],
         [ 2.5362e+02,  5.5395e+02],
         [ 5.2301e+02, -4.5813e+02],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-4.0724e+02,  7.3146e+01]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 5.0671e+02, -3.5759e+02],
         [-1.0927e+03, -3.8830e+02],
         [-2.4405e+03, -1.6778e+03],
         [-7.3953e+02,  9.3028e+02],
         [-1.4357e+03,  1.1882e+03],
         [ 1.6823e+03, -3.7868e+02],
         [-2.3170e+03,  2.0584e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 6.0339e+02, -3.1313e+02],
         [-6.5361e+01, -1.4718e+03],
         [ 8.0303e+02,  2.9698e+03],
         [ 6.4372e+03,  2.8385e+03],
         [-5.3136e+03, -5.8569e+03],
         [-5.7227e+03,  2.0647e+03],
         [ 4.1580e+03,  6.5386e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-7.3086e+02,  2.5038e+02],
         [ 8.2016e+02,  1.5730e+03],
         [ 3.2934e+03, -2.6656e+03],
         [-7.1776e+02,  5.6052e+02],
         [ 1.8733e+03,  8.5566e+03],
         [ 5.4439e+01, -2.2679e+03],
         [-4.3996e+03,  4.1338e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 6.0533e+02, -6.0108e+02],
         [-1.9210e+03,  6.8448e+02],
         [-1.0651e+03, -2.9237e+03],
         [-4.0824e+03,  4.6364e+03],
         [-7.5320e+03, -2.4074e+03],
         [ 4.4677e+03, -2.9721e+03],
         [-5.4992e+03, -3.1375e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-4.8126e+02,  1.4098e+02],
         [ 1.6199e+03, -9.3485e+02],
         [ 3.3038e+03,  4.6687e+03],
         [ 8.2211e+03,  1.2230e+03],
         [-5.0932e+03, -8.6032e+03],
         [ 5.7877e+02,  6.3526e+03],
         [ 1.2059e+03,  3.6608e+03]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[ 5.3206e+03,  2.5391e+03],
         [ 5.5743e+03, -4.3170e+03],
         [-2.9570e+03, -6.4257e+03],
         [-1.7143e+03, -1.7331e+03],
         [ 6.7733e+03,  6.2606e+03],
         [-2.3456e+03, -2.8120e+03],
         [-5.5960e+03, -4.5421e+01],
         [ 8.1835e+03,  3.3025e+03],
         [ 6.5444e+03, -4.1890e+03],
         [-3.9778e+03, -5.3049e+03]],

        [[-4.2874e+03,  4.3622e+03],
         [-6.2851e+03, -9.9290e+02],
         [ 2.0522e+03, -3.2545e+03],
         [-1.3368e+02, -5.0490e+03],
         [ 4.9817e+03,  1.0010e+03],
         [-6.0281e+03, -2.4526e+03],
         [-1.4610e+03, -9.1299e+03],
         [-4.8875e+03,  1.0816e+03],
         [-3.8508e+03,  3.1372e+03],
         [ 7.1859e+03, -3.3084e+03]],

        [[-3.2181e+02, -7.3592e+03],
         [-1.9803e+01, -9.3337e+03],
         [ 2.1812e+03,  5.1328e+03],
         [ 5.7382e+03,  1.1783e+03],
         [-2.7699e+02, -3.2570e+00],
         [ 1.8864e+03,  2.4722e+03],
         [-2.1402e+03,  6.8816e+03],
         [-6.4919e+03, -3.9601e+03],
         [-8.3680e+02,  7.6244e+03],
         [ 3.9598e+03, -3.6884e+03]],

        [[ 2.6227e+03,  7.6790e+03],
         [ 9.0475e+03, -1.7175e+03],
         [ 4.7664e+03,  4.0198e+03],
         [-5.9637e+03,  1.9129e+03],
         [-2.3370e+03, -2.3672e+03],
         [ 3.5468e+03, -7.3071e+03],
         [ 3.4649e+03,  2.8677e+03],
         [ 2.1132e+03,  4.4085e+03],
         [ 4.8979e+03,  4.0431e+03],
         [-2.6348e+03, -5.5412e+03]],

        [[-9.1886e+03, -1.2212e+03],
         [ 6.7731e+03,  6.1740e+03],
         [ 1.3849e+02, -4.0607e+03],
         [-4.5571e+03,  4.3568e+03],
         [ 4.5329e+03, -4.9648e+03],
         [-7.2355e+03, -1.9827e+03],
         [ 6.9942e+03,  8.0848e+02],
         [-2.0932e+03, -8.4202e+03],
         [-2.8688e+03, -5.3128e+03],
         [ 5.1337e+03, -7.0718e+03]],

        [[ 1.8866e+03, -7.0398e+03],
         [-2.4677e+03, -2.9773e+03],
         [ 4.2285e+03, -2.8434e+03],
         [-1.7093e+03, -2.5500e+03],
         [-3.1352e+03,  4.4728e+03],
         [ 3.0394e+03, -4.1904e+03],
         [ 5.0356e+03,  3.7245e+03],
         [-1.0291e+03, -4.0328e+03],
         [-6.6949e+03, -1.7912e+03],
         [-6.6944e+02,  6.2150e+03]],

        [[ 6.9152e+03,  5.0131e+03],
         [ 2.0751e+03, -9.1124e+03],
         [ 4.0979e+03,  4.9366e+03],
         [-1.5753e+03, -6.4338e+03],
         [-2.4078e+03,  6.4140e+03],
         [ 4.2124e+03,  3.8701e+03],
         [-1.9340e+02,  4.4646e+03],
         [-1.5865e+03, -8.7357e+02],
         [-7.8200e+03,  1.9020e+03],
         [ 6.5991e+03,  6.5562e+03]],

        [[-9.2264e+03,  1.3487e+03],
         [-2.6977e+03,  7.8355e+03],
         [-6.3142e+03, -3.8843e+03],
         [ 1.4834e+03,  9.0982e+02],
         [ 8.4964e+03, -2.1877e+03],
         [-6.6108e+03, -6.9028e+03],
         [-5.3719e+03, -2.5981e+03],
         [ 2.6930e+03, -4.3575e+03],
         [ 7.3165e+03,  1.6816e+03],
         [ 5.8164e+03, -5.1435e+03]],

        [[ 3.6368e+03, -6.0683e+03],
         [-4.2567e+03, -1.8566e+02],
         [ 1.5691e+03, -3.2997e+03],
         [-1.3611e+03, -5.4149e+03],
         [ 2.1547e+03,  4.5935e+03],
         [ 3.8309e+03,  1.7589e+03],
         [-3.5675e+02,  4.4966e+03],
         [ 1.6642e+03,  1.8976e+03],
         [-4.5979e+03,  4.3825e+03],
         [ 8.0778e+02, -1.0642e+03]],

        [[ 7.8353e+03,  2.6377e+03],
         [ 6.2810e+03, -2.5137e+03],
         [ 2.4913e+03,  7.1136e+03],
         [-3.7223e+03, -5.0828e+03],
         [-1.7379e+03,  6.8976e+03],
         [ 3.5796e+03, -3.3244e+03],
         [-1.3213e+03, -7.0238e+02],
         [ 1.2302e+03,  6.8597e+03],
         [-2.4857e+03,  7.2331e+01],
         [ 5.8999e+03, -4.7223e+02]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[ 3.1558e+03, -6.8762e+01],
         [-1.6661e+03, -2.1194e+03],
         [-6.7717e+03, -3.0613e+03],
         [-1.4890e+03, -4.1185e+03],
         [ 6.8272e+03, -4.6844e+03],
         [-7.3746e+03,  2.9346e+03],
         [-3.2808e+02,  1.1506e+03],
         [ 8.0363e+03,  3.0001e+02],
         [-2.9253e+03, -1.8557e+03],
         [-2.1838e+03,  3.5611e+03]],

        [[ 6.7233e+02, -3.6699e+03],
         [-1.3872e+03,  6.2196e+03],
         [ 3.8570e+03,  4.1029e+03],
         [ 5.8557e+03,  2.0581e+03],
         [-2.4881e+03,  5.6155e+03],
         [ 1.3836e+03,  3.4126e+03],
         [-8.7455e+02, -1.3981e+03],
         [-9.6314e+02, -7.6069e+03],
         [-5.9619e+03,  3.3543e+03],
         [-2.3615e+03,  5.7441e+03]],

        [[-5.4225e+03,  2.3235e+03],
         [ 2.2835e+03, -5.1173e+03],
         [ 7.9096e+03,  1.6107e+03],
         [ 3.8919e+03,  6.3952e+01],
         [-2.9194e+03, -3.9544e+03],
         [ 4.7859e+03,  4.9697e+03],
         [-4.6339e+03, -3.0401e+03],
         [ 5.4294e+03,  5.2071e+03],
         [-1.6922e+03,  3.3257e+03],
         [ 2.1488e+03,  6.9002e+00]],

        [[ 3.8942e+03, -3.3487e+03],
         [-2.4083e+03,  1.6128e+03],
         [ 4.7066e+03,  5.6117e+03],
         [ 6.7472e+03, -4.9431e+03],
         [ 2.3353e+03, -3.3892e+03],
         [-3.2572e+03, -3.4777e+02],
         [-2.7656e+02, -8.7959e+03],
         [ 2.2323e+02, -6.5360e+03],
         [-1.7945e+02, -2.4245e+03],
         [ 9.5404e+00,  1.3917e+03]],

        [[ 1.9397e+03, -2.0544e+03],
         [-1.9884e+03,  3.5148e+03],
         [-1.4162e+02, -2.3268e+02],
         [-2.3081e+03,  4.4437e+03],
         [-4.0689e+03, -5.4602e+03],
         [-9.1566e+03, -5.8878e+02],
         [ 4.3611e+02,  7.7870e+03],
         [ 8.5497e+02, -2.9194e+02],
         [ 7.1213e+02,  7.5279e+02],
         [-7.4476e+02, -6.4640e+02]],

        [[-2.3938e+03,  2.8379e+03],
         [ 7.7012e+03, -2.7613e+03],
         [-3.6747e+02,  6.5281e+03],
         [ 1.7208e+03, -5.9311e+03],
         [ 5.5759e+03,  1.3558e+03],
         [ 1.8111e+03,  7.9707e+02],
         [-4.8978e+03,  4.9847e+02],
         [ 1.7570e+03, -9.8317e+00],
         [-6.4388e+02, -7.3727e+02],
         [-7.3712e+02, -4.7497e+01]],

        [[ 5.2349e+02, -3.4223e+03],
         [-2.1216e+02, -3.0534e+03],
         [ 1.2864e+03, -4.5001e+03],
         [ 4.3497e+03, -4.1448e+03],
         [-2.6865e+03,  1.8027e+03],
         [ 6.5733e+02,  1.4709e+03],
         [-6.0310e+02, -7.8810e+03],
         [-1.6725e+02, -9.1059e+02],
         [-2.6562e+02, -8.9882e+02],
         [-1.8807e+02,  3.9539e+02]],

        [[ 3.6626e+03,  4.2258e+02],
         [-1.4916e+03,  2.1699e+03],
         [-2.0799e+03,  1.2544e+02],
         [-1.3347e+03, -5.7869e+03],
         [-1.0871e+03, -3.2491e+03],
         [-8.8297e+03, -5.3511e+02],
         [ 1.2125e+02,  7.8822e+03],
         [ 5.0280e+02, -5.4134e+01],
         [ 6.1214e+03,  4.2587e+03],
         [-5.1434e+03,  4.3649e+00]],

        [[-2.8234e+03, -9.8884e+02],
         [ 7.5134e+03,  1.1071e+03],
         [-2.1175e+03,  1.5081e+03],
         [ 4.8223e+03, -2.1782e+02],
         [-1.9285e+03,  1.4340e+03],
         [-2.6981e+03, -2.6597e+03],
         [-6.3481e+03, -1.8509e+01],
         [ 3.3169e+03,  7.9863e+03],
         [ 9.6070e+02,  5.5324e+03],
         [-7.9190e+01, -3.3570e+02]],

        [[-1.5676e+03,  7.7959e+03],
         [-1.0265e+03,  4.6857e+03],
         [ 5.7155e+02,  7.2939e+03],
         [ 2.9623e+03,  1.5065e+03],
         [ 1.5229e+03, -2.5146e+03],
         [ 1.3648e+03, -7.3506e+03],
         [ 3.3620e+02, -8.5905e+03],
         [ 9.0250e+02, -5.8538e+03],
         [ 3.2761e+02, -9.1927e+03],
         [-1.4742e+03, -7.7772e+03]]]) 

Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0151,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]],
       grad_fn=<SelectBackward>)

Epoch 5 finished. Total time: 4457.693742275238;  Epoch time: 1097.1509747505188 












test_counter in loss_omega_mat(): 578
test_counter in loss_omega_mat(): 1156
test_counter in loss_omega_mat(): 1734
test_counter in loss_omega_mat(): 2312
test_counter in loss_omega_mat(): 2890
test_counter in loss_omega_mat(): 3468
test_counter in loss_omega_mat(): 4046
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9437, 0.9434, 0.9398,  ..., 0.6394, 0.6052, 0.6045],
         [0.4506, 0.4149, 0.3997,  ..., 0.2739, 0.2731, 0.2650],
         [0.4145, 0.3995, 0.3988,  ..., 0.2729, 0.2638, 0.2593],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7571, 0.7571],
         [0.9459, 0.9459, 0.9459,  ..., 0.7572, 0.7571, 0.7571]],

        [[0.9456, 0.9448, 0.9447,  ..., 0.6407, 0.6404, 0.6400],
         [0.9447, 0.9446, 0.9445,  ..., 0.6400, 0.6057, 0.6057],
         [0.9449, 0.9446, 0.9445,  ..., 0.6388, 0.6058, 0.6058],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7572]],

        [[0.9456, 0.9452, 0.9448,  ..., 0.7563, 0.7561, 0.6407],
         [0.9451, 0.9448, 0.9448,  ..., 0.7559, 0.6408, 0.6407],
         [0.9452, 0.9450, 0.9448,  ..., 0.6409, 0.6405, 0.6394],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7571]],

        ...,

        [[0.9459, 0.9459, 0.9458,  ..., 0.7568, 0.7566, 0.7560],
         [0.9458, 0.9458, 0.9456,  ..., 0.7564, 0.7561, 0.7337],
         [0.9455, 0.9452, 0.9451,  ..., 0.7558, 0.7213, 0.7201],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7571],
         [0.9459, 0.9459, 0.9459,  ..., 0.7572, 0.7570, 0.7568],
         [0.9459, 0.9459, 0.9458,  ..., 0.7569, 0.7559, 0.7555]],

        [[0.9458, 0.9458, 0.9456,  ..., 0.7564, 0.7563, 0.7558],
         [0.9458, 0.9457, 0.9453,  ..., 0.7478, 0.7402, 0.7240],
         [0.9451, 0.9451, 0.9449,  ..., 0.7397, 0.7152, 0.7051],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7571],
         [0.9459, 0.9459, 0.9459,  ..., 0.7570, 0.7570, 0.7568],
         [0.9459, 0.9458, 0.9458,  ..., 0.7569, 0.7567, 0.7557]],

        [[0.9458, 0.9456, 0.9456,  ..., 0.7555, 0.7552, 0.7521],
         [0.9457, 0.9447, 0.9443,  ..., 0.7367, 0.7333, 0.7184],
         [0.9451, 0.9441, 0.9364,  ..., 0.7250, 0.7118, 0.6928],
         ...,
         [0.9459, 0.9458, 0.9458,  ..., 0.7569, 0.7556, 0.7525],
         [0.9459, 0.9459, 0.9458,  ..., 0.7566, 0.7564, 0.7538],
         [0.9458, 0.9458, 0.9457,  ..., 0.7562, 0.7560, 0.7558]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[4.8776e-10, 5.7129e-08, 2.4481e-07,  ..., 5.9994e-09,
          3.8550e-07, 2.0021e-06],
         [9.9657e-08, 4.4061e-06, 4.8728e-07,  ..., 3.3413e-08,
          7.4824e-07, 1.1286e-05],
         [4.2297e-06, 2.0046e-06, 2.9245e-07,  ..., 6.5051e-06,
          2.3138e-06, 6.0726e-06],
         ...,
         [1.2920e-08, 7.2771e-08, 6.5019e-08,  ..., 3.2907e-07,
          1.5339e-07, 1.3513e-06],
         [6.0891e-08, 3.7839e-09, 2.0828e-08,  ..., 2.7649e-08,
          2.5380e-07, 1.2044e-07],
         [1.7269e-08, 3.4664e-07, 1.1309e-07,  ..., 9.0172e-08,
          4.0702e-07, 9.1679e-10]],

        [[5.1982e-07, 2.4594e-07, 3.5068e-06,  ..., 5.8112e-07,
          2.6108e-06, 2.0585e-07],
         [3.5875e-06, 6.4148e-06, 3.7575e-06,  ..., 4.8938e-07,
          1.1548e-05, 8.8704e-07],
         [8.5195e-08, 1.2462e-05, 4.9846e-08,  ..., 7.0801e-08,
          8.3424e-06, 3.9466e-06],
         ...,
         [6.2302e-08, 3.6835e-08, 5.8116e-08,  ..., 3.4077e-07,
          2.0851e-07, 1.5815e-06],
         [2.5305e-07, 5.9384e-08, 3.6803e-08,  ..., 2.5785e-09,
          5.5517e-07, 3.6154e-07],
         [8.9568e-08, 8.3466e-08, 5.7682e-08,  ..., 7.6802e-08,
          9.0865e-07, 2.1060e-08]],

        [[1.6957e-08, 3.5429e-10, 3.2730e-07,  ..., 2.5547e-07,
          6.0319e-08, 7.4665e-07],
         [1.4734e-08, 4.7469e-08, 6.3709e-07,  ..., 5.4392e-07,
          5.9663e-07, 8.1230e-07],
         [2.9548e-10, 4.9248e-08, 1.1778e-07,  ..., 1.0440e-06,
          1.4574e-07, 5.6194e-08],
         ...,
         [9.6974e-09, 1.1882e-09, 6.4246e-09,  ..., 5.3818e-07,
          4.3518e-08, 1.8391e-07],
         [2.5026e-07, 3.4571e-08, 5.8493e-09,  ..., 8.4928e-07,
          5.4095e-07, 1.9979e-08],
         [8.7414e-10, 1.4769e-08, 2.6797e-07,  ..., 2.0535e-08,
          1.2300e-07, 1.2422e-07]],

        ...,

        [[4.2519e-08, 7.6249e-08, 3.4247e-08,  ..., 6.0263e-07,
          2.8483e-08, 4.3493e-06],
         [1.5949e-07, 6.6479e-08, 1.6627e-07,  ..., 6.4207e-08,
          4.4783e-06, 7.4406e-06],
         [1.7061e-06, 2.0155e-06, 3.7444e-07,  ..., 4.0719e-06,
          1.7597e-04, 7.0855e-07],
         ...,
         [1.1040e-07, 1.6817e-07, 3.5897e-08,  ..., 1.0875e-07,
          8.5279e-08, 7.7323e-07],
         [8.8164e-08, 4.8080e-08, 2.4183e-07,  ..., 2.3868e-07,
          2.6977e-08, 2.9338e-07],
         [4.1776e-08, 9.4383e-08, 6.6703e-08,  ..., 7.9180e-07,
          1.0320e-06, 2.4755e-07]],

        [[1.5664e-11, 9.6250e-10, 9.2694e-08,  ..., 8.9367e-07,
          4.9098e-06, 2.7708e-06],
         [3.6543e-07, 1.0374e-07, 9.5710e-07,  ..., 8.6733e-06,
          7.9657e-06, 9.9712e-07],
         [2.8582e-09, 3.5180e-07, 3.1282e-06,  ..., 2.1280e-06,
          1.6480e-06, 7.4546e-05],
         ...,
         [5.1870e-08, 9.5249e-08, 6.0904e-09,  ..., 3.5609e-07,
          3.7288e-07, 4.9460e-08],
         [2.9214e-08, 8.4706e-09, 3.7191e-08,  ..., 9.4821e-09,
          2.2209e-09, 4.5938e-08],
         [3.9586e-08, 7.0609e-09, 3.9737e-07,  ..., 9.3918e-07,
          3.0858e-07, 5.7786e-07]],

        [[1.7618e-06, 7.5408e-07, 2.1261e-07,  ..., 2.1076e-09,
          5.6250e-06, 8.5694e-06],
         [5.6091e-08, 1.1953e-07, 4.4576e-07,  ..., 9.7127e-07,
          5.0947e-06, 4.3123e-07],
         [1.0561e-07, 3.6389e-06, 1.6318e-10,  ..., 1.7827e-04,
          1.0581e-04, 1.2365e-04],
         ...,
         [2.3205e-09, 3.0260e-08, 1.8631e-07,  ..., 1.6501e-07,
          5.9443e-09, 6.6628e-07],
         [1.2435e-06, 2.1075e-07, 2.1035e-09,  ..., 5.0476e-07,
          8.5023e-11, 5.8235e-07],
         [1.7815e-07, 3.4191e-10, 5.2417e-09,  ..., 2.0419e-07,
          3.4917e-07, 8.8908e-07]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[9.9892e-05, 3.6443e-04, 4.4039e-04,  ..., 9.1534e-05,
          1.5784e-04, 4.1934e-04],
         [1.4437e-04, 9.1197e-04, 7.7426e-04,  ..., 3.3928e-04,
          4.8702e-05, 1.2323e-03],
         [9.3331e-04, 2.6186e-04, 1.0900e-03,  ..., 5.4391e-04,
          4.2703e-04, 4.4962e-04],
         ...,
         [2.0609e-04, 3.6662e-04, 4.9130e-04,  ..., 3.0904e-04,
          5.8173e-05, 2.4636e-04],
         [5.0617e-04, 1.1987e-04, 4.7498e-04,  ..., 6.3091e-04,
          5.5632e-04, 3.8652e-04],
         [1.1987e-04, 3.4870e-04, 3.8826e-04,  ..., 3.0643e-04,
          1.4810e-04, 3.5538e-04]],

        [[8.7085e-04, 3.8001e-04, 7.2752e-04,  ..., 4.7055e-04,
          7.4716e-04, 5.8458e-04],
         [7.2752e-04, 1.5014e-03, 7.9456e-04,  ..., 7.8505e-04,
          2.9944e-04, 5.3026e-04],
         [9.5336e-04, 1.5014e-03, 1.0847e-03,  ..., 6.0589e-04,
          6.2677e-04, 1.8471e-04],
         ...,
         [2.0609e-04, 2.6604e-04, 2.0347e-04,  ..., 1.7313e-04,
          4.8312e-04, 4.7101e-04],
         [2.0856e-04, 5.0617e-04, 2.2903e-04,  ..., 6.8458e-04,
          3.3022e-05, 4.3057e-05],
         [2.0856e-04, 2.2220e-04, 3.4870e-04,  ..., 1.5109e-04,
          4.5947e-04, 4.1672e-04]],

        [[4.5451e-04, 2.8004e-04, 2.6259e-04,  ..., 1.8143e-04,
          5.2401e-04, 3.4451e-05],
         [3.8095e-04, 5.9629e-04, 2.6259e-04,  ..., 2.3615e-04,
          3.7661e-04, 2.6008e-04],
         [6.2533e-04, 2.8176e-04, 5.9629e-04,  ..., 2.2599e-04,
          3.1478e-04, 4.1958e-04],
         ...,
         [4.2303e-04, 4.3144e-04, 2.0347e-04,  ..., 4.0009e-04,
          9.5157e-05, 3.9225e-04],
         [5.9633e-05, 8.1503e-05, 2.2903e-04,  ..., 2.6858e-04,
          5.1433e-04, 3.9976e-04],
         [2.3804e-04, 8.1503e-05, 1.3979e-04,  ..., 2.1001e-04,
          3.1684e-04, 3.6533e-04]],

        ...,

        [[3.3087e-04, 2.4002e-04, 2.5641e-04,  ..., 2.6624e-04,
          2.1093e-04, 3.8602e-04],
         [4.0699e-04, 1.1516e-04, 1.5732e-04,  ..., 3.0955e-04,
          5.4817e-04, 5.8212e-03],
         [2.1204e-04, 2.6404e-04, 3.2815e-05,  ..., 1.8363e-04,
          7.3391e-03, 2.5442e-04],
         ...,
         [4.2013e-04, 6.8873e-04, 3.8045e-04,  ..., 4.1163e-04,
          1.1183e-04, 1.1416e-03],
         [2.7093e-04, 6.8873e-04, 5.1327e-04,  ..., 3.3367e-04,
          2.5920e-04, 5.0356e-04],
         [9.4370e-04, 1.8893e-04, 4.5777e-04,  ..., 2.0138e-04,
          8.1931e-04, 6.7190e-04]],

        [[2.5641e-04, 3.5654e-04, 3.2490e-04,  ..., 4.9773e-04,
          3.9652e-04, 1.8363e-04],
         [4.0699e-04, 2.8191e-04, 5.0263e-04,  ..., 4.4106e-04,
          3.1521e-04, 1.7490e-04],
         [2.9982e-04, 3.2815e-05, 4.2335e-04,  ..., 6.2678e-03,
          1.0052e-03, 4.6192e-05],
         ...,
         [4.9783e-04, 3.6675e-04, 3.8045e-04,  ..., 1.6896e-04,
          3.5239e-04, 5.1897e-04],
         [2.7093e-04, 6.5374e-04, 4.3772e-04,  ..., 1.7334e-04,
          5.3734e-04, 2.8409e-04],
         [9.4370e-04, 7.9845e-04, 7.3202e-04,  ..., 7.7558e-04,
          6.8113e-04, 1.2287e-03]],

        [[5.7874e-04, 5.6476e-04, 3.2490e-04,  ..., 6.1830e-04,
          2.0703e-04, 2.3220e-04],
         [2.8191e-04, 2.6575e-04, 2.7385e-04,  ..., 2.0775e-03,
          5.7013e-03, 6.9049e-04],
         [2.9982e-04, 6.1606e-04, 3.1359e-04,  ..., 7.1007e-03,
          1.3308e-03, 1.4966e-03],
         ...,
         [3.6675e-04, 1.2117e-04, 7.2645e-04,  ..., 7.7558e-04,
          5.4080e-04, 4.1636e-04],
         [7.5283e-04, 6.5374e-04, 7.2645e-04,  ..., 1.2729e-04,
          6.9496e-04, 3.4765e-04],
         [4.2848e-04, 7.9845e-04, 6.7910e-04,  ..., 5.8135e-04,
          6.2297e-04, 7.2892e-04]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:4.2612996101379395 loss2:1091.4315185546875


loss.item(): 21832.892578125


Finish constructing loss, calculating backward() ... 
require grad ? True True False
MatD grad and MatUx grad: torch.Size([59, 98]) torch.Size([59, 98, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 6.8125e-02,  1.4263e+00,  8.0353e-01,  5.9728e-01,  2.1443e+00,
          4.5244e-01,  4.4123e+00,  9.6238e+00,  6.3431e+00, -1.2882e+01],
        [ 1.0375e+01,  2.4998e+00,  3.8653e+00,  4.7129e+00,  3.7272e+00,
          8.3928e+00,  1.4066e+01,  8.2264e+01,  3.8804e+01,  5.5228e+01],
        [ 1.1277e+01,  1.8442e+01,  2.0152e+01, -1.1139e+01,  3.3275e+01,
          3.4988e+01, -2.1271e+02,  1.6903e+02, -4.3259e+02,  2.2608e+02],
        [ 2.5204e+01,  2.3119e+01, -1.8263e+00,  1.4639e+01,  6.1488e+01,
          4.3333e+02,  2.8947e+02,  4.1013e+02, -3.0248e+02, -5.7467e+02],
        [ 1.8000e+01, -7.0147e+00,  1.2784e+01,  4.7448e+02,  6.1590e+02,
          6.7322e+02,  9.2501e+02,  1.0414e+03, -1.4296e+02,  4.9320e+02],
        [ 1.8367e+01,  1.4001e+01,  4.8751e+01,  4.9401e+02,  1.0110e+03,
         -9.8138e+02,  7.4750e+02,  1.3033e+03, -2.1574e+02,  1.3137e+03],
        [ 2.4251e+01,  2.0646e+00,  4.1719e+02,  6.5918e+02,  4.3786e+02,
         -1.0532e+04, -1.0879e+03,  1.0632e+03,  3.8384e+02, -1.3775e+03],
        [-9.2992e+00, -1.0585e+01,  2.3191e+01,  8.7383e+02,  6.3099e+02,
          2.3988e+02, -6.4846e+03,  7.0327e+02, -1.0371e+03, -9.2130e+03]]) 

MatU.grad[0:10,35:45]: 
tensor([[[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[ -657.5601,  -151.6347],
         [  376.3217,  -282.7730],
         [ -639.5949,   185.1310],
         [ -277.8459,  -128.0664],
         [  160.2350,   342.8643],
         [ -343.0042,  -426.7440],
         [  248.6715,   569.1284],
         [  472.1355,   -60.5751],
         [   55.9465,   848.8698],
         [  108.8941,  -235.2396]],

        [[-1212.6410, -1475.3718],
         [-1351.2902,  -659.0939],
         [ 1439.7085,  1443.7708],
         [-1398.7030,   554.9144],
         [  225.4007, -1127.2377],
         [  956.8212,   204.1978],
         [-2272.7480,  -742.5870],
         [ 2183.6394,    61.7609],
         [-1815.6417, -1054.2850],
         [ -140.6351,  1753.3374]],

        [[ -766.4575, -3406.0005],
         [-2466.0149,   733.8956],
         [ 1930.5835,  2641.5300],
         [ 4894.8677,   766.8203],
         [ 1217.5773, -6216.8735],
         [-3049.5806,   885.3311],
         [-5265.0918,   848.7262],
         [ 2945.1797,   129.0741],
         [ 1828.4396, -1991.5681],
         [-5686.2778,  -699.3453]],

        [[ 2102.8362, -5105.9492],
         [ 4095.7124,  2988.6238],
         [-7923.3965,  1418.8411],
         [-3359.7319, -1118.4974],
         [ 1806.4526,  1502.3855],
         [ -766.0291,  7044.8979],
         [-3907.9792,  -970.4051],
         [ 5337.0884,   136.6081],
         [ 2347.4287,  2224.0073],
         [-3302.4346, -6311.5366]],

        [[ -867.8004, -3352.4736],
         [-1995.0220,  3823.9102],
         [ 4576.8711, -2265.8962],
         [-2973.0247,  6195.6709],
         [ 1637.6514,   340.7120],
         [ -161.3654,  1630.2405],
         [  113.0114,  1369.1362],
         [ 6953.4521,   113.3121],
         [-6640.4165, -1232.7593],
         [   45.6127,  7437.3784]],

        [[-6979.2573,   461.0109],
         [-5505.1426, -3164.6389],
         [ 6531.7554, -4137.9473],
         [-6753.1738, -1939.8448],
         [ 1643.6976,   -23.1505],
         [ -532.1004,  -673.8397],
         [ -110.1739,  1154.1229],
         [ 1648.1989,   194.6321],
         [  116.7495,    83.1607],
         [ -150.7205,  1182.6355]],

        [[  425.1328, -2057.0364],
         [ 8641.0732, -3465.2678],
         [ 5604.5586,  3442.0881],
         [-4803.7612, -1750.5902],
         [ -908.3888, -1029.6843],
         [ 1193.5245,   -33.0300],
         [ -634.0347,  -402.3741],
         [ 1197.9041,   -83.4667],
         [ 1075.2913,   114.5482],
         [-1140.7316, -1278.7698]]]) 

MatD.grad: 
tensor([[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.8413,  ..., 0.0000, 0.0000, 0.0000],
        ...,
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.1723e+02,  1.3837e+02],
         [ 7.1431e+01, -3.4878e+01],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.7258e+02,  8.3728e+01],
         [ 2.5999e+01, -3.0825e+02],
         [ 3.1903e+02,  2.4209e+02],
         [ 0.0000e+00,  0.0000e+00],
         [-3.8065e-01,  9.6315e+01],
         [ 9.6188e+01,  4.7842e+00],
         [-7.2110e+01,  2.1392e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-2.5763e+02, -3.0704e+02],
         [ 3.9334e+02,  5.1989e+02],
         [ 6.3377e+02, -8.0428e+01],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-9.3898e+02, -6.3579e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 5.7421e+02, -4.4813e+00],
         [-2.0912e+02, -2.5389e+01],
         [-2.8447e+03, -1.1850e+03],
         [-9.8823e+02, -1.0745e+01],
         [-1.5386e+03,  8.1808e+02],
         [ 8.8147e+02, -8.0377e+02],
         [ 3.5533e+02, -1.2378e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 6.0399e+02, -2.1429e+02],
         [ 4.3695e+02, -1.4575e+03],
         [-1.0854e+03,  4.1677e+03],
         [ 6.6731e+03,  2.8076e+03],
         [-4.2967e+03, -7.0192e+03],
         [-1.6400e+03,  5.8178e+03],
         [ 4.5549e+03,  4.3620e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-8.6795e+01, -1.5512e+02],
         [ 9.0806e+02,  1.4223e+03],
         [ 2.5896e+03,  4.7603e+02],
         [ 2.4994e+03, -4.3105e+03],
         [-1.4489e+03,  8.2786e+03],
         [-4.4896e+03,  4.7282e+03],
         [-7.0458e+03,  2.1092e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 7.4048e+02, -4.1329e+02],
         [-1.5244e+03,  9.2181e+02],
         [-5.3078e+02, -2.3940e+03],
         [-5.4316e+03,  1.0352e+03],
         [-4.0721e+03, -4.7488e+03],
         [ 2.3221e+03,  2.1330e+03],
         [-4.3329e+03, -6.3775e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-5.1777e+02, -3.2862e+02],
         [ 1.9438e+03,  1.8984e+02],
         [ 8.6185e+02,  6.2625e+03],
         [ 8.0374e+03, -1.3455e+03],
         [-3.6135e+03, -9.0610e+03],
         [ 6.0655e+03,  7.0434e+02],
         [-4.7202e+03,  4.3938e+03]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[ 5312.9883,  5145.8057],
         [  746.0778, -6346.6138],
         [ 1153.2371, -7723.8218],
         [-6810.0249,  4279.3164],
         [ 4580.1709,  3648.3486],
         [ 4146.2368,  6504.2920],
         [-3643.6338,   377.6554],
         [ 4403.6509,   973.1766],
         [ 7032.4878,  3774.7654],
         [-7093.1909, -1449.9854]],

        [[-1144.0631,  4837.9233],
         [-1493.6725, -4202.0986],
         [ 2552.7747,  4574.7148],
         [ 4536.5459,  3676.7104],
         [-2255.4612, -4952.2744],
         [-8641.6855, -3538.8433],
         [ 3167.0923, -8245.9990],
         [-1590.0378, -4006.4731],
         [  973.7306, -2874.0007],
         [ 4090.5776, -6897.0552]],

        [[-2638.6838, -5807.0049],
         [ 1100.9452, -9212.7549],
         [ 4907.3281,  -237.2869],
         [-1897.1741,  4481.0552],
         [ 3602.5732, -4752.8652],
         [-5563.6904, -4352.3027],
         [ 3306.8748,  8705.6904],
         [  585.7972,  2180.2422],
         [-6260.5181,  1989.1963],
         [-1264.8177,  4610.5195]],

        [[ 4959.0420,  5659.7529],
         [ 9161.5889, -1516.3125],
         [ 2892.8523,  3640.6040],
         [-6368.7964, -4441.8799],
         [ 4276.6133, -3792.4653],
         [ -534.5851,   987.9175],
         [-3931.0544, -3732.8779],
         [-2467.0339,  7798.0396],
         [-3033.3086, -1672.0812],
         [ 4299.6494, -6218.3765]],

        [[-9344.3184,  -517.4849],
         [ 6872.5586,  5894.7646],
         [ 2476.3584, -4777.3750],
         [-6612.0967,  -946.9625],
         [ 8300.3418,  -271.1081],
         [  241.5091, -1363.0006],
         [ 5758.5884, -2967.7566],
         [ 2293.8086, -8609.5938],
         [-8319.3486,   254.1840],
         [ 4016.2893, -3593.7480]],

        [[  736.2808, -6416.2500],
         [-2454.5720, -2899.0322],
         [ 2604.1072, -1735.9889],
         [-5551.3462,  1617.6615],
         [ 2396.0913,  7446.6226],
         [  415.0779,   350.2724],
         [-3594.2275, -1887.0566],
         [ 3410.1345,  2678.3943],
         [-8040.0942,  3179.0325],
         [ 4783.8633,  -428.1345]],

        [[ 7640.8120,  3686.2117],
         [ 1660.5891, -9112.3584],
         [ 4257.0859,  3003.9978],
         [  856.9629, -6492.8696],
         [-2903.9856,  2444.2534],
         [ 5954.1440, -1387.7268],
         [ 4455.7041,  1357.7448],
         [ 3562.8428,  3760.7874],
         [-4044.0403,  3484.0085],
         [ 5070.7295,  6818.2246]],

        [[-8902.7939,  2075.7542],
         [-5783.3452,  4908.4795],
         [-4343.7915, -3558.8076],
         [-1853.5696,  3928.2227],
         [ 9071.6094,   385.8223],
         [-6901.6860, -6624.0005],
         [-6523.7246,  2180.2493],
         [ 3846.6604, -6986.4307],
         [-1189.7845, -5763.5171],
         [ 5338.4531,  1842.9915]],

        [[ 3428.9741,  1691.8184],
         [-4008.3066,  -523.9426],
         [ 2726.7415,  -928.1103],
         [-1857.7493,   494.5539],
         [ -281.0577,  3397.1941],
         [  939.5796,  -592.4513],
         [-3677.4524,  3592.5725],
         [ 1467.9331,  3046.1460],
         [-3614.9829,  2234.3369],
         [-2217.2634,  1774.0811]],

        [[  476.2281, -4891.3037],
         [ 3369.4153, -5617.1592],
         [ 7113.8818,  5739.2490],
         [ -655.8811, -8636.8945],
         [  495.1685,  5983.4390],
         [ 1872.1888,  2558.3525],
         [ 3661.5156,  -435.4721],
         [  831.5638,  6844.1450],
         [ 1032.4752,   704.1123],
         [ 4857.9580,  -937.2373]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[ 7.0593e+03,  2.0428e+03],
         [-7.3076e+03,  2.4507e+03],
         [ 1.4276e+03,  2.6931e+03],
         [ 5.1983e+03,  3.7762e+03],
         [ 2.5092e+03, -5.9890e+03],
         [-7.7024e+03, -3.1805e+02],
         [-4.1788e+03, -8.5909e+02],
         [ 4.3421e+03, -2.1142e+03],
         [ 3.8077e+03,  4.6118e+03],
         [ 2.0192e+03,  2.3168e+03]],

        [[ 4.8907e+03, -5.0564e+03],
         [-5.0755e+03,  4.1820e+03],
         [-8.2204e+01, -4.4502e+03],
         [ 8.5270e+03, -2.1513e+03],
         [-2.5913e+03,  2.5331e+03],
         [ 5.6999e+03,  2.7361e+02],
         [-2.9272e+03, -1.4365e+03],
         [-9.2401e+02, -7.4794e+03],
         [-5.3997e+03,  5.3156e+03],
         [-3.5767e+03,  3.8241e+03]],

        [[-2.9971e+03,  3.0830e+03],
         [-9.1904e+02,  3.0065e+02],
         [ 3.8548e+03, -2.8436e+03],
         [ 9.2252e+03, -9.9658e+01],
         [-3.5243e+03, -1.1884e+03],
         [ 3.4503e+03,  5.9435e+03],
         [-5.8007e+03, -1.6374e+03],
         [ 4.4186e+03,  3.5583e+03],
         [ 4.9141e+02,  1.6909e+03],
         [-1.3806e+03,  1.4152e+03]],

        [[ 4.5607e+03, -9.1758e+02],
         [-3.4644e+03, -2.8806e+03],
         [ 2.9017e+03,  6.6447e+03],
         [ 5.6475e+03, -4.3957e+03],
         [ 2.5323e+02, -4.4496e+03],
         [-2.0346e+03,  3.0086e+03],
         [-2.1506e+02, -8.7851e+03],
         [ 7.0854e+01, -6.4697e+03],
         [-6.1984e+01, -2.3794e+03],
         [ 7.2631e+01,  1.3819e+03]],

        [[ 4.2373e+03,  8.3539e+02],
         [-2.0415e+03,  5.7462e+03],
         [-2.2217e+03,  2.5358e+03],
         [ 3.0552e+03,  3.6129e+03],
         [-3.2063e+03, -4.9426e+03],
         [-9.1060e+03, -4.9863e+02],
         [-1.7159e+02,  7.7806e+03],
         [ 9.4369e+02, -1.9077e+02],
         [ 6.9063e+02,  7.3147e+02],
         [-7.1967e+02, -6.2781e+02]],

        [[-6.0259e+02,  2.5065e+03],
         [ 6.1647e+03, -5.2296e+03],
         [ 6.7420e+02,  3.3113e+03],
         [ 4.5331e+03, -2.7233e+03],
         [ 2.1048e+03,  1.1270e+03],
         [ 1.9814e+03, -1.8661e+03],
         [-4.7114e+03,  3.6709e+02],
         [ 1.7162e+03,  6.9704e-02],
         [-6.2465e+02, -7.1475e+02],
         [-6.8475e+02, -9.6779e+01]],

        [[-1.2438e+03, -3.7983e+03],
         [-2.7087e+03, -5.7634e+03],
         [ 2.9809e+03, -3.4983e+03],
         [ 2.0244e+03, -3.4318e+03],
         [-2.4680e+03, -2.2886e+03],
         [-1.4278e+03, -3.1957e+03],
         [-3.8039e+02, -7.8381e+03],
         [-2.0057e+02, -8.7865e+02],
         [-2.9044e+02, -8.6881e+02],
         [ 8.2708e+01,  2.9138e+02]],

        [[ 2.6710e+03,  6.9147e+02],
         [-1.2817e+03,  3.4093e+03],
         [ 5.4037e+02,  2.1999e+03],
         [-6.2628e+02, -2.8240e+03],
         [ 8.7168e+02,  9.5268e+02],
         [-8.6827e+03, -2.7186e+02],
         [-2.6662e+02,  7.8611e+03],
         [-7.4685e+01,  4.2685e+02],
         [ 6.0172e+03,  4.3270e+03],
         [-4.9646e+03, -2.2278e+02]],

        [[-3.0754e+03,  4.4340e+02],
         [ 7.7055e+03,  5.6716e+01],
         [-8.0953e+02, -3.5138e+02],
         [ 2.7223e+03, -1.4605e+03],
         [-2.2661e+03, -5.0518e+02],
         [-1.7584e+03, -5.1873e+02],
         [-5.8890e+03, -1.2367e+03],
         [ 3.0166e+03,  8.0532e+03],
         [ 8.3666e+02,  5.5865e+03],
         [ 1.2434e+02, -6.2041e+02]],

        [[-2.0344e+03,  7.7134e+03],
         [-1.4542e+03,  4.3046e+03],
         [-5.8604e+02,  6.9314e+03],
         [ 2.3683e+03,  2.7944e+03],
         [ 9.1684e+02,  3.0259e+02],
         [ 8.3146e+02, -7.4621e+03],
         [-1.4573e+02, -8.5723e+03],
         [ 5.3795e+02, -5.6712e+03],
         [ 8.6001e+02, -8.9925e+03],
         [-1.8497e+03, -7.7732e+03]]]) 

Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0161, 0.0156,  ..., 0.0088, 0.0082, 0.0087],
        [0.0154, 0.0159, 0.0149,  ..., 0.0087, 0.0080, 0.0084],
        [0.0161, 0.0137, 0.0149,  ..., 0.0086, 0.0084, 0.0086],
        ...,
        [0.0120, 0.0152, 0.0130,  ..., 0.0118, 0.0125, 0.0123],
        [0.0115, 0.0182, 0.0122,  ..., 0.0137, 0.0128, 0.0135],
        [0.0141, 0.0145, 0.0137,  ..., 0.0139, 0.0118, 0.0114]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[ 0.0003, -0.0005,  0.0002,  ..., -0.0006,  0.0005,  0.0005],
        [ 0.0005, -0.0009,  0.0005,  ..., -0.0007,  0.0004,  0.0004],
        [-0.0024,  0.0012, -0.0004,  ..., -0.0002,  0.0002,  0.0002],
        ...,
        [ 0.0031, -0.0022,  0.0009,  ...,  0.0007, -0.0002, -0.0002],
        [ 0.0067, -0.0060,  0.0017,  ..., -0.0009,  0.0007,  0.0007],
        [ 0.0004, -0.0008,  0.0004,  ..., -0.0021, -0.0004, -0.0004]],
       grad_fn=<SelectBackward>)

Epoch 6 finished. Total time: 5584.631971359253;  Epoch time: 1126.9282553195953 












