DIR_NAME: g:\Workspaces\Anaconda_ws\Semantic_Denoising_MVS\scripts 

Graph params:
(pLambda,pAlpha,pCigma_int,pCigma_spa,pB,pK,pQ): 
(20,3.5,0.07,3,9,20,3)

cv_MatI numpy float32: 
[[ 63  64  65 ...  81 106 108]
 [ 63  62  65 ...  81 100 110]
 [ 61  64  62 ...  85 102 114]
 ...
 [ 62  62  62 ...  76  77  79]
 [ 62  62  64 ...  77  80  75]
 [ 63  63  63 ...  88  85  89]]
MatI: 
tensor([[ 63.,  64.,  65.,  ...,  81., 106., 108.],
        [ 63.,  62.,  65.,  ...,  81., 100., 110.],
        [ 61.,  64.,  62.,  ...,  85., 102., 114.],
        ...,
        [ 62.,  62.,  62.,  ...,  76.,  77.,  79.],
        [ 62.,  62.,  64.,  ...,  77.,  80.,  75.],
        [ 63.,  63.,  63.,  ...,  88.,  85.,  89.]])
MatI[0:10,35:45]: 
tensor([[ 67.,  68.,  87.,  86.,  85.,  87.,  86.,  85.,  87.,  85.],
        [ 68.,  69.,  76.,  79.,  83.,  83.,  87.,  85.,  78.,  79.],
        [ 68.,  73.,  67.,  82.,  79.,  83.,  95.,  84.,  83.,  83.],
        [ 68.,  69.,  69.,  77.,  85.,  85.,  87.,  94.,  76.,  85.],
        [ 68.,  69.,  74.,  79.,  83.,  82.,  94.,  97.,  89., 100.],
        [ 68.,  68.,  68.,  76.,  80.,  85.,  94.,  96., 103.,  98.],
        [ 68.,  67.,  67.,  77.,  86.,  79., 100.,  97.,  95., 111.],
        [ 67.,  67.,  73.,  66.,  75.,  81., 105., 101., 104., 113.],
        [ 66.,  66.,  67.,  76.,  69.,  69., 103., 112., 121., 111.],
        [ 66.,  67.,  66.,  69.,  69.,  74., 124., 105.,  99., 107.]]) 

debug:
MatD.shape: torch.Size([56, 123]) 
has nan? False 
MatD: 
tensor([[0.0159, 0.0156, 0.0154,  ..., 0.0123, 0.0094, 0.0093],
        [0.0159, 0.0161, 0.0154,  ..., 0.0123, 0.0100, 0.0091],
        [0.0164, 0.0156, 0.0161,  ..., 0.0118, 0.0098, 0.0088],
        ...,
        [0.0161, 0.0161, 0.0161,  ..., 0.0132, 0.0130, 0.0127],
        [0.0161, 0.0161, 0.0156,  ..., 0.0130, 0.0125, 0.0133],
        [0.0159, 0.0159, 0.0159,  ..., 0.0114, 0.0118, 0.0112]]) 

MatU.shape: torch.Size([56, 123, 2]) 
has nan? False 
MatUx: 
tensor([[-2.4802e-04, -2.4038e-04,  1.0088e-03,  ..., -2.9117e-03,
         -1.7470e-04, -1.7470e-04],
        [ 2.5602e-04, -7.4442e-04,  1.2821e-03,  ..., -2.3457e-03,
         -9.0909e-04, -9.0909e-04],
        [-7.6844e-04,  5.0403e-04,  2.6441e-04,  ..., -1.9608e-03,
         -1.0320e-03, -1.0320e-03],
        ...,
        [ 1.0000e-10,  1.0000e-10, -2.5601e-04,  ..., -1.7088e-04,
         -3.2878e-04, -3.2878e-04],
        [ 1.0000e-10, -5.0403e-04,  5.0403e-04,  ..., -4.8701e-04,
          8.3333e-04,  8.3333e-04],
        [ 1.0000e-10,  1.0000e-10,  2.5602e-04,  ...,  4.0107e-04,
         -5.2875e-04, -5.2875e-04]]) 

MatD[0:10,35:45]: 
tensor([[0.0149, 0.0147, 0.0115, 0.0116, 0.0118, 0.0115, 0.0116, 0.0118, 0.0115,
         0.0118],
        [0.0147, 0.0145, 0.0132, 0.0127, 0.0120, 0.0120, 0.0115, 0.0118, 0.0128,
         0.0127],
        [0.0147, 0.0137, 0.0149, 0.0122, 0.0127, 0.0120, 0.0105, 0.0119, 0.0120,
         0.0120],
        [0.0147, 0.0145, 0.0145, 0.0130, 0.0118, 0.0118, 0.0115, 0.0106, 0.0132,
         0.0118],
        [0.0147, 0.0145, 0.0135, 0.0127, 0.0120, 0.0122, 0.0106, 0.0103, 0.0112,
         0.0100],
        [0.0147, 0.0147, 0.0147, 0.0132, 0.0125, 0.0118, 0.0106, 0.0104, 0.0097,
         0.0102],
        [0.0147, 0.0149, 0.0149, 0.0130, 0.0116, 0.0127, 0.0100, 0.0103, 0.0105,
         0.0090],
        [0.0149, 0.0149, 0.0137, 0.0152, 0.0133, 0.0123, 0.0095, 0.0099, 0.0096,
         0.0088],
        [0.0152, 0.0152, 0.0149, 0.0132, 0.0145, 0.0145, 0.0097, 0.0089, 0.0083,
         0.0090],
        [0.0152, 0.0149, 0.0152, 0.0145, 0.0145, 0.0135, 0.0081, 0.0095, 0.0101,
         0.0093]]) 

MatU[0:10,35:45]: 
tensor([[[-2.1949e-04, -2.1949e-04],
         [-3.2116e-03, -2.1313e-04],
         [ 1.3365e-04,  1.6636e-03],
         [ 1.3680e-04,  1.0303e-03],
         [-2.7045e-04,  2.8349e-04],
         [ 1.3365e-04,  5.5394e-04],
         [ 1.3680e-04, -1.3365e-04],
         [-2.7045e-04,  1.0000e-10],
         [ 2.7045e-04,  1.3263e-03],
         [-1.3680e-04,  8.9352e-04]],

        [[-2.1313e-04,  1.0000e-10],
         [-1.3349e-03, -7.9412e-04],
         [-4.9967e-04,  1.7675e-03],
         [-6.1004e-04, -4.6311e-04],
         [ 1.0000e-10,  6.1004e-04],
         [-5.5394e-04,  1.0000e-10],
         [ 2.7045e-04, -9.6794e-04],
         [ 1.0558e-03,  1.4006e-04],
         [-1.6228e-04, -7.7232e-04],
         [-1.1640e-03, -6.1004e-04]],

        [[-1.0073e-03,  1.0000e-10],
         [ 1.2267e-03,  7.9412e-04],
         [-2.7303e-03, -4.3262e-04],
         [ 4.6311e-04,  7.9189e-04],
         [-6.1004e-04, -8.9352e-04],
         [-1.5219e-03, -2.8349e-04],
         [ 1.3784e-03,  9.6794e-04],
         [ 1.4343e-04, -1.2665e-03],
         [ 1.0000e-10,  1.1097e-03],
         [ 4.5181e-04, -2.8349e-04]],

        [[-2.1313e-04,  1.0000e-10],
         [ 1.0000e-10,  1.0000e-10],
         [-1.5057e-03, -9.7924e-04],
         [-1.2223e-03, -3.2878e-04],
         [ 1.0000e-10,  2.8349e-04],
         [-2.7045e-04,  4.3042e-04],
         [-8.5596e-04, -8.5596e-04],
         [ 2.5196e-03, -3.2902e-04],
         [-1.3932e-03, -1.9219e-03],
         [-2.7045e-04, -1.7647e-03]],

        [[-2.1313e-04,  1.0000e-10],
         [-9.7924e-04,  2.1313e-04],
         [-8.5529e-04,  1.1924e-03],
         [-6.1004e-04,  4.9967e-04],
         [ 1.4693e-04,  4.5181e-04],
         [-1.5568e-03, -4.3042e-04],
         [-3.2902e-04,  1.0000e-10],
         [ 9.2668e-04,  1.0739e-04],
         [-1.2360e-03, -1.5272e-03],
         [ 6.3830e-04,  2.0408e-04]],

        [[ 1.0000e-10,  1.0000e-10],
         [ 1.0000e-10,  2.1949e-04],
         [-1.5480e-03,  2.1949e-04],
         [-6.5789e-04, -1.7088e-04],
         [-7.3529e-04, -8.7209e-04],
         [-1.1264e-03,  8.9352e-04],
         [-2.2163e-04, -6.3830e-04],
         [-7.0793e-04, -1.0739e-04],
         [ 4.9534e-04,  8.1758e-04],
         [-6.8027e-04, -1.1951e-03]],

        [[ 2.1949e-04,  2.1949e-04],
         [ 1.0000e-10,  1.0000e-10],
         [-1.9384e-03, -1.2267e-03],
         [-1.3591e-03,  2.1645e-03],
         [ 1.0303e-03,  1.7054e-03],
         [-2.6582e-03, -3.1255e-04],
         [ 3.0928e-04, -4.7619e-04],
         [ 2.1704e-04, -4.0829e-04],
         [-1.5173e-03, -9.1093e-04],
         [ 1.3003e-03, -1.5945e-04]],

        [[ 1.0000e-10,  2.2614e-04],
         [-1.2267e-03,  2.2614e-04],
         [ 1.4529e-03,  1.2267e-03],
         [-1.8182e-03, -1.9936e-03],
         [-9.8765e-04,  1.1594e-03],
         [-2.8219e-03,  2.1471e-03],
         [ 3.7718e-04,  1.8493e-04],
         [-2.8560e-04, -9.7242e-04],
         [-7.6583e-04, -1.3509e-03],
         [ 9.5436e-04,  1.5945e-04]],

        [[ 1.0000e-10,  1.0000e-10],
         [-2.2614e-04, -2.2614e-04],
         [-1.7675e-03,  2.2614e-04],
         [ 1.3349e-03,  1.3349e-03],
         [ 1.0000e-10,  1.0000e-10],
         [-4.7840e-03, -9.7924e-04],
         [-7.8017e-04, -1.6442e-03],
         [-6.6411e-04,  5.9524e-04],
         [ 7.4455e-04,  1.8365e-03],
         [ 1.1951e-03,  3.3678e-04]],

        [[-2.2614e-04,  1.0000e-10],
         [ 2.2614e-04,  1.0000e-10],
         [-6.5876e-04, -1.0670e-03],
         [ 1.0000e-10,  4.3262e-04],
         [-9.7924e-04, -7.9412e-04],
         [-5.4490e-03,  7.7220e-04],
         [ 1.4593e-03,  2.6882e-04],
         [ 5.7720e-04,  2.8011e-04],
         [-7.5522e-04, -2.1010e-03],
         [ 5.5520e-04,  1.2925e-03]]]) 

Optimize & Adam params:
 (n_iter,lr,betas,eps):
(20,0.0005,(0.9, 0.999),1e-08)]







test_counter in loss_omega_mat(): 688
test_counter in loss_omega_mat(): 1376
test_counter in loss_omega_mat(): 2064
test_counter in loss_omega_mat(): 2752
test_counter in loss_omega_mat(): 3440
test_counter in loss_omega_mat(): 4128
test_counter in loss_omega_mat(): 4816
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9458, 0.9455, 0.9453,  ..., 0.7570, 0.7570, 0.7570],
         [0.9458, 0.9456, 0.9455,  ..., 0.7571, 0.7571, 0.7569],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7572],
         ...,
         [0.9457, 0.9457, 0.9456,  ..., 0.7570, 0.7569, 0.7569],
         [0.9457, 0.9457, 0.9455,  ..., 0.7570, 0.7569, 0.7568],
         [0.9458, 0.9458, 0.9455,  ..., 0.7571, 0.7570, 0.7569]],

        [[0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7572],
         ...,
         [0.9457, 0.9456, 0.9455,  ..., 0.7569, 0.7567, 0.7561],
         [0.9458, 0.9457, 0.9457,  ..., 0.7569, 0.7568, 0.7562],
         [0.9458, 0.9458, 0.9458,  ..., 0.7571, 0.7570, 0.7567]],

        [[0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7572],
         ...,
         [0.9457, 0.9456, 0.9451,  ..., 0.7567, 0.7566, 0.7559],
         [0.9458, 0.9457, 0.9457,  ..., 0.7567, 0.7567, 0.7560],
         [0.9458, 0.9458, 0.9458,  ..., 0.7571, 0.7571, 0.7565]],

        ...,

        [[0.9456, 0.9456, 0.9454,  ..., 0.7554, 0.7534, 0.7514],
         [0.9454, 0.9454, 0.9452,  ..., 0.7536, 0.7535, 0.7514],
         [0.9453, 0.9452, 0.9450,  ..., 0.7541, 0.7536, 0.7534],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7574],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7566, 0.7564],
         [0.9459, 0.9458, 0.9457,  ..., 0.7562, 0.7548, 0.7546]],

        [[0.9422, 0.9389, 0.9355,  ..., 0.7519, 0.7508, 0.7486],
         [0.9420, 0.9356, 0.9355,  ..., 0.7509, 0.7501, 0.7499],
         [0.9417, 0.9401, 0.9356,  ..., 0.7529, 0.7517, 0.7481],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7574],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7568, 0.7566],
         [0.9459, 0.9459, 0.9458,  ..., 0.7565, 0.7556, 0.7553]],

        [[0.9371, 0.9341, 0.9335,  ..., 0.7519, 0.7508, 0.7469],
         [0.9331, 0.9331, 0.9306,  ..., 0.7511, 0.7502, 0.7498],
         [0.9367, 0.9323, 0.9321,  ..., 0.7514, 0.7492, 0.7486],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7571, 0.7567, 0.7566],
         [0.9459, 0.9459, 0.9459,  ..., 0.7562, 0.7555, 0.7555]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[6.9913e-08, 4.7835e-07, 6.0286e-07,  ..., 2.6217e-07,
          3.3025e-06, 2.4114e-06],
         [6.9913e-08, 6.9913e-08, 2.8905e-07,  ..., 7.4652e-08,
          1.1373e-06, 6.4328e-07],
         [2.7084e-07, 2.7965e-07, 2.7084e-07,  ..., 2.6217e-07,
          2.1062e-06, 2.8860e-07],
         ...,
         [2.7626e-07, 5.4992e-07, 5.2856e-06,  ..., 1.0178e-06,
          3.7116e-06, 9.8827e-06],
         [3.4281e-07, 1.6086e-07, 1.6086e-07,  ..., 6.4343e-07,
          1.3372e-06, 1.0974e-07],
         [1.6986e-10, 7.2493e-07, 7.2493e-07,  ..., 9.6398e-07,
          1.3158e-07, 1.1801e-06]],

        [[1.0000e-20, 1.0000e-20, 2.7084e-07,  ..., 1.0000e-20,
          6.9912e-08, 7.4653e-08],
         [6.5544e-08, 6.5544e-08, 6.9913e-08,  ..., 1.0834e-06,
          1.7257e-06, 7.6913e-06],
         [6.9913e-08, 6.0286e-07, 6.9913e-08,  ..., 2.6217e-07,
          1.0660e-06, 4.3703e-06],
         ...,
         [2.2087e-06, 1.3553e-20, 1.3553e-20,  ..., 2.9531e-06,
          5.1653e-06, 2.7705e-07],
         [7.2493e-07, 7.2493e-07, 1.2380e-06,  ..., 3.8692e-06,
          2.4624e-06, 3.1512e-06],
         [1.7863e-08, 1.7863e-08, 1.6867e-06,  ..., 9.8495e-06,
          1.5955e-05, 3.8696e-06]],

        [[6.9913e-08, 7.6233e-21, 6.1597e-07,  ..., 2.7965e-07,
          1.1373e-06, 1.1186e-06],
         [6.9913e-08, 6.5544e-08, 7.0477e-11,  ..., 7.0473e-11,
          6.2988e-07, 2.6217e-07],
         [7.0477e-11, 6.9913e-08, 1.0000e-20,  ..., 7.7719e-11,
          6.9913e-08, 2.7965e-07],
         ...,
         [1.7863e-08, 2.3072e-07, 1.7863e-08,  ..., 3.6418e-07,
          3.0458e-06, 1.8234e-06],
         [1.0000e-20, 1.0000e-20, 1.7061e-08,  ..., 3.9023e-07,
          3.9023e-07, 5.7761e-06],
         [5.1957e-07, 6.9839e-08, 6.9839e-08,  ..., 3.6587e-07,
          1.6276e-08, 2.8258e-07]],

        ...,

        [[2.4942e-06, 6.5750e-07, 2.5405e-07,  ..., 3.9465e-07,
          2.1643e-07, 2.3254e-05],
         [5.8252e-11, 1.0851e-06, 6.1512e-08,  ..., 2.3864e-05,
          6.1512e-08, 1.0893e-05],
         [3.5921e-06, 4.1474e-06, 7.0706e-07,  ..., 3.1419e-06,
          9.6205e-06, 5.5238e-06],
         ...,
         [4.9120e-08, 3.1629e-07, 4.9120e-08,  ..., 1.9648e-07,
          4.6130e-07, 1.4192e-08],
         [1.0376e-20, 4.8092e-08, 1.9862e-07,  ..., 1.2023e-08,
          4.8092e-08, 1.0050e-06],
         [1.2023e-08, 1.2540e-08, 5.4388e-12,  ..., 1.1286e-07,
          4.0801e-06, 1.1662e-06]],

        [[1.1292e-09, 2.3942e-05, 1.9264e-05,  ..., 1.7148e-05,
          6.6237e-09, 4.8744e-05],
         [2.3731e-06, 2.2881e-05, 1.4040e-05,  ..., 1.1703e-07,
          2.6953e-05, 1.0310e-04],
         [1.1082e-05, 7.8651e-06, 7.6452e-08,  ..., 2.6108e-06,
          5.5848e-08, 6.5938e-05],
         ...,
         [1.0376e-20, 5.8054e-12, 1.0376e-20,  ..., 5.0159e-08,
          1.0376e-20, 4.9086e-08],
         [1.0000e-20, 1.2023e-08, 1.0000e-20,  ..., 9.0000e-20,
          1.2540e-08, 1.2540e-08],
         [1.0000e-20, 1.0000e-20, 1.0000e-20,  ..., 1.0050e-06,
          1.2135e-06, 4.5450e-06]],

        [[4.2427e-05, 1.5688e-04, 1.9142e-05,  ..., 5.6066e-04,
          3.5672e-04, 8.5609e-05],
         [6.3063e-06, 8.6310e-05, 6.3063e-06,  ..., 6.3063e-06,
          6.7100e-04, 3.4531e-04],
         [3.2631e-05, 1.2993e-06, 3.2631e-05,  ..., 1.7038e-06,
          3.8010e-05, 5.6576e-05],
         ...,
         [1.2540e-08, 5.1244e-08, 5.1244e-08,  ..., 2.0498e-07,
          5.1244e-08, 2.0498e-07],
         [1.0000e-20, 1.2023e-08, 1.2023e-08,  ..., 4.9120e-08,
          4.8092e-08, 6.4657e-07],
         [1.2540e-08, 1.0000e-20, 1.2540e-08,  ..., 1.0291e-06,
          5.0351e-06, 1.9878e-06]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[5.7999e-04, 1.5455e-03, 9.3007e-04,  ..., 2.4780e-04,
          7.8502e-04, 2.4780e-04],
         [7.4195e-04, 5.8374e-04, 8.4731e-04,  ..., 6.0308e-04,
          1.9171e-03, 2.0242e-03],
         [5.7247e-04, 2.6454e-04, 3.6804e-04,  ..., 3.6804e-04,
          1.9053e-03, 5.2931e-04],
         ...,
         [1.3495e-03, 1.6623e-03, 2.1908e-03,  ..., 8.8537e-04,
          1.2366e-03, 9.8273e-04],
         [1.5072e-03, 7.5802e-04, 8.9383e-04,  ..., 4.1891e-04,
          5.7848e-04, 7.2454e-04],
         [9.5853e-04, 1.5006e-03, 5.2272e-04,  ..., 1.2381e-03,
          3.7788e-04, 2.0614e-03]],

        [[3.7393e-04, 5.8374e-04, 5.2042e-04,  ..., 5.8374e-04,
          2.6441e-04, 1.8224e-03],
         [5.2049e-04, 1.1637e-03, 5.8374e-04,  ..., 9.5610e-04,
          2.6454e-04, 2.5660e-03],
         [3.6206e-04, 5.7247e-04, 5.7999e-04,  ..., 9.4170e-04,
          3.7393e-04, 1.1224e-03],
         ...,
         [1.6623e-03, 5.9237e-04, 6.0698e-04,  ..., 1.5527e-03,
          1.9280e-03, 6.1655e-04],
         [1.9631e-03, 9.9069e-04, 7.5802e-04,  ..., 1.6012e-03,
          1.4265e-03, 1.3509e-03],
         [1.1468e-03, 7.4190e-04, 1.5006e-03,  ..., 5.8460e-04,
          2.7280e-03, 1.4016e-03]],

        [[3.7393e-04, 2.6454e-04, 8.2818e-04,  ..., 5.2889e-04,
          3.7393e-04, 1.1872e-05],
         [5.2049e-04, 3.6804e-04, 2.6454e-04,  ..., 5.9561e-04,
          2.5601e-04, 8.1756e-04],
         [3.6206e-04, 3.7393e-04, 3.6804e-04,  ..., 2.6441e-04,
          5.8374e-04, 3.7393e-04],
         ...,
         [1.0562e-03, 5.9237e-04, 2.9479e-04,  ..., 9.8454e-04,
          1.2029e-03, 6.6605e-04],
         [1.8688e-04, 1.8902e-04, 9.9069e-04,  ..., 7.6730e-04,
          5.7235e-04, 2.5906e-03],
         [1.1468e-03, 5.8413e-04, 1.3065e-04,  ..., 8.8189e-04,
          4.8031e-04, 8.9200e-04]],

        ...,

        [[1.1156e-03, 1.3430e-03, 1.3973e-03,  ..., 2.9300e-03,
          2.6824e-03, 9.4548e-03],
         [7.4699e-04, 1.3973e-03, 2.1514e-03,  ..., 8.0703e-03,
          5.6440e-03, 4.2401e-03],
         [2.7842e-03, 2.1514e-03, 2.9840e-03,  ..., 6.8513e-03,
          8.4760e-03, 1.9875e-03],
         ...,
         [2.2405e-04, 4.7857e-04, 4.9881e-04,  ..., 6.0022e-04,
          3.2021e-04, 3.5496e-04],
         [1.5507e-04, 3.1013e-04, 4.9881e-04,  ..., 1.5673e-04,
          2.0223e-03, 2.1148e-03],
         [1.0967e-04, 1.1198e-04, 1.0108e-03,  ..., 2.6531e-03,
          1.0364e-03, 1.9397e-03]],

        [[4.3885e-03, 3.2956e-03, 8.2018e-03,  ..., 3.0381e-03,
          8.3504e-03, 8.4188e-03],
         [3.7034e-03, 5.4594e-03, 8.2018e-03,  ..., 3.2570e-03,
          5.5807e-03, 4.5009e-03],
         [2.5428e-03, 5.2514e-03, 5.4594e-03,  ..., 1.5820e-03,
          2.9668e-03, 4.6519e-03],
         ...,
         [3.5640e-04, 2.2405e-04, 1.5837e-04,  ..., 1.5837e-04,
          2.5040e-04, 1.6177e-04],
         [1.0965e-04, 1.5507e-04, 0.0000e+00,  ..., 5.9542e-04,
          1.0968e-03, 2.0230e-03],
         [0.0000e+00, 1.1198e-04, 1.1198e-04,  ..., 2.2638e-03,
          1.5867e-03, 4.9967e-04]],

        [[1.1049e-02, 1.1516e-02, 1.2802e-02,  ..., 8.1578e-03,
          3.2503e-03, 1.0019e-02],
         [1.4966e-02, 1.2633e-02, 1.2414e-02,  ..., 7.9808e-03,
          9.1919e-03, 8.9439e-03],
         [5.3500e-03, 6.0387e-03, 3.3557e-03,  ..., 4.2401e-03,
          7.9934e-03, 8.4188e-03],
         ...,
         [3.5640e-04, 4.7857e-04, 2.2637e-04,  ..., 2.2637e-04,
          8.8235e-04, 5.9588e-04],
         [1.0965e-04, 2.4518e-04, 3.3602e-04,  ..., 1.3301e-03,
          2.1434e-03, 1.2086e-03],
         [1.1198e-04, 1.5673e-04, 4.8589e-04,  ..., 1.1191e-03,
          1.0364e-03, 1.1478e-03]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:557.6881713867188
t:0, Finish constructing loss
require grad ? True True False
MatD grad and MatUx grad: torch.Size([56, 123]) torch.Size([56, 123, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-1.0748e-02,  3.4430e-02, -1.4642e-01,  7.4021e-02, -3.9782e-02,
         -4.2643e-02,  1.0904e-01, -2.7059e-01, -3.5642e-01, -4.0179e-01],
        [-1.7214e+00, -6.3330e+00, -6.4006e+00, -1.3297e+01, -1.1982e+01,
         -5.8570e+00, -3.9778e+00,  5.3926e-01,  1.1372e+01,  5.5338e+00],
        [-1.1762e+00, -1.4738e+01, -3.7948e+01, -2.2898e+01, -2.0188e+01,
          1.4137e+00, -6.5200e+00, -1.2074e+01,  2.0498e+01,  2.3804e+00],
        [-1.4074e+01,  2.0901e+01,  2.1414e+01, -2.8439e+01, -1.0643e+01,
          1.9383e+00, -5.1664e+01, -2.2320e+01, -2.5586e+01,  9.0577e+00],
        [-4.1773e+01,  3.2222e+01,  3.4656e+01, -2.8227e+01, -3.8472e+01,
          3.8176e+01, -8.4815e+01,  1.5998e+01,  7.3691e+01, -2.9464e+01],
        [-2.7413e+01, -1.6275e+00, -6.7921e+01,  5.8758e+01,  6.5887e+00,
          1.4440e+01, -7.0698e+01,  4.5665e+00,  1.4159e+01, -4.2065e+01],
        [-5.4366e+00,  4.2369e+01,  1.7011e+01, -6.0771e+01,  3.7785e+01,
          5.5397e+01, -5.7956e+01, -3.1171e+01, -5.2602e+01, -2.8569e+01],
        [-1.0996e+01, -4.8574e+00,  4.2942e+01, -2.6402e+00,  3.1446e+01,
          2.0836e+00, -5.1244e+01,  1.1441e+01,  5.3637e+01, -9.4405e+00]]) 

MatU.grad[0:10,35:45]: 
tensor([[[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[  -91.4397,    14.9508],
         [   52.4570,   -63.4615],
         [  -77.7947,  -125.5224],
         [  -62.2695,   -21.1647],
         [  120.2307,    52.1473],
         [   64.6714,    76.1312],
         [  -55.1776,  -122.4922],
         [  154.4436,   -23.9787],
         [  -87.4635,  -133.3026],
         [   25.8679,  -148.2344]],

        [[ -173.0862,   -13.8668],
         [ -223.1834,   134.7227],
         [  -29.4258,   305.7805],
         [   76.8806,    95.7237],
         [  268.4050,    58.5868],
         [ -275.7419,   -95.5316],
         [   40.8274,   118.5765],
         [  373.6673,    93.2585],
         [ -232.3646,  -338.5840],
         [  121.6025,    62.0683]],

        [[  593.6965,  -372.0378],
         [  568.1254,   272.9779],
         [-1352.5565,   272.4648],
         [  153.7939,  -431.2705],
         [   96.4915, -1178.9126],
         [ -726.0375,   786.5142],
         [  212.9201,  -688.6749],
         [ -627.6233,   566.5349],
         [  543.0031,  1526.3657],
         [ -651.3821,  -723.7536]],

        [[ 1360.1527,   226.3004],
         [  872.6240,  -325.4332],
         [-1390.1917, -1329.7396],
         [ -564.7983,  1750.5787],
         [ 1300.3127,  1325.3745],
         [-1655.7504,  -224.1352],
         [ 1394.4924,  -499.4784],
         [  752.6443,  -214.8582],
         [-1821.3942,  -761.9305],
         [ 1453.0157,  -177.6158]],

        [[  340.0751,   716.6690],
         [-1381.0139,   299.8143],
         [ 1947.3728,   918.4982],
         [ -802.9073, -1954.7133],
         [ -132.8210,  1139.1833],
         [-1351.0513,  1478.8508],
         [ 1116.2335,   403.4243],
         [  -61.5564, -1057.7469],
         [-1000.4351, -1445.0289],
         [  947.8332,   305.0977]],

        [[  665.5123,  -223.5133],
         [   -2.9016,  -955.7548],
         [-1912.3683,   319.2880],
         [ 1725.0923,  1036.2253],
         [  694.1926,  -382.5878],
         [-1887.5881,  -668.7847],
         [  -95.5724, -1407.7710],
         [ -773.9084,   917.9444],
         [  504.7594,  2124.2224],
         [ 1159.8091,   483.9348]],

        [[ -128.2644,   447.2253],
         [ 1414.7368,  -297.2324],
         [ -507.0429, -1873.8416],
         [  461.2534,   848.0432],
         [ -300.4164,  -846.0236],
         [-1849.8313,   588.3650],
         [ 1666.5243,   249.5858],
         [  645.8831,   309.8313],
         [ -846.1763, -1890.0062],
         [  152.4377,  1350.5071]]]) 

MatD.grad: 
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 3.6802e+00, -5.2859e+01],
         [-1.9913e+01, -1.0703e+02],
         [ 6.0541e+01,  1.9393e+00],
         [-1.1751e+02, -8.6525e+01],
         [-1.5679e+02,  2.3102e+01],
         [ 3.7492e+01,  1.4656e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.1617e+00, -5.2977e+01],
         [-1.5410e+02, -6.7115e+01],
         [ 2.5891e+02,  1.2647e+02],
         [-1.5275e+02, -3.2125e+02],
         [-6.9231e+01, -3.2341e+02],
         [-3.9551e+01, -3.2835e+01],
         [-1.2944e+01, -6.1113e-01]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-3.9615e+01,  1.3396e+01],
         [-1.4973e+01, -1.1063e+02],
         [ 4.0579e+02,  1.3064e+03],
         [-2.3605e+02,  1.1434e+03],
         [ 1.0748e+03, -1.0805e+03],
         [ 3.5938e+01,  2.7037e+02],
         [-1.1896e+02,  1.6704e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.3695e+02,  8.5755e+00],
         [ 3.5326e+02, -3.9729e+01],
         [-5.7761e+01, -1.1792e+02],
         [-1.7558e+03, -7.7649e+02],
         [ 1.7797e+03,  6.9292e+02],
         [-1.7781e+02,  5.7081e+01],
         [-2.9583e+02, -1.2082e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.2701e+02, -7.1427e+01],
         [ 3.6267e+02, -9.8127e+01],
         [-7.9806e+02, -1.2211e+03],
         [-2.0893e+02, -1.4682e+03],
         [ 1.5126e+03, -2.2022e+02],
         [-2.6357e+02, -1.9106e+03],
         [-1.4679e+02, -1.8945e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-5.2165e+01,  5.2121e+01],
         [ 1.3300e+02,  3.6925e+02],
         [-1.0644e+03,  8.3013e+02],
         [ 6.8524e+02,  1.9666e+03],
         [-2.0090e+02,  1.8254e+03],
         [-2.8444e+02,  1.9390e+03],
         [ 1.5037e+03,  1.2704e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 7.5599e+01, -1.3039e+02],
         [-3.1918e+02, -8.3234e+01],
         [ 1.0777e+03,  8.1513e+02],
         [ 1.2396e+02, -5.1584e+02],
         [-3.2600e+01, -4.0194e+02],
         [-1.6424e+03, -2.4999e+02],
         [ 1.7931e+03, -2.9888e+02]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[  236.6869,  -148.2576],
         [  398.5350,   -35.8312],
         [  990.1828,   112.4355],
         [ 1195.6887,    78.6525],
         [ -914.1866,  -982.9816],
         [ -551.1667, -1688.0731],
         [    4.7238,  -730.2173],
         [  976.2869, -1647.7983],
         [  237.9933,  -396.9573],
         [-1259.9080, -1702.0134]],

        [[  274.6633,  1939.2054],
         [  622.0507,   215.7091],
         [ 1021.4568,   124.2402],
         [ -152.2469, -1723.5509],
         [-1544.3616, -1314.3289],
         [  792.5499,   180.1182],
         [-1368.1245,   879.8392],
         [ 2060.1802,   722.6211],
         [-1645.4761,  -560.8420],
         [ -436.7614,  1716.9515]],

        [[-1339.4932,   183.9680],
         [  698.7295,   110.7059],
         [-1573.3444, -1039.0631],
         [-1127.9683,  1240.9463],
         [   80.2039,  1709.1815],
         [  887.8262,  1790.5491],
         [ -451.0926, -1832.6989],
         [  254.4872,   755.7744],
         [  944.9891,   931.8047],
         [   88.9126, -1771.7361]],

        [[-1333.3409,    99.9552],
         [ -572.2142,    61.6611],
         [ 1417.4427,   181.4685],
         [  -38.4256, -1159.2625],
         [  897.6258, -1506.6683],
         [-1819.7332, -1472.3181],
         [ 1722.2701,  1260.4109],
         [ 1046.1698,  -828.5730],
         [-1751.4403,  -839.2917],
         [  430.4385,  -200.4496]],

        [[ -738.2519, -1943.4888],
         [ -650.6573,  1905.5890],
         [   48.9203,   149.1308],
         [-1080.1123,    37.5037],
         [ -980.9212,  1512.8707],
         [ 1296.5009,   518.1408],
         [ -327.1499,   626.0612],
         [  -14.2905,  1447.6978],
         [-1062.8510,  -510.5953],
         [ 1772.7354,  -530.4777]],

        [[ 1969.4414,  1110.5785],
         [-1811.4674, -1132.0692],
         [  -61.2399,  1511.1830],
         [ 1031.1727,   -37.2609],
         [-1720.1619,   893.9615],
         [  987.4922,  1894.1340],
         [  665.8742, -1207.4524],
         [-1615.0350,  -579.6377],
         [-1044.4586,  1146.8260],
         [ 1728.3783,  1279.1698]],

        [[  360.5198, -1442.4878],
         [  460.8002,   334.3520],
         [-1294.4410,  -869.3024],
         [ 1870.7413,  -680.8842],
         [ -107.0106, -2160.3057],
         [-1601.0585, -1394.5383],
         [  569.8850,   185.1582],
         [  527.1608,  -852.2143],
         [  377.4317,  -944.2505],
         [ -837.4307, -1570.7013]],

        [[ 1761.7793,   247.1808],
         [ -898.3455,   390.1314],
         [-1327.4531,   473.9167],
         [  -23.5817,  1322.6700],
         [  524.4670,  1880.3269],
         [ -707.2460,  -507.7979],
         [ -795.4872,   486.7290],
         [  246.3434,  1947.8265],
         [-1044.7465,  1661.3129],
         [ 1052.4353,  1813.1382]],

        [[ 1513.9425,   153.2204],
         [ -621.0896,  -941.3333],
         [  -62.0557, -2289.0625],
         [  948.6262,  -455.7042],
         [-1541.0569,   453.0045],
         [  460.9914,  -337.1419],
         [ 1639.8666,  -376.4773],
         [  146.9528, -1364.8760],
         [  -46.7380,  1019.6167],
         [ -757.7659,   -97.4858]],

        [[  149.3075,   254.0597],
         [-2013.5354, -1190.4794],
         [ 1507.9318,  1833.0205],
         [ 1409.5742,   130.9271],
         [-1819.2665,  -498.1859],
         [  197.7400, -2110.3083],
         [  977.1889,  1048.8246],
         [ 1695.4725,  -906.1213],
         [ -515.1888, -1870.7289],
         [-1851.4990, -1389.1796]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[  672.0682,   606.7872],
         [  603.1094, -1727.4956],
         [-1335.5625, -1386.3394],
         [ -426.5658,  1183.2188],
         [  434.8459, -1226.8234],
         [ -545.8537,   639.0049],
         [ 1365.0697,   147.9511],
         [  607.9465,  1059.0283],
         [  282.6956,  -157.2609],
         [ -622.6559,  -660.8264]],

        [[-1301.4050, -1688.5739],
         [  548.4212,   973.6615],
         [ 1049.8536,   -77.1023],
         [-2131.5359,   325.5489],
         [ 1347.0167,  1494.6073],
         [ -208.9673,  -555.2937],
         [ 1634.3303,  -516.7967],
         [ -316.8529, -1905.7069],
         [ -359.0208,  1629.0433],
         [  277.5709,  -980.5505]],

        [[ 1501.1340,  -253.6653],
         [   19.3184, -1231.1334],
         [  927.5908,  1293.3575],
         [ -756.3932, -1153.4525],
         [ -824.3191, -1139.2151],
         [-1170.4323,   351.6056],
         [   35.5480,   213.2349],
         [ 1925.4994,   537.2623],
         [-1125.8711,  1762.9698],
         [  580.7230,  1181.0228]],

        [[ -152.7938,  2134.0842],
         [ 2146.3545,  -170.0873],
         [-1101.7319, -1323.8170],
         [ -820.2094,  1375.2612],
         [  689.6492,  -455.5056],
         [ -655.0922,   246.3988],
         [ 1184.3737,   267.6915],
         [ 2157.2092,  -494.4696],
         [-1544.5365, -1532.6561],
         [-1155.4878,  -656.8744]],

        [[-1743.2487, -1553.2106],
         [  233.8092,  1005.4968],
         [ 1379.3752,  -217.2490],
         [-2002.5278,   235.7878],
         [ 1166.4535, -1182.0515],
         [  308.7160,  -725.8841],
         [-1553.7028,  -280.1441],
         [ 1293.4503,   671.9506],
         [ -108.7591, -1895.0331],
         [ -135.6459,  -748.5954]],

        [[  854.6600,  -240.8563],
         [ -146.4359, -1393.7467],
         [ 1178.1968,  1246.1166],
         [-2209.0708,  -651.3028],
         [ 1088.2960,  1502.2667],
         [ -388.3032,    74.2165],
         [  718.9053,   428.7432],
         [-1710.1466,   634.6255],
         [ 1683.5439,   187.4371],
         [  442.1240,  1432.1252]],

        [[ -302.0308, -1343.9822],
         [ 1987.4446,   880.2015],
         [-1102.5011,   172.5479],
         [-1026.3484,   994.7748],
         [ -241.7262,  -525.4128],
         [  787.7676,    63.5139],
         [ 1356.5728,  -269.0479],
         [-1306.4022, -1508.1953],
         [ 1071.3584,  1850.1533],
         [ -984.1926,  -345.4686]],

        [[ 1706.5758,  1373.3966],
         [ 1317.3232,  -588.3558],
         [ -169.8764, -1341.0056],
         [-1689.1304,  -991.7552],
         [   54.1259,  1766.8784],
         [  179.2352,   832.7421],
         [-1729.2758,  -221.7716],
         [ 1894.7631,  1099.4303],
         [ -534.2759, -2086.9985],
         [  -44.7208,  -966.6271]],

        [[  471.6800,   944.6859],
         [  302.4646,   166.8450],
         [ -175.2657, -1777.4183],
         [ 1359.0530,   748.2655],
         [ -312.9631, -1115.6300],
         [-1016.3293,  -915.9769],
         [ 1051.5450,   594.3063],
         [-1480.7087,   482.4213],
         [ 1509.2189,  -528.0634],
         [  163.3875,  1282.7186]],

        [[ -413.6438,  -884.1944],
         [-1576.3365,   644.7587],
         [ 1859.0201,  -288.8649],
         [ -403.6663, -2124.3342],
         [-1045.4962,     9.1105],
         [  722.5166,   321.9214],
         [ 1289.2374,   270.8835],
         [-1977.5342,    47.3597],
         [ 1991.0465,  -114.8861],
         [-1088.4597,  -432.9203]]]) 

t:0, loss.item(): 11153.763671875
Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0156, 0.0154,  ..., 0.0123, 0.0094, 0.0093],
        [0.0159, 0.0161, 0.0154,  ..., 0.0123, 0.0100, 0.0091],
        [0.0164, 0.0156, 0.0161,  ..., 0.0118, 0.0098, 0.0088],
        ...,
        [0.0161, 0.0161, 0.0161,  ..., 0.0132, 0.0130, 0.0127],
        [0.0161, 0.0161, 0.0156,  ..., 0.0130, 0.0125, 0.0133],
        [0.0159, 0.0159, 0.0159,  ..., 0.0114, 0.0118, 0.0112]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[-2.4802e-04, -2.4038e-04,  1.0088e-03,  ..., -2.9117e-03,
         -1.7470e-04, -1.7470e-04],
        [ 2.5602e-04, -7.4442e-04,  1.2821e-03,  ..., -2.3457e-03,
         -9.0909e-04, -9.0909e-04],
        [-7.6844e-04,  5.0403e-04,  2.6441e-04,  ..., -1.9608e-03,
         -1.0320e-03, -1.0320e-03],
        ...,
        [ 1.0000e-10,  1.0000e-10, -2.5601e-04,  ..., -1.7088e-04,
         -3.2878e-04, -3.2878e-04],
        [ 1.0000e-10, -5.0403e-04,  5.0403e-04,  ..., -4.8701e-04,
          8.3333e-04,  8.3333e-04],
        [ 1.0000e-10,  1.0000e-10,  2.5602e-04,  ...,  4.0107e-04,
         -5.2875e-04, -5.2875e-04]], grad_fn=<SelectBackward>)  









test_counter in loss_omega_mat(): 688
test_counter in loss_omega_mat(): 1376
test_counter in loss_omega_mat(): 2064
test_counter in loss_omega_mat(): 2752
test_counter in loss_omega_mat(): 3440
test_counter in loss_omega_mat(): 4128
test_counter in loss_omega_mat(): 4816
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9458, 0.9457, 0.9457,  ..., 0.7570, 0.7568, 0.7567],
         [0.9458, 0.9458, 0.9457,  ..., 0.7570, 0.7570, 0.7568],
         [0.9459, 0.9458, 0.9458,  ..., 0.7573, 0.7572, 0.7569],
         ...,
         [0.9459, 0.9458, 0.9457,  ..., 0.7570, 0.7569, 0.7568],
         [0.9459, 0.9459, 0.9457,  ..., 0.7570, 0.7569, 0.7568],
         [0.9459, 0.9459, 0.9458,  ..., 0.7569, 0.7569, 0.7568]],

        [[0.9458, 0.9458, 0.9457,  ..., 0.7573, 0.7572, 0.7571],
         [0.9458, 0.9458, 0.9458,  ..., 0.7573, 0.7572, 0.7572],
         [0.9458, 0.9458, 0.9458,  ..., 0.7573, 0.7572, 0.7572],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.7570, 0.7569, 0.7567],
         [0.9459, 0.9458, 0.9457,  ..., 0.7570, 0.7570, 0.7568],
         [0.9459, 0.9458, 0.9457,  ..., 0.7570, 0.7569, 0.7569]],

        [[0.9458, 0.9458, 0.9458,  ..., 0.7573, 0.7573, 0.7572],
         [0.9458, 0.9458, 0.9458,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9458, 0.9458,  ..., 0.7573, 0.7573, 0.7572],
         ...,
         [0.9458, 0.9457, 0.9455,  ..., 0.7569, 0.7569, 0.7567],
         [0.9458, 0.9458, 0.9457,  ..., 0.7570, 0.7570, 0.7567],
         [0.9458, 0.9458, 0.9457,  ..., 0.7570, 0.7569, 0.7568]],

        ...,

        [[0.9458, 0.9457, 0.9456,  ..., 0.7552, 0.7542, 0.7512],
         [0.9458, 0.9458, 0.9456,  ..., 0.7550, 0.7525, 0.7519],
         [0.9457, 0.9456, 0.9456,  ..., 0.7547, 0.7547, 0.7526],
         ...,
         [0.9457, 0.9457, 0.9455,  ..., 0.7572, 0.7572, 0.7572],
         [0.9457, 0.9457, 0.9455,  ..., 0.7571, 0.7570, 0.7569],
         [0.9459, 0.9458, 0.9454,  ..., 0.7565, 0.7544, 0.7543]],

        [[0.9415, 0.9368, 0.9341,  ..., 0.7509, 0.7503, 0.7480],
         [0.9416, 0.9345, 0.9341,  ..., 0.7507, 0.7500, 0.7480],
         [0.9422, 0.9412, 0.9345,  ..., 0.7535, 0.7524, 0.7475],
         ...,
         [0.9458, 0.9457, 0.9457,  ..., 0.7571, 0.7571, 0.7571],
         [0.9458, 0.9457, 0.9457,  ..., 0.7572, 0.7571, 0.7570],
         [0.9459, 0.9459, 0.9456,  ..., 0.7562, 0.7547, 0.7544]],

        [[0.9347, 0.9313, 0.9309,  ..., 0.7508, 0.7495, 0.7451],
         [0.9309, 0.9308, 0.9278,  ..., 0.7489, 0.7486, 0.7484],
         [0.9361, 0.9317, 0.9311,  ..., 0.7507, 0.7481, 0.7480],
         ...,
         [0.9458, 0.9457, 0.9457,  ..., 0.7572, 0.7569, 0.7568],
         [0.9458, 0.9457, 0.9457,  ..., 0.7569, 0.7569, 0.7568],
         [0.9459, 0.9458, 0.9457,  ..., 0.7555, 0.7546, 0.7546]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[5.5503e-08, 5.5502e-08, 7.6419e-08,  ..., 8.9703e-07,
          9.7608e-07, 4.6609e-07],
         [5.5503e-08, 2.4168e-07, 1.5267e-06,  ..., 1.8796e-07,
          5.9788e-07, 9.1233e-08],
         [9.5956e-07, 9.4319e-07, 5.9529e-08,  ..., 2.1047e-06,
          9.0493e-07, 9.2695e-07],
         ...,
         [6.5566e-10, 5.8353e-08, 6.3847e-07,  ..., 6.9890e-06,
          2.3626e-06, 1.6070e-07],
         [9.7872e-09, 7.3105e-09, 9.7873e-09,  ..., 2.1042e-07,
          9.7872e-09, 6.9102e-07],
         [1.2350e-07, 2.6320e-07, 4.2065e-07,  ..., 4.3030e-08,
          2.3049e-06, 1.1398e-06]],

        [[2.5000e-07, 2.5000e-07, 9.5956e-07,  ..., 5.5502e-08,
          2.2500e-06, 1.5267e-06],
         [5.5503e-08, 5.7156e-07, 5.9528e-08,  ..., 9.4319e-07,
          1.4074e-06, 2.4168e-07],
         [5.5502e-08, 5.5503e-08, 7.6419e-08,  ..., 8.1131e-08,
          2.1082e-07, 2.1860e-07],
         ...,
         [1.9135e-10, 2.5000e-07, 5.9625e-07,  ..., 3.1426e-06,
          6.1081e-07, 1.0534e-06],
         [3.7535e-07, 1.2350e-07, 1.8264e-06,  ..., 5.5292e-06,
          1.7329e-07, 1.6261e-06],
         [6.3799e-07, 1.3421e-07, 4.0152e-07,  ..., 8.8094e-07,
          2.1524e-06, 4.0152e-07]],

        [[2.5000e-07, 2.5000e-07, 5.5503e-08,  ..., 9.4319e-07,
          4.9952e-07, 8.3059e-10],
         [2.4167e-07, 5.7156e-07, 5.9529e-08,  ..., 7.1848e-08,
          5.7156e-07, 5.2354e-07],
         [1.5267e-06, 2.5000e-07, 5.5503e-08,  ..., 8.3069e-10,
          3.8855e-06, 2.4126e-07],
         ...,
         [1.0397e-06, 1.3421e-07, 8.4151e-08,  ..., 1.2176e-06,
          4.3435e-06, 3.4237e-06],
         [1.3644e-07, 2.5000e-07, 2.5000e-07,  ..., 7.6617e-07,
          4.0152e-07, 8.1603e-07],
         [4.8757e-08, 1.5270e-06, 5.5568e-08,  ..., 5.4145e-08,
          3.8747e-06, 9.4373e-07]],

        ...,

        [[1.0081e-06, 1.1649e-06, 9.6635e-08,  ..., 1.2729e-06,
          9.3165e-07, 1.8682e-05],
         [2.5769e-07, 2.9340e-07, 5.5953e-07,  ..., 1.5675e-06,
          1.9229e-05, 6.4083e-07],
         [1.5625e-07, 1.1619e-07, 2.3609e-06,  ..., 3.5095e-06,
          3.4235e-06, 1.2972e-05],
         ...,
         [7.7490e-08, 8.7911e-07, 7.7490e-08,  ..., 3.6073e-09,
          3.2193e-09, 2.2118e-06],
         [2.5000e-07, 1.6402e-06, 1.1116e-06,  ..., 7.8793e-08,
          7.8793e-08, 2.5251e-07],
         [1.5056e-07, 2.4767e-07, 1.5237e-07,  ..., 4.6831e-06,
          2.7033e-07, 2.0166e-06]],

        [[2.1753e-07, 1.9299e-05, 1.5125e-05,  ..., 2.6930e-06,
          3.3801e-07, 5.5975e-05],
         [1.0826e-06, 1.0781e-05, 1.0543e-05,  ..., 7.0912e-07,
          7.4886e-05, 1.3628e-05],
         [3.3453e-06, 1.7017e-06, 4.9953e-08,  ..., 4.4765e-06,
          1.5969e-06, 5.8068e-05],
         ...,
         [2.5000e-07, 2.5242e-07, 2.5000e-07,  ..., 4.2110e-06,
          2.5000e-07, 2.5000e-07],
         [2.5000e-07, 1.5237e-07, 1.5056e-07,  ..., 2.5000e-07,
          5.7026e-06, 1.9266e-06],
         [2.5000e-07, 2.5000e-07, 2.5000e-07,  ..., 3.6680e-06,
          1.9555e-06, 3.9931e-07]],

        [[3.6163e-05, 1.4460e-04, 1.5017e-05,  ..., 2.3159e-05,
          3.0231e-04, 4.5596e-05],
         [9.5851e-05, 1.6090e-05, 4.0451e-06,  ..., 2.5865e-04,
          9.0675e-06, 6.4534e-04],
         [2.7169e-05, 4.0941e-07, 2.7169e-05,  ..., 6.7127e-05,
          1.3434e-05, 3.6261e-05],
         ...,
         [1.5056e-07, 1.6221e-06, 7.4872e-08,  ..., 5.2762e-07,
          4.6727e-06, 5.2762e-07],
         [2.5000e-07, 3.7167e-07, 1.5237e-07,  ..., 2.2430e-06,
          5.1910e-06, 2.8761e-06],
         [1.5056e-07, 1.5056e-07, 2.5000e-07,  ..., 2.6463e-07,
          6.5591e-08, 8.1190e-09]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[7.8680e-04, 8.8516e-04, 5.3674e-04,  ..., 7.5300e-04,
          2.4780e-04, 2.1585e-04],
         [8.7811e-04, 7.8680e-04, 7.0203e-04,  ..., 1.7525e-03,
          5.3706e-04, 1.0422e-03],
         [7.8957e-04, 7.3564e-04, 8.7811e-04,  ..., 8.8064e-04,
          1.4909e-03, 4.7084e-04],
         ...,
         [5.3542e-04, 5.4917e-04, 7.7662e-04,  ..., 4.0168e-04,
          6.8569e-04, 1.0889e-03],
         [1.0257e-03, 1.1395e-03, 5.4217e-04,  ..., 4.7917e-04,
          7.5023e-04, 7.2629e-04],
         [6.2214e-04, 9.5853e-04, 8.5576e-04,  ..., 4.2144e-04,
          5.3726e-04, 7.4452e-04]],

        [[5.8374e-04, 3.7393e-04, 4.7957e-04,  ..., 7.7887e-04,
          5.8374e-04, 7.3559e-04],
         [5.8374e-04, 5.2049e-04, 4.8131e-04,  ..., 2.6755e-04,
          2.6454e-04, 8.7811e-04],
         [5.4363e-04, 7.8680e-04, 5.5105e-04,  ..., 5.9914e-04,
          5.5615e-04, 3.7393e-04],
         ...,
         [5.4917e-04, 6.2469e-04, 3.2156e-04,  ..., 1.9280e-03,
          1.5496e-04, 6.1655e-04],
         [1.0257e-03, 8.6957e-04, 7.0005e-04,  ..., 9.8205e-04,
          6.9373e-04, 3.5640e-04],
         [6.2214e-04, 5.8735e-04, 7.4190e-04,  ..., 8.9698e-04,
          8.5624e-04, 7.5149e-04]],

        [[4.7125e-04, 2.6454e-04, 3.7393e-04,  ..., 5.4030e-04,
          7.7887e-04, 4.7125e-04],
         [2.6454e-04, 7.4564e-04, 7.7887e-04,  ..., 7.4564e-04,
          7.3559e-04, 7.4398e-04],
         [7.8167e-04, 7.7887e-04, 8.6883e-04,  ..., 7.3559e-04,
          7.3559e-04, 4.6236e-04],
         ...,
         [6.2469e-04, 2.6524e-04, 4.8863e-04,  ..., 4.4005e-04,
          8.5624e-04, 6.6605e-04],
         [8.6957e-04, 8.7659e-04, 8.7614e-04,  ..., 5.7235e-04,
          3.7373e-04, 1.6089e-03],
         [5.8735e-04, 5.8413e-04, 8.6939e-04,  ..., 1.3228e-03,
          1.0805e-04, 8.8584e-04]],

        ...,

        [[5.4562e-04, 3.0663e-04, 4.1691e-04,  ..., 2.3978e-03,
          1.7409e-03, 9.4548e-03],
         [3.7879e-04, 5.4562e-04, 8.1242e-04,  ..., 4.3691e-03,
          8.0703e-03, 3.6980e-03],
         [1.8109e-03, 1.6228e-03, 8.1242e-04,  ..., 3.1540e-03,
          1.9875e-03, 8.4760e-03],
         ...,
         [2.2405e-04, 9.3566e-04, 9.5362e-04,  ..., 3.3605e-04,
          9.5508e-04, 1.0436e-03],
         [1.2591e-03, 1.1041e-03, 9.5362e-04,  ..., 8.9035e-04,
          2.0223e-03, 2.1148e-03],
         [8.8802e-04, 8.9036e-04, 8.9035e-04,  ..., 2.6531e-03,
          1.3602e-03, 1.5603e-03]],

        [[4.3799e-03, 3.2956e-03, 7.1361e-03,  ..., 1.9130e-03,
          8.3504e-03, 7.2576e-03],
         [3.3374e-03, 4.0779e-03, 7.1361e-03,  ..., 2.2633e-03,
          3.5134e-03, 4.7238e-03],
         [1.5779e-03, 4.6522e-03, 4.0779e-03,  ..., 1.5820e-03,
          2.1281e-03, 4.6519e-03],
         ...,
         [6.7106e-04, 2.2405e-04, 1.5837e-04,  ..., 8.9505e-04,
          1.0198e-03, 7.8408e-04],
         [1.0965e-04, 1.2591e-03, 1.5837e-04,  ..., 1.4142e-03,
          5.2729e-04, 1.0261e-03],
         [8.8802e-04, 8.8802e-04, 5.8208e-11,  ..., 3.5207e-04,
          7.8547e-04, 5.0033e-04]],

        [[1.0065e-02, 1.0831e-02, 1.1507e-02,  ..., 7.9340e-03,
          2.6685e-03, 8.7706e-03],
         [1.1704e-02, 1.4186e-02, 1.1462e-02,  ..., 8.2497e-03,
          7.1411e-03, 8.5671e-03],
         [4.3567e-03, 4.6295e-03, 2.3756e-03,  ..., 4.3605e-03,
          6.7839e-03, 7.2576e-03],
         ...,
         [6.7106e-04, 7.3994e-04, 6.6398e-04,  ..., 1.0941e-03,
          5.5743e-04, 1.2468e-03],
         [1.0965e-04, 1.1842e-03, 6.6398e-04,  ..., 1.1201e-04,
          3.1882e-04, 2.4497e-04],
         [8.8802e-04, 1.0060e-03, 8.9476e-04,  ..., 1.4044e-03,
          1.3602e-03, 6.6317e-04]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:510.44952392578125
t:1, Finish constructing loss
require grad ? True True False
MatD grad and MatUx grad: torch.Size([56, 123]) torch.Size([56, 123, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-1.6302e-02,  1.0623e-01, -1.0333e-01,  1.2221e-01, -4.1544e-02,
         -3.5254e-02,  1.4887e-01, -2.3144e-01, -3.9906e-01, -4.9309e-01],
        [-3.3468e-01, -8.8209e+00, -4.0953e+00, -1.3295e+01, -1.1530e+01,
         -6.8548e+00, -3.8129e+00, -1.1963e+01,  2.0950e+01,  8.6866e+00],
        [-1.8514e+00, -1.0804e+01, -2.5170e+01, -1.5653e+01, -1.5729e+01,
         -1.8611e+01, -1.0701e+01, -1.1303e+01,  6.8147e+00, -8.1562e+00],
        [ 1.7357e+01, -6.8150e+01, -1.0112e+01,  6.5207e+00,  1.6405e+01,
         -4.9754e+01, -9.1911e-01,  4.9377e+01,  4.5807e+00, -3.5573e+01],
        [ 4.2013e+01, -4.1264e+01,  2.2276e+01,  3.5180e+00, -2.6060e+01,
          2.0113e+01, -4.5178e+01, -5.3648e+01,  3.4850e+01, -2.8826e+00],
        [ 6.4325e+01,  7.7061e+01, -1.0857e+01,  5.8405e+01, -1.0991e+01,
          1.1531e+01, -5.5712e+01, -5.5427e+01, -5.2488e+01, -1.8066e+01],
        [ 8.1279e+01, -5.0192e+01, -1.9981e+01, -4.3996e+01,  2.7116e+01,
          7.2307e+01, -3.7771e+01, -1.4249e+01, -4.4776e+01,  3.0237e+00],
        [ 9.6171e+01,  5.2467e+01, -2.3042e+01,  6.7487e+01,  2.8358e+01,
          9.9020e+00, -7.5048e+01, -3.8398e+01,  3.3513e+01,  3.5966e+01]]) 

MatU.grad[0:10,35:45]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 8.6128e+01, -1.1126e+02],
         [ 8.3424e+01,  9.9361e+01],
         [-2.7845e+01, -1.2619e+02],
         [ 1.1999e+02,  6.2373e+01],
         [ 1.0632e+02, -7.4080e+01],
         [-2.9087e+00,  1.8577e+01],
         [ 3.9238e+01, -3.2841e+01],
         [ 1.5818e+02,  2.0576e+01],
         [-9.6527e+01, -1.2804e+02],
         [-8.2197e+01, -1.3569e+02]],

        [[ 2.9477e+02,  2.5177e+02],
         [ 1.2094e+02, -1.8559e+02],
         [ 2.6040e+02,  2.6460e+02],
         [-1.0237e+02,  5.1079e+00],
         [ 2.8857e+02, -1.3109e+02],
         [-1.4505e+02,  9.3522e-01],
         [-1.1362e+02, -2.6581e+02],
         [ 3.8914e+02, -1.1434e+02],
         [-1.9215e+02, -3.6604e+02],
         [ 1.0009e+02, -1.2912e+02]],

        [[-6.8039e+02,  1.2481e+03],
         [-1.9196e+01, -8.8987e+02],
         [-7.7679e+02, -4.8469e+02],
         [-8.4904e+02,  6.0801e+02],
         [-7.7640e+02, -8.4421e+02],
         [ 1.3543e+01,  7.2074e+02],
         [-5.2578e+02, -7.3257e+01],
         [ 2.1103e+02, -7.5980e+02],
         [ 3.6992e+02,  1.4114e+03],
         [-2.5145e+02, -8.1999e+02]],

        [[ 3.9523e+02, -1.2357e+03],
         [ 6.6064e+01,  1.0911e+03],
         [-1.4511e+03, -1.2889e+03],
         [-2.4392e+02,  1.8500e+03],
         [ 1.3857e+03,  1.2445e+03],
         [-1.6982e+03,  1.2778e+02],
         [ 7.1776e+02,  2.1832e+02],
         [-2.0587e+02,  7.9455e+02],
         [-1.9741e+03, -5.0241e+02],
         [ 1.1464e+03,  9.5814e+02]],

        [[-6.0529e+02, -1.1726e+03],
         [-9.0977e+02, -7.4233e+02],
         [ 2.0449e+03,  6.8297e+02],
         [-6.4795e+02, -2.0373e+03],
         [ 4.1101e+02,  1.0698e+03],
         [-1.3740e+03,  1.4581e+03],
         [ 5.8141e+02, -6.0506e+02],
         [ 9.7966e+02, -7.3061e+02],
         [-6.1261e+02, -1.6203e+03],
         [ 6.4412e+02, -7.6886e+02]],

        [[-1.1342e+03,  1.5830e+03],
         [ 1.2828e+03,  7.7868e+02],
         [-1.8288e+03, -3.5627e+02],
         [ 1.7455e+03,  9.6430e+02],
         [ 7.7923e+01,  6.8008e+02],
         [-1.8764e+03, -4.0874e+02],
         [ 2.5922e+02, -1.4489e+03],
         [-1.1958e+02,  8.2114e+02],
         [ 9.5969e+01,  2.2151e+03],
         [ 9.4995e+02, -4.0531e+02]],

        [[ 1.1045e+03, -1.4373e+03],
         [-2.7136e+02,  1.6402e+03],
         [ 3.2293e+02, -1.3906e+03],
         [-3.8452e+02, -2.8098e+01],
         [ 1.2215e+02, -5.4756e+02],
         [-1.8690e+03,  3.1171e+02],
         [ 1.7109e+03, -2.6813e+02],
         [ 2.4449e+02,  2.1621e+01],
         [-6.9314e+02, -1.9681e+03],
         [-5.0242e+02,  1.2918e+03]]]) 

MatD.grad: 
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]]) 

MatU.grad[0:10,0:10]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 1.2112e+00,  5.2976e+01],
         [ 5.6884e+00, -1.0360e+02],
         [-5.1326e+01, -1.0515e+02],
         [ 6.6505e+01,  8.1008e+01],
         [ 3.1388e+01, -4.4783e+01],
         [-9.1666e+01,  2.9854e+01]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 4.2237e+00,  5.2803e+01],
         [-1.6581e+02, -1.3292e+01],
         [ 2.7036e+02,  7.2818e+01],
         [ 1.5782e+02, -2.4280e+01],
         [ 2.6022e+02,  2.5937e+02],
         [ 1.8770e+02,  2.8364e+02],
         [ 2.4749e+02,  1.6237e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 5.2978e+01, -7.1224e+01],
         [ 7.9981e+01,  7.1906e+01],
         [-1.0066e+03, -3.2365e+02],
         [ 9.6562e+02, -7.9455e+02],
         [-1.2397e+03,  5.4986e+02],
         [-1.2932e+03, -1.1671e+03],
         [ 9.0256e+02, -1.1450e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-2.2368e+01, -1.4847e+02],
         [-1.5807e+02,  2.7887e+02],
         [ 1.0960e+03,  1.0473e+03],
         [-5.7940e+02,  3.9781e+02],
         [-7.1236e+02, -1.1943e+03],
         [ 9.0540e+02, -1.7619e+03],
         [ 1.2975e+03,  1.1889e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-1.2923e+02,  2.2213e+01],
         [-7.9507e+01,  3.1926e+02],
         [ 5.2285e+02,  2.4295e+02],
         [ 1.2903e+03,  5.2688e+02],
         [-1.3294e+03,  1.3198e+03],
         [ 1.1734e+03,  1.4769e+02],
         [ 1.5549e+03,  4.4609e+02]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 5.3939e+01,  2.0362e+00],
         [-2.2290e+02,  6.0720e+01],
         [ 4.2285e+02, -1.5421e+03],
         [-1.1406e+03, -1.5821e+01],
         [ 1.5235e+03, -7.7530e+02],
         [ 1.2003e+03, -9.0238e+02],
         [-4.5397e+02, -1.5120e+03]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [-8.7269e+01,  7.5420e+01],
         [ 7.3790e+01,  1.9304e+02],
         [-7.2664e+02, -1.3818e+03],
         [-1.6323e+03,  4.5300e+02],
         [ 1.6681e+03,  1.0759e+03],
         [ 1.0219e+03,  9.2376e+02],
         [-1.7556e+02,  1.1626e+03]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[ -929.2838,  1758.8336],
         [ -604.1234,  1811.2947],
         [ -593.0837, -1107.8231],
         [-1037.9093, -1847.0641],
         [ 1165.1555,  1257.2023],
         [ 1312.1444,  -559.5079],
         [-1823.4476,   949.4288],
         [ -604.2584,  -409.8371],
         [-1213.5839,  1708.9149],
         [ -991.9110, -1602.8832]],

        [[-1134.2750,  -128.7643],
         [ -850.7352, -1059.2977],
         [-1207.7107, -1139.3165],
         [ 1837.9384,   474.1575],
         [ -629.3315,  -382.9450],
         [ -770.5947, -1577.7670],
         [  330.9274, -1153.6703],
         [ 2112.7849,   -95.0754],
         [ -945.7145,   273.7112],
         [ 1628.0127,  1227.1980]],

        [[ 1505.2902,  -900.0381],
         [ -626.1984, -1027.3844],
         [  539.5981,  1689.8618],
         [ 1109.7288,  -143.9356],
         [-1863.9882,   710.0773],
         [ -386.2581,  1314.3041],
         [ 1050.1064, -1353.8650],
         [-1099.5406,  -941.4712],
         [  385.2753,  -354.4811],
         [-1413.5490, -1349.7668]],

        [[ 1018.9397, -1103.7062],
         [ 1590.5463, -1053.3781],
         [-1403.5168,  -975.2192],
         [ 1468.2061,  1479.0745],
         [-1101.6628,   637.3289],
         [-2014.4124, -1025.2749],
         [ 1382.3522,   865.6622],
         [ -555.6136,  1311.0485],
         [-1225.5680,   -12.2084],
         [-1000.4780,  1421.8956]],

        [[ 1207.6400,   829.8890],
         [ 1196.0515,    49.9876],
         [-2013.8126,  -951.1765],
         [  481.6400, -1636.9983],
         [  955.7445,   369.6109],
         [ -574.1531, -1069.6655],
         [ 1675.9773, -1015.5588],
         [ 2117.4099,  -321.0023],
         [  665.1973,   973.5045],
         [ 1196.7820,   911.4139]],

        [[  186.8819,   -59.7952],
         [  203.3624,  1408.5701],
         [ 1288.4546,  -187.5845],
         [-1158.5430,  1897.7528],
         [ -205.7030,  -775.6096],
         [ -380.0876,  1010.1818],
         [-1484.7909,   840.3931],
         [  -54.1719,  1004.1252],
         [  850.4812,  -888.8406],
         [ 1817.9792,   885.9282]],

        [[-1467.2220,  1290.1010],
         [-1314.1302,  -735.8738],
         [  499.3725,  1474.9248],
         [ -432.0039,  1464.1121],
         [ 1430.0745,  -562.9626],
         [ -102.9760,   -97.5861],
         [-1115.9913, -1802.3529],
         [-1701.1473,   989.8983],
         [-1355.6718,   752.7761],
         [ -183.4534, -1147.3671]],

        [[   76.3948,  -701.9705],
         [ 1379.5952, -1011.3893],
         [  502.4484, -1109.9805],
         [ 1481.5702,  -574.6151],
         [-1365.5374,    25.6769],
         [ 1780.7574,  1019.5120],
         [ 1354.7871, -1561.4003],
         [-1447.7039,   187.7953],
         [  460.3894,   523.5038],
         [  592.8060,  1780.6775]],

        [[  381.0596,  -728.3362],
         [ 1148.2854,  1259.9200],
         [  674.7008, -2200.8564],
         [-1115.7211,   996.7673],
         [  -35.0365, -1385.4968],
         [-1068.4816,  1560.9207],
         [  490.2760,  1248.6005],
         [-1366.6158,  -133.8342],
         [ 1717.3030,  -911.3395],
         [  732.1702,  1483.8802]],

        [[ -526.1968,  -934.5710],
         [-2222.8618,  -723.1129],
         [ 1351.2596,  1944.8799],
         [  -52.2848, -1032.0001],
         [ -501.7323,  1205.1147],
         [ -857.0520, -1638.2616],
         [ -627.7014,  -878.4307],
         [  907.3080,   327.7264],
         [  697.0589, -1507.4657],
         [-1727.5100, -1449.9974]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[-4.5065e+01, -7.7781e+02],
         [-7.0010e+02, -1.4370e+03],
         [-7.3891e+02, -9.8420e+02],
         [ 1.2447e+03, -5.1510e+02],
         [-1.9256e+03, -2.1596e+02],
         [ 2.3850e+02, -7.7840e+02],
         [ 1.3208e+03, -1.4050e+02],
         [ 5.2048e+02,  9.2740e+02],
         [-3.0334e+02,  2.0036e+02],
         [-2.4969e+02, -5.8262e+02]],

        [[-6.2803e+02, -1.9394e+03],
         [-3.4972e+02, -7.7181e+01],
         [-2.4072e+02,  1.9027e+03],
         [-1.8063e+03, -1.4167e+03],
         [ 9.1251e+02,  1.5515e+03],
         [ 6.7881e+02,  7.0691e+02],
         [ 1.6541e+03, -2.2330e+02],
         [-1.9131e+02, -1.9158e+03],
         [-1.1896e+02,  1.6446e+03],
         [-3.3853e+02, -5.7465e+02]],

        [[ 7.8986e+02,  1.6967e+03],
         [-1.9209e+03, -2.7507e+02],
         [-1.7968e+02,  1.2238e+02],
         [ 7.5565e+02,  4.8171e+01],
         [ 6.0180e+02,  6.0329e+02],
         [-1.4585e+02, -1.2144e+03],
         [-1.0153e+03, -6.3311e+02],
         [ 1.9205e+03,  4.5615e+02],
         [-1.0895e+03,  1.7676e+03],
         [ 3.4309e+02,  1.1675e+03]],

        [[ 1.7508e+03,  9.7747e+02],
         [ 1.6010e+03,  1.4244e+03],
         [-3.1252e+01, -1.3270e+03],
         [ 1.3002e+03, -3.8884e+02],
         [-1.2541e+03,  1.2544e+03],
         [ 2.7246e+02, -1.1367e+03],
         [ 1.1454e+03, -5.6855e+01],
         [ 2.1697e+03, -4.1547e+02],
         [-1.5342e+03, -1.5225e+03],
         [-1.1240e+03, -4.9732e+02]],

        [[-1.4131e+03, -1.4605e+03],
         [-1.0974e+03, -1.5854e+02],
         [ 3.9924e+02,  1.7908e+03],
         [-1.5879e+03, -1.4197e+03],
         [-7.6235e+02,  4.7305e+02],
         [-1.0016e+03,  8.8506e+02],
         [-1.4982e+03,  3.0655e+02],
         [ 1.2881e+03,  6.0670e+02],
         [-4.2915e+01, -1.8876e+03],
         [ 6.4165e+02, -4.1223e+02]],

        [[-5.6058e+02,  1.8411e+03],
         [ 1.0905e+03, -8.5627e+02],
         [ 1.0600e+02, -2.4476e+01],
         [-2.2856e+03,  1.6572e+02],
         [ 3.8207e+02,  9.0236e+02],
         [ 9.9895e+02, -1.0679e+03],
         [ 7.1167e+02,  5.5726e+01],
         [-1.6812e+03,  5.1750e+02],
         [ 1.6707e+03,  9.7464e+01],
         [ 2.1332e+02,  1.4613e+03]],

        [[ 1.3545e+03, -2.5625e+02],
         [ 1.9383e+03, -1.3903e+01],
         [ 2.0475e+02, -1.8474e+03],
         [ 2.9667e+02, -6.8388e+02],
         [ 1.2140e+03,  1.2969e+03],
         [-2.6166e+02, -1.2894e+03],
         [ 1.2811e+03,  4.7676e+02],
         [-1.2888e+03, -1.5049e+03],
         [ 1.0541e+03,  1.8433e+03],
         [-3.6919e+02,  3.4769e+02]],

        [[ 1.3958e+03,  6.3008e+02],
         [-3.7296e+02,  1.4886e+03],
         [ 1.2503e+03, -4.3815e+02],
         [-1.5328e+03, -1.9350e+02],
         [-1.3441e+03,  1.2435e+03],
         [-8.0804e+02,  5.2709e+02],
         [-1.7649e+03, -3.7846e+01],
         [ 1.8973e+03,  1.0756e+03],
         [-4.8474e+02, -2.0853e+03],
         [ 6.9486e+02, -6.0764e+02]],

        [[-1.4034e+03, -9.0333e+02],
         [-1.3649e+03, -1.5216e+03],
         [ 1.0657e+03, -9.6994e+02],
         [-3.9113e+02, -4.8121e+02],
         [ 7.7098e+02,  1.3905e+01],
         [-7.4759e+02, -1.1280e+02],
         [ 9.8508e+02,  2.3492e+02],
         [-1.4714e+03,  3.9078e+02],
         [ 1.4877e+03, -4.3771e+02],
         [-2.8274e+02,  1.2526e+03]],

        [[ 1.5925e+03,  8.4440e+02],
         [-6.3950e+02, -9.4490e+02],
         [ 1.1250e+03,  8.7698e+02],
         [ 1.6526e+02, -2.1598e+03],
         [ 4.3432e+02, -1.3662e+03],
         [ 2.2321e+00, -3.0339e+02],
         [ 1.3805e+03, -1.3566e+01],
         [-1.9638e+03, -6.6295e+01],
         [ 1.9732e+03, -3.1068e+01],
         [-7.7565e+02,  2.1384e+02]]]) 

t:1, loss.item(): 10208.990234375
Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0156, 0.0154,  ..., 0.0123, 0.0094, 0.0093],
        [0.0159, 0.0161, 0.0154,  ..., 0.0123, 0.0100, 0.0091],
        [0.0164, 0.0156, 0.0161,  ..., 0.0118, 0.0098, 0.0088],
        ...,
        [0.0161, 0.0161, 0.0161,  ..., 0.0132, 0.0130, 0.0127],
        [0.0161, 0.0161, 0.0156,  ..., 0.0130, 0.0125, 0.0133],
        [0.0159, 0.0159, 0.0159,  ..., 0.0114, 0.0118, 0.0112]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[-2.4802e-04, -2.4038e-04,  1.0088e-03,  ..., -2.9117e-03,
         -1.7470e-04, -1.7470e-04],
        [ 2.5602e-04, -7.4442e-04,  1.2821e-03,  ..., -2.3457e-03,
         -9.0909e-04, -9.0909e-04],
        [-7.6844e-04,  5.0403e-04,  2.6441e-04,  ..., -1.9608e-03,
         -1.0320e-03, -1.0320e-03],
        ...,
        [ 1.0000e-10,  1.0000e-10, -2.5601e-04,  ..., -1.7088e-04,
         -3.2878e-04, -3.2878e-04],
        [ 1.0000e-10, -5.0403e-04,  5.0403e-04,  ..., -4.8701e-04,
          8.3333e-04,  8.3333e-04],
        [ 1.0000e-10,  1.0000e-10,  2.5602e-04,  ...,  4.0107e-04,
         -5.2875e-04, -5.2875e-04]], grad_fn=<SelectBackward>)  









test_counter in loss_omega_mat(): 688
test_counter in loss_omega_mat(): 1376
test_counter in loss_omega_mat(): 2064
test_counter in loss_omega_mat(): 2752
test_counter in loss_omega_mat(): 3440
test_counter in loss_omega_mat(): 4128
test_counter in loss_omega_mat(): 4816
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9459, 0.9459, 0.9458,  ..., 0.7567, 0.7566, 0.7565],
         [0.9459, 0.9459, 0.9459,  ..., 0.7571, 0.7567, 0.7566],
         [0.9459, 0.9459, 0.9458,  ..., 0.7571, 0.7570, 0.7565],
         ...,
         [0.9458, 0.9458, 0.9457,  ..., 0.7569, 0.7567, 0.7565],
         [0.9459, 0.9459, 0.9457,  ..., 0.7568, 0.7565, 0.7564],
         [0.9459, 0.9459, 0.9458,  ..., 0.7567, 0.7566, 0.7565]],

        [[0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7570, 0.7568],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7571],
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7572, 0.7571],
         ...,
         [0.9458, 0.9458, 0.9458,  ..., 0.7571, 0.7570, 0.7570],
         [0.9459, 0.9459, 0.9458,  ..., 0.7571, 0.7570, 0.7569],
         [0.9459, 0.9459, 0.9458,  ..., 0.7570, 0.7569, 0.7568]],

        [[0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7571, 0.7571],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7572, 0.7572],
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7572, 0.7571],
         ...,
         [0.9458, 0.9458, 0.9458,  ..., 0.7572, 0.7571, 0.7570],
         [0.9459, 0.9459, 0.9458,  ..., 0.7571, 0.7571, 0.7571],
         [0.9459, 0.9459, 0.9458,  ..., 0.7569, 0.7569, 0.7567]],

        ...,

        [[0.9459, 0.9459, 0.9454,  ..., 0.7545, 0.7543, 0.7506],
         [0.9459, 0.9459, 0.9459,  ..., 0.7553, 0.7515, 0.7507],
         [0.9459, 0.9458, 0.9458,  ..., 0.7552, 0.7538, 0.7508],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9458, 0.9458,  ..., 0.7572, 0.7572, 0.7572],
         [0.9459, 0.9459, 0.9457,  ..., 0.7570, 0.7543, 0.7542]],

        [[0.9412, 0.9354, 0.9339,  ..., 0.7493, 0.7491, 0.7469],
         [0.9413, 0.9342, 0.9339,  ..., 0.7497, 0.7495, 0.7456],
         [0.9425, 0.9417, 0.9342,  ..., 0.7529, 0.7522, 0.7460],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7573, 0.7572],
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7572, 0.7572],
         [0.9459, 0.9459, 0.9458,  ..., 0.7563, 0.7544, 0.7542]],

        [[0.9328, 0.9292, 0.9288,  ..., 0.7480, 0.7476, 0.7427],
         [0.9293, 0.9289, 0.9254,  ..., 0.7468, 0.7466, 0.7458],
         [0.9345, 0.9310, 0.9304,  ..., 0.7488, 0.7469, 0.7464],
         ...,
         [0.9459, 0.9458, 0.9457,  ..., 0.7572, 0.7567, 0.7566],
         [0.9459, 0.9457, 0.9457,  ..., 0.7568, 0.7567, 0.7566],
         [0.9459, 0.9458, 0.9456,  ..., 0.7552, 0.7543, 0.7542]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[7.3804e-08, 2.4598e-07, 2.0464e-07,  ..., 4.9733e-07,
          1.0311e-06, 4.3812e-08],
         [1.2581e-07, 3.6665e-08, 2.8991e-07,  ..., 9.7292e-07,
          1.1870e-07, 1.0290e-07],
         [6.5183e-08, 2.2914e-07, 1.2426e-06,  ..., 3.6990e-06,
          1.2664e-06, 1.9484e-07],
         ...,
         [5.8266e-08, 5.9399e-08, 7.8330e-08,  ..., 6.3868e-07,
          2.9675e-06, 3.5013e-07],
         [6.0865e-08, 3.1812e-08, 1.3919e-08,  ..., 8.6930e-07,
          3.3159e-08, 6.6991e-08],
         [6.1769e-10, 4.5759e-08, 5.5932e-07,  ..., 3.1719e-06,
          2.8715e-06, 1.3979e-08]],

        [[1.5752e-10, 2.0059e-09, 3.8754e-07,  ..., 1.4812e-07,
          7.1372e-07, 1.3448e-08],
         [2.9840e-09, 2.2951e-08, 5.3981e-07,  ..., 1.2980e-06,
          2.6513e-07, 4.8940e-07],
         [5.4655e-08, 5.4534e-08, 4.3851e-07,  ..., 1.3598e-07,
          1.8148e-06, 8.7210e-07],
         ...,
         [7.1326e-07, 1.9469e-06, 7.3188e-09,  ..., 1.4607e-06,
          1.8126e-06, 2.5019e-06],
         [1.2734e-07, 2.9610e-08, 2.8180e-08,  ..., 4.0504e-07,
          6.6324e-07, 6.2224e-07],
         [9.6094e-09, 6.2655e-08, 1.2652e-07,  ..., 9.3858e-07,
          4.6346e-09, 4.5558e-07]],

        [[2.3470e-08, 6.0676e-09, 1.6996e-08,  ..., 1.9907e-06,
          2.5934e-07, 5.8077e-07],
         [3.0103e-08, 3.9759e-10, 2.0282e-09,  ..., 3.2901e-08,
          4.3242e-09, 1.8399e-06],
         [1.0416e-07, 4.9402e-07, 8.9955e-10,  ..., 2.3828e-07,
          2.3140e-06, 2.4801e-06],
         ...,
         [3.9055e-08, 9.8501e-07, 8.4810e-08,  ..., 2.7861e-07,
          1.7858e-06, 4.4247e-06],
         [1.7080e-07, 4.5556e-07, 4.8240e-07,  ..., 7.1881e-07,
          9.7697e-07, 8.0158e-08],
         [3.0277e-08, 7.3253e-07, 3.0025e-08,  ..., 3.2414e-06,
          6.4028e-09, 7.2890e-07]],

        ...,

        [[1.2471e-07, 8.8621e-09, 3.1030e-08,  ..., 2.2218e-07,
          4.5919e-06, 1.6927e-05],
         [3.2796e-08, 2.1282e-08, 2.3768e-08,  ..., 3.0883e-09,
          2.1494e-08, 1.4774e-05],
         [1.6971e-07, 4.1189e-07, 4.8018e-07,  ..., 7.4339e-06,
          1.1961e-06, 1.5501e-05],
         ...,
         [2.1257e-07, 8.2734e-07, 8.7981e-07,  ..., 4.3527e-07,
          2.1075e-06, 4.9946e-07],
         [4.1979e-08, 8.4694e-07, 9.0721e-07,  ..., 1.5043e-06,
          8.4900e-08, 5.8863e-08],
         [3.7101e-08, 3.6042e-08, 1.3041e-07,  ..., 6.0308e-07,
          5.1864e-07, 2.4687e-07]],

        [[1.4575e-07, 1.7204e-05, 1.1487e-05,  ..., 1.1021e-06,
          6.8252e-07, 4.7387e-05],
         [2.5675e-08, 4.3287e-06, 7.5446e-06,  ..., 1.2112e-06,
          5.5063e-05, 3.8406e-06],
         [1.5164e-07, 1.7167e-08, 1.8971e-07,  ..., 3.0925e-05,
          3.6326e-06, 5.0188e-05],
         ...,
         [1.3235e-07, 1.5381e-08, 2.1486e-08,  ..., 6.2837e-07,
          2.9759e-07, 1.4431e-07],
         [1.5783e-07, 2.6589e-08, 1.3201e-07,  ..., 2.6770e-07,
          3.2276e-09, 8.6859e-07],
         [3.7666e-09, 1.1041e-07, 5.7047e-09,  ..., 1.4087e-06,
          1.7870e-07, 9.5618e-07]],

        [[2.6903e-05, 1.3105e-04, 1.3678e-05,  ..., 2.4856e-05,
          2.6298e-04, 2.1064e-05],
         [9.6128e-05, 2.7856e-05, 2.7647e-04,  ..., 1.6467e-04,
          6.0872e-04, 1.0849e-05],
         [2.2240e-05, 2.8211e-08, 2.2356e-05,  ..., 3.2702e-05,
          2.2949e-05, 1.4104e-06],
         ...,
         [9.8914e-08, 6.4963e-07, 1.5189e-07,  ..., 1.9068e-06,
          1.6938e-06, 3.6478e-07],
         [2.0019e-08, 5.5453e-08, 2.8501e-07,  ..., 2.9871e-06,
          1.0894e-07, 2.4024e-06],
         [1.3809e-07, 1.1776e-07, 3.6670e-09,  ..., 4.0419e-07,
          1.9398e-08, 3.9864e-07]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[2.5601e-04, 7.8743e-04, 4.1909e-04,  ..., 1.1536e-03,
          7.7701e-04, 4.1575e-04],
         [2.5601e-04, 6.2331e-04, 6.9077e-04,  ..., 1.1649e-03,
          5.2831e-04, 4.9894e-04],
         [4.6441e-04, 4.1507e-04, 5.8795e-04,  ..., 4.0252e-04,
          9.6291e-04, 2.4427e-04],
         ...,
         [3.3651e-04, 5.8466e-04, 5.8828e-04,  ..., 6.2126e-04,
          3.3080e-04, 1.1540e-03],
         [5.0608e-04, 2.1629e-04, 5.3936e-04,  ..., 3.6084e-04,
          4.9505e-04, 9.1398e-04],
         [1.3038e-04, 4.3352e-04, 4.5306e-04,  ..., 9.2939e-04,
          6.8744e-04, 4.7702e-04]],

        [[3.6375e-04, 3.3243e-04, 4.1909e-04,  ..., 9.0806e-04,
          4.3384e-04, 2.7512e-04],
         [2.3850e-04, 3.3243e-04, 6.9077e-04,  ..., 2.7003e-04,
          2.1278e-04, 7.9842e-04],
         [4.6441e-04, 2.9225e-04, 3.5506e-04,  ..., 7.5417e-05,
          4.4130e-04, 3.3929e-04],
         ...,
         [1.4798e-04, 4.4274e-04, 5.8466e-04,  ..., 4.0324e-04,
          6.7743e-05, 3.4408e-04],
         [3.6762e-04, 2.1629e-04, 3.0113e-04,  ..., 2.1957e-04,
          1.9917e-04, 4.9536e-04],
         [3.3900e-04, 4.3352e-04, 3.8041e-04,  ..., 5.1653e-04,
          7.1781e-04, 1.7086e-04]],

        [[3.6375e-04, 1.3831e-04, 5.6820e-04,  ..., 4.0875e-04,
          1.0813e-03, 6.4205e-04],
         [2.3850e-04, 1.3831e-04, 5.5066e-04,  ..., 7.0219e-04,
          3.6497e-04, 5.7270e-04],
         [2.9225e-04, 5.7327e-04, 4.9314e-04,  ..., 7.0690e-04,
          4.5381e-04, 4.1450e-04],
         ...,
         [6.5547e-04, 1.4798e-04, 3.5106e-04,  ..., 4.5629e-05,
          1.9648e-04, 5.1653e-04],
         [2.3344e-04, 3.6762e-04, 3.1006e-04,  ..., 1.2835e-03,
          3.1401e-04, 2.4205e-04],
         [3.3900e-04, 2.5756e-04, 7.3946e-04,  ..., 3.3680e-04,
          1.0624e-03, 7.5479e-04]],

        ...,

        [[5.2307e-04, 3.9022e-04, 5.1625e-04,  ..., 6.2721e-04,
          2.2515e-03, 9.0134e-03],
         [5.2307e-04, 7.8557e-04, 4.0223e-04,  ..., 4.1023e-04,
          2.6810e-03, 7.5941e-03],
         [7.8557e-04, 6.1055e-04, 7.4629e-04,  ..., 4.1242e-03,
          3.1802e-03, 8.4511e-03],
         ...,
         [3.1851e-04, 9.9542e-04, 1.0197e-03,  ..., 5.9999e-04,
          7.9641e-04, 3.6935e-04],
         [7.3052e-04, 1.0024e-03, 1.0454e-03,  ..., 7.1387e-04,
          1.5032e-03, 1.3833e-03],
         [5.3094e-04, 3.9323e-04, 5.4131e-04,  ..., 1.6912e-03,
          4.1099e-04, 7.9850e-04]],

        [[3.8861e-03, 3.2583e-03, 6.1373e-03,  ..., 9.4174e-04,
          7.6738e-03, 6.2442e-03],
         [2.4729e-03, 2.7412e-03, 6.1373e-03,  ..., 1.2912e-03,
          2.5427e-03, 3.9577e-03],
         [7.3873e-04, 4.2045e-03, 2.7412e-03,  ..., 6.5969e-03,
          1.4891e-03, 4.6182e-03],
         ...,
         [3.1851e-04, 9.8408e-04, 5.2934e-04,  ..., 5.1697e-04,
          1.2515e-03, 1.3225e-03],
         [7.3052e-04, 4.6855e-04, 5.2934e-04,  ..., 8.2250e-04,
          4.2940e-04, 2.0546e-04],
         [4.8909e-04, 5.3094e-04, 1.4076e-04,  ..., 3.8187e-04,
          1.4903e-04, 7.7696e-04]],

        [[9.0839e-03, 9.5529e-03, 1.0254e-02,  ..., 6.6724e-03,
          2.4177e-03, 7.5824e-03],
         [1.0785e-02, 1.3369e-02, 1.5257e-02,  ..., 6.4976e-03,
          8.2257e-03, 6.3497e-03],
         [3.3689e-03, 3.2326e-03, 1.4371e-03,  ..., 3.5029e-03,
          6.2442e-03, 5.6946e-03],
         ...,
         [9.8408e-04, 9.0255e-04, 9.2398e-04,  ..., 6.2653e-04,
          5.8035e-04, 5.0912e-04],
         [4.6855e-04, 1.1952e-03, 9.2398e-04,  ..., 4.2671e-04,
          6.2057e-04, 4.4240e-04],
         [4.8909e-04, 4.6589e-04, 3.6078e-04,  ..., 5.0878e-04,
          4.6353e-04, 2.8060e-04]]], grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:425.71337890625
t:2, Finish constructing loss
require grad ? True True False
MatD grad and MatUx grad: torch.Size([56, 123]) torch.Size([56, 123, 2]) 

Grads has nan? MatD.grad: False 	MatU.grad: False

Where is nan? 
MatD.grad nan: 
tensor([], size=(0, 2), dtype=torch.int64) 
MatU.grad nan: 
tensor([], size=(0, 3), dtype=torch.int64)

MatD.grad[0:10,35:45]: 
tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
          0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-1.5929e-02,  1.3298e-01, -5.1363e-02,  9.9917e-02, -4.4484e-02,
         -5.4882e-02,  2.3072e-01, -2.1891e-01, -3.4732e-01, -5.0288e-01],
        [-6.6986e-01, -4.5418e+00, -8.2211e-01, -8.2973e+00, -8.6820e+00,
         -9.9242e-01,  6.8678e+00, -1.3314e+01,  2.2235e+01,  3.7118e+00],
        [ 4.9910e+00, -2.1322e+00, -1.4836e+01, -1.0410e+01, -8.2102e+00,
         -1.3781e+01, -6.8163e+00,  6.5718e+00, -8.1348e+00, -3.4224e+00],
        [ 1.4089e+00, -5.1024e+01, -4.5765e+01,  1.4716e+01, -6.7057e+00,
         -6.2477e+01,  1.4586e+01, -1.5336e+00,  3.4934e+01, -4.8937e+00],
        [ 3.2189e+01, -3.9898e+01, -4.0899e+01,  1.0841e+01, -2.0659e+01,
         -2.3487e+01, -1.0226e+01, -6.2055e+01, -8.0551e+01,  1.5684e+01],
        [ 6.4488e+01,  6.7452e+01,  2.9946e+01,  3.3752e+01, -5.4098e+00,
         -2.6056e+01, -2.8233e+01, -4.9832e+01, -6.4175e+01,  2.9779e+01],
        [ 8.8225e+01, -2.8609e+01, -1.3391e+01, -2.6471e+00,  4.0318e+00,
          7.5437e+01,  3.6074e+00,  1.4357e+01, -2.9294e+01,  3.8920e+01],
        [ 1.0288e+02,  3.6040e+01, -4.2866e+01,  4.5758e+01, -5.6973e+00,
          7.0247e+00, -8.2328e+01, -4.5133e+01, -1.6212e+01, -2.6846e+00]]) 

MatU.grad[0:10,35:45]: 
tensor([[[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00]],

        [[ 1.1903e+02, -8.5160e+01],
         [-1.0872e+02,  1.0317e+02],
         [ 9.8516e+01,  3.4617e+01],
         [-5.8751e+01, -1.0064e+02],
         [-9.5733e+01, -1.0018e+02],
         [-9.9276e+01, -1.1589e+02],
         [ 1.9022e+01,  6.4295e+01],
         [ 1.5587e+02,  3.1136e+01],
         [-6.4083e+01, -1.3339e+02],
         [-9.1354e+01, -1.1489e+02]],

        [[ 3.6012e+02, -4.5555e+01],
         [ 2.8239e+02, -2.3511e+02],
         [ 1.3482e+02,  9.9639e+01],
         [-2.4845e+02, -3.5278e+02],
         [-1.1114e+02, -5.9619e+01],
         [ 2.5735e+01,  2.6179e+02],
         [-1.0187e+02, -2.8408e+02],
         [ 1.9935e+02, -1.4597e+02],
         [-8.6116e+01, -2.9928e+02],
         [-2.2716e+02,  7.1891e+00]],

        [[-2.3612e+02,  8.3708e+02],
         [-1.1474e+03, -3.1174e+02],
         [ 3.1585e+02, -7.3846e+02],
         [-5.1305e+02,  7.2846e+02],
         [-7.6481e+02,  5.7361e+01],
         [ 1.0416e+03, -4.7054e+02],
         [ 1.2266e+02,  9.5327e+02],
         [ 8.1348e+02, -1.1760e+03],
         [-9.4952e+02, -1.7178e+02],
         [ 5.9676e+02,  1.0321e+02]],

        [[-1.4309e+03,  9.3446e+01],
         [-1.4934e+03,  9.5949e+02],
         [-1.3795e+03, -1.0043e+03],
         [ 3.6223e+02,  1.9103e+03],
         [ 1.3416e+03,  1.1322e+03],
         [-1.7070e+03,  2.9821e+02],
         [-4.9010e+02,  8.1858e+02],
         [-7.6621e+02, -3.1665e+02],
         [-1.2556e+03,  7.1892e+02],
         [ 6.7210e+02,  6.3310e+02]],

        [[-4.1005e+02, -7.0778e+02],
         [ 3.9497e+02, -1.6945e+02],
         [ 2.1359e+03,  2.9608e+02],
         [-4.2193e+02, -2.0819e+03],
         [-5.8155e+01,  2.8137e+02],
         [-1.3702e+03,  1.4529e+03],
         [-5.0102e+02, -5.8987e+02],
         [ 4.8126e+02,  6.9760e+02],
         [ 1.0584e+03, -7.9505e+02],
         [-8.5297e+02, -9.4041e+01]],

        [[-8.2978e+02,  1.0701e+03],
         [ 3.5618e+02,  1.5676e+03],
         [-1.4124e+03, -7.1883e+02],
         [ 1.7777e+03,  7.1505e+02],
         [-6.1626e+02,  8.3259e+02],
         [-1.8865e+03,  4.3470e+01],
         [-1.2044e+02, -1.1549e+03],
         [ 1.0770e+03, -8.0946e+02],
         [-4.8147e+02,  2.1088e+03],
         [-2.1875e+01, -2.7231e+02]],

        [[ 4.4417e+02, -1.2489e+03],
         [-1.5922e+03,  1.1726e+03],
         [ 8.6515e+02,  1.2227e+02],
         [-2.2074e+02, -1.2694e+03],
         [ 6.2434e+02,  7.4048e+02],
         [-1.9247e+03, -1.9420e+02],
         [ 1.5886e+03, -1.6792e+02],
         [-5.7088e+02, -6.9443e+02],
         [ 1.5767e+00, -1.9773e+03],
         [-1.2898e+02,  9.2737e+02]]]) 

MatD.grad: 
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        ...,
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]]) 

MatU.grad[0:10,0:10]: 
tensor([[[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [  -29.2614,    44.1541],
         [   61.5753,   -88.8114],
         [  -82.9692,    32.8523],
         [  104.4243,    70.8230],
         [  140.0770,   -69.7692],
         [  -92.5927,  -128.8225]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [  -44.3220,    28.9924],
         [ -144.0844,    80.8425],
         [  255.6377,   -35.1956],
         [  104.0524,   242.9399],
         [  131.1609,   260.8266],
         [   53.0908,   264.2129],
         [   55.1322,   123.5415]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [   96.0461,    11.8248],
         [ -178.5318,   128.0412],
         [ -308.0171, -1083.7833],
         [  543.2162, -1328.9655],
         [-1095.7533,  1122.0544],
         [ -891.1133, -1132.9722],
         [  611.3145, -1136.2780]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [   89.4938,   -89.5174],
         [ -308.5127,    40.2631],
         [  200.1677,    60.2030],
         [ 1383.5054,   835.3442],
         [-1387.8436,  -723.3788],
         [  694.2355, -1062.3568],
         [ 1140.4888,   355.6563]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [  101.1113,    71.4930],
         [ -313.3785,   126.7316],
         [  744.0271,  1381.5844],
         [  427.0848,  1300.0967],
         [-1646.5895,   272.7578],
         [  780.3062,  2003.7656],
         [  718.0777,  1495.4600]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [   11.4222,  -142.2903],
         [ -119.3563,  -303.0192],
         [ 1242.8444,  -982.8931],
         [ -660.7536, -1017.2682],
         [  418.3636, -1424.1796],
         [ 1201.4812, -1190.9915],
         [-1588.9226, -1226.5874]],

        [[    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [    0.0000,     0.0000],
         [  -76.0804,    64.8557],
         [  351.1382,    25.8179],
         [-1273.0001, -1071.9896],
         [ -888.1399,  1593.2627],
         [  619.4241,   491.4821],
         [ 1798.1337,   402.0253],
         [-1863.9949,   509.8658]]]) 

MatU.grad[10:20,10:20]: 
tensor([[[ 8.3924e+01,  8.5763e+02],
         [-6.6837e+02,  8.7405e+02],
         [-1.9879e+03, -4.0155e+02],
         [-1.4173e+03, -3.8918e+01],
         [ 6.3607e+02,  9.5912e+02],
         [-5.0735e+01,  1.4909e+03],
         [-9.9175e+02,  9.4086e+02],
         [-1.0913e+03,  1.6237e+03],
         [-2.2533e+02,  1.3489e+03],
         [ 1.2299e+03,  7.0754e+02]],

        [[-3.8772e+01, -1.9688e+03],
         [-3.9091e+02, -7.6402e+02],
         [-7.8476e+02, -1.5248e+02],
         [ 7.2565e+02,  1.6215e+03],
         [ 1.4326e+03,  1.2222e+03],
         [-1.2921e+03, -4.2796e+02],
         [ 1.6712e+03, -6.8320e+02],
         [ 4.7316e+02, -1.7234e+03],
         [ 1.3507e+03,  8.9637e+02],
         [ 9.5338e+02, -9.8611e+02]],

        [[ 1.4058e+03, -5.3202e+02],
         [-1.6971e+03, -3.1522e+01],
         [ 1.6124e+03,  1.0741e+03],
         [ 9.8099e+02, -1.8286e+03],
         [-6.6885e+02, -1.8840e+03],
         [-1.2177e+03, -1.0490e+03],
         [ 4.6684e+02,  7.6032e+02],
         [-1.1561e+02, -9.4429e+02],
         [-1.7587e+03, -1.1465e+03],
         [-1.2990e+03,  1.9401e+01]],

        [[ 1.9262e+03, -9.0873e+00],
         [ 5.6355e+02,  9.1504e+01],
         [-1.7192e+03, -3.8881e+02],
         [ 3.1809e+02,  1.3635e+03],
         [-1.0298e+03,  1.6388e+03],
         [-9.2433e+02,  8.1043e+02],
         [-5.0290e+02, -1.3328e+03],
         [-1.3904e+03,  1.0249e+03],
         [ 9.9393e+02,  1.9452e+03],
         [-6.7062e+02,  1.0121e+03]],

        [[ 8.1775e+02,  1.4166e+03],
         [ 7.9075e+02, -1.9037e+03],
         [-1.1768e+03, -1.8692e+02],
         [ 1.5148e+03, -8.2709e-01],
         [ 1.1322e+03, -1.3041e+03],
         [-1.3273e+03, -1.4652e+02],
         [ 6.2885e+02, -4.2947e+02],
         [ 1.4783e+03, -1.4879e+03],
         [ 1.3812e+03,  2.4131e+02],
         [-1.0233e+03,  4.0638e+02]],

        [[-1.1011e+03, -1.7228e+03],
         [ 1.6525e+03,  1.3347e+03],
         [-2.1096e+02, -1.7937e+03],
         [-1.3019e+03,  1.2402e+03],
         [ 1.5875e+03, -8.6915e+02],
         [-1.5096e+03, -1.0650e+03],
         [-9.5767e+02,  1.8112e+03],
         [ 1.4332e+03,  5.6801e+02],
         [ 1.1324e+03, -7.8502e+02],
         [-3.5146e+02, -1.1186e+03]],

        [[-5.9864e+02,  1.7872e+03],
         [-5.7876e+02, -6.1002e+02],
         [ 1.2192e+03,  1.0966e+03],
         [-1.7674e+03,  8.3751e+02],
         [ 1.3680e+02,  1.3909e+03],
         [ 1.2139e+03,  1.8057e+03],
         [-1.0929e+03, -8.1887e+02],
         [-8.8150e+02,  8.8174e+02],
         [-7.3412e+02,  1.2404e+03],
         [ 1.4482e+03,  1.4244e+03]],

        [[-1.6743e+03, -3.7233e+02],
         [ 1.2988e+03, -4.6204e+02],
         [ 1.6230e+03, -7.2099e+02],
         [-3.9439e+01, -1.3795e+03],
         [-5.7614e+02, -1.3879e+03],
         [ 1.3521e+03,  7.1306e+02],
         [ 1.1496e+03, -9.8086e+02],
         [-5.3261e+02, -1.1997e+03],
         [ 1.5130e+03, -1.3303e+03],
         [-1.3710e+03,  3.8901e+02]],

        [[-1.8574e+03,  5.0100e+01],
         [ 9.9075e+02,  1.3741e+03],
         [ 2.2207e+02, -2.2636e+03],
         [-1.1463e+03,  7.2178e+02],
         [ 1.2369e+03, -7.9506e+02],
         [-6.9710e+02,  2.7802e+02],
         [-1.9946e+03,  3.4489e+02],
         [-1.9717e+02,  2.1009e+03],
         [ 8.2161e+02, -1.6223e+03],
         [ 1.2848e+03,  8.0396e+02]],

        [[-5.4916e+02, -1.7773e+02],
         [-2.2906e+03,  3.7903e+01],
         [ 1.2260e+03,  2.0236e+03],
         [-1.7027e+03, -2.4631e+02],
         [ 8.5195e+02,  9.0270e+02],
         [-1.0129e+02,  2.0015e+02],
         [-1.3508e+03, -1.2139e+03],
         [-1.1076e+03,  1.5463e+03],
         [ 8.7300e+02,  6.6075e+02],
         [-8.8959e+02, -8.6915e+02]]]) 

MatU.grad[20:30,20:30]:  
tensor([[[-1886.3561,  -672.4841],
         [ -923.8141,   524.7026],
         [ 1342.4227,   956.1412],
         [   -6.2433, -1340.2186],
         [-1626.6494,  1233.8782],
         [  702.2946,  -567.8066],
         [ 1304.0287,  -184.3368],
         [  220.4565,   823.7961],
         [  101.0589,   260.8847],
         [  764.0848,  -388.5935]],

        [[ 1243.8096,  -785.0452],
         [ -449.8381, -1859.9545],
         [-1499.4224,   702.2261],
         [ -966.8561, -1211.1946],
         [-1129.6632,  -588.0151],
         [ -518.9979,   362.7748],
         [ 1628.9958,    15.4036],
         [  -57.4580, -1920.6750],
         [  146.8847,  1593.6104],
         [ -437.5677,  -275.3351]],

        [[ -536.8846,  1129.3730],
         [-1015.8561,  1322.9042],
         [-1426.7423, -1705.6531],
         [  753.8270,  1655.8571],
         [  761.4581,   628.5442],
         [  665.2524,  -775.7004],
         [ -476.5118,  -341.5250],
         [ 1914.1737,   345.1756],
         [-1055.0924,  1766.0500],
         [  -78.4994,   800.0987]],

        [[ 1437.7004,  -472.5414],
         [  396.8451,   806.9839],
         [ 1685.2657,  1191.8295],
         [  691.2852, -1162.1219],
         [ -928.0750,   319.3217],
         [  920.9066,  -340.7707],
         [ 1037.5745,  -421.9963],
         [ 2176.1484,  -340.2763],
         [-1523.2268, -1510.5411],
         [ -232.5336,  -405.5216]],

        [[  983.2236,   352.6746],
         [  718.9243, -1598.4222],
         [-1429.3011,   722.4105],
         [ -310.4308,  -865.2579],
         [ -945.5515,  1402.2659],
         [ -565.5789,  1078.4292],
         [-1018.8040,   222.8563],
         [ 1284.7677,   516.6315],
         [   35.8729, -1874.0848],
         [  301.3705,   220.2865]],

        [[ -452.6981,  1124.3002],
         [    8.1242,  1858.3096],
         [-1110.5995, -1555.8796],
         [-1868.2035,  1124.4146],
         [-1658.2745, -1121.2930],
         [  633.2314,   -97.3341],
         [  600.8940,  -494.4673],
         [-1634.5835,   291.6024],
         [ 1652.0999,    23.3402],
         [ -595.0315,  1196.5176]],

        [[  425.1673,  1664.2166],
         [  -15.5224, -1807.9709],
         [ 1938.8978,  -349.9023],
         [ 1710.8193, -1112.4297],
         [  261.6339,   471.5176],
         [-1091.9706,  -270.7008],
         [ 1222.6384,   541.0962],
         [-1264.2971, -1504.3247],
         [ 1030.1281,  1838.7419],
         [  405.1431,   260.1100]],

        [[ -456.7135, -1748.8187],
         [-1320.4209,   462.5541],
         [   35.5785,  1570.1967],
         [  841.3787,  1549.8054],
         [ -422.4442,  -809.6060],
         [   66.3947, -1178.7690],
         [-1792.7336,   452.0950],
         [ 1898.7689,  1049.8879],
         [ -443.5732, -2079.5527],
         [  461.7935,   501.9126]],

        [[ -972.3858, -1289.1530],
         [ -731.8376,  -546.3981],
         [ -133.7980,   849.6051],
         [-1287.5414, -1435.4285],
         [  399.7278,   945.1318],
         [  624.1839,   974.9557],
         [  965.5657,  -347.2349],
         [-1446.1685,     6.1261],
         [ 1455.9622,  -336.1475],
         [ -104.8011,  1192.0869]],

        [[  887.0430,  1501.3243],
         [ 1488.3131,  -793.4039],
         [ -404.3112,   -48.5612],
         [  974.1252, -1792.4995],
         [ 1353.2571,  -164.9424],
         [-1232.8633,   -86.0663],
         [ 1237.4705,  -364.2273],
         [-1963.1151,   -73.2527],
         [ 1964.6538,    33.3167],
         [ -246.4074,   600.6544]]]) 

t:2, loss.item(): 8514.267578125
Optimized result :
MatD: 
has nan? False 
tensor([[0.0159, 0.0156, 0.0154,  ..., 0.0123, 0.0094, 0.0093],
        [0.0159, 0.0161, 0.0154,  ..., 0.0123, 0.0100, 0.0091],
        [0.0164, 0.0156, 0.0161,  ..., 0.0118, 0.0098, 0.0088],
        ...,
        [0.0161, 0.0161, 0.0161,  ..., 0.0132, 0.0130, 0.0127],
        [0.0161, 0.0161, 0.0156,  ..., 0.0130, 0.0125, 0.0133],
        [0.0159, 0.0159, 0.0159,  ..., 0.0114, 0.0118, 0.0112]],
       requires_grad=True) 

MatUx: 
 has nan? False 
tensor([[-2.4802e-04, -2.4038e-04,  1.0088e-03,  ..., -2.9117e-03,
         -1.7470e-04, -1.7470e-04],
        [ 2.5602e-04, -7.4442e-04,  1.2821e-03,  ..., -2.3457e-03,
         -9.0909e-04, -9.0909e-04],
        [-7.6844e-04,  5.0403e-04,  2.6441e-04,  ..., -1.9608e-03,
         -1.0320e-03, -1.0320e-03],
        ...,
        [ 1.0000e-10,  1.0000e-10, -2.5601e-04,  ..., -1.7088e-04,
         -3.2878e-04, -3.2878e-04],
        [ 1.0000e-10, -5.0403e-04,  5.0403e-04,  ..., -4.8701e-04,
          8.3333e-04,  8.3333e-04],
        [ 1.0000e-10,  1.0000e-10,  2.5602e-04,  ...,  4.0107e-04,
         -5.2875e-04, -5.2875e-04]], grad_fn=<SelectBackward>)  









test_counter in loss_omega_mat(): 688
test_counter in loss_omega_mat(): 1376
test_counter in loss_omega_mat(): 2064
test_counter in loss_omega_mat(): 2752
test_counter in loss_omega_mat(): 3440
test_counter in loss_omega_mat(): 4128
test_counter in loss_omega_mat(): 4816
mat_omega_topk has nan? False 

mat_duij has nan? False 

mat_uij has nan? False 

mat_omega_topk: 
tensor([[[0.9459, 0.9459, 0.9459,  ..., 0.7564, 0.7563, 0.7562],
         [0.9459, 0.9459, 0.9459,  ..., 0.7571, 0.7565, 0.7563],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7568, 0.7561],
         ...,
         [0.9459, 0.9459, 0.9457,  ..., 0.7570, 0.7563, 0.7560],
         [0.9458, 0.9458, 0.9457,  ..., 0.7568, 0.7560, 0.7557],
         [0.9459, 0.9459, 0.9458,  ..., 0.7563, 0.7560, 0.7558]],

        [[0.9459, 0.9459, 0.9459,  ..., 0.7570, 0.7566, 0.7565],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7573],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7571, 0.7571, 0.7571],
         [0.9459, 0.9458, 0.9458,  ..., 0.7572, 0.7572, 0.7569],
         [0.9459, 0.9459, 0.9459,  ..., 0.7570, 0.7566, 0.7564]],

        [[0.9459, 0.9459, 0.9458,  ..., 0.7573, 0.7568, 0.7567],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7573, 0.7573],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7572, 0.7571],
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7572, 0.7571],
         [0.9459, 0.9459, 0.9458,  ..., 0.7571, 0.7566, 0.7566]],

        ...,

        [[0.9458, 0.9458, 0.9452,  ..., 0.7549, 0.7537, 0.7498],
         [0.9458, 0.9458, 0.9458,  ..., 0.7549, 0.7509, 0.7500],
         [0.9458, 0.9458, 0.9457,  ..., 0.7550, 0.7536, 0.7498],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7574, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7573, 0.7542, 0.7542]],

        [[0.9413, 0.9355, 0.9354,  ..., 0.7485, 0.7478, 0.7466],
         [0.9417, 0.9354, 0.9353,  ..., 0.7490, 0.7486, 0.7446],
         [0.9432, 0.9423, 0.9353,  ..., 0.7525, 0.7518, 0.7454],
         ...,
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7574, 0.7573, 0.7573],
         [0.9459, 0.9459, 0.9459,  ..., 0.7562, 0.7543, 0.7541]],

        [[0.9321, 0.9283, 0.9278,  ..., 0.7455, 0.7452, 0.7410],
         [0.9293, 0.9283, 0.9246,  ..., 0.7457, 0.7450, 0.7432],
         [0.9328, 0.9312, 0.9303,  ..., 0.7475, 0.7466, 0.7448],
         ...,
         [0.9459, 0.9459, 0.9458,  ..., 0.7572, 0.7566, 0.7564],
         [0.9459, 0.9458, 0.9458,  ..., 0.7567, 0.7565, 0.7563],
         [0.9459, 0.9458, 0.9458,  ..., 0.7549, 0.7542, 0.7538]]],
       grad_fn=<SliceBackward>) 

mat_duij: 
tensor([[[7.1971e-08, 1.1321e-07, 8.0001e-09,  ..., 9.3780e-08,
          5.1246e-08, 3.5116e-07],
         [1.6123e-07, 6.7800e-08, 2.0693e-09,  ..., 5.1271e-07,
          6.3506e-08, 2.6408e-07],
         [7.0696e-08, 1.9001e-08, 2.1743e-07,  ..., 1.0317e-06,
          1.1067e-08, 9.0433e-08],
         ...,
         [6.1180e-09, 1.4395e-08, 1.6194e-07,  ..., 7.0286e-10,
          6.6597e-08, 1.7871e-06],
         [2.5660e-07, 3.7890e-08, 6.4471e-07,  ..., 9.6216e-07,
          4.0382e-09, 7.7233e-07],
         [1.5988e-07, 4.4441e-07, 1.9537e-07,  ..., 2.8636e-06,
          1.7861e-10, 2.3535e-06]],

        [[1.2708e-07, 1.9269e-08, 1.3923e-07,  ..., 7.3553e-07,
          9.8877e-07, 5.1037e-10],
         [1.2163e-09, 4.6961e-08, 1.3108e-08,  ..., 4.2830e-07,
          2.9304e-07, 1.4641e-07],
         [4.0470e-07, 3.9944e-09, 1.4610e-07,  ..., 4.6452e-08,
          1.3614e-06, 1.4783e-06],
         ...,
         [7.3782e-07, 8.2048e-10, 1.0640e-06,  ..., 3.9558e-06,
          1.0890e-07, 1.1992e-06],
         [3.2986e-09, 4.9562e-08, 6.7605e-08,  ..., 3.0317e-07,
          8.5463e-08, 4.0738e-07],
         [4.3700e-08, 5.3888e-08, 1.0585e-06,  ..., 2.4978e-07,
          2.5384e-07, 7.9342e-07]],

        [[2.0892e-07, 9.5959e-10, 7.5076e-08,  ..., 1.4971e-07,
          2.4788e-07, 1.4622e-09],
         [1.6979e-07, 2.6080e-10, 3.4705e-07,  ..., 1.2509e-06,
          5.0450e-07, 2.8899e-07],
         [8.1558e-09, 8.3741e-08, 5.5426e-11,  ..., 1.1583e-07,
          1.2292e-07, 2.1965e-07],
         ...,
         [2.7357e-07, 1.9538e-08, 8.3128e-08,  ..., 1.3341e-08,
          1.5367e-06, 1.2751e-06],
         [6.9117e-08, 5.0850e-08, 4.6825e-07,  ..., 6.6392e-07,
          1.3627e-06, 1.5091e-06],
         [4.3178e-09, 1.7781e-07, 1.2611e-11,  ..., 6.4731e-09,
          3.1682e-08, 6.7639e-08]],

        ...,

        [[3.1342e-07, 4.2543e-07, 8.4198e-11,  ..., 3.7945e-08,
          7.9635e-06, 1.7433e-05],
         [3.5362e-07, 5.1772e-07, 7.9693e-08,  ..., 8.8854e-09,
          1.9732e-07, 1.5587e-05],
         [2.0297e-07, 3.3265e-07, 2.4874e-07,  ..., 6.8265e-06,
          2.9399e-09, 1.9804e-05],
         ...,
         [1.2347e-07, 2.3919e-07, 2.8863e-08,  ..., 5.0211e-07,
          1.7288e-06, 6.8030e-07],
         [8.3718e-09, 1.4723e-08, 9.5415e-08,  ..., 1.2212e-08,
          2.9074e-08, 2.2831e-07],
         [4.9158e-11, 2.6792e-07, 8.5893e-09,  ..., 3.5610e-08,
          7.8820e-07, 6.5094e-07]],

        [[1.8570e-07, 1.2636e-05, 8.7256e-06,  ..., 7.4170e-07,
          6.9252e-06, 3.4802e-05],
         [2.1635e-07, 4.7600e-06, 2.7766e-06,  ..., 4.2225e-05,
          1.1677e-06, 2.0590e-09],
         [4.7957e-08, 7.7782e-07, 1.0415e-09,  ..., 1.6784e-05,
          3.9238e-06, 3.8503e-05],
         ...,
         [7.7532e-09, 3.1963e-07, 2.9059e-07,  ..., 1.1338e-08,
          5.6940e-07, 9.2031e-09],
         [2.3676e-08, 6.9482e-09, 1.1301e-07,  ..., 1.6689e-07,
          2.5818e-07, 1.8143e-06],
         [7.6206e-08, 1.3198e-10, 2.6622e-08,  ..., 1.5912e-08,
          2.3992e-07, 5.8509e-07]],

        [[1.6782e-05, 1.1596e-04, 1.5247e-05,  ..., 2.2936e-05,
          2.3770e-04, 7.9748e-06],
         [8.2517e-05, 3.7772e-05, 2.4939e-04,  ..., 5.2544e-04,
          1.3702e-04, 1.0135e-05],
         [1.7465e-05, 1.0085e-08, 1.8353e-05,  ..., 1.0821e-05,
          1.5047e-05, 1.5000e-06],
         ...,
         [4.1638e-08, 6.8974e-09, 4.0500e-10,  ..., 2.3185e-06,
          3.7937e-09, 1.6041e-06],
         [3.2242e-08, 1.7366e-07, 5.4251e-07,  ..., 6.8896e-07,
          3.6517e-07, 1.1126e-07],
         [5.2004e-09, 7.9940e-08, 1.0862e-07,  ..., 1.1356e-06,
          4.9491e-07, 9.7482e-08]]], grad_fn=<CopySlices>) 

mat_uij: 
tensor([[[0.0004, 0.0002, 0.0004,  ..., 0.0007, 0.0009, 0.0005],
         [0.0007, 0.0005, 0.0004,  ..., 0.0004, 0.0004, 0.0004],
         [0.0001, 0.0002, 0.0002,  ..., 0.0006, 0.0004, 0.0001],
         ...,
         [0.0007, 0.0006, 0.0004,  ..., 0.0006, 0.0007, 0.0002],
         [0.0006, 0.0005, 0.0004,  ..., 0.0004, 0.0004, 0.0005],
         [0.0004, 0.0007, 0.0006,  ..., 0.0008, 0.0005, 0.0008]],

        [[0.0007, 0.0004, 0.0006,  ..., 0.0004, 0.0005, 0.0010],
         [0.0007, 0.0007, 0.0006,  ..., 0.0006, 0.0004, 0.0002],
         [0.0001, 0.0006, 0.0001,  ..., 0.0002, 0.0002, 0.0004],
         ...,
         [0.0004, 0.0007, 0.0003,  ..., 0.0002, 0.0005, 0.0006],
         [0.0004, 0.0005, 0.0007,  ..., 0.0001, 0.0003, 0.0007],
         [0.0003, 0.0003, 0.0007,  ..., 0.0003, 0.0008, 0.0008]],

        [[0.0003, 0.0006, 0.0006,  ..., 0.0002, 0.0008, 0.0003],
         [0.0003, 0.0006, 0.0005,  ..., 0.0006, 0.0002, 0.0005],
         [0.0006, 0.0005, 0.0003,  ..., 0.0001, 0.0004, 0.0004],
         ...,
         [0.0004, 0.0007, 0.0004,  ..., 0.0002, 0.0002, 0.0007],
         [0.0004, 0.0005, 0.0005,  ..., 0.0003, 0.0004, 0.0002],
         [0.0003, 0.0005, 0.0002,  ..., 0.0006, 0.0006, 0.0007]],

        ...,

        [[0.0007, 0.0004, 0.0007,  ..., 0.0004, 0.0019, 0.0083],
         [0.0002, 0.0005, 0.0007,  ..., 0.0001, 0.0019, 0.0068],
         [0.0005, 0.0004, 0.0007,  ..., 0.0030, 0.0031, 0.0081],
         ...,
         [0.0005, 0.0005, 0.0006,  ..., 0.0001, 0.0006, 0.0006],
         [0.0003, 0.0001, 0.0006,  ..., 0.0008, 0.0006, 0.0004],
         [0.0003, 0.0005, 0.0001,  ..., 0.0007, 0.0007, 0.0001]],

        [[0.0031, 0.0032, 0.0051,  ..., 0.0002, 0.0067, 0.0052],
         [0.0018, 0.0051, 0.0016,  ..., 0.0016, 0.0006, 0.0033],
         [0.0004, 0.0039, 0.0016,  ..., 0.0063, 0.0009, 0.0045],
         ...,
         [0.0005, 0.0009, 0.0007,  ..., 0.0003, 0.0005, 0.0008],
         [0.0001, 0.0007, 0.0002,  ..., 0.0007, 0.0005, 0.0004],
         [0.0002, 0.0001, 0.0003,  ..., 0.0006, 0.0004, 0.0005]],

        [[0.0081, 0.0082, 0.0091,  ..., 0.0055, 0.0024, 0.0065],
         [0.0099, 0.0123, 0.0139,  ..., 0.0081, 0.0057, 0.0056],
         [0.0024, 0.0019, 0.0008,  ..., 0.0028, 0.0052, 0.0047],
         ...,
         [0.0008, 0.0009, 0.0005,  ..., 0.0004, 0.0003, 0.0005],
         [0.0006, 0.0007, 0.0007,  ..., 0.0001, 0.0008, 0.0003],
         [0.0003, 0.0005, 0.0007,  ..., 0.0007, 0.0006, 0.0008]]],
       grad_fn=<CopySlices>) 

loss = loss1 + lambda*loss2
loss1:0.0 loss2:372.5306396484375
t:3, Finish constructing loss
